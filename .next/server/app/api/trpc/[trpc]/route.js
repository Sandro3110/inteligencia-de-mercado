(()=>{var e={};e.id=841,e.ids=[841],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},79428:e=>{"use strict";e.exports=require("buffer")},81115:e=>{"use strict";e.exports=require("constants")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},79748:e=>{"use strict";e.exports=require("fs/promises")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},41204:e=>{"use strict";e.exports=require("string_decoder")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},78460:(t,r,i)=>{"use strict";let n,s,a,o,l,u,c,h,d,p;i.r(r),i.d(r,{patchFetch:()=>yr,routeModule:()=>g7,serverHooks:()=>yt,workAsyncStorage:()=>g9,workUnitAsyncStorage:()=>ye});var f,m,g,y,v,b,w,x,S,E,T,k,O,C,A,N,R,I,P,j,D,L,$,F,M,B,U,z,q,H,W,V,G,K,J,Q,Z,X,Y,ee,et,er,ei,en,es,ea,eo,el,eu,ec,eh,ed,ep,ef,em,eg,ey,e_,ev,eb,ew,ex,eS,eE,eT,ek,eO,eC,eA,eN,eR,eI,eP,ej,eD,eL,e$,eF,eM,eB,eU,ez,eq,eH,eW,eV,eG,eK,eJ,eQ,eZ,eX,eY,e0,e1,e2,e5,e6,e3,e4,e8={};i.r(e8);var e7={};i.r(e7),i.d(e7,{jD:()=>u4,EY:()=>ce,Z4:()=>ct,zW:()=>u8,Qz:()=>u7,W6:()=>u9});var e9={};i.r(e9),i.d(e9,{GET:()=>g8,POST:()=>g8,dynamic:()=>g4,runtime:()=>g3});var te=i(94287),tt=i(65432),tr=i(53303);let ti={PARSE_ERROR:-32700,BAD_REQUEST:-32600,INTERNAL_SERVER_ERROR:-32603,NOT_IMPLEMENTED:-32603,BAD_GATEWAY:-32603,SERVICE_UNAVAILABLE:-32603,GATEWAY_TIMEOUT:-32603,UNAUTHORIZED:-32001,PAYMENT_REQUIRED:-32002,FORBIDDEN:-32003,NOT_FOUND:-32004,METHOD_NOT_SUPPORTED:-32005,TIMEOUT:-32008,CONFLICT:-32009,PRECONDITION_FAILED:-32012,PAYLOAD_TOO_LARGE:-32013,UNSUPPORTED_MEDIA_TYPE:-32015,UNPROCESSABLE_CONTENT:-32022,PRECONDITION_REQUIRED:-32028,TOO_MANY_REQUESTS:-32029,CLIENT_CLOSED_REQUEST:-32099},tn={[-32700]:"PARSE_ERROR",[-32600]:"BAD_REQUEST",[-32603]:"INTERNAL_SERVER_ERROR",[-32001]:"UNAUTHORIZED",[-32002]:"PAYMENT_REQUIRED",[-32003]:"FORBIDDEN",[-32004]:"NOT_FOUND",[-32005]:"METHOD_NOT_SUPPORTED",[-32008]:"TIMEOUT",[-32009]:"CONFLICT",[-32012]:"PRECONDITION_FAILED",[-32013]:"PAYLOAD_TOO_LARGE",[-32015]:"UNSUPPORTED_MEDIA_TYPE",[-32022]:"UNPROCESSABLE_CONTENT",[-32028]:"PRECONDITION_REQUIRED",[-32029]:"TOO_MANY_REQUESTS",[-32099]:"CLIENT_CLOSED_REQUEST"};function ts(e,...t){let r=Object.assign(Object.create(null),e);for(let e of t)for(let t in e){if(t in r&&r[t]!==e[t])throw Error(`Duplicate key ${t}`);r[t]=e[t]}return r}function ta(e){return!!e&&!Array.isArray(e)&&"object"==typeof e}function to(e){return"function"==typeof e}function tl(e){return Object.assign(Object.create(null),e)}ti.BAD_GATEWAY,ti.SERVICE_UNAVAILABLE,ti.GATEWAY_TIMEOUT,ti.INTERNAL_SERVER_ERROR;let tu="function"==typeof Symbol&&!!Symbol.asyncIterator;function tc(e){return tu&&ta(e)&&Symbol.asyncIterator in e}let th=e=>e();function td(e){return e}var tp=Object.create,tf=Object.defineProperty,tm=Object.getOwnPropertyDescriptor,tg=Object.getOwnPropertyNames,ty=Object.getPrototypeOf,t_=Object.prototype.hasOwnProperty,tv=(e,t)=>function(){return t||(0,e[tg(e)[0]])((t={exports:{}}).exports,t),t.exports},tb=(e,t,r,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(var n,s=tg(t),a=0,o=s.length;a<o;a++)n=s[a],t_.call(e,n)||n===r||tf(e,n,{get:(e=>t[e]).bind(null,n),enumerable:!(i=tm(t,n))||i.enumerable});return e},tw=(e,t,r)=>(r=null!=e?tp(ty(e)):{},tb(!t&&e&&e.__esModule?r:tf(r,"default",{value:e,enumerable:!0}),e));let tx=()=>{},tS=e=>{Object.freeze&&Object.freeze(e)},tE=e=>(function e(t,r,i){var n;let s=r.join(".");return null!==(n=i[s])&&void 0!==n||(i[s]=new Proxy(tx,{get(n,s){if("string"==typeof s&&"then"!==s)return e(t,[...r,s],i)},apply(e,i,n){let s=r[r.length-1],a={args:n,path:r};return"call"===s?a={args:n.length>=2?[n[1]]:[],path:r.slice(0,-1)}:"apply"===s&&(a={args:n.length>=2?n[1]:[],path:r.slice(0,-1)}),tS(a.args),tS(a.path),t(a)}})),i[s]})(e,[],Object.create(null)),tT={PARSE_ERROR:400,BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_SUPPORTED:405,TIMEOUT:408,CONFLICT:409,PRECONDITION_FAILED:412,PAYLOAD_TOO_LARGE:413,UNSUPPORTED_MEDIA_TYPE:415,UNPROCESSABLE_CONTENT:422,PRECONDITION_REQUIRED:428,TOO_MANY_REQUESTS:429,CLIENT_CLOSED_REQUEST:499,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504};function tk(e){var t;return null!==(t=tT[e])&&void 0!==t?t:500}var tO=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/typeof.js"(e,t){function r(e){return t.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}}),tC=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPrimitive.js"(e,t){var r=tO().default;t.exports=function(e,t){if("object"!=r(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=r(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},t.exports.__esModule=!0,t.exports.default=t.exports}}),tA=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPropertyKey.js"(e,t){var r=tO().default,i=tC();t.exports=function(e){var t=i(e,"string");return"symbol"==r(t)?t:t+""},t.exports.__esModule=!0,t.exports.default=t.exports}}),tN=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/defineProperty.js"(e,t){var r=tA();t.exports=function(e,t,i){return(t=r(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},t.exports.__esModule=!0,t.exports.default=t.exports}}),tR=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectSpread2.js"(e,t){var r=tN();function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}t.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e},t.exports.__esModule=!0,t.exports.default=t.exports}}),tI=tw(tR(),1);function tP(e){let{path:t,error:r,config:i}=e,{code:n}=e.error,s={message:r.message,code:ti[n],data:{code:n,httpStatus:tk(r.code)}};return i.isDev&&"string"==typeof e.error.stack&&(s.data.stack=e.error.stack),"string"==typeof t&&(s.data.path=t),i.errorFormatter((0,tI.default)((0,tI.default)({},e),{},{shape:s}))}let tj=({shape:e})=>e;var tD=tw(tN(),1),tL=class extends Error{};function t$(e){if(e instanceof tF||e instanceof Error&&"TRPCError"===e.name)return e;let t=new tF({code:"INTERNAL_SERVER_ERROR",cause:e});return e instanceof Error&&e.stack&&(t.stack=e.stack),t}var tF=class extends Error{constructor(e){var t,r,i;let n=function(e){if(e instanceof Error)return e;let t=typeof e;if("undefined"!==t&&"function"!==t&&null!==e){if("object"!==t)return Error(String(e));if(ta(e))return Object.assign(new tL,e)}}(e.cause);super(null!==(t=null!==(r=e.message)&&void 0!==r?r:null==n?void 0:n.message)&&void 0!==t?t:e.code,{cause:n}),(0,tD.default)(this,"cause",void 0),(0,tD.default)(this,"code",void 0),this.code=e.code,this.name="TRPCError",null!==(i=this.cause)&&void 0!==i||(this.cause=n)}},tM=tw(tR(),1);let tB={input:{serialize:e=>e,deserialize:e=>e},output:{serialize:e=>e,deserialize:e=>e}};function tU(e,t){return"error"in t?(0,tM.default)((0,tM.default)({},t),{},{error:e.transformer.output.serialize(t.error)}):"data"in t.result?(0,tM.default)((0,tM.default)({},t),{},{result:(0,tM.default)((0,tM.default)({},t.result),{},{data:e.transformer.output.serialize(t.result.data)})}):t}function tz(e,t){return Array.isArray(t)?t.map(t=>tU(e,t)):tU(e,t)}var tq=tw(tR(),1);let tH={_ctx:null,_errorShape:null,_meta:null,queries:{},mutations:{},subscriptions:{},errorFormatter:tj,transformer:tB},tW=["then","call","apply"];function tV(e){return function(t){let r=new Set(Object.keys(t).filter(e=>tW.includes(e)));if(r.size>0)throw Error("Reserved words used in `router({})` call: "+Array.from(r).join(", "));let i=tl({}),n=tl({}),s=function e(t,r=[]){let s=tl({});for(let[a,o]of Object.entries(null!=t?t:{})){if("function"==typeof o&&"lazyMarker"in o){n[[...r,a].join(".")]=function t(r){return{ref:r.ref,load:function(e){let t=Symbol(),r=t;return()=>(r===t&&(r=e()),r)}(async()=>{let i=await r.ref(),s=[...r.path,r.key],a=s.join(".");for(let[o,l]of(r.aggregate[r.key]=e(i._def.record,s),delete n[a],Object.entries(i._def.lazy)))n[[...s,o].join(".")]=t({ref:l.ref,path:s,key:o,aggregate:r.aggregate[r.key]})})}}({path:r,ref:o,key:a,aggregate:s});continue}if(ta(o)&&ta(o._def)&&"router"in o._def){s[a]=e(o._def.record,[...r,a]);continue}if("function"!=typeof o){s[a]=e(o,[...r,a]);continue}let t=[...r,a].join(".");if(i[t])throw Error(`Duplicate key: ${t}`);i[t]=o,s[a]=o}return s}(t),a=(0,tq.default)((0,tq.default)({_config:e,router:!0,procedures:i,lazy:n},tH),{},{record:s});return(0,tq.default)((0,tq.default)({},s),{},{_def:a,createCaller:tK()({_def:a})})}}async function tG(e,t){let{_def:r}=e,i=r.procedures[t];for(;!i;){let e=Object.keys(r.lazy).find(e=>t.startsWith(e));if(!e)return null;let n=r.lazy[e];await n.load(),i=r.procedures[t]}return i}function tK(){return function(e){let{_def:t}=e;return function(r,i){return tE(async n=>{let s;let{path:a,args:o}=n,l=a.join(".");if(1===a.length&&"_def"===a[0])return t;let u=await tG(e,l);try{if(!u)throw new tF({code:"NOT_FOUND",message:`No procedure found on path "${a}"`});return s=to(r)?await Promise.resolve(r()):r,await u({path:l,getRawInput:async()=>o[0],ctx:s,type:u._def.type,signal:null==i?void 0:i.signal})}catch(e){var c,h;throw null==i||null===(c=i.onError)||void 0===c||c.call(i,{ctx:s,error:t$(e),input:o[0],path:l,type:null!==(h=null==u?void 0:u._def.type)&&void 0!==h?h:"unknown"}),e}})}}}function tJ(...e){var t,r;let i=ts({},...e.map(e=>e._def.record));return tV({errorFormatter:e.reduce((e,t)=>{if(t._def._config.errorFormatter&&t._def._config.errorFormatter!==tj){if(e!==tj&&e!==t._def._config.errorFormatter)throw Error("You seem to have several error formatters");return t._def._config.errorFormatter}return e},tj),transformer:e.reduce((e,t)=>{if(t._def._config.transformer&&t._def._config.transformer!==tB){if(e!==tB&&e!==t._def._config.transformer)throw Error("You seem to have several transformers");return t._def._config.transformer}return e},tB),isDev:e.every(e=>e._def._config.isDev),allowOutsideOfServer:e.every(e=>e._def._config.allowOutsideOfServer),isServer:e.every(e=>e._def._config.isServer),$types:null===(t=e[0])||void 0===t?void 0:t._def._config.$types,sse:null===(r=e[0])||void 0===r?void 0:r._def._config.sse})(i)}let tQ=Symbol();function tZ(e){return"object"==typeof e&&null!==e&&"subscribe"in e}function tX(e,t){let r=(function(e,t){let r=null,i=()=>{null==r||r.unsubscribe(),r=null,t.removeEventListener("abort",i)};return new ReadableStream({start(n){r=e.subscribe({next(e){n.enqueue({ok:!0,value:e})},error(e){n.enqueue({ok:!1,error:e}),n.close()},complete(){n.close()}}),t.aborted?i():t.addEventListener("abort",i,{once:!0})},cancel(){i()}})})(e,t).getReader(),i={async next(){let e=await r.read();if(e.done)return{value:void 0,done:!0};let{value:t}=e;if(!t.ok)throw t.error;return{value:t.value,done:!1}},return:async()=>(await r.cancel(),{value:void 0,done:!0})};return{[Symbol.asyncIterator]:()=>i}}var tY=tw(tR(),1);function t0(e){let t=null,r=Symbol.for("@trpc/server/http/memo"),i=r;return{read:async()=>{var n;return i!==r||(null!==(n=t)&&void 0!==n||(t=e().catch(e=>{if(e instanceof tF)throw e;throw new tF({code:"BAD_REQUEST",message:e instanceof Error?e.message:"Invalid input",cause:e})})),i=await t,t=null),i},result:()=>i!==r?i:void 0}}let t1={isMatch(e){var t;return!!(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.startsWith("application/json"))},async parse(e){var t;let{req:r}=e,i="1"===e.searchParams.get("batch"),n=i?e.path.split(","):[e.path],s=t0(async()=>{let t;if("GET"===r.method){let r=e.searchParams.get("input");r&&(t=JSON.parse(r))}else t=await r.json();if(void 0===t)return{};if(!i)return{0:e.router._def._config.transformer.input.deserialize(t)};if(!ta(t))throw new tF({code:"BAD_REQUEST",message:'"input" needs to be an object when doing a batch call'});let s={};for(let r of n.keys()){let i=t[r];void 0!==i&&(s[r]=e.router._def._config.transformer.input.deserialize(i))}return s}),a=await Promise.all(n.map(async(t,r)=>{let i=await tG(e.router,t);return{path:t,procedure:i,getRawInput:async()=>{let t=(await s.read())[r];if((null==i?void 0:i._def.type)==="subscription"){var n,a,o;let r=null!==(n=null!==(a=e.headers.get("last-event-id"))&&void 0!==a?a:e.searchParams.get("lastEventId"))&&void 0!==n?n:e.searchParams.get("Last-Event-Id");r&&(ta(t)?t=(0,tY.default)((0,tY.default)({},t),{},{lastEventId:r}):null!==(o=t)&&void 0!==o||(t={lastEventId:r}))}return t},result:()=>{var e;return null===(e=s.result())||void 0===e?void 0:e[r]}}})),o=new Set(a.map(e=>{var t;return null===(t=e.procedure)||void 0===t?void 0:t._def.type}).filter(Boolean));if(o.size>1)throw new tF({code:"BAD_REQUEST",message:`Cannot mix procedure types in call: ${Array.from(o).join(", ")}`});let l=null!==(t=o.values().next().value)&&void 0!==t?t:"unknown",u=e.searchParams.get("connectionParams");return{isBatchCall:i,accept:r.headers.get("trpc-accept"),calls:a,type:l,connectionParams:null===u?null:function(e){let t;try{t=JSON.parse(e)}catch(e){throw new tF({code:"PARSE_ERROR",message:"Not JSON-parsable query params",cause:e})}return function(e){try{if(null===e)return null;if(!ta(e))throw Error("Expected object");let t=Object.entries(e).filter(([e,t])=>"string"!=typeof t);if(t.length>0)throw Error(`Expected connectionParams to be string values. Got ${t.map(([e,t])=>`${e}: ${typeof t}`).join(", ")}`);return e}catch(e){throw new tF({code:"PARSE_ERROR",message:"Invalid connection params shape",cause:e})}}(t)}(u),signal:r.signal,url:e.url}}},t2=[t1,{isMatch(e){var t;return!!(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.startsWith("multipart/form-data"))},async parse(e){let{req:t}=e;if("POST"!==t.method)throw new tF({code:"METHOD_NOT_SUPPORTED",message:"Only POST requests are supported for multipart/form-data requests"});let r=t0(async()=>await t.formData()),i=await tG(e.router,e.path);return{accept:null,calls:[{path:e.path,getRawInput:r.read,result:r.result,procedure:i}],isBatchCall:!1,type:"mutation",connectionParams:null,signal:t.signal,url:e.url}}},{isMatch(e){var t;return!!(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.startsWith("application/octet-stream"))},async parse(e){let{req:t}=e;if("POST"!==t.method)throw new tF({code:"METHOD_NOT_SUPPORTED",message:"Only POST requests are supported for application/octet-stream requests"});let r=t0(async()=>t.body);return{calls:[{path:e.path,getRawInput:r.read,result:r.result,procedure:await tG(e.router,e.path)}],isBatchCall:!1,accept:null,type:"mutation",connectionParams:null,signal:t.signal,url:e.url}}}];async function t5(e){let t=function(e){let t=t2.find(t=>t.isMatch(e));if(t)return t;if(!t&&"GET"===e.method)return t1;throw new tF({code:"UNSUPPORTED_MEDIA_TYPE",message:e.headers.has("content-type")?`Unsupported content-type "${e.headers.get("content-type")}`:"Missing content-type header"})}(e.req);return await t.parse(e)}function t6(e="AbortError"){throw new DOMException(e,"AbortError")}function t3(e){return"[object Object]"===Object.prototype.toString.call(e)}var t4=tw(tN(),1);let t8=new WeakMap,t7=()=>{};n=Symbol.toStringTag;var t9=class e{constructor(e){(0,t4.default)(this,"promise",void 0),(0,t4.default)(this,"subscribers",[]),(0,t4.default)(this,"settlement",null),(0,t4.default)(this,n,"Unpromise"),"function"==typeof e?this.promise=new Promise(e):this.promise=e;let t=this.promise.then(e=>{let{subscribers:t}=this;this.subscribers=null,this.settlement={status:"fulfilled",value:e},null==t||t.forEach(({resolve:t})=>{t(e)})});"catch"in t&&t.catch(e=>{let{subscribers:t}=this;this.subscribers=null,this.settlement={status:"rejected",reason:e},null==t||t.forEach(({reject:t})=>{t(e)})})}subscribe(){let e,t;let{settlement:r}=this;if(null===r){let r,i;if(null===this.subscribers)throw Error("Unpromise settled but still has subscribers");let n={promise:new Promise((e,t)=>{r=e,i=t}),resolve:r,reject:i};this.subscribers=[...this.subscribers,n],e=n.promise,t=()=>{null!==this.subscribers&&(this.subscribers=function(e,t){let r=e.indexOf(t);return -1!==r?[...e.slice(0,r),...e.slice(r+1)]:e}(this.subscribers,n))}}else{let{status:i}=r;e="fulfilled"===i?Promise.resolve(r.value):Promise.reject(r.reason),t=t7}return Object.assign(e,{unsubscribe:t})}then(e,t){let r=this.subscribe(),{unsubscribe:i}=r;return Object.assign(r.then(e,t),{unsubscribe:i})}catch(e){let t=this.subscribe(),{unsubscribe:r}=t;return Object.assign(t.catch(e),{unsubscribe:r})}finally(e){let t=this.subscribe(),{unsubscribe:r}=t;return Object.assign(t.finally(e),{unsubscribe:r})}static proxy(t){let r=e.getSubscribablePromise(t);return void 0!==r?r:e.createSubscribablePromise(t)}static createSubscribablePromise(t){let r=new e(t);return t8.set(t,r),t8.set(r,r),r}static getSubscribablePromise(e){return t8.get(e)}static resolve(t){let r="object"==typeof t&&null!==t&&"then"in t&&"function"==typeof t.then?t:Promise.resolve(t);return e.proxy(r).subscribe()}static async any(t){let r=(Array.isArray(t)?t:[...t]).map(e.resolve);try{return await Promise.any(r)}finally{r.forEach(({unsubscribe:e})=>{e()})}}static async race(t){let r=(Array.isArray(t)?t:[...t]).map(e.resolve);try{return await Promise.race(r)}finally{r.forEach(({unsubscribe:e})=>{e()})}}static async raceReferences(e){let t=e.map(re);try{return await Promise.race(t)}finally{for(let e of t)e.unsubscribe()}}};function re(e){return t9.proxy(e).then(()=>[e])}function rt(e,t){let r=e[Symbol.asyncDispose];return e[Symbol.asyncDispose]=async()=>{await t(),await (null==r?void 0:r())},e}null!==(m=(f=Symbol).dispose)&&void 0!==m||(f.dispose=Symbol()),null!==(y=(g=Symbol).asyncDispose)&&void 0!==y||(g.asyncDispose=Symbol());let rr=Symbol();function ri(e){let t=null;return function(e,t){let r=e[Symbol.dispose];return e[Symbol.dispose]=()=>{t(),null==r||r()},e}({start(){if(t)throw Error("Timer already started");return new Promise(r=>{t=setTimeout(()=>r(rr),e)})}},()=>{t&&clearTimeout(t)})}var rn=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/usingCtx.js"(e,t){t.exports=function(){var e="function"==typeof SuppressedError?SuppressedError:function(e,t){var r=Error();return r.name="SuppressedError",r.error=e,r.suppressed=t,r},t={},r=[];function i(e,t){if(null!=t){if(Object(t)!==t)throw TypeError("using declarations can only be used with objects, functions, null, or undefined.");if(e)var i=t[Symbol.asyncDispose||Symbol.for("Symbol.asyncDispose")];if(void 0===i&&(i=t[Symbol.dispose||Symbol.for("Symbol.dispose")],e))var n=i;if("function"!=typeof i)throw TypeError("Object is not disposable.");n&&(i=function(){try{n.call(t)}catch(e){return Promise.reject(e)}}),r.push({v:t,d:i,a:e})}else e&&r.push({d:t,a:e});return t}return{e:t,u:i.bind(null,!1),a:i.bind(null,!0),d:function(){var i,n=this.e,s=0;function a(){for(;i=r.pop();)try{if(!i.a&&1===s)return s=0,r.push(i),Promise.resolve().then(a);if(i.d){var e=i.d.call(i.v);if(i.a)return s|=2,Promise.resolve(e).then(a,o)}else s|=1}catch(e){return o(e)}if(1===s)return n!==t?Promise.reject(n):Promise.resolve();if(n!==t)throw n}function o(r){return n=n!==t?new e(r,n):r,a()}return a()}}},t.exports.__esModule=!0,t.exports.default=t.exports}}),rs=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/OverloadYield.js"(e,t){t.exports=function(e,t){this.v=e,this.k=t},t.exports.__esModule=!0,t.exports.default=t.exports}}),ra=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/awaitAsyncGenerator.js"(e,t){var r=rs();t.exports=function(e){return new r(e,0)},t.exports.__esModule=!0,t.exports.default=t.exports}}),ro=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/wrapAsyncGenerator.js"(e,t){var r=rs();function i(e){var t,i;function n(t,i){try{var a=e[t](i),o=a.value,l=o instanceof r;Promise.resolve(l?o.v:o).then(function(r){if(l){var i="return"===t?"return":"next";if(!o.k||r.done)return n(i,r);r=e[i](r).value}s(a.done?"return":"normal",r)},function(e){n("throw",e)})}catch(e){s("throw",e)}}function s(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?n(t.key,t.arg):i=null}this._invoke=function(e,r){return new Promise(function(s,a){var o={key:e,arg:r,resolve:s,reject:a,next:null};i?i=i.next=o:(t=i=o,n(e,r))})},"function"!=typeof e.return&&(this.return=void 0)}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)},t.exports=function(e){return function(){return new i(e.apply(this,arguments))}},t.exports.__esModule=!0,t.exports.default=t.exports}}),rl=tw(rn(),1),ru=tw(ra(),1),rc=tw(ro(),1);function rh(e){let t=e[Symbol.asyncIterator]();return t[Symbol.asyncDispose]?t:rt(t,async()=>{var e;await (null===(e=t.return)||void 0===e?void 0:e.call(t))})}function rd(){return(rd=(0,rc.default)(function*(e,t){try{let i;var r=(0,rl.default)();let n=r.a(rh(e)),s=r.u(ri(t.maxDurationMs)).start();for(;;){if((i=yield(0,ru.default)(t9.race([n.next(),s])))===rr&&t6(),i.done)return i;yield i.value,i=null}}catch(e){r.e=e}finally{yield(0,ru.default)(r.d())}})).apply(this,arguments)}function rp(){return(rp=(0,rc.default)(function*(e,t){try{let i;var r=(0,rl.default)();let n=r.a(rh(e)),s=r.u(ri(t.gracePeriodMs)),a=t.count,o=new Promise(()=>{});for(;;){if((i=yield(0,ru.default)(t9.race([n.next(),o])))===rr&&t6(),i.done)return i.value;yield i.value,0==--a&&(o=s.start()),i=null}}catch(e){r.e=e}finally{yield(0,ru.default)(r.d())}})).apply(this,arguments)}function rf(){let e,t;return{promise:new Promise((r,i)=>{e=r,t=i}),resolve:e,reject:t}}var rm=tw(rn(),1),rg=tw(ra(),1),ry=tw(ro(),1);function r_(e){let t=e[Symbol.asyncIterator]();return new ReadableStream({async cancel(){var e;await (null===(e=t.return)||void 0===e?void 0:e.call(t))},async pull(e){let r=await t.next();if(r.done){e.close();return}e.enqueue(r.value)}})}var rv=tw(rn(),1),rb=tw(ra(),1),rw=tw(ro(),1);let rx=Symbol("ping");function rS(e,t){return rE.apply(this,arguments)}function rE(){return(rE=(0,rw.default)(function*(e,t){try{let n;var r=(0,rv.default)();let s=r.a(rh(e)),a=s.next();for(;;)try{var i=(0,rv.default)();let e=i.u(ri(t));if((n=yield(0,rb.default)(t9.race([a,e.start()])))===rr){yield rx;continue}if(n.done)return n.value;a=s.next(),yield n.value,n=null}catch(e){i.e=e}finally{i.d()}}catch(e){r.e=e}finally{yield(0,rb.default)(r.d())}})).apply(this,arguments)}var rT=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/asyncIterator.js"(e,t){function r(e){function t(e){if(Object(e)!==e)return Promise.reject(TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return(r=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new r(e)}t.exports=function(e){var t,i,n,s=2;for("undefined"!=typeof Symbol&&(i=Symbol.asyncIterator,n=Symbol.iterator);s--;){if(i&&null!=(t=e[i]))return t.call(e);if(n&&null!=(t=e[n]))return new r(t.call(e));i="@@asyncIterator",n="@@iterator"}throw TypeError("Object is not async iterable")},t.exports.__esModule=!0,t.exports.default=t.exports}}),rk=tw(ra(),1),rO=tw(ro(),1),rC=tw(rn(),1),rA=tw(rT(),1);function rN(e){return(ta(e)||to(e))&&"function"==typeof(null==e?void 0:e.then)&&"function"==typeof(null==e?void 0:e.catch)}var rR=class extends Error{constructor(e){super("Max depth reached at path: "+e.join(".")),this.path=e}};function rI(){return(rI=(0,rO.default)(function*(e){let{data:t}=e,r=0,i=function(){let e="idle",t=rf(),r=[],i=new Set,n=[];function s(r){if("pending"!==e)return;let s=function(e,t){let r=e[Symbol.asyncIterator](),i="idle";function n(){i="done",t=()=>{}}return{pull:function(){"idle"===i&&(i="pending",r.next().then(e=>{if(e.done){i="done",t({status:"return",value:e.value}),n();return}i="idle",t({status:"yield",value:e.value})}).catch(e=>{t({status:"error",error:e}),n()}))},destroy:async()=>{var e;n(),await (null===(e=r.return)||void 0===e?void 0:e.call(r))}}}(r,r=>{if("pending"===e){switch(r.status){case"yield":n.push([s,r]);break;case"return":i.delete(s);break;case"error":n.push([s,r]),i.delete(s)}t.resolve()}});i.add(s),s.pull()}return{add(t){switch(e){case"idle":r.push(t);break;case"pending":s(t)}},[Symbol.asyncIterator]:()=>(0,ry.default)(function*(){try{var a=(0,rm.default)();if("idle"!==e)throw Error("Cannot iterate twice");for(e="pending",a.a(rt({},async()=>{e="done";let r=[];if(await Promise.all(Array.from(i.values()).map(async e=>{try{await e.destroy()}catch(e){r.push(e)}})),n.length=0,i.clear(),t.resolve(),r.length>0)throw AggregateError(r)}));r.length>0;)s(r.shift());for(;i.size>0;){for(yield(0,rg.default)(t.promise);n.length>0;){let[e,t]=n.shift();switch(t.status){case"yield":yield t.value,e.pull();break;case"error":throw t.error}}t=rf()}}catch(e){a.e=e}finally{yield(0,rg.default)(a.d())}})()}}();function n(e){let t=r++,n=e(t);return i.add(n),t}function s(t){return e.maxDepth&&t.length>e.maxDepth?new rR(t):null}function a(t,r){var i,a,l;if(rN(t))return[0,(i=t,n((a=(0,rO.default)(function*(t){let n=s(r);n&&(i.catch(t=>{var i;null===(i=e.onError)||void 0===i||i.call(e,{error:t,path:r})}),i=Promise.reject(n));try{let e=yield(0,rk.default)(i);yield[t,0,o(e,r)]}catch(i){var a,l;null===(a=e.onError)||void 0===a||a.call(e,{error:i,path:r}),yield[t,1,null===(l=e.formatError)||void 0===l?void 0:l.call(e,{error:i,path:r})]}}),function(e){return a.apply(this,arguments)})))];if(tc(t)){if(e.maxDepth&&r.length>=e.maxDepth)throw Error("Max depth reached");return[1,n((l=(0,rO.default)(function*(i){try{var n,a,l=(0,rC.default)();let u=s(r);if(u)throw u;let c=l.a(rh(t));try{for(;;){let e=yield(0,rk.default)(c.next());if(e.done){yield[i,0,o(e.value,r)];break}yield[i,1,o(e.value,r)]}}catch(t){null===(n=e.onError)||void 0===n||n.call(e,{error:t,path:r}),yield[i,2,null===(a=e.formatError)||void 0===a?void 0:a.call(e,{error:t,path:r})]}}catch(e){l.e=e}finally{yield(0,rk.default)(l.d())}}),function(e){return l.apply(this,arguments)}))]}return null}function o(e,t){var r,i;if(void 0===e)return[[]];let n=a(e,t);if(n)return[[0],[null,...n]];if(!(!1!==t3(e)&&(void 0===(r=e.constructor)||!1!==t3(i=r.prototype)&&!1!==i.hasOwnProperty("isPrototypeOf"))))return[[e]];let s={},o=[];for(let[r,i]of Object.entries(e)){let e=a(i,[...t,r]);if(!e){s[r]=i;continue}s[r]=0,o.push([r,...e])}return[[s],...o]}let l={};for(let[e,r]of Object.entries(t))l[e]=o(r,[e]);yield l;let u=i;e.pingMs&&(u=rS(i,e.pingMs));var c=!1,h=!1;try{for(var d,p,f=(0,rA.default)(u);c=!(p=yield(0,rk.default)(f.next())).done;c=!1){let e=p.value;yield e}}catch(e){h=!0,d=e}finally{try{c&&null!=f.return&&(yield(0,rk.default)(f.return()))}finally{if(h)throw d}}})).apply(this,arguments)}var rP=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/asyncGeneratorDelegate.js"(e,t){var r=rs();t.exports=function(e){var t={},i=!1;function n(t,n){return i=!0,{done:!1,value:new r(n=new Promise(function(r){r(e[t](n))}),1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return i?(i=!1,e):n("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(i)throw i=!1,e;return n("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return i?(i=!1,e):n("return",e)}),t},t.exports.__esModule=!0,t.exports.default=t.exports}}),rj=tw(rT(),1),rD=tw(ra(),1),rL=tw(ro(),1),r$=tw(rP(),1);tw(rn(),1);let rF={"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform","X-Accel-Buffering":"no",Connection:"keep-alive"};var rM=tw(ro(),1),rB=tw(tR(),1);function rU(e){return th((0,rM.default)(function*(){throw e}))}let rz={mutation:["POST"],query:["GET"],subscription:["GET"]},rq={mutation:["POST"],query:["GET","POST"],subscription:["GET","POST"]};function rH(e){var t,r,i;let{ctx:n,info:s,responseMeta:a,untransformedJSON:o,errors:l=[],headers:u}=e,c=o?function(e){let t=new Set((Array.isArray(e)?e:[e]).map(e=>{if("error"in e&&ta(e.error.data)){var t;return"number"==typeof(null===(t=e.error.data)||void 0===t?void 0:t.httpStatus)?e.error.data.httpStatus:tk(tn[e.error.code])}return 200}));return 1!==t.size?207:t.values().next().value}(o):200,h=!o,d=h?[]:Array.isArray(o)?o:[o],p=null!==(t=null==a?void 0:a({ctx:n,info:s,paths:null==s?void 0:s.calls.map(e=>e.path),data:d,errors:l,eagerGeneration:h,type:null!==(r=null==s||null===(i=s.calls.find(e=>{var t;return null===(t=e.procedure)||void 0===t?void 0:t._def.type}))||void 0===i||null===(i=i.procedure)||void 0===i?void 0:i._def.type)&&void 0!==r?r:"unknown"}))&&void 0!==t?t:{};if(p.headers){if(p.headers instanceof Headers)for(let[e,t]of p.headers.entries())u.append(e,t);else for(let[e,t]of Object.entries(p.headers))if(Array.isArray(t))for(let r of t)u.append(e,r);else"string"==typeof t&&u.set(e,t)}return p.status&&(c=p.status),{status:c}}function rW(e){return!!ta(e)&&(!!tc(e)||Object.values(e).some(rN)||Object.values(e).some(tc))}async function rV(e){var t,r,i,n,s,a,o;let{router:l,req:u}=e,c=new Headers([["vary","trpc-accept"]]),h=l._def._config,d=new URL(u.url);if("HEAD"===u.method)return new Response(null,{status:204});let p=null===(t=null!==(r=e.allowBatching)&&void 0!==r?r:null===(i=e.batching)||void 0===i?void 0:i.enabled)||void 0===t||t,f=null!==(n=e.allowMethodOverride)&&void 0!==n&&n&&"POST"===u.method,m=await th(async()=>{try{return[void 0,await t5({req:u,path:decodeURIComponent(e.path),router:l,searchParams:d.searchParams,headers:e.req.headers,url:d})]}catch(e){return[t$(e),void 0]}}),g=th(()=>{let t;return{valueOrUndefined:()=>{if(t)return t[1]},value:()=>{let[e,r]=t;if(e)throw e;return r},create:async r=>{if(t)throw Error("This should only be called once - report a bug in tRPC");try{let i=await e.createContext({info:r});t=[void 0,i]}catch(e){t=[t$(e),void 0]}}}}),y=f?rq:rz,v="application/jsonl"===u.headers.get("trpc-accept"),b=null===(s=null===(a=h.sse)||void 0===a?void 0:a.enabled)||void 0===s||s;try{let[t,r]=m;if(t)throw t;if(r.isBatchCall&&!p)throw new tF({code:"BAD_REQUEST",message:"Batching is not enabled on the server"});if(v&&!r.isBatchCall)throw new tF({message:"Streaming requests must be batched (you can do a batch of 1)",code:"BAD_REQUEST"});await g.create(r);let i=r.calls.map(async t=>{let i=t.procedure;try{if(e.error)throw e.error;if(!i)throw new tF({code:"NOT_FOUND",message:`No procedure found on path "${t.path}"`});if(!y[i._def.type].includes(u.method))throw new tF({code:"METHOD_NOT_SUPPORTED",message:`Unsupported ${u.method}-request to ${i._def.type} procedure at path "${t.path}"`});if("subscription"===i._def.type&&r.isBatchCall)throw new tF({code:"BAD_REQUEST",message:"Cannot batch subscription calls"});let n=await i({path:t.path,getRawInput:t.getRawInput,ctx:g.value(),type:i._def.type,signal:e.req.signal});return[void 0,{data:n}]}catch(o){var n,s,a;let r=t$(o),i=t.result();return null===(n=e.onError)||void 0===n||n.call(e,{error:r,path:t.path,input:i,ctx:g.valueOrUndefined(),type:null!==(s=null===(a=t.procedure)||void 0===a?void 0:a._def.type)&&void 0!==s?s:"unknown",req:e.req}),[r,void 0]}});if(!r.isBatchCall){let[t]=r.calls,[n,s]=await i[0];switch(r.type){case"unknown":case"mutation":case"query":{if(c.set("content-type","application/json"),rW(null==s?void 0:s.data))throw new tF({code:"UNSUPPORTED_MEDIA_TYPE",message:"Cannot use stream-like response in non-streaming request - use httpBatchStreamLink"});let i=n?{error:tP({config:h,ctx:g.valueOrUndefined(),error:n,input:t.result(),path:t.path,type:r.type})}:{result:{data:s.data}},a=rH({ctx:g.valueOrUndefined(),info:r,responseMeta:e.responseMeta,errors:n?[n]:[],headers:c,untransformedJSON:[i]});return new Response(JSON.stringify(tz(h,i)),{status:a.status,headers:c})}case"subscription":{let i=th(()=>n?rU(n):b?tZ(s.data)||tc(s.data)?tZ(s.data)?tX(s.data,e.req.signal):s.data:rU(new tF({message:`Subscription ${t.path} did not return an observable or a AsyncGenerator`,code:"INTERNAL_SERVER_ERROR"})):rU(new tF({code:"METHOD_NOT_SUPPORTED",message:'Missing experimental flag "sseSubscriptions"'}))),a=function(e){var t,r,i,n,s;let{serialize:a=td}=e,o={enabled:null!==(t=null===(r=e.ping)||void 0===r?void 0:r.enabled)&&void 0!==t&&t,intervalMs:null!==(i=null===(n=e.ping)||void 0===n?void 0:n.intervalMs)&&void 0!==i?i:1e3},l=null!==(s=e.client)&&void 0!==s?s:{};if(o.enabled&&l.reconnectAfterInactivityMs&&o.intervalMs>l.reconnectAfterInactivityMs)throw Error(`Ping interval must be less than client reconnect interval to prevent unnecessary reconnection - ping.intervalMs: ${o.intervalMs} client.reconnectAfterInactivityMs: ${l.reconnectAfterInactivityMs}`);function u(){return(u=(0,rL.default)(function*(){let t,r;yield{event:"connected",data:JSON.stringify(l)};let i=e.data;e.emitAndEndImmediately&&(i=function(e,t){return rp.apply(this,arguments)}(i,{count:1,gracePeriodMs:1})),e.maxDurationMs&&e.maxDurationMs>0&&e.maxDurationMs!==1/0&&(i=function(e,t){return rd.apply(this,arguments)}(i,{maxDurationMs:e.maxDurationMs})),o.enabled&&o.intervalMs!==1/0&&o.intervalMs>0&&(i=rS(i,o.intervalMs));var n=!1,s=!1;try{for(var u,c,h,d=(0,rj.default)(i);n=!(h=yield(0,rD.default)(d.next())).done;n=!1){if((t=h.value)===rx){yield{event:"ping",data:""};continue}(u=t,r=Array.isArray(u)&&u[2]===tQ?{id:t[0],data:t[1]}:{data:t}).data=JSON.stringify(a(r.data)),yield r,t=null,r=null}}catch(e){s=!0,c=e}finally{try{n&&null!=d.return&&(yield(0,rD.default)(d.return()))}finally{if(s)throw c}}})).apply(this,arguments)}function c(){return(c=(0,rL.default)(function*(){try{yield*(0,r$.default)((0,rj.default)(function(){return u.apply(this,arguments)}())),yield{event:"return",data:""}}catch(s){var t,r;if(ta(s)&&"AbortError"===s.name)return;let i=t$(s),n=null!==(t=null===(r=e.formatError)||void 0===r?void 0:r.call(e,{error:i}))&&void 0!==t?t:null;yield{event:"serialized-error",data:JSON.stringify(a(n))}}})).apply(this,arguments)}return r_(function(){return c.apply(this,arguments)}()).pipeThrough(new TransformStream({transform(e,t){"event"in e&&t.enqueue(`event: ${e.event}
`),"data"in e&&t.enqueue(`data: ${e.data}
`),"id"in e&&t.enqueue(`id: ${e.id}
`),"comment"in e&&t.enqueue(`: ${e.comment}
`),t.enqueue("\n\n")}})).pipeThrough(new TextEncoderStream)}((0,rB.default)((0,rB.default)({},h.sse),{},{data:i,serialize:e=>h.transformer.output.serialize(e),formatError(r){var i,n,s;let a=t$(r.error),o=null==t?void 0:t.result(),l=null==t?void 0:t.path,u=null!==(i=null==t||null===(n=t.procedure)||void 0===n?void 0:n._def.type)&&void 0!==i?i:"unknown";return null===(s=e.onError)||void 0===s||s.call(e,{error:a,path:l,input:o,ctx:g.valueOrUndefined(),req:e.req,type:u}),tP({config:h,ctx:g.valueOrUndefined(),error:a,input:o,path:l,type:u})}}));for(let[e,t]of Object.entries(rF))c.set(e,t);let o=rH({ctx:g.valueOrUndefined(),info:r,responseMeta:e.responseMeta,errors:[],headers:c,untransformedJSON:null});return new Response(a,{headers:c,status:o.status})}}}if("application/jsonl"===r.accept){c.set("content-type","application/json"),c.set("transfer-encoding","chunked");let t=rH({ctx:g.valueOrUndefined(),info:r,responseMeta:e.responseMeta,errors:[],headers:c,untransformedJSON:null}),n=function(e){let t=r_(function(e){return rI.apply(this,arguments)}(e)),{serialize:r}=e;return r&&(t=t.pipeThrough(new TransformStream({transform(e,t){e===rx?t.enqueue(rx):t.enqueue(r(e))}}))),t.pipeThrough(new TransformStream({transform(e,t){e===rx?t.enqueue(" "):t.enqueue(JSON.stringify(e)+"\n")}})).pipeThrough(new TextEncoderStream)}((0,rB.default)((0,rB.default)({},h.jsonl),{},{maxDepth:1/0,data:i.map(async t=>{let[i,n]=await t,s=r.calls[0];if(i){var a,o;return{error:tP({config:h,ctx:g.valueOrUndefined(),error:i,input:s.result(),path:s.path,type:null!==(a=null===(o=s.procedure)||void 0===o?void 0:o._def.type)&&void 0!==a?a:"unknown"})}}let l=tZ(n.data)?tX(n.data,e.req.signal):Promise.resolve(n.data);return{result:Promise.resolve({data:l})}}),serialize:e=>h.transformer.output.serialize(e),onError:t=>{var i,n;null===(i=e.onError)||void 0===i||i.call(e,{error:t$(t),path:void 0,input:void 0,ctx:g.valueOrUndefined(),req:e.req,type:null!==(n=null==r?void 0:r.type)&&void 0!==n?n:"unknown"})},formatError(e){var t,i;let n=null==r?void 0:r.calls[e.path[0]],s=t$(e.error),a=null==n?void 0:n.result(),o=null==n?void 0:n.path,l=null!==(t=null==n||null===(i=n.procedure)||void 0===i?void 0:i._def.type)&&void 0!==t?t:"unknown";return tP({config:h,ctx:g.valueOrUndefined(),error:s,input:a,path:o,type:l})}}));return new Response(n,{headers:c,status:t.status})}c.set("content-type","application/json");let n=(await Promise.all(i)).map(e=>{let[t,r]=e;return t?e:rW(r.data)?[new tF({code:"UNSUPPORTED_MEDIA_TYPE",message:"Cannot use stream-like response in non-streaming request - use httpBatchStreamLink"}),void 0]:e}),s=n.map(([e,t],i)=>{let n=r.calls[i];if(e){var s,a;return{error:tP({config:h,ctx:g.valueOrUndefined(),error:e,input:n.result(),path:n.path,type:null!==(s=null===(a=n.procedure)||void 0===a?void 0:a._def.type)&&void 0!==s?s:"unknown"})}}return{result:{data:t.data}}}),a=n.map(([e])=>e).filter(Boolean),o=rH({ctx:g.valueOrUndefined(),info:r,responseMeta:e.responseMeta,untransformedJSON:s,errors:a,headers:c});return new Response(JSON.stringify(tz(h,s)),{status:o.status,headers:c})}catch(l){let[t,r]=m,i=g.valueOrUndefined(),{error:n,untransformedJSON:s,body:a}=function(e,t){let{router:r,req:i,onError:n}=t.opts,s=t$(e);null==n||n({error:s,path:t.path,input:t.input,ctx:t.ctx,type:t.type,req:i});let a={error:tP({config:r._def._config,error:s,type:t.type,path:t.path,input:t.input,ctx:t.ctx})},o=JSON.stringify(tz(r._def._config,a));return{error:s,untransformedJSON:a,body:o}}(l,{opts:e,ctx:g.valueOrUndefined(),type:null!==(o=null==r?void 0:r.type)&&void 0!==o?o:"unknown"});return new Response(a,{status:rH({ctx:i,info:r,responseMeta:e.responseMeta,untransformedJSON:s,errors:[n],headers:c}).status,headers:c})}}var rG=tw(tR(),1);let rK=e=>e=(e=e.startsWith("/")?e.slice(1):e).endsWith("/")?e.slice(0,-1):e;async function rJ(e){let t=new Headers,r=async r=>{var i;return null===(i=e.createContext)||void 0===i?void 0:i.call(e,(0,rG.default)({req:e.req,resHeaders:t},r))},i=rK(new URL(e.req.url).pathname),n=rK(e.endpoint),s=rK(i.slice(n.length));return await rV((0,rG.default)((0,rG.default)({},e),{},{req:e.req,createContext:r,path:s,error:null,onError(t){var r;null==e||null===(r=e.onError)||void 0===r||r.call(e,(0,rG.default)((0,rG.default)({},t),{},{req:e.req}))},responseMeta(r){var i;let n=null===(i=e.responseMeta)||void 0===i?void 0:i.call(e,r);if(null==n?void 0:n.headers){if(n.headers instanceof Headers)for(let[e,r]of n.headers.entries())t.append(e,r);else for(let[e,r]of Object.entries(n.headers))if(Array.isArray(r))for(let i of r)t.append(e,i);else"string"==typeof r&&t.set(e,r)}return{headers:t,status:null==n?void 0:n.status}}}))}var rQ=tw(tR(),1);let rZ="middlewareMarker";var rX=tw(tN(),1),rY=class extends Error{constructor(e){var t;super(null===(t=e[0])||void 0===t?void 0:t.message),(0,rX.default)(this,"issues",void 0),this.name="SchemaError",this.issues=e}};function r0(e){let t="~standard"in e;if("function"==typeof e&&"function"==typeof e.assert)return e.assert.bind(e);if("function"==typeof e&&!t)return e;if("function"==typeof e.parseAsync)return e.parseAsync.bind(e);if("function"==typeof e.parse)return e.parse.bind(e);if("function"==typeof e.validateSync)return e.validateSync.bind(e);if("function"==typeof e.create)return e.create.bind(e);if("function"==typeof e.assert)return t=>(e.assert(t),t);if(t)return async t=>{let r=await e["~standard"].validate(t);if(r.issues)throw new rY(r.issues);return r.value};throw Error("Could not find a validator fn")}var r1=tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectWithoutPropertiesLoose.js"(e,t){t.exports=function(e,t){if(null==e)return{};var r={};for(var i in e)if(({}).hasOwnProperty.call(e,i)){if(t.includes(i))continue;r[i]=e[i]}return r},t.exports.__esModule=!0,t.exports.default=t.exports}}),r2=tw(tv({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectWithoutProperties.js"(e,t){var r=r1();t.exports=function(e,t){if(null==e)return{};var i,n,s=r(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)i=a[n],t.includes(i)||({}).propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s},t.exports.__esModule=!0,t.exports.default=t.exports}})(),1),r5=tw(tR(),1);let r6=["middlewares","inputs","meta"];function r3(e,t){let{middlewares:r=[],inputs:i,meta:n}=t,s=(0,r2.default)(t,r6);return r4((0,r5.default)((0,r5.default)({},ts(e,s)),{},{inputs:[...e.inputs,...null!=i?i:[]],middlewares:[...e.middlewares,...r],meta:e.meta&&n?(0,r5.default)((0,r5.default)({},e.meta),n):null!=n?n:e.meta}))}function r4(e={}){let t=(0,r5.default)({procedure:!0,inputs:[],middlewares:[]},e);return{_def:t,input(e){let r=r0(e);return r3(t,{inputs:[e],middlewares:[function(e){let t=async function(t){let r;let i=await t.getRawInput();try{r=await e(i)}catch(e){throw new tF({code:"BAD_REQUEST",cause:e})}let n=ta(t.input)&&ta(r)?(0,rQ.default)((0,rQ.default)({},t.input),r):r;return t.next({input:n})};return t._type="input",t}(r)]})},output(e){let r=r0(e);return r3(t,{output:e,middlewares:[function(e){let t=async function({next:t}){let r=await t();if(!r.ok)return r;try{let t=await e(r.data);return(0,rQ.default)((0,rQ.default)({},r),{},{data:t})}catch(e){throw new tF({message:"Output validation failed",code:"INTERNAL_SERVER_ERROR",cause:e})}};return t._type="output",t}(r)]})},meta:e=>r3(t,{meta:e}),use:e=>r3(t,{middlewares:"_middlewares"in e?e._middlewares:[e]}),unstable_concat:e=>r3(t,e._def),concat:e=>r3(t,e._def),query:e=>r8((0,r5.default)((0,r5.default)({},t),{},{type:"query"}),e),mutation:e=>r8((0,r5.default)((0,r5.default)({},t),{},{type:"mutation"}),e),subscription:e=>r8((0,r5.default)((0,r5.default)({},t),{},{type:"subscription"}),e),experimental_caller:e=>r3(t,{caller:e})}}function r8(e,t){let r=r3(e,{resolver:t,middlewares:[async function(e){return{marker:rZ,ok:!0,data:await t(e),ctx:e.ctx}}]}),i=(0,r5.default)((0,r5.default)({},r._def),{},{type:e.type,experimental_caller:!!r._def.caller,meta:r._def.meta,$types:null}),n=function(e){async function t(t){if(!t||!("getRawInput"in t))throw Error(r7);let r=await r9(0,e,t);if(!r)throw new tF({code:"INTERNAL_SERVER_ERROR",message:"No result from middlewares - did you forget to `return next()`?"});if(!r.ok)throw r.error;return r.data}return t._def=e,t.procedure=!0,t.meta=e.meta,t}(r._def),s=r._def.caller;if(!s)return n;let a=async(...e)=>await s({args:e,invoke:n,_def:i});return a._def=i,a}let r7=`
This is a client-only function.
If you want to call this function on the server, see https://trpc.io/docs/v11/server/server-side-calls
`.trim();async function r9(e,t,r){try{let i=t.middlewares[e];return await i((0,r5.default)((0,r5.default)({},r),{},{meta:t.meta,input:r.input,next(i){var n;return r9(e+1,t,(0,r5.default)((0,r5.default)({},r),{},{ctx:(null==i?void 0:i.ctx)?(0,r5.default)((0,r5.default)({},r.ctx),i.ctx):r.ctx,input:i&&"input"in i?i.input:r.input,getRawInput:null!==(n=null==i?void 0:i.getRawInput)&&void 0!==n?n:r.getRawInput}))}}))}catch(e){return{ok:!1,error:t$(e),marker:rZ}}}let ie="undefined"==typeof window||"Deno"in window||(null===(v=globalThis.process)||void 0===v||null===(v=v.env)||void 0===v?void 0:v.NODE_ENV)==="test"||!!(null===(b=globalThis.process)||void 0===b||null===(b=b.env)||void 0===b?void 0:b.JEST_WORKER_ID)||!!(null===(w=globalThis.process)||void 0===w||null===(w=w.env)||void 0===w?void 0:w.VITEST_WORKER_ID);var it=tw(tR(),1);let ir=new class e{context(){return new e}meta(){return new e}create(e){var t,r,i,n,s,a,o,l;let u=(0,it.default)((0,it.default)({},e),{},{transformer:"input"in(l=null!==(t=null==e?void 0:e.transformer)&&void 0!==t?t:tB)?l:{input:l,output:l},isDev:null!==(r=null==e?void 0:e.isDev)&&void 0!==r?r:(null===(i=globalThis.process)||void 0===i?void 0:i.env.NODE_ENV)!=="production",allowOutsideOfServer:null!==(n=null==e?void 0:e.allowOutsideOfServer)&&void 0!==n&&n,errorFormatter:null!==(s=null==e?void 0:e.errorFormatter)&&void 0!==s?s:tj,isServer:null!==(a=null==e?void 0:e.isServer)&&void 0!==a?a:ie,$types:null});if(!(null!==(o=null==e?void 0:e.isServer)&&void 0!==o?o:ie)&&(null==e?void 0:e.allowOutsideOfServer)!==!0)throw Error("You're trying to use @trpc/server in a non-server environment. This is not supported by default.");return{_config:u,procedure:r4({meta:null==e?void 0:e.defaultMeta}),middleware:function(e){return function e(t){return{_middlewares:t,unstable_pipe:r=>e([...t,..."_middlewares"in r?r._middlewares:[r]])}}([e])},router:tV(u),mergeRouters:tJ,createCallerFactory:tK()}}}().context().create(),ii=ir.router,is=ir.procedure;(function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},e.getValidEnumValues=t=>{let r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),i={};for(let e of r)i[e]=t[e];return e.objectValues(i)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(let r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t})(x||(x={})),(S||(S={})).mergeShapes=(e,t)=>({...e,...t});let ia=x.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),io=e=>{switch(typeof e){case"undefined":return ia.undefined;case"string":return ia.string;case"number":return Number.isNaN(e)?ia.nan:ia.number;case"boolean":return ia.boolean;case"function":return ia.function;case"bigint":return ia.bigint;case"symbol":return ia.symbol;case"object":if(Array.isArray(e))return ia.array;if(null===e)return ia.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return ia.promise;if("undefined"!=typeof Map&&e instanceof Map)return ia.map;if("undefined"!=typeof Set&&e instanceof Set)return ia.set;if("undefined"!=typeof Date&&e instanceof Date)return ia.date;return ia.object;default:return ia.unknown}},il=x.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class iu extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},i=e=>{for(let n of e.issues)if("invalid_union"===n.code)n.unionErrors.map(i);else if("invalid_return_type"===n.code)i(n.returnTypeError);else if("invalid_arguments"===n.code)i(n.argumentsError);else if(0===n.path.length)r._errors.push(t(n));else{let e=r,i=0;for(;i<n.path.length;){let r=n.path[i];i===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(n))):e[r]=e[r]||{_errors:[]},e=e[r],i++}}};return i(this),r}static assert(e){if(!(e instanceof iu))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,x.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let i of this.issues)if(i.path.length>0){let r=i.path[0];t[r]=t[r]||[],t[r].push(e(i))}else r.push(e(i));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}iu.create=e=>new iu(e);let ic=(e,t)=>{let r;switch(e.code){case il.invalid_type:r=e.received===ia.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case il.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,x.jsonStringifyReplacer)}`;break;case il.unrecognized_keys:r=`Unrecognized key(s) in object: ${x.joinValues(e.keys,", ")}`;break;case il.invalid_union:r="Invalid input";break;case il.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${x.joinValues(e.options)}`;break;case il.invalid_enum_value:r=`Invalid enum value. Expected ${x.joinValues(e.options)}, received '${e.received}'`;break;case il.invalid_arguments:r="Invalid function arguments";break;case il.invalid_return_type:r="Invalid function return type";break;case il.invalid_date:r="Invalid date";break;case il.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:x.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case il.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case il.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case il.custom:r="Invalid input";break;case il.invalid_intersection_types:r="Intersection results could not be merged";break;case il.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case il.not_finite:r="Number must be finite";break;default:r=t.defaultError,x.assertNever(e)}return{message:r}};!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(E||(E={}));let ih=e=>{let{data:t,path:r,errorMaps:i,issueData:n}=e,s=[...r,...n.path||[]],a={...n,path:s};if(void 0!==n.message)return{...n,path:s,message:n.message};let o="";for(let e of i.filter(e=>!!e).slice().reverse())o=e(a,{data:t,defaultError:o}).message;return{...n,path:s,message:o}};function id(e,t){let r=ih({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,ic,ic==ic?void 0:ic].filter(e=>!!e)});e.common.issues.push(r)}class ip{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let i of t){if("aborted"===i.status)return im;"dirty"===i.status&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,i=await e.value;r.push({key:t,value:i})}return ip.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let i of t){let{key:t,value:n}=i;if("aborted"===t.status||"aborted"===n.status)return im;"dirty"===t.status&&e.dirty(),"dirty"===n.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==n.value||i.alwaysSet)&&(r[t.value]=n.value)}return{status:e.value,value:r}}}let im=Object.freeze({status:"aborted"}),ig=e=>({status:"dirty",value:e}),iy=e=>({status:"valid",value:e}),i_=e=>"aborted"===e.status,iv=e=>"dirty"===e.status,ib=e=>"valid"===e.status,iw=e=>"undefined"!=typeof Promise&&e instanceof Promise;class ix{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let iS=(e,t)=>{if(ib(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new iu(e.common.issues);return this._error=t,this._error}}};function iE(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:i,description:n}=e;if(t&&(r||i))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:n}:{errorMap:(t,n)=>{let{message:s}=e;return"invalid_enum_value"===t.code?{message:s??n.defaultError}:void 0===n.data?{message:s??i??n.defaultError}:"invalid_type"!==t.code?{message:n.defaultError}:{message:s??r??n.defaultError}},description:n}}class iT{get description(){return this._def.description}_getType(e){return io(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:io(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ip,ctx:{common:e.parent.common,data:e.data,parsedType:io(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(iw(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:io(e)},i=this._parseSync({data:e,path:r.path,parent:r});return iS(r,i)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:io(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return ib(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>ib(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:io(e)},i=this._parse({data:e,path:r.path,parent:r});return iS(r,await (iw(i)?i:Promise.resolve(i)))}refine(e,t){let r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,i)=>{let n=e(t),s=()=>i.addIssue({code:il.custom,...r(t)});return"undefined"!=typeof Promise&&n instanceof Promise?n.then(e=>!!e||(s(),!1)):!!n||(s(),!1)})}refinement(e,t){return this._refinement((r,i)=>!!e(r)||(i.addIssue("function"==typeof t?t(r,i):t),!1))}_refinement(e){return new nl({schema:this,typeName:T.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return nu.create(this,this._def)}nullable(){return nc.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return i1.create(this)}promise(){return no.create(this,this._def)}or(e){return i5.create([this,e],this._def)}and(e){return i4.create(this,e,this._def)}transform(e){return new nl({...iE(this._def),schema:this,typeName:T.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new nh({...iE(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:T.ZodDefault})}brand(){return new nf({typeName:T.ZodBranded,type:this,...iE(this._def)})}catch(e){return new nd({...iE(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:T.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return nm.create(this,e)}readonly(){return ng.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let ik=/^c[^\s-]{8,}$/i,iO=/^[0-9a-z]+$/,iC=/^[0-9A-HJKMNP-TV-Z]{26}$/i,iA=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,iN=/^[a-z0-9_-]{21}$/i,iR=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,iI=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,iP=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ij=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,iD=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,iL=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,i$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,iF=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,iM=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,iB="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",iU=RegExp(`^${iB}$`);function iz(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}class iq extends iT{_parse(e){var t,r,i,n;let a;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ia.string){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.string,received:t.parsedType}),im}let o=new ip;for(let l of this._def.checks)if("min"===l.kind)e.data.length<l.value&&(id(a=this._getOrReturnCtx(e,a),{code:il.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("max"===l.kind)e.data.length>l.value&&(id(a=this._getOrReturnCtx(e,a),{code:il.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("length"===l.kind){let t=e.data.length>l.value,r=e.data.length<l.value;(t||r)&&(a=this._getOrReturnCtx(e,a),t?id(a,{code:il.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):r&&id(a,{code:il.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),o.dirty())}else if("email"===l.kind)iP.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{validation:"email",code:il.invalid_string,message:l.message}),o.dirty());else if("emoji"===l.kind)s||(s=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),s.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{validation:"emoji",code:il.invalid_string,message:l.message}),o.dirty());else if("uuid"===l.kind)iA.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{validation:"uuid",code:il.invalid_string,message:l.message}),o.dirty());else if("nanoid"===l.kind)iN.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{validation:"nanoid",code:il.invalid_string,message:l.message}),o.dirty());else if("cuid"===l.kind)ik.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{validation:"cuid",code:il.invalid_string,message:l.message}),o.dirty());else if("cuid2"===l.kind)iO.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{validation:"cuid2",code:il.invalid_string,message:l.message}),o.dirty());else if("ulid"===l.kind)iC.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{validation:"ulid",code:il.invalid_string,message:l.message}),o.dirty());else if("url"===l.kind)try{new URL(e.data)}catch{id(a=this._getOrReturnCtx(e,a),{validation:"url",code:il.invalid_string,message:l.message}),o.dirty()}else"regex"===l.kind?(l.regex.lastIndex=0,l.regex.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{validation:"regex",code:il.invalid_string,message:l.message}),o.dirty())):"trim"===l.kind?e.data=e.data.trim():"includes"===l.kind?e.data.includes(l.value,l.position)||(id(a=this._getOrReturnCtx(e,a),{code:il.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),o.dirty()):"toLowerCase"===l.kind?e.data=e.data.toLowerCase():"toUpperCase"===l.kind?e.data=e.data.toUpperCase():"startsWith"===l.kind?e.data.startsWith(l.value)||(id(a=this._getOrReturnCtx(e,a),{code:il.invalid_string,validation:{startsWith:l.value},message:l.message}),o.dirty()):"endsWith"===l.kind?e.data.endsWith(l.value)||(id(a=this._getOrReturnCtx(e,a),{code:il.invalid_string,validation:{endsWith:l.value},message:l.message}),o.dirty()):"datetime"===l.kind?(function(e){let t=`${iB}T${iz(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)})(l).test(e.data)||(id(a=this._getOrReturnCtx(e,a),{code:il.invalid_string,validation:"datetime",message:l.message}),o.dirty()):"date"===l.kind?iU.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{code:il.invalid_string,validation:"date",message:l.message}),o.dirty()):"time"===l.kind?RegExp(`^${iz(l)}$`).test(e.data)||(id(a=this._getOrReturnCtx(e,a),{code:il.invalid_string,validation:"time",message:l.message}),o.dirty()):"duration"===l.kind?iI.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{validation:"duration",code:il.invalid_string,message:l.message}),o.dirty()):"ip"===l.kind?(t=e.data,("v4"===(r=l.version)||!r)&&ij.test(t)||("v6"===r||!r)&&iL.test(t)||(id(a=this._getOrReturnCtx(e,a),{validation:"ip",code:il.invalid_string,message:l.message}),o.dirty())):"jwt"===l.kind?!function(e,t){if(!iR.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));if("object"!=typeof n||null===n||"typ"in n&&n?.typ!=="JWT"||!n.alg||t&&n.alg!==t)return!1;return!0}catch{return!1}}(e.data,l.alg)&&(id(a=this._getOrReturnCtx(e,a),{validation:"jwt",code:il.invalid_string,message:l.message}),o.dirty()):"cidr"===l.kind?(i=e.data,("v4"===(n=l.version)||!n)&&iD.test(i)||("v6"===n||!n)&&i$.test(i)||(id(a=this._getOrReturnCtx(e,a),{validation:"cidr",code:il.invalid_string,message:l.message}),o.dirty())):"base64"===l.kind?iF.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{validation:"base64",code:il.invalid_string,message:l.message}),o.dirty()):"base64url"===l.kind?iM.test(e.data)||(id(a=this._getOrReturnCtx(e,a),{validation:"base64url",code:il.invalid_string,message:l.message}),o.dirty()):x.assertNever(l);return{status:o.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:il.invalid_string,...E.errToObj(r)})}_addCheck(e){return new iq({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...E.errToObj(e)})}url(e){return this._addCheck({kind:"url",...E.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...E.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...E.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...E.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...E.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...E.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...E.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...E.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...E.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...E.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...E.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...E.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...E.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...E.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...E.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...E.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...E.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...E.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...E.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...E.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...E.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...E.errToObj(t)})}nonempty(e){return this.min(1,E.errToObj(e))}trim(){return new iq({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new iq({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new iq({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}iq.create=e=>new iq({checks:[],typeName:T.ZodString,coerce:e?.coerce??!1,...iE(e)});class iH extends iT{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ia.number){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.number,received:t.parsedType}),im}let r=new ip;for(let i of this._def.checks)"int"===i.kind?x.isInteger(e.data)||(id(t=this._getOrReturnCtx(e,t),{code:il.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(id(t=this._getOrReturnCtx(e,t),{code:il.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(id(t=this._getOrReturnCtx(e,t),{code:il.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):"multipleOf"===i.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,n=r>i?r:i;return Number.parseInt(e.toFixed(n).replace(".",""))%Number.parseInt(t.toFixed(n).replace(".",""))/10**n}(e.data,i.value)&&(id(t=this._getOrReturnCtx(e,t),{code:il.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(id(t=this._getOrReturnCtx(e,t),{code:il.not_finite,message:i.message}),r.dirty()):x.assertNever(i);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,E.toString(t))}gt(e,t){return this.setLimit("min",e,!1,E.toString(t))}lte(e,t){return this.setLimit("max",e,!0,E.toString(t))}lt(e,t){return this.setLimit("max",e,!1,E.toString(t))}setLimit(e,t,r,i){return new iH({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:E.toString(i)}]})}_addCheck(e){return new iH({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:E.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:E.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:E.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:E.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:E.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&x.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}iH.create=e=>new iH({checks:[],typeName:T.ZodNumber,coerce:e?.coerce||!1,...iE(e)});class iW extends iT{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ia.bigint)return this._getInvalidInput(e);let r=new ip;for(let i of this._def.checks)"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(id(t=this._getOrReturnCtx(e,t),{code:il.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(id(t=this._getOrReturnCtx(e,t),{code:il.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(id(t=this._getOrReturnCtx(e,t),{code:il.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):x.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.bigint,received:t.parsedType}),im}gte(e,t){return this.setLimit("min",e,!0,E.toString(t))}gt(e,t){return this.setLimit("min",e,!1,E.toString(t))}lte(e,t){return this.setLimit("max",e,!0,E.toString(t))}lt(e,t){return this.setLimit("max",e,!1,E.toString(t))}setLimit(e,t,r,i){return new iW({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:E.toString(i)}]})}_addCheck(e){return new iW({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:E.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}iW.create=e=>new iW({checks:[],typeName:T.ZodBigInt,coerce:e?.coerce??!1,...iE(e)});class iV extends iT{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ia.boolean){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.boolean,received:t.parsedType}),im}return iy(e.data)}}iV.create=e=>new iV({typeName:T.ZodBoolean,coerce:e?.coerce||!1,...iE(e)});class iG extends iT{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ia.date){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.date,received:t.parsedType}),im}if(Number.isNaN(e.data.getTime()))return id(this._getOrReturnCtx(e),{code:il.invalid_date}),im;let r=new ip;for(let i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(id(t=this._getOrReturnCtx(e,t),{code:il.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(id(t=this._getOrReturnCtx(e,t),{code:il.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):x.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new iG({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:E.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:E.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}iG.create=e=>new iG({checks:[],coerce:e?.coerce||!1,typeName:T.ZodDate,...iE(e)});class iK extends iT{_parse(e){if(this._getType(e)!==ia.symbol){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.symbol,received:t.parsedType}),im}return iy(e.data)}}iK.create=e=>new iK({typeName:T.ZodSymbol,...iE(e)});class iJ extends iT{_parse(e){if(this._getType(e)!==ia.undefined){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.undefined,received:t.parsedType}),im}return iy(e.data)}}iJ.create=e=>new iJ({typeName:T.ZodUndefined,...iE(e)});class iQ extends iT{_parse(e){if(this._getType(e)!==ia.null){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.null,received:t.parsedType}),im}return iy(e.data)}}iQ.create=e=>new iQ({typeName:T.ZodNull,...iE(e)});class iZ extends iT{constructor(){super(...arguments),this._any=!0}_parse(e){return iy(e.data)}}iZ.create=e=>new iZ({typeName:T.ZodAny,...iE(e)});class iX extends iT{constructor(){super(...arguments),this._unknown=!0}_parse(e){return iy(e.data)}}iX.create=e=>new iX({typeName:T.ZodUnknown,...iE(e)});class iY extends iT{_parse(e){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.never,received:t.parsedType}),im}}iY.create=e=>new iY({typeName:T.ZodNever,...iE(e)});class i0 extends iT{_parse(e){if(this._getType(e)!==ia.undefined){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.void,received:t.parsedType}),im}return iy(e.data)}}i0.create=e=>new i0({typeName:T.ZodVoid,...iE(e)});class i1 extends iT{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),i=this._def;if(t.parsedType!==ia.array)return id(t,{code:il.invalid_type,expected:ia.array,received:t.parsedType}),im;if(null!==i.exactLength){let e=t.data.length>i.exactLength.value,n=t.data.length<i.exactLength.value;(e||n)&&(id(t,{code:e?il.too_big:il.too_small,minimum:n?i.exactLength.value:void 0,maximum:e?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(null!==i.minLength&&t.data.length<i.minLength.value&&(id(t,{code:il.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),null!==i.maxLength&&t.data.length>i.maxLength.value&&(id(t,{code:il.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>i.type._parseAsync(new ix(t,e,t.path,r)))).then(e=>ip.mergeArray(r,e));let n=[...t.data].map((e,r)=>i.type._parseSync(new ix(t,e,t.path,r)));return ip.mergeArray(r,n)}get element(){return this._def.type}min(e,t){return new i1({...this._def,minLength:{value:e,message:E.toString(t)}})}max(e,t){return new i1({...this._def,maxLength:{value:e,message:E.toString(t)}})}length(e,t){return new i1({...this._def,exactLength:{value:e,message:E.toString(t)}})}nonempty(e){return this.min(1,e)}}i1.create=(e,t)=>new i1({type:e,minLength:null,maxLength:null,exactLength:null,typeName:T.ZodArray,...iE(t)});class i2 extends iT{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=x.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==ia.object){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.object,received:t.parsedType}),im}let{status:t,ctx:r}=this._processInputParams(e),{shape:i,keys:n}=this._getCached(),s=[];if(!(this._def.catchall instanceof iY&&"strip"===this._def.unknownKeys))for(let e in r.data)n.includes(e)||s.push(e);let a=[];for(let e of n){let t=i[e],n=r.data[e];a.push({key:{status:"valid",value:e},value:t._parse(new ix(r,n,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof iY){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of s)a.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)s.length>0&&(id(r,{code:il.unrecognized_keys,keys:s}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of s){let i=r.data[t];a.push({key:{status:"valid",value:t},value:e._parse(new ix(r,i,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of a){let r=await t.key,i=await t.value;e.push({key:r,value:i,alwaysSet:t.alwaysSet})}return e}).then(e=>ip.mergeObjectSync(t,e)):ip.mergeObjectSync(t,a)}get shape(){return this._def.shape()}strict(e){return E.errToObj,new i2({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{let i=this._def.errorMap?.(t,r).message??r.defaultError;return"unrecognized_keys"===t.code?{message:E.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new i2({...this._def,unknownKeys:"strip"})}passthrough(){return new i2({...this._def,unknownKeys:"passthrough"})}extend(e){return new i2({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new i2({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:T.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new i2({...this._def,catchall:e})}pick(e){let t={};for(let r of x.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new i2({...this._def,shape:()=>t})}omit(e){let t={};for(let r of x.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new i2({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof i2){let r={};for(let i in t.shape){let n=t.shape[i];r[i]=nu.create(e(n))}return new i2({...t._def,shape:()=>r})}return t instanceof i1?new i1({...t._def,type:e(t.element)}):t instanceof nu?nu.create(e(t.unwrap())):t instanceof nc?nc.create(e(t.unwrap())):t instanceof i8?i8.create(t.items.map(t=>e(t))):t}(this)}partial(e){let t={};for(let r of x.objectKeys(this.shape)){let i=this.shape[r];e&&!e[r]?t[r]=i:t[r]=i.optional()}return new i2({...this._def,shape:()=>t})}required(e){let t={};for(let r of x.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof nu;)e=e._def.innerType;t[r]=e}return new i2({...this._def,shape:()=>t})}keyof(){return nn(x.objectKeys(this.shape))}}i2.create=(e,t)=>new i2({shape:()=>e,unknownKeys:"strip",catchall:iY.create(),typeName:T.ZodObject,...iE(t)}),i2.strictCreate=(e,t)=>new i2({shape:()=>e,unknownKeys:"strict",catchall:iY.create(),typeName:T.ZodObject,...iE(t)}),i2.lazycreate=(e,t)=>new i2({shape:e,unknownKeys:"strip",catchall:iY.create(),typeName:T.ZodObject,...iE(t)});class i5 extends iT{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new iu(e.ctx.common.issues));return id(t,{code:il.invalid_union,unionErrors:r}),im});{let e;let i=[];for(let n of r){let r={...t,common:{...t.common,issues:[]},parent:null},s=n._parseSync({data:t.data,path:t.path,parent:r});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:r}),r.common.issues.length&&i.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let n=i.map(e=>new iu(e));return id(t,{code:il.invalid_union,unionErrors:n}),im}}get options(){return this._def.options}}i5.create=(e,t)=>new i5({options:e,typeName:T.ZodUnion,...iE(t)});let i6=e=>{if(e instanceof nr)return i6(e.schema);if(e instanceof nl)return i6(e.innerType());if(e instanceof ni)return[e.value];if(e instanceof ns)return e.options;if(e instanceof na)return x.objectValues(e.enum);if(e instanceof nh)return i6(e._def.innerType);if(e instanceof iJ)return[void 0];else if(e instanceof iQ)return[null];else if(e instanceof nu)return[void 0,...i6(e.unwrap())];else if(e instanceof nc)return[null,...i6(e.unwrap())];else if(e instanceof nf)return i6(e.unwrap());else if(e instanceof ng)return i6(e.unwrap());else if(e instanceof nd)return i6(e._def.innerType);else return[]};class i3 extends iT{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==ia.object)return id(t,{code:il.invalid_type,expected:ia.object,received:t.parsedType}),im;let r=this.discriminator,i=t.data[r],n=this.optionsMap.get(i);return n?t.common.async?n._parseAsync({data:t.data,path:t.path,parent:t}):n._parseSync({data:t.data,path:t.path,parent:t}):(id(t,{code:il.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),im)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let i=new Map;for(let r of t){let t=i6(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let n of t){if(i.has(n))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(n)}`);i.set(n,r)}}return new i3({typeName:T.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...iE(r)})}}class i4 extends iT{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=(e,i)=>{if(i_(e)||i_(i))return im;let n=function e(t,r){let i=io(t),n=io(r);if(t===r)return{valid:!0,data:t};if(i===ia.object&&n===ia.object){let i=x.objectKeys(r),n=x.objectKeys(t).filter(e=>-1!==i.indexOf(e)),s={...t,...r};for(let i of n){let n=e(t[i],r[i]);if(!n.valid)return{valid:!1};s[i]=n.data}return{valid:!0,data:s}}if(i===ia.array&&n===ia.array){if(t.length!==r.length)return{valid:!1};let i=[];for(let n=0;n<t.length;n++){let s=e(t[n],r[n]);if(!s.valid)return{valid:!1};i.push(s.data)}return{valid:!0,data:i}}return i===ia.date&&n===ia.date&&+t==+r?{valid:!0,data:t}:{valid:!1}}(e.value,i.value);return n.valid?((iv(e)||iv(i))&&t.dirty(),{status:t.value,value:n.data}):(id(r,{code:il.invalid_intersection_types}),im)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>i(e,t)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}i4.create=(e,t,r)=>new i4({left:e,right:t,typeName:T.ZodIntersection,...iE(r)});class i8 extends iT{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ia.array)return id(r,{code:il.invalid_type,expected:ia.array,received:r.parsedType}),im;if(r.data.length<this._def.items.length)return id(r,{code:il.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),im;!this._def.rest&&r.data.length>this._def.items.length&&(id(r,{code:il.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let i=[...r.data].map((e,t)=>{let i=this._def.items[t]||this._def.rest;return i?i._parse(new ix(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(i).then(e=>ip.mergeArray(t,e)):ip.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new i8({...this._def,rest:e})}}i8.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new i8({items:e,typeName:T.ZodTuple,rest:null,...iE(t)})};class i7 extends iT{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ia.object)return id(r,{code:il.invalid_type,expected:ia.object,received:r.parsedType}),im;let i=[],n=this._def.keyType,s=this._def.valueType;for(let e in r.data)i.push({key:n._parse(new ix(r,e,r.path,e)),value:s._parse(new ix(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?ip.mergeObjectAsync(t,i):ip.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,r){return new i7(t instanceof iT?{keyType:e,valueType:t,typeName:T.ZodRecord,...iE(r)}:{keyType:iq.create(),valueType:e,typeName:T.ZodRecord,...iE(t)})}}class i9 extends iT{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ia.map)return id(r,{code:il.invalid_type,expected:ia.map,received:r.parsedType}),im;let i=this._def.keyType,n=this._def.valueType,s=[...r.data.entries()].map(([e,t],s)=>({key:i._parse(new ix(r,e,r.path,[s,"key"])),value:n._parse(new ix(r,t,r.path,[s,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of s){let i=await r.key,n=await r.value;if("aborted"===i.status||"aborted"===n.status)return im;("dirty"===i.status||"dirty"===n.status)&&t.dirty(),e.set(i.value,n.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of s){let i=r.key,n=r.value;if("aborted"===i.status||"aborted"===n.status)return im;("dirty"===i.status||"dirty"===n.status)&&t.dirty(),e.set(i.value,n.value)}return{status:t.value,value:e}}}}i9.create=(e,t,r)=>new i9({valueType:t,keyType:e,typeName:T.ZodMap,...iE(r)});class ne extends iT{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ia.set)return id(r,{code:il.invalid_type,expected:ia.set,received:r.parsedType}),im;let i=this._def;null!==i.minSize&&r.data.size<i.minSize.value&&(id(r,{code:il.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),null!==i.maxSize&&r.data.size>i.maxSize.value&&(id(r,{code:il.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());let n=this._def.valueType;function s(e){let r=new Set;for(let i of e){if("aborted"===i.status)return im;"dirty"===i.status&&t.dirty(),r.add(i.value)}return{status:t.value,value:r}}let a=[...r.data.values()].map((e,t)=>n._parse(new ix(r,e,r.path,t)));return r.common.async?Promise.all(a).then(e=>s(e)):s(a)}min(e,t){return new ne({...this._def,minSize:{value:e,message:E.toString(t)}})}max(e,t){return new ne({...this._def,maxSize:{value:e,message:E.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ne.create=(e,t)=>new ne({valueType:e,minSize:null,maxSize:null,typeName:T.ZodSet,...iE(t)});class nt extends iT{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==ia.function)return id(t,{code:il.invalid_type,expected:ia.function,received:t.parsedType}),im;function r(e,r){return ih({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,ic,ic].filter(e=>!!e),issueData:{code:il.invalid_arguments,argumentsError:r}})}function i(e,r){return ih({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,ic,ic].filter(e=>!!e),issueData:{code:il.invalid_return_type,returnTypeError:r}})}let n={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof no){let e=this;return iy(async function(...t){let a=new iu([]),o=await e._def.args.parseAsync(t,n).catch(e=>{throw a.addIssue(r(t,e)),a}),l=await Reflect.apply(s,this,o);return await e._def.returns._def.type.parseAsync(l,n).catch(e=>{throw a.addIssue(i(l,e)),a})})}{let e=this;return iy(function(...t){let a=e._def.args.safeParse(t,n);if(!a.success)throw new iu([r(t,a.error)]);let o=Reflect.apply(s,this,a.data),l=e._def.returns.safeParse(o,n);if(!l.success)throw new iu([i(o,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new nt({...this._def,args:i8.create(e).rest(iX.create())})}returns(e){return new nt({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new nt({args:e||i8.create([]).rest(iX.create()),returns:t||iX.create(),typeName:T.ZodFunction,...iE(r)})}}class nr extends iT{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}nr.create=(e,t)=>new nr({getter:e,typeName:T.ZodLazy,...iE(t)});class ni extends iT{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return id(t,{received:t.data,code:il.invalid_literal,expected:this._def.value}),im}return{status:"valid",value:e.data}}get value(){return this._def.value}}function nn(e,t){return new ns({values:e,typeName:T.ZodEnum,...iE(t)})}ni.create=(e,t)=>new ni({value:e,typeName:T.ZodLiteral,...iE(t)});class ns extends iT{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return id(t,{expected:x.joinValues(r),received:t.parsedType,code:il.invalid_type}),im}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return id(t,{received:t.data,code:il.invalid_enum_value,options:r}),im}return iy(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ns.create(e,{...this._def,...t})}exclude(e,t=this._def){return ns.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}ns.create=nn;class na extends iT{_parse(e){let t=x.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ia.string&&r.parsedType!==ia.number){let e=x.objectValues(t);return id(r,{expected:x.joinValues(e),received:r.parsedType,code:il.invalid_type}),im}if(this._cache||(this._cache=new Set(x.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=x.objectValues(t);return id(r,{received:r.data,code:il.invalid_enum_value,options:e}),im}return iy(e.data)}get enum(){return this._def.values}}na.create=(e,t)=>new na({values:e,typeName:T.ZodNativeEnum,...iE(t)});class no extends iT{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==ia.promise&&!1===t.common.async?(id(t,{code:il.invalid_type,expected:ia.promise,received:t.parsedType}),im):iy((t.parsedType===ia.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}no.create=(e,t)=>new no({type:e,typeName:T.ZodPromise,...iE(t)});class nl extends iT{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===T.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,n={addIssue:e=>{id(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(n.addIssue=n.addIssue.bind(n),"preprocess"===i.type){let e=i.transform(r.data,n);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return im;let i=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===i.status?im:"dirty"===i.status||"dirty"===t.value?ig(i.value):i});{if("aborted"===t.value)return im;let i=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===i.status?im:"dirty"===i.status||"dirty"===t.value?ig(i.value):i}}if("refinement"===i.type){let e=e=>{let t=i.refinement(e,n);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?im:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===i.status?im:("dirty"===i.status&&t.dirty(),e(i.value),{status:t.value,value:i.value})}}if("transform"===i.type){if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>ib(e)?Promise.resolve(i.transform(e.value,n)).then(e=>({status:t.value,value:e})):im);{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ib(e))return im;let s=i.transform(e.value,n);if(s instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}}x.assertNever(i)}}nl.create=(e,t,r)=>new nl({schema:e,typeName:T.ZodEffects,effect:t,...iE(r)}),nl.createWithPreprocess=(e,t,r)=>new nl({schema:t,effect:{type:"preprocess",transform:e},typeName:T.ZodEffects,...iE(r)});class nu extends iT{_parse(e){return this._getType(e)===ia.undefined?iy(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}nu.create=(e,t)=>new nu({innerType:e,typeName:T.ZodOptional,...iE(t)});class nc extends iT{_parse(e){return this._getType(e)===ia.null?iy(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}nc.create=(e,t)=>new nc({innerType:e,typeName:T.ZodNullable,...iE(t)});class nh extends iT{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===ia.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}nh.create=(e,t)=>new nh({innerType:e,typeName:T.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...iE(t)});class nd extends iT{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return iw(i)?i.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new iu(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===i.status?i.value:this._def.catchValue({get error(){return new iu(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}nd.create=(e,t)=>new nd({innerType:e,typeName:T.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...iE(t)});class np extends iT{_parse(e){if(this._getType(e)!==ia.nan){let t=this._getOrReturnCtx(e);return id(t,{code:il.invalid_type,expected:ia.nan,received:t.parsedType}),im}return{status:"valid",value:e.data}}}np.create=e=>new np({typeName:T.ZodNaN,...iE(e)}),Symbol("zod_brand");class nf extends iT{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class nm extends iT{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?im:"dirty"===e.status?(t.dirty(),ig(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?im:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new nm({in:e,out:t,typeName:T.ZodPipeline})}}class ng extends iT{_parse(e){let t=this._def.innerType._parse(e),r=e=>(ib(e)&&(e.value=Object.freeze(e.value)),e);return iw(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}ng.create=(e,t)=>new ng({innerType:e,typeName:T.ZodReadonly,...iE(t)}),i2.lazycreate,function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(T||(T={}));let ny=iq.create,n_=iH.create;np.create,iW.create;let nv=iV.create,nb=iG.create;iK.create,iJ.create,iQ.create;let nw=iZ.create;iX.create,iY.create,i0.create;let nx=i1.create,nS=i2.create;i2.strictCreate;let nE=i5.create;i3.create,i4.create,i8.create;let nT=i7.create;i9.create,ne.create,nt.create,nr.create,ni.create;let nk=ns.create;na.create,no.create,nl.create,nu.create,nc.create,nl.createWithPreprocess,nm.create;var nO=function(e){return e.ADMIN="admin",e.MANAGER="manager",e.ANALYST="analyst",e.VIEWER="viewer",e}({}),nC=function(e){return e.PROJETO_CREATE="projeto:create",e.PROJETO_READ="projeto:read",e.PROJETO_UPDATE="projeto:update",e.PROJETO_DELETE="projeto:delete",e.PESQUISA_CREATE="pesquisa:create",e.PESQUISA_READ="pesquisa:read",e.PESQUISA_UPDATE="pesquisa:update",e.PESQUISA_DELETE="pesquisa:delete",e.PESQUISA_START="pesquisa:start",e.PESQUISA_STOP="pesquisa:stop",e.IMPORTACAO_CREATE="importacao:create",e.IMPORTACAO_READ="importacao:read",e.IMPORTACAO_DELETE="importacao:delete",e.ENRIQUECIMENTO_EXECUTE="enriquecimento:execute",e.ENRIQUECIMENTO_READ="enriquecimento:read",e.ENTIDADE_READ="entidade:read",e.ENTIDADE_UPDATE="entidade:update",e.ENTIDADE_DELETE="entidade:delete",e.ENTIDADE_EXPORT="entidade:export",e.ANALISE_READ="analise:read",e.ANALISE_EXPORT="analise:export",e.USER_READ="user:read",e.USER_CREATE="user:create",e.USER_UPDATE="user:update",e.USER_DELETE="user:delete",e.ROLE_MANAGE="role:manage",e.AUDIT_READ="audit:read",e.SETTINGS_MANAGE="settings:manage",e}({});let nA={admin:Object.values(nC),manager:["projeto:create","projeto:read","projeto:update","projeto:delete","pesquisa:create","pesquisa:read","pesquisa:update","pesquisa:delete","pesquisa:start","pesquisa:stop","importacao:create","importacao:read","importacao:delete","enriquecimento:execute","enriquecimento:read","entidade:read","entidade:update","entidade:export","analise:read","analise:export","user:read"],analyst:["projeto:read","pesquisa:read","importacao:read","enriquecimento:read","entidade:read","entidade:export","analise:read","analise:export"],viewer:["projeto:read","pesquisa:read","entidade:read","analise:read"]};var nN=i(21820),nR=i(29021);let nI=new Map,nP=new Map,nj=Symbol("OriginError"),nD={};class nL extends Promise{constructor(e,t,r,i,n={}){let s,a;super((e,t)=>{s=e,a=t}),this.tagged=Array.isArray(e.raw),this.strings=e,this.args=t,this.handler=r,this.canceller=i,this.options=n,this.state=null,this.statement=null,this.resolve=e=>(this.active=!1,s(e)),this.reject=e=>(this.active=!1,a(e)),this.active=!1,this.cancelled=null,this.executed=!1,this.signature="",this[nj]=this.handler.debug?Error():this.tagged&&function(e){if(nI.has(e))return nI.get(e);let t=Error.stackTraceLimit;return Error.stackTraceLimit=4,nI.set(e,Error()),Error.stackTraceLimit=t,nI.get(e)}(this.strings)}get origin(){return(this.handler.debug?this[nj].stack:this.tagged&&nP.has(this.strings)?nP.get(this.strings):nP.set(this.strings,this[nj].stack).get(this.strings))||""}static get[Symbol.species](){return Promise}cancel(){return this.canceller&&(this.canceller(this),this.canceller=null)}simple(){return this.options.simple=!0,this.options.prepare=!1,this}async readable(){return this.simple(),this.streaming=!0,this}async writable(){return this.simple(),this.streaming=!0,this}cursor(e=1,t){let r;return(this.options.simple=!1,"function"==typeof e&&(t=e,e=1),this.cursorRows=e,"function"==typeof t)?(this.cursorFn=t,this):{[Symbol.asyncIterator]:()=>({next:()=>{if(this.executed&&!this.active)return{done:!0};r&&r();let e=new Promise((e,t)=>{this.cursorFn=t=>(e({value:t,done:!1}),new Promise(e=>r=e)),this.resolve=()=>(this.active=!1,e({done:!0})),this.reject=e=>(this.active=!1,t(e))});return this.execute(),e},return:()=>(r&&r(nD),{done:!0})})}}describe(){return this.options.simple=!1,this.onlyDescribe=this.options.prepare=!0,this}stream(){throw Error(".stream has been renamed to .forEach")}forEach(e){return this.forEachFn=e,this.handle(),this}raw(){return this.isRaw=!0,this}values(){return this.isRaw="values",this}async handle(){!this.executed&&(this.executed=!0)&&await 1&&this.handler(this)}execute(){return this.handle(),this}then(){return this.handle(),super.then.apply(this,arguments)}catch(){return this.handle(),super.catch.apply(this,arguments)}finally(){return this.handle(),super.finally.apply(this,arguments)}}class n$ extends Error{constructor(e){super(e.message),this.name=this.constructor.name,Object.assign(this,e)}}let nF={connection:function e(t,r,i){let{host:n,port:s}=i||r,a=Object.assign(Error("write "+t+" "+(r.path||n+":"+s)),{code:t,errno:t,address:r.path||n},r.path?{}:{port:s});return Error.captureStackTrace(a,e),a},postgres:function e(t){let r=new n$(t);return Error.captureStackTrace(r,e),r},generic:function e(t,r){let i=Object.assign(Error(t+": "+r),{code:t});return Error.captureStackTrace(i,e),i},notSupported:function e(t){let r=Object.assign(Error(t+" (B) is not supported"),{code:"MESSAGE_NOT_SUPPORTED",name:t});return Error.captureStackTrace(r,e),r}};class nM{then(){nX()}catch(){nX()}finally(){nX()}}class nB extends nM{constructor(e){super(),this.value=n6(e)}}class nU extends nM{constructor(e,t,r){super(),this.value=e,this.type=t,this.array=r}}class nz extends nM{constructor(e,t){super(),this.first=e,this.rest=t}build(e,t,r,i){let n=nZ.map(([t,r])=>({fn:r,i:e.search(t)})).sort((e,t)=>e.i-t.i).pop();return -1===n.i?n5(this.first,i):n.fn(this.first,this.rest,t,r,i)}}function nq(e,t,r,i){let n=e instanceof nU?e.value:e;if(void 0===n&&(e instanceof nU?e.value=i.transform.undefined:n=e=i.transform.undefined,void 0===n))throw nF.generic("UNDEFINED_VALUE","Undefined values are not allowed");return"$"+r.push(e instanceof nU?(t.push(e.value),e.array?e.array[e.type||n3(e.value)]||e.type||function e(t){return Array.isArray(t)?e(t[0]):"string"==typeof t?1009:0}(e.value):e.type):(t.push(e),n3(e)))}let nH=n2({string:{to:25,from:null,serialize:e=>""+e},number:{to:0,from:[21,23,26,700,701],serialize:e=>""+e,parse:e=>+e},json:{to:114,from:[114,3802],serialize:e=>JSON.stringify(e),parse:e=>JSON.parse(e)},boolean:{to:16,from:16,serialize:e=>!0===e?"t":"f",parse:e=>"t"===e},date:{to:1184,from:[1082,1114,1184],serialize:e=>(e instanceof Date?e:new Date(e)).toISOString(),parse:e=>new Date(e)},bytea:{to:17,from:17,serialize:e=>"\\x"+Buffer.from(e).toString("hex"),parse:e=>Buffer.from(e.slice(2),"hex")}});function nW(e,t,r,i,n,s){for(let a=1;a<e.strings.length;a++)t+=nV(t,r,i,n,s)+e.strings[a],r=e.args[a];return t}function nV(e,t,r,i,n){return t instanceof nz?t.build(e,r,i,n):t instanceof nL?nG(t,r,i,n):t instanceof nB?t.value:t&&t[0]instanceof nL?t.reduce((e,t)=>e+" "+nG(t,r,i,n),""):nq(t,r,i,n)}function nG(e,t,r,i){return e.fragment=!0,nW(e,e.strings[0],e.args[0],t,r,i)}function nK(e,t,r,i,n){return e.map(e=>"("+i.map(i=>nV("values",e[i],t,r,n)).join(",")+")").join(",")}function nJ(e,t,r,i,n){let s=Array.isArray(e[0]),a=t.length?t.flat():Object.keys(s?e[0]:e);return nK(s?e:[e],r,i,a,n)}function nQ(e,t,r,i,n){let s;return("string"==typeof e&&(e=[e].concat(t)),Array.isArray(e))?n5(e,n):(t.length?t.flat():Object.keys(e)).map(t=>((s=e[t])instanceof nL?nG(s,r,i,n):s instanceof nB?s.value:nq(s,r,i,n))+" as "+n6(n.transform.column.to?n.transform.column.to(t):t)).join(",")}let nZ=Object.entries({values:nJ,in:(...e)=>{let t=nJ(...e);return"()"===t?"(null)":t},select:nQ,as:nQ,returning:nQ,"\\(":nQ,update:(e,t,r,i,n)=>(t.length?t.flat():Object.keys(e)).map(t=>n6(n.transform.column.to?n.transform.column.to(t):t)+"="+nV("values",e[t],r,i,n)),insert(e,t,r,i,n){let s=t.length?t.flat():Object.keys(Array.isArray(e)?e[0]:e);return"("+n5(s,n)+")values"+nK(Array.isArray(e)?e:[e],r,i,s,n)}}).map(([e,t])=>[RegExp("((?:^|[\\s(])"+e+"(?:$|[\\s(]))(?![\\s\\S]*\\1)","i"),t]);function nX(){throw nF.generic("NOT_TAGGED_CALL","Query not called as a tagged template literal")}let nY=nH.serializers,n0=nH.parsers,n1=function(e){let t=n2(e||{});return{serializers:Object.assign({},nY,t.serializers),parsers:Object.assign({},n0,t.parsers)}};function n2(e){return Object.keys(e).reduce((t,r)=>(e[r].from&&[].concat(e[r].from).forEach(i=>t.parsers[i]=e[r].parse),e[r].serialize&&(t.serializers[e[r].to]=e[r].serialize,e[r].from&&[].concat(e[r].from).forEach(i=>t.serializers[i]=e[r].serialize)),t),{parsers:{},serializers:{}})}function n5(e,{transform:{column:t}}){return e.map(e=>n6(t.to?t.to(e):e)).join(",")}let n6=function(e){return'"'+e.replace(/"/g,'""').replace(/\./g,'"."')+'"'},n3=function e(t){return t instanceof nU?t.type:t instanceof Date?1184:t instanceof Uint8Array?17:!0===t||!1===t?16:"bigint"==typeof t?20:Array.isArray(t)?e(t[0]):0},n4=/\\/g,n8=/"/g,n7=function e(t,r,i,n){if(!1===Array.isArray(t))return t;if(!t.length)return"{}";let s=t[0],a=1020===n?";":",";return Array.isArray(s)&&!s.type?"{"+t.map(t=>e(t,r,i,n)).join(a)+"}":"{"+t.map(e=>{if(void 0===e&&void 0===(e=i.transform.undefined))throw nF.generic("UNDEFINED_VALUE","Undefined values are not allowed");return null===e?"null":'"'+(r?r(e.type?e.value:e):""+e).replace(n4,"\\\\").replace(n8,'\\"')+'"'}).join(a)+"}"},n9={i:0,char:null,str:"",quoted:!1,last:0},se=e=>{let t=e[0];for(let r=1;r<e.length;r++)t+="_"===e[r]?e[++r].toUpperCase():e[r];return t},st=e=>{let t=e[0].toUpperCase();for(let r=1;r<e.length;r++)t+="_"===e[r]?e[++r].toUpperCase():e[r];return t},sr=e=>e.replace(/_/g,"-"),si=e=>e.replace(/([A-Z])/g,"_$1").toLowerCase(),sn=e=>(e.slice(0,1)+e.slice(1).replace(/([A-Z])/g,"_$1")).toLowerCase(),ss=e=>e.replace(/-/g,"_");function sa(e){return function t(r,i){return"object"==typeof r&&null!==r&&(114===i.type||3802===i.type)?Array.isArray(r)?r.map(e=>t(e,i)):Object.entries(r).reduce((r,[n,s])=>Object.assign(r,{[e(n)]:t(s,i)}),{}):r}}se.column={from:se},se.value={from:sa(se)},si.column={to:si};let so={...se};so.column.to=si,st.column={from:st},st.value={from:sa(st)},sn.column={to:sn};let sl={...st};sl.column.to=sn,sr.column={from:sr},sr.value={from:sa(sr)},ss.column={to:ss};let su={...sr};su.column.to=ss;let sc=require("net"),sh=require("tls");var sd=i(55511),sp=i.n(sd),sf=i(27910);let sm=require("perf_hooks");class sg extends Array{constructor(){super(),Object.defineProperties(this,{count:{value:null,writable:!0},state:{value:null,writable:!0},command:{value:null,writable:!0},columns:{value:null,writable:!0},statement:{value:null,writable:!0}})}static get[Symbol.species](){return Array}}let sy=function(e=[]){let t=e.slice(),r=0;return{get length(){return t.length-r},remove:e=>{let r=t.indexOf(e);return -1===r?null:(t.splice(r,1),e)},push:e=>(t.push(e),e),shift:()=>{let e=t[r++];return r===t.length?(r=0,t=[]):t[r-1]=void 0,e}}},s_=Buffer.allocUnsafe(256),sv=Object.assign(function(){return sv.i=0,sv},"BCcDdEFfHPpQSX".split("").reduce((e,t)=>{let r=t.charCodeAt(0);return e[t]=()=>(s_[0]=r,sv.i=5,sv),e},{}),{N:"\0",i:0,inc:e=>(sv.i+=e,sv),str(e){let t=Buffer.byteLength(e);return sb(t),sv.i+=s_.write(e,sv.i,t,"utf8"),sv},i16:e=>(sb(2),s_.writeUInt16BE(e,sv.i),sv.i+=2,sv),i32:(e,t)=>(t||0===t?s_.writeUInt32BE(e,t):(sb(4),s_.writeUInt32BE(e,sv.i),sv.i+=4),sv),z:e=>(sb(e),s_.fill(0,sv.i,sv.i+e),sv.i+=e,sv),raw:e=>(s_=Buffer.concat([s_.subarray(0,sv.i),e]),sv.i=s_.length,sv),end(e=1){s_.writeUInt32BE(sv.i-e,e);let t=s_.subarray(0,sv.i);return sv.i=0,s_=Buffer.allocUnsafe(256),t}});function sb(e){if(s_.length-sv.i<e){let t=s_,r=t.length;s_=Buffer.allocUnsafe(r+(r>>1)+e),t.copy(s_)}}let sw=function e(t,r={},{onopen:i=sC,onend:n=sC,onclose:s=sC}={}){let{ssl:a,max:o,user:l,host:u,port:c,database:h,parsers:d,transform:p,onnotice:f,onnotify:m,onparameter:g,max_pipeline:y,keep_alive:v,backoff:b,target_session_attrs:w}=t,x=sy(),S=sx++,E={pid:null,secret:null},T=sj(eb,t.idle_timeout),k=sj(eb,t.max_lifetime),O=sj(function(){e_(nF.connection("CONNECT_TIMEOUT",t,C)),C.destroy()},t.connect_timeout),C=null,A,N=new sg,R=Buffer.alloc(0),I=t.fetch_types,P={},j={},D=Math.random().toString(36).slice(2),L=1,$=0,F=0,M=0,B=0,U=0,z=0,q=0,H=null,W=null,V=!1,G=null,K=null,J=null,Q=null,Z=null,X=null,Y=null,ee=null,et=null,er=null,ei={queue:r.closed,idleTimer:T,connect(e){J=e,em()},terminate:ew,execute:ea,cancel:es,end:eb,count:0,id:S};return r.closed&&r.closed.push(ei),ei;async function en(){let e;try{e=t.socket?await Promise.resolve(t.socket(t)):new sc.Socket}catch(e){ey(e);return}return e.on("error",ey),e.on("close",ex),e.on("drain",ed),e}async function es({pid:e,secret:t},r,i){try{A=sv().i32(16).i32(0x4d2162e).i32(e).i32(t).end(16),await ef(),C.once("error",i),C.once("close",r)}catch(e){i(e)}}function ea(e){if(V)return ev(e,nF.connection("CONNECTION_DESTROYED",t));if(!e.cancelled)try{return e.state=E,et?x.push(e):(et=e).active=!0,function(e){let r=[],i=[],n=nW(e,e.strings[0],e.args[0],r,i,t);e.tagged||e.args.forEach(e=>nq(e,r,i,t)),e.prepare=t.prepare&&(!("prepare"in e.options)||e.options.prepare),e.string=n,e.signature=e.prepare&&i+n,e.onlyDescribe&&delete j[e.signature],e.parameters=e.parameters||r,e.prepared=e.prepare&&e.signature in j,e.describeFirst=e.onlyDescribe||r.length&&!e.prepared,e.statement=e.prepared?j[e.signature]:{string:n,types:i,name:e.prepare?D+L++:""},"function"==typeof t.debug&&t.debug(S,n,r,i)}(e),eu(function(e){if(e.parameters.length>=65534)throw nF.generic("MAX_PARAMETERS_EXCEEDED","Max number of parameters (65534) exceeded");return e.options.simple?sv().Q().str(e.statement.string+sv.N).end():e.describeFirst?Buffer.concat([eo(e),sE]):e.prepare?e.prepared?el(e):Buffer.concat([eo(e),el(e)]):Buffer.concat([eI(e.statement.string,e.parameters,e.statement.types),sO,el(e)])}(e))&&!e.describeFirst&&!e.cursorFn&&x.length<y&&(!e.options.onexecute||e.options.onexecute(ei))}catch(e){return 0===x.length&&eu(sS),e_(e),!0}}function eo(e){return Buffer.concat([eI(e.statement.string,e.parameters,e.statement.types,e.statement.name),function(e,t=""){return sv().D().str("S").str(t+sv.N).end()}(0,e.statement.name)])}function el(e){return Buffer.concat([function(e,r,i="",n=""){let s,a;return sv().B().str(n+sv.N).str(i+sv.N).i16(0).i16(e.length),e.forEach((i,n)=>{if(null===i)return sv.i32(0xffffffff);a=r[n],e[n]=i=a in t.serializers?t.serializers[a](i):""+i,s=sv.i,sv.inc(4).str(i).i32(sv.i-s-4,s)}),sv.i16(0),sv.end()}(e.parameters,e.statement.types,e.statement.name,e.cursorName),e.cursorFn?eP("",e.cursorRows):sk])}function eu(e,t){return(X=X?Buffer.concat([X,e]):Buffer.from(e),t||X.length>=1024)?ec(t):(null===W&&(W=setImmediate(ec)),!0)}function ec(e){let t=C.write(X,e);return null!==W&&clearImmediate(W),X=W=null,t}async function eh(){if(eu(sT),!await new Promise(e=>C.once("data",t=>e(83===t[0])))&&"prefer"===a)return eg();C.removeAllListeners(),(C=sh.connect({socket:C,servername:sc.isIP(C.host)?void 0:C.host,..."require"===a||"allow"===a||"prefer"===a?{rejectUnauthorized:!1}:"verify-full"===a?{}:"object"==typeof a?a:{}})).on("secureConnect",eg),C.on("error",ey),C.on("close",ex),C.on("drain",ed)}function ed(){et||i(ei)}function ep(r){if(!G||(G.push(r),!((F-=r.length)>0)))for(R=G?Buffer.concat(G,U-F):0===R.length?r:Buffer.concat([R,r],R.length+r.length);R.length>4;){if((U=R.readUInt32BE(1))>=R.length){F=U-R.length,G=[R];break}try{(function(r,n=r[0]){(68===n?function(e){let t,r,i,n=7,s=et.isRaw?Array(et.statement.columns.length):{};for(let a=0;a<et.statement.columns.length;a++)r=et.statement.columns[a],t=e.readInt32BE(n),n+=4,i=-1===t?null:!0===et.isRaw?e.subarray(n,n+=t):void 0===r.parser?e.toString("utf8",n,n+=t):!0===r.parser.array?r.parser(e.toString("utf8",n+1,n+=t)):r.parser(e.toString("utf8",n,n+=t)),et.isRaw?s[a]=!0===et.isRaw?i:p.value.from?p.value.from(i,r):i:s[r.name]=p.value.from?p.value.from(i,r):i;et.forEachFn?et.forEachFn(p.row.from?p.row.from(s):s,N):N[q++]=p.row.from?p.row.from(s):s}:100===n?function(e){Z&&(Z.push(e.subarray(5))||C.pause())}:65===n?function(e){if(!m)return;let t=9;for(;0!==e[t++];);m(e.toString("utf8",9,t-1),e.toString("utf8",t,e.length-1))}:83===n?function(e){let[r,i]=e.toString("utf8",5,e.length-1).split(sv.N);P[r]=i,t.parameters[r]!==i&&(t.parameters[r]=i,g&&g(r,i))}:90===n?function(r){if(et&&et.options.simple&&et.resolve(K||N),et=K=null,N=new sg,O.cancel(),J){if(w){var n;if(!P.in_hot_standby||!P.default_transaction_read_only)return function(){let e=new nL([`
      show transaction_read_only;
      select pg_catalog.pg_is_in_recovery()
    `],[],ea,null,{simple:!0});e.resolve=([[e],[t]])=>{P.default_transaction_read_only=e.transaction_read_only,P.in_hot_standby=t.pg_is_in_recovery?"on":"off"},e.execute()}();if(n=P,"read-write"===w&&"on"===n.default_transaction_read_only||"read-only"===w&&"off"===n.default_transaction_read_only||"primary"===w&&"on"===n.in_hot_standby||"standby"===w&&"off"===n.in_hot_standby||"prefer-standby"===w&&"off"===n.in_hot_standby&&t.host[B])return ew()}return I?(J.reserve&&(J=null),eN()):(J&&!J.reserve&&ea(J),t.shared.retries=B=0,void(J=null))}for(;x.length&&(et=x.shift())&&(et.active=!0,et.cancelled);)e(t).cancel(et.state,et.cancelled.resolve,et.cancelled.reject);et||(ei.reserved?ei.reserved.release||73!==r[5]?ei.reserved():Q?ew():(ei.reserved=null,i(ei)):Q?ew():i(ei))}:67===n?function(e){q=0;for(let t=e.length-1;t>0;t--)if(32===e[t]&&e[t+1]<58&&null===N.count&&(N.count=+e.toString("utf8",t+1,e.length-1)),e[t-1]>=65){N.command=e.toString("utf8",5,t),N.state=E;break}return(er&&(er(),er=null),"BEGIN"!==N.command||1===o||ei.reserved)?et.options.simple?eS():void(et.cursorFn&&(N.count&&et.cursorFn(N),eu(sS)),et.resolve(N)):e_(nF.generic("UNSAFE_TRANSACTION","Only use sql.begin, sql.reserved or max: 1"))}:50===n?eS:49===n?function(){et.parsing=!1}:116===n?function(e){let t=e.readUInt16BE(5);for(let r=0;r<t;++r)et.statement.types[r]||(et.statement.types[r]=e.readUInt32BE(7+4*r));et.prepare&&(j[et.signature]=et.statement),et.describeFirst&&!et.onlyDescribe&&(eu(el(et)),et.describeFirst=!1)}:84===n?function(e){let t;N.command&&((K=K||[N]).push(N=new sg),N.count=null,et.statement.columns=null);let r=e.readUInt16BE(5),i=7;et.statement.columns=Array(r);for(let n=0;n<r;++n){for(t=i;0!==e[i++];);let r=e.readUInt32BE(i),s=e.readUInt16BE(i+4),a=e.readUInt32BE(i+6);et.statement.columns[n]={name:p.column.from?p.column.from(e.toString("utf8",t,i-1)):e.toString("utf8",t,i-1),parser:d[a],table:r,number:s,type:a},i+=18}if(N.statement=et.statement,et.onlyDescribe)return et.resolve(et.statement),eu(sS)}:82===n?eE:110===n?function(){if(N.statement=et.statement,N.statement.columns=[],et.onlyDescribe)return et.resolve(et.statement),eu(sS)}:75===n?function(e){E.pid=e.readUInt32BE(5),E.secret=e.readUInt32BE(9)}:69===n?function(e){var t;et&&(et.cursorFn||et.describeFirst)&&eu(sS);let r=nF.postgres(sR(e));et&&et.retried?e_(et.retried):et&&et.prepared&&sA.has(r.routine)?(t=et,delete j[t.signature],t.retried=r,ea(t)):e_(r)}:115===n?eR:51===n?function(){N.count&&et.cursorFn(N),et.resolve(N)}:71===n?function(){Z=new sf.Writable({autoDestroy:!0,write(e,t,r){C.write(sv().d().raw(e).end(),r)},destroy(e,t){t(e),C.write(sv().f().str(e+sv.N).end()),Z=null},final(e){C.write(sv().c().end()),er=e}}),et.resolve(Z)}:78===n?function(e){f?f(sR(e)):console.log(sR(e))}:72===n?function(){Z=new sf.Readable({read(){C.resume()}}),et.resolve(Z)}:99===n?function(){Z&&Z.push(null),Z=null}:73===n?function(){}:86===n?function(){e_(nF.notSupported("FunctionCallResponse"))}:118===n?function(){e_(nF.notSupported("NegotiateProtocolVersion"))}:87===n?function(){Z=new sf.Duplex({autoDestroy:!0,read(){C.resume()},write(e,t,r){C.write(sv().d().raw(e).end(),r)},destroy(e,t){t(e),C.write(sv().f().str(e+sv.N).end()),Z=null},final(e){C.write(sv().c().end()),er=e}}),et.resolve(Z)}:function(e){console.error("Postgres.js : Unknown Message:",e[0])})(r)})(R.subarray(0,U+1))}catch(e){et&&(et.cursorFn||et.describeFirst)&&eu(sS),e_(e)}R=R.subarray(U+1),F=0,G=null}}async function ef(){if(V=!1,P={},C||(C=await en()),C){if(O.start(),t.socket)return a?eh():eg();if(C.on("connect",a?eh:eg),t.path)return C.connect(t.path);C.ssl=a,C.connect(c[M],u[M]),C.host=u[M],C.port=c[M],M=(M+1)%c.length}}function em(){setTimeout(ef,$?$+z-sm.performance.now():0)}function eg(){try{j={},I=t.fetch_types,D=Math.random().toString(36).slice(2),L=1,k.start(),C.on("data",ep),v&&C.setKeepAlive&&C.setKeepAlive(!0,1e3*v);let e=A||sv().inc(4).i16(3).z(2).str(Object.entries(Object.assign({user:l,database:h,client_encoding:"UTF8"},t.connection)).filter(([,e])=>e).map(([e,t])=>e+sv.N+t).join(sv.N)).z(2).end(0);eu(e)}catch(e){ey(e)}}function ey(e){if(ei.queue!==r.connecting||!t.host[B+1])for(e_(e);x.length;)ev(x.shift(),e)}function e_(e){Z&&(Z.destroy(e),Z=null),et&&ev(et,e),J&&(ev(J,e),J=null)}function ev(e,r){if(e.reserve)return e.reject(r);r&&"object"==typeof r||(r=Error(r)),"query"in r||"parameters"in r||Object.defineProperties(r,{stack:{value:r.stack+e.origin.replace(/.*\n/,"\n"),enumerable:t.debug},query:{value:e.string,enumerable:t.debug},parameters:{value:e.parameters,enumerable:t.debug},args:{value:e.args,enumerable:t.debug},types:{value:e.statement&&e.statement.types,enumerable:t.debug}}),e.reject(r)}function eb(){return Q||(ei.reserved||n(ei),ei.reserved||J||et||0!==x.length?Q=new Promise(e=>Y=e):(ew(),new Promise(e=>C&&"closed"!==C.readyState?C.once("close",e):e())))}function ew(){V=!0,(Z||et||J||x.length)&&ey(nF.connection("CONNECTION_DESTROYED",t)),clearImmediate(W),C&&(C.removeListener("data",ep),C.removeListener("connect",eg),"open"===C.readyState&&C.end(sv().X().end())),Y&&(Y(),Q=Y=null)}async function ex(e){if(R=Buffer.alloc(0),F=0,G=null,clearImmediate(W),C.removeListener("data",ep),C.removeListener("connect",eg),T.cancel(),k.cancel(),O.cancel(),C.removeAllListeners(),C=null,J)return em();!e&&(et||x.length)&&ey(nF.connection("CONNECTION_CLOSED",t,C)),$=sm.performance.now(),e&&t.shared.retries++,z=("function"==typeof b?b(t.shared.retries):b)*1e3,s(ei,nF.connection("CONNECTION_CLOSED",t,C))}function eS(){N.statement||(N.statement=et.statement),N.columns=et.statement.columns}async function eE(e,t=e.readUInt32BE(5)){(3===t?eT:5===t?ek:10===t?eO:11===t?eC:12===t?function(e){e.toString("utf8",9).split(sv.N,1)[0].slice(2)!==H&&(e_(nF.generic("SASL_SIGNATURE_MISMATCH","The server did not return the correct signature")),C.destroy())}:0!==t?function(e,t){console.error("Postgres.js : Unknown Auth:",t)}:sC)(e,t)}async function eT(){let e=await eA();eu(sv().p().str(e).z(1).end())}async function ek(e){let t="md5"+await sI(Buffer.concat([Buffer.from(await sI(await eA()+l)),e.subarray(9)]));eu(sv().p().str(t).z(1).end())}async function eO(){ee=(await sd.randomBytes(18)).toString("base64"),sv().p().str("SCRAM-SHA-256"+sv.N);let e=sv.i;eu(sv.inc(4).str("n,,n=*,r="+ee).i32(sv.i-e-4,e).end())}async function eC(e){let t=e.toString("utf8",9).split(",").reduce((e,t)=>(e[t[0]]=t.slice(2),e),{}),r=await sd.pbkdf2Sync(await eA(),Buffer.from(t.s,"base64"),parseInt(t.i),32,"sha256"),i=await sP(r,"Client Key"),n="n=*,r="+ee+",r="+t.r+",s="+t.s+",i="+t.i+",c=biws,r="+t.r;H=(await sP(await sP(r,"Server Key"),n)).toString("base64");let s="c=biws,r="+t.r+",p="+(function(e,t){let r=Math.max(e.length,t.length),i=Buffer.allocUnsafe(r);for(let n=0;n<r;n++)i[n]=e[n]^t[n];return i})(i,Buffer.from(await sP(await sd.createHash("sha256").update(i).digest(),n))).toString("base64");eu(sv().p().str(s).end())}function eA(){return Promise.resolve("function"==typeof t.pass?t.pass():t.pass)}async function eN(){I=!1,(await new nL([`
      select b.oid, b.typarray
      from pg_catalog.pg_type a
      left join pg_catalog.pg_type b on b.oid = a.typelem
      where a.typcategory = 'A'
      group by b.oid, b.typarray
      order by b.oid
    `],[],ea)).forEach(({oid:e,typarray:r})=>(function(e,r){if(t.parsers[r]&&t.serializers[r])return;let i=t.parsers[e];t.shared.typeArrayMap[e]=r,t.parsers[r]=e=>(n9.i=n9.last=0,function e(t,r,i,n){let s=[],a=1020===n?";":",";for(;t.i<r.length;t.i++){if(t.char=r[t.i],t.quoted)"\\"===t.char?t.str+=r[++t.i]:'"'===t.char?(s.push(i?i(t.str):t.str),t.str="",t.quoted='"'===r[t.i+1],t.last=t.i+2):t.str+=t.char;else if('"'===t.char)t.quoted=!0;else if("{"===t.char)t.last=++t.i,s.push(e(t,r,i,n));else if("}"===t.char){t.quoted=!1,t.last<t.i&&s.push(i?i(r.slice(t.last,t.i)):r.slice(t.last,t.i)),t.last=t.i+1;break}else t.char===a&&"}"!==t.p&&'"'!==t.p&&(s.push(i?i(r.slice(t.last,t.i)):r.slice(t.last,t.i)),t.last=t.i+1);t.p=t.char}return t.last<t.i&&s.push(i?i(r.slice(t.last,t.i+1)):r.slice(t.last,t.i+1)),s}(n9,e,i,r)),t.parsers[r].array=!0,t.serializers[r]=i=>n7(i,t.serializers[e],t,r)})(e,r))}async function eR(){try{let e=await Promise.resolve(et.cursorFn(N));q=0,e===nD?eu(function(e=""){return Buffer.concat([sv().C().str("P").str(e+sv.N).end(),sv().S().end()])}(et.portal)):(N=new sg,eu(eP("",et.cursorRows)))}catch(e){eu(sS),et.reject(e)}}function eI(e,t,r,i=""){return sv().P().str(i+sv.N).str(e+sv.N).i16(t.length),t.forEach((e,t)=>sv.i32(r[t]||0)),sv.end()}function eP(e="",t=0){return Buffer.concat([sv().E().str(e+sv.N).i32(t).end(),sE])}},sx=1,sS=sv().S().end(),sE=sv().H().end(),sT=sv().i32(8).i32(0x4d2162f).end(8),sk=Buffer.concat([sv().E().str(sv.N).i32(0).end(),sS]),sO=sv().D().str("S").str(sv.N).end(),sC=()=>{},sA=new Set(["FetchPreparedStatement","RevalidateCachedQuery","transformAssignedExpr"]),sN={83:"severity_local",86:"severity",67:"code",77:"message",68:"detail",72:"hint",80:"position",112:"internal_position",113:"internal_query",87:"where",115:"schema_name",116:"table_name",99:"column_name",100:"data type_name",110:"constraint_name",70:"file",76:"line",82:"routine"};function sR(e){let t={},r=5;for(let i=5;i<e.length-1;i++)0===e[i]&&(t[sN[e[r]]]=e.toString("utf8",r+1,i),r=i+1);return t}function sI(e){return sd.createHash("md5").update(e).digest("hex")}function sP(e,t){return sd.createHmac("sha256",e).update(t).digest()}function sj(e,t){let r;if(!(t="function"==typeof t?t():t))return{cancel:sC,start:sC};return{cancel(){r&&(clearTimeout(r),r=null)},start(){r&&clearTimeout(r),r=setTimeout(i,1e3*t,arguments)}};function i(t){e.apply(null,t),r=null}}let sD=()=>{};function sL(e,t,r,i){let n,s,a;let o=i.raw?Array(t.length):{};for(let l=0;l<t.length;l++)n=e[r++],s=t[l],a=110===n?null:117===n?void 0:void 0===s.parser?e.toString("utf8",r+4,r+=4+e.readUInt32BE(r)):!0===s.parser.array?s.parser(e.toString("utf8",r+5,r+=4+e.readUInt32BE(r))):s.parser(e.toString("utf8",r+4,r+=4+e.readUInt32BE(r))),i.raw?o[l]=!0===i.raw?a:i.value.from?i.value.from(a,s):a:o[s.name]=i.value.from?i.value.from(a,s):a;return{i:r,row:i.row.from?i.row.from(o):o}}function s$(e,t,r=393216){return new Promise(async(i,n)=>{await e.begin(async e=>{let n;t||([{oid:t}]=await e`select lo_creat(-1) as oid`);let[{fd:s}]=await e`select lo_open(${t}, ${r}) as fd`,a={writable:l,readable:o,close:()=>e`select lo_close(${s})`.then(n),tell:()=>e`select lo_tell64(${s})`,read:t=>e`select loread(${s}, ${t}) as data`,write:t=>e`select lowrite(${s}, ${t})`,truncate:t=>e`select lo_truncate64(${s}, ${t})`,seek:(t,r=0)=>e`select lo_lseek64(${s}, ${t}, ${r})`,size:()=>e`
          select
            lo_lseek64(${s}, location, 0) as position,
            seek.size
          from (
            select
              lo_lseek64($1, 0, 2) as size,
              tell.location
            from (select lo_tell64($1) as location) tell
          ) seek
        `};return i(a),new Promise(async e=>n=e);async function o({highWaterMark:e=16384,start:t=0,end:r=1/0}={}){let i=r-t;return t&&await a.seek(t),new sf.Readable({highWaterMark:e,async read(e){let t=e>i?e-i:e;i-=e;let[{data:r}]=await a.read(t);this.push(r),r.length<e&&this.push(null)}})}async function l({highWaterMark:e=16384,start:t=0}={}){return t&&await a.seek(t),new sf.Writable({highWaterMark:e,write(e,t,r){a.write(e).then(()=>r(),r)}})}}).catch(n)})}Object.assign(sM,{PostgresError:n$,toPascal:st,pascal:sl,toCamel:se,camel:so,toKebab:sr,kebab:su,fromPascal:sn,fromCamel:si,fromKebab:ss,BigInt:{to:20,from:[20],parse:e=>BigInt(e),serialize:e=>e.toString()}});let sF=sM;function sM(e,t){let r=function(e,t){var r;if(e&&e.shared)return e;let i=process.env,n=(e&&"string"!=typeof e?e:t)||{},{url:s,multihost:a}=function(e){if(!e||"string"!=typeof e)return{url:{searchParams:new Map}};let t=e;t=decodeURIComponent((t=t.slice(t.indexOf("://")+3).split(/[?/]/)[0]).slice(t.indexOf("@")+1));let r=new URL(e.replace(t,t.split(",")[0]));return{url:{username:decodeURIComponent(r.username),password:decodeURIComponent(r.password),host:r.host,hostname:r.hostname,port:r.port,pathname:r.pathname,searchParams:r.searchParams},multihost:t.indexOf(",")>-1&&t}}(e),o=[...s.searchParams].reduce((e,[t,r])=>(e[t]=r,e),{}),l=n.hostname||n.host||a||s.hostname||i.PGHOST||"localhost",u=n.port||s.port||i.PGPORT||5432,c=n.user||n.username||s.username||i.PGUSERNAME||i.PGUSER||function(){try{return nN.userInfo().username}catch(e){return process.env.USERNAME||process.env.USER||process.env.LOGNAME}}();n.no_prepare&&(n.prepare=!1),o.sslmode&&(o.ssl=o.sslmode,delete o.sslmode),"timeout"in n&&(console.log("The timeout option is deprecated, use idle_timeout instead"),n.idle_timeout=n.timeout),"system"===o.sslrootcert&&(o.ssl="verify-full");let h=["idle_timeout","connect_timeout","max_lifetime","max_pipeline","backoff","keep_alive"],d={max:10,ssl:!1,idle_timeout:null,connect_timeout:30,max_lifetime:sU,max_pipeline:100,backoff:sB,keep_alive:60,prepare:!0,debug:!1,fetch_types:!0,publications:"alltables",target_session_attrs:null};return{host:Array.isArray(l)?l:l.split(",").map(e=>e.split(":")[0]),port:Array.isArray(u)?u:l.split(",").map(e=>parseInt(e.split(":")[1]||u)),path:n.path||l.indexOf("/")>-1&&l+"/.s.PGSQL."+u,database:n.database||n.db||(s.pathname||"").slice(1)||i.PGDATABASE||c,user:c,pass:n.pass||n.password||s.password||i.PGPASSWORD||"",...Object.entries(d).reduce((e,[t,r])=>{let s=t in n?n[t]:t in o?"disable"!==o[t]&&"false"!==o[t]&&o[t]:i["PG"+t.toUpperCase()]||r;return e[t]="string"==typeof s&&h.includes(t)?+s:s,e},{}),connection:{application_name:i.PGAPPNAME||"postgres.js",...n.connection,...Object.entries(o).reduce((e,[t,r])=>(t in d||(e[t]=r),e),{})},types:n.types||{},target_session_attrs:function(e,t,r){let i=e.target_session_attrs||t.searchParams.get("target_session_attrs")||r.PGTARGETSESSIONATTRS;if(!i||["read-write","read-only","primary","standby","prefer-standby"].includes(i))return i;throw Error("target_session_attrs "+i+" is not supported")}(n,s,i),onnotice:n.onnotice,onnotify:n.onnotify,onclose:n.onclose,onparameter:n.onparameter,socket:n.socket,transform:{undefined:(r=n.transform||{undefined:void 0}).undefined,column:{from:"function"==typeof r.column?r.column:r.column&&r.column.from,to:r.column&&r.column.to},value:{from:"function"==typeof r.value?r.value:r.value&&r.value.from,to:r.value&&r.value.to},row:{from:"function"==typeof r.row?r.row:r.row&&r.row.from,to:r.row&&r.row.to}},parameters:{},shared:{retries:0,typeArrayMap:{}},...n1(n.types)}}(e,t),i=r.no_subscribe||function(e,t){let r=new Map,i="postgresjs_"+Math.random().toString(36).slice(2),n={},s,a,o=!1,l=h.sql=e({...t,transform:{column:{},value:{},row:{}},max:1,fetch_types:!1,idle_timeout:null,max_lifetime:null,connection:{...t.connection,replication:"database"},onclose:async function(){o||(a=null,n.pid=n.secret=void 0,d(await p(l,i,t.publications)),r.forEach(e=>e.forEach(({onsubscribe:e})=>e())))},no_subscribe:!0}),u=l.end,c=l.close;return l.end=async()=>(o=!0,a&&await new Promise(e=>(a.once("close",e),a.end())),u()),l.close=async()=>(a&&await new Promise(e=>(a.once("close",e),a.end())),c()),h;async function h(e,o,u=sD,c=sD){e=function(e){let t=e.match(/^(\*|insert|update|delete)?:?([^.]+?\.?[^=]+)?=?(.+)?/i)||[];if(!t)throw Error("Malformed subscribe pattern: "+e);let[,r,i,n]=t;return(r||"*")+(i?":"+(-1===i.indexOf(".")?"public."+i:i):"")+(n?"="+n:"")}(e),s||(s=p(l,i,t.publications));let f={fn:o,onsubscribe:u},m=r.has(e)?r.get(e).add(f):r.set(e,new Set([f])).get(e),g=()=>{m.delete(f),0===m.size&&r.delete(e)};return s.then(e=>(d(e),u(),a&&a.on("error",c),{unsubscribe:g,state:n,sql:l}))}function d(e){a=e.stream,n.pid=e.state.pid,n.secret=e.state.secret}async function p(e,r,i){if(!i)throw Error("Missing publication names");let n=await e.unsafe(`CREATE_REPLICATION_SLOT ${r} TEMPORARY LOGICAL pgoutput NOEXPORT_SNAPSHOT`),[s]=n,a=await e.unsafe(`START_REPLICATION SLOT ${r} LOGICAL ${s.consistent_point} (proto_version '1', publication_names '${i}')`).writable(),o={lsn:Buffer.concat(s.consistent_point.split("/").map(e=>Buffer.from(("00000000"+e).slice(-8),"hex")))};return a.on("data",function(r){119===r[0]?function(e,t,r,i,n){Object.entries({R:e=>{let i=1,s=t[e.readUInt32BE(i)]={schema:e.toString("utf8",i+=4,i=e.indexOf(0,i))||"pg_catalog",table:e.toString("utf8",i+1,i=e.indexOf(0,i+1)),columns:Array(e.readUInt16BE(i+=2)),keys:[]};i+=2;let a=0,o;for(;i<e.length;)(o=s.columns[a++]={key:e[i++],name:n.column.from?n.column.from(e.toString("utf8",i,i=e.indexOf(0,i))):e.toString("utf8",i,i=e.indexOf(0,i)),type:e.readUInt32BE(i+=1),parser:r[e.readUInt32BE(i)],atttypmod:e.readUInt32BE(i+=4)}).key&&s.keys.push(o),i+=4},Y:()=>{},O:()=>{},B:e=>{var r;t.date=(r=e.readBigInt64BE(9),new Date(Date.UTC(2e3,0,1)+Number(r/BigInt(1e3)))),t.lsn=e.subarray(1,9)},I:e=>{let r=1,s=t[e.readUInt32BE(r)],{row:a}=sL(e,s.columns,r+=7,n);i(a,{command:"insert",relation:s})},D:e=>{let r=1,s=t[e.readUInt32BE(r)],a=75===e[r+=4];i(a||79===e[r]?sL(e,s.columns,r+=3,n).row:null,{command:"delete",relation:s,key:a})},U:e=>{let r=1,s=t[e.readUInt32BE(r)],a=75===e[r+=4],o=a||79===e[r]?sL(e,s.columns,r+=3,n):null;o&&(r=o.i);let{row:l}=sL(e,s.columns,r+3,n);i(l,{command:"update",relation:s,key:a,old:o&&o.row})},T:()=>{},C:()=>{}}).reduce((e,[t,r])=>(e[t.charCodeAt(0)]=r,e),{})[e[0]](e)}(r.subarray(25),o,e.options.parsers,l,t.transform):107===r[0]&&r[17]&&(o.lsn=r.subarray(1,9),function(){let e=Buffer.alloc(34);e[0]=114,e.fill(o.lsn,1),e.writeBigInt64BE(BigInt(Date.now()-Date.UTC(2e3,0,1))*BigInt(1e3),25),a.write(e)}())}),a.on("error",function(e){console.error("Unexpected error during logical streaming - reconnecting",e)}),a.on("close",e.close),{stream:a,state:n.state};function l(e,t){let r=t.relation.schema+"."+t.relation.table;f("*",e,t),f("*:"+r,e,t),t.relation.keys.length&&f("*:"+r+"="+t.relation.keys.map(t=>e[t.name]),e,t),f(t.command,e,t),f(t.command+":"+r,e,t),t.relation.keys.length&&f(t.command+":"+r+"="+t.relation.keys.map(t=>e[t.name]),e,t)}}function f(e,t,i){r.has(e)&&r.get(e).forEach(({fn:r})=>r(t,i,e))}}(sM,{...r}),n=!1,s=sy(),a=sy(),o=sy(),l=sy(),u=sy(),c=sy(),h=sy(),d=sy(),p={connecting:a,reserved:o,closed:l,ended:u,open:c,busy:h,full:d},f=[...Array(r.max)].map(()=>sw(r,p,{onopen:R,onend:N,onclose:I})),m=g(function(e){return n?e.reject(nF.connection("CONNECTION_ENDED",r,r)):c.length?E(c.shift(),e):l.length?A(l.shift(),e):void(h.length?E(h.shift(),e):s.push(e))});return Object.assign(m,{get parameters(){return r.parameters},largeObject:s$.bind(null,m),subscribe:i,CLOSE:nD,END:nD,PostgresError:n$,options:r,reserve:b,listen:y,begin:w,close:O,end:k}),m;function g(e){return e.debug=r.debug,Object.entries(r.types).reduce((e,[t,r])=>(e[t]=e=>new nU(e,r.to),e),t),Object.assign(i,{types:t,typed:t,unsafe:function(t,r=[],i={}){return 2!=arguments.length||Array.isArray(r)||(i=r,r=[]),new nL([t],r,e,T,{prepare:!1,...i,simple:"simple"in i?i.simple:0===r.length})},notify:v,array:function e(t,i){return Array.isArray(t)?new nU(t,i||(t.length?n3(t)||25:0),r.shared.typeArrayMap):e(Array.from(arguments))},json:S,file:function(t,r=[],i={}){return 2!=arguments.length||Array.isArray(r)||(i=r,r=[]),new nL([],r,r=>{nR.readFile(t,"utf8",(t,i)=>{if(t)return r.reject(t);r.strings=[i],e(r)})},T,{...i,simple:"simple"in i?i.simple:0===r.length})}}),i;function t(e,t){return new nU(e,t)}function i(t,...n){return t&&Array.isArray(t.raw)?new nL(t,n,e,T):"string"!=typeof t||n.length?new nz(t,n):new nB(r.transform.column.to?r.transform.column.to(t):t)}}async function y(e,t,i){let n={fn:t,onlisten:i},s=y.sql||(y.sql=sM({...r,max:1,idle_timeout:null,max_lifetime:null,fetch_types:!1,onclose(){Object.entries(y.channels).forEach(([e,{listeners:t}])=>{delete y.channels[e],Promise.all(t.map(t=>y(e,t.fn,t.onlisten).catch(()=>{})))})},onnotify(e,t){e in y.channels&&y.channels[e].listeners.forEach(e=>e.fn(t))}})),a=y.channels||(y.channels={});if(e in a){a[e].listeners.push(n);let t=await a[e].result;return n.onlisten&&n.onlisten(),{state:t.state,unlisten:l}}a[e]={result:s`listen ${s.unsafe('"'+e.replace(/"/g,'""')+'"')}`,listeners:[n]};let o=await a[e].result;return n.onlisten&&n.onlisten(),{state:o.state,unlisten:l};async function l(){if(e in a!=!1&&(a[e].listeners=a[e].listeners.filter(e=>e!==n),!a[e].listeners.length))return delete a[e],s`unlisten ${s.unsafe('"'+e.replace(/"/g,'""')+'"')}`}}async function v(e,t){return await m`select pg_notify(${e}, ${""+t})`}async function b(){let e=sy(),t=c.length?c.shift():await new Promise((e,t)=>{let r={reserve:e,reject:t};s.push(r),l.length&&A(l.shift(),r)});x(t,o),t.reserved=()=>e.length?t.execute(e.shift()):x(t,o),t.reserved.release=!0;let r=g(function(r){t.queue===d?e.push(r):t.execute(r)||x(t,d)});return r.release=()=>{t.reserved=null,R(t)},r}async function w(e,t){t||(t=e,e="");let r=sy(),i=0,n,s=null;try{return await m.unsafe("begin "+e.replace(/[^a-z ]/ig,""),[],{onexecute:function(e){n=e,x(e,o),e.reserved=()=>r.length?e.execute(r.shift()):x(e,o)}}).execute(),await Promise.race([a(n,t),new Promise((e,t)=>n.onclose=t)])}catch(e){throw e}async function a(e,t,n){let o,l;let u=g(function(t){t.catch(e=>o||(o=e)),e.queue===d?r.push(t):e.execute(t)||x(e,d)});u.savepoint=function t(r,n){return r&&Array.isArray(r.raw)?t(e=>e.apply(e,arguments)):(1==arguments.length&&(n=r,r=null),a(e,n,"s"+i+++(r?"_"+r:"")))},u.prepare=e=>s=e.replace(/[^a-z0-9$-_. ]/gi),n&&await u`savepoint ${u(n)}`;try{if(l=await new Promise((e,r)=>{let i=t(u);Promise.resolve(Array.isArray(i)?Promise.all(i):i).then(e,r)}),o)throw o}catch(e){throw await (n?u`rollback to ${u(n)}`:u`rollback`),e instanceof n$&&"25P02"===e.code&&o||e}return n||(s?await u`prepare transaction '${u.unsafe(s)}'`:await u`commit`),l}}function x(e,t){return e.queue.remove(e),t.push(e),e.queue=t,t===c?e.idleTimer.start():e.idleTimer.cancel(),e}function S(e){return new nU(e,3802)}function E(e,t){return e.execute(t)?x(e,h):x(e,d)}function T(e){return new Promise((t,i)=>{e.state?e.active?sw(r).cancel(e.state,t,i):e.cancelled={resolve:t,reject:i}:(s.remove(e),e.cancelled=!0,e.reject(nF.generic("57014","canceling statement due to user request")),t())})}async function k({timeout:e=null}={}){let t;return n||(await 1,n=Promise.race([new Promise(r=>null!==e&&(t=setTimeout(C,1e3*e,r))),Promise.all(f.map(e=>e.end()).concat(y.sql?y.sql.end({timeout:0}):[],i.sql?i.sql.end({timeout:0}):[]))]).then(()=>clearTimeout(t)))}async function O(){await Promise.all(f.map(e=>e.end()))}async function C(e){for(await Promise.all(f.map(e=>e.terminate()));s.length;)s.shift().reject(nF.connection("CONNECTION_DESTROYED",r));e()}function A(e,t){return x(e,a),e.connect(t),e}function N(e){x(e,u)}function R(e){if(0===s.length)return x(e,c);let t=Math.ceil(s.length/(a.length+1)),r=!0;for(;r&&s.length&&t-- >0;){let t=s.shift();if(t.reserve)return t.reserve(e);r=e.execute(t)}r?x(e,h):x(e,d)}function I(e,t){x(e,l),e.reserved=null,e.onclose&&(e.onclose(t),e.onclose=null),r.onclose&&r.onclose(e.id),s.length&&A(e,s.shift())}}function sB(e){return(.5+Math.random()/2)*Math.min(3**e/100,20)}function sU(){return 60*(30+30*Math.random())}let sz=Symbol.for("drizzle:entityKind");function sq(e,t){if(!e||"object"!=typeof e)return!1;if(e instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,sz))throw Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(e).constructor;if(r)for(;r;){if(sz in r&&r[sz]===t[sz])return!0;r=Object.getPrototypeOf(r)}return!1}Symbol.for("drizzle:hasOwnEntityKind");class sH{static [sz]="ConsoleLogWriter";write(e){console.log(e)}}class sW{static [sz]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new sH}logQuery(e,t){let r=t.map(e=>{try{return JSON.stringify(e)}catch{return String(e)}}),i=r.length?` -- params: [${r.join(", ")}]`:"";this.writer.write(`Query: ${e}${i}`)}}class sV{static [sz]="NoopLogger";logQuery(){}}class sG{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static [sz]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return void 0!==this.config.generated&&"byDefault"!==this.config.generated.type}}class sK{static [sz]="ColumnBuilder";config;constructor(e,t,r){this.config={name:e,keyAsName:""===e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){""===this.config.name&&(this.config.name=e)}}let sJ=Symbol.for("drizzle:Name");class sQ{static [sz]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:t,columns:r,foreignColumns:i}=e();return{name:t,columns:r,foreignTable:i[0].table,foreignColumns:i}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=void 0===e?"no action":e,this}onDelete(e){return this._onDelete=void 0===e?"no action":e,this}build(e){return new sZ(e,this)}}class sZ{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static [sz]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),i=t.map(e=>e.name),n=r.map(e=>e.name),s=[this.table[sJ],...i,r[0].table[sJ],...n];return e??`${s.join("_")}_fk`}}function sX(e,...t){return e(...t)}function sY(e,t){return`${e[sJ]}_${t.join("_")}_unique`}class s0{constructor(e,t){this.name=t,this.columns=e}static [sz]=null;columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new s2(e,this.columns,this.nullsNotDistinctConfig,this.name)}}class s1{static [sz]=null;name;constructor(e){this.name=e}on(...e){return new s0(e,this.name)}}class s2{constructor(e,t,r,i){this.table=e,this.columns=t,this.name=i??sY(this.table,this.columns.map(e=>e.name)),this.nullsNotDistinct=r}static [sz]=null;columns;name;nullsNotDistinct=!1;getName(){return this.name}}function s5(e,t,r){for(let i=t;i<e.length;i++){let n=e[i];if("\\"===n){i++;continue}if('"'===n)return[e.slice(t,i).replace(/\\/g,""),i+1];if(!r&&(","===n||"}"===n))return[e.slice(t,i).replace(/\\/g,""),i]}return[e.slice(t).replace(/\\/g,""),e.length]}class s6 extends sK{foreignKeyConfigs=[];static [sz]="PgColumnBuilder";array(e){return new s7(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:i})=>sX((r,i)=>{let n=new sQ(()=>({columns:[e],foreignColumns:[r()]}));return i.onUpdate&&n.onUpdate(i.onUpdate),i.onDelete&&n.onDelete(i.onDelete),n.build(t)},r,i))}buildExtraConfigColumn(e){return new s4(e,this.config)}}class s3 extends sG{constructor(e,t){t.uniqueName||(t.uniqueName=sY(e,[t.name])),super(e,t),this.table=e}static [sz]="PgColumn"}class s4 extends s3{static [sz]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}}class s8{static [sz]=null;constructor(e,t,r,i){this.name=e,this.keyAsName=t,this.type=r,this.indexConfig=i}name;keyAsName;type;indexConfig}class s7 extends s6{static [sz]="PgArrayBuilder";constructor(e,t,r){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=r}build(e){let t=this.config.baseBuilder.build(e);return new s9(e,this.config,t)}}class s9 extends s3{constructor(e,t,r,i){super(e,t),this.baseColumn=r,this.range=i,this.size=t.size}size;static [sz]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(e){return"string"==typeof e&&(e=function(e){let[t]=function e(t,r=0){let i=[],n=r,s=!1;for(;n<t.length;){let a=t[n];if(","===a){(s||n===r)&&i.push(""),s=!0,n++;continue}if(s=!1,"\\"===a){n+=2;continue}if('"'===a){let[e,r]=s5(t,n+1,!0);i.push(e),n=r;continue}if("}"===a)return[i,n+1];if("{"===a){let[r,s]=e(t,n+1);i.push(r),n=s;continue}let[o,l]=s5(t,n,!1);i.push(o),n=l}return[i,n]}(e,1);return t}(e)),e.map(e=>this.baseColumn.mapFromDriverValue(e))}mapToDriverValue(e,t=!1){let r=e.map(e=>null===e?null:sq(this.baseColumn,s9)?this.baseColumn.mapToDriverValue(e,!0):this.baseColumn.mapToDriverValue(e));return t?r:function e(t){return`{${t.map(t=>Array.isArray(t)?e(t):"string"==typeof t?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}(r)}}let ae=Symbol.for("drizzle:isPgEnum");class at extends s6{static [sz]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new ar(e,this.config)}}class ar extends s3{static [sz]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}class ai{static [sz]="Subquery";constructor(e,t,r,i=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:i}}}class an extends ai{static [sz]="WithSubquery"}let as={startActiveSpan:(e,t)=>a?(o||(o=a.trace.getTracer("drizzle-orm","0.38.4")),sX((r,i)=>i.startActiveSpan(e,e=>{try{return t(e)}catch(t){throw e.setStatus({code:r.SpanStatusCode.ERROR,message:t instanceof Error?t.message:"Unknown error"}),t}finally{e.end()}}),a,o)):t()},aa=Symbol.for("drizzle:ViewBaseConfig"),ao=Symbol.for("drizzle:Schema"),al=Symbol.for("drizzle:Columns"),au=Symbol.for("drizzle:ExtraConfigColumns"),ac=Symbol.for("drizzle:OriginalName"),ah=Symbol.for("drizzle:BaseName"),ad=Symbol.for("drizzle:IsAlias"),ap=Symbol.for("drizzle:ExtraConfigBuilder"),af=Symbol.for("drizzle:IsDrizzleTable");class am{static [sz]="Table";static Symbol={Name:sJ,Schema:ao,OriginalName:ac,Columns:al,ExtraConfigColumns:au,BaseName:ah,IsAlias:ad,ExtraConfigBuilder:ap};[sJ];[ac];[ao];[al];[au];[ah];[ad]=!1;[af]=!0;[ap]=void 0;constructor(e,t,r){this[sJ]=this[ac]=e,this[ao]=t,this[ah]=r}}function ag(e){return`${e[ao]??"public"}.${e[sJ]}`}class ay{static [sz]=null}function a_(e){return null!=e&&"function"==typeof e.getSQL}class av{static [sz]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new ab([this])}}class ab{constructor(e){this.queryChunks=e}static [sz]="SQL";decoder=ax;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return as.startActiveSpan("drizzle.buildSQL",t=>{let r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(e,t){let r=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:i,escapeName:n,escapeParam:s,prepareTyping:a,inlineParams:o,paramStartIndex:l}=r;return function(e){let t={sql:"",params:[]};for(let r of e)t.sql+=r.sql,t.params.push(...r.params),r.typings?.length&&(t.typings||(t.typings=[]),t.typings.push(...r.typings));return t}(e.map(e=>{if(sq(e,av))return{sql:e.value.join(""),params:[]};if(sq(e,aw))return{sql:n(e.value),params:[]};if(void 0===e)return{sql:"",params:[]};if(Array.isArray(e)){let t=[new av("(")];for(let[r,i]of e.entries())t.push(i),r<e.length-1&&t.push(new av(", "));return t.push(new av(")")),this.buildQueryFromSourceParams(t,r)}if(sq(e,ab))return this.buildQueryFromSourceParams(e.queryChunks,{...r,inlineParams:o||e.shouldInlineParams});if(sq(e,am)){let t=e[am.Symbol.Schema],r=e[am.Symbol.Name];return{sql:void 0===t?n(r):n(t)+"."+n(r),params:[]}}if(sq(e,sG)){let r=i.getColumnCasing(e);if("indexes"===t.invokeSource)return{sql:n(r),params:[]};let s=e.table[am.Symbol.Schema];return{sql:e.table[ad]||void 0===s?n(e.table[am.Symbol.Name])+"."+n(r):n(s)+"."+n(e.table[am.Symbol.Name])+"."+n(r),params:[]}}if(sq(e,aA)){let t=e[aa].schema,r=e[aa].name;return{sql:void 0===t?n(r):n(t)+"."+n(r),params:[]}}if(sq(e,aE)){if(sq(e.value,ak))return{sql:s(l.value++,e),params:[e],typings:["none"]};let t=null===e.value?null:e.encoder.mapToDriverValue(e.value);if(sq(t,ab))return this.buildQueryFromSourceParams([t],r);if(o)return{sql:this.mapInlineParam(t,r),params:[]};let i=["none"];return a&&(i=[a(e.encoder)]),{sql:s(l.value++,t),params:[t],typings:i}}return sq(e,ak)?{sql:s(l.value++,e),params:[e],typings:["none"]}:sq(e,ab.Aliased)&&void 0!==e.fieldAlias?{sql:n(e.fieldAlias),params:[]}:sq(e,ai)?e._.isWith?{sql:n(e._.alias),params:[]}:this.buildQueryFromSourceParams([new av("("),e._.sql,new av(") "),new aw(e._.alias)],r):e&&"function"==typeof e&&ae in e&&!0===e[ae]?e.schema?{sql:n(e.schema)+"."+n(e.enumName),params:[]}:{sql:n(e.enumName),params:[]}:a_(e)?e.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([e.getSQL()],r):this.buildQueryFromSourceParams([new av("("),e.getSQL(),new av(")")],r):o?{sql:this.mapInlineParam(e,r),params:[]}:{sql:s(l.value++,e),params:[e],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(null===e)return"null";if("number"==typeof e||"boolean"==typeof e)return e.toString();if("string"==typeof e)return t(e);if("object"==typeof e){let r=e.toString();return"[object Object]"===r?t(JSON.stringify(e)):t(r)}throw Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return void 0===e?this:new ab.Aliased(this,e)}mapWith(e){return this.decoder="function"==typeof e?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}}class aw{constructor(e){this.value=e}static [sz]="Name";brand;getSQL(){return new ab([this])}}let ax={mapFromDriverValue:e=>e},aS={mapToDriverValue:e=>e};class aE{constructor(e,t=aS){this.value=e,this.encoder=t}static [sz]="Param";brand;getSQL(){return new ab([this])}}function aT(e,...t){let r=[];for(let[i,n]of((t.length>0||e.length>0&&""!==e[0])&&r.push(new av(e[0])),t.entries()))r.push(n,new av(e[i+1]));return new ab(r)}(e=>{e.empty=function(){return new ab([])},e.fromList=function(e){return new ab(e)},e.raw=function(e){return new ab([new av(e)])},e.join=function(e,t){let r=[];for(let[i,n]of e.entries())i>0&&void 0!==t&&r.push(t),r.push(n);return new ab(r)},e.identifier=function(e){return new aw(e)},e.placeholder=function(e){return new ak(e)},e.param=function(e,t){return new aE(e,t)}})(aT||(aT={})),(e=>{class t{constructor(e,t){this.sql=e,this.fieldAlias=t}static [sz]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new t(this.sql,this.fieldAlias)}}e.Aliased=t})(ab||(ab={}));class ak{constructor(e){this.name=e}static [sz]="Placeholder";getSQL(){return new ab([this])}}function aO(e,t){return e.map(e=>{if(sq(e,ak)){if(!(e.name in t))throw Error(`No value for placeholder "${e.name}" was provided`);return t[e.name]}if(sq(e,aE)&&sq(e.value,ak)){if(!(e.value.name in t))throw Error(`No value for placeholder "${e.value.name}" was provided`);return e.encoder.mapToDriverValue(t[e.value.name])}return e})}let aC=Symbol.for("drizzle:IsDrizzleView");class aA{static [sz]="View";[aa];[aC]=!0;constructor({name:e,schema:t,selectedFields:r,query:i}){this[aa]={name:e,originalName:e,schema:t,selectedFields:r,query:i,isExisting:!i,isAlias:!1}}getSQL(){return new ab([this])}}sG.prototype.getSQL=function(){return new ab([this])},am.prototype.getSQL=function(){return new ab([this])},ai.prototype.getSQL=function(){return new ab([this])};class aN{constructor(e){this.table=e}static [sz]="ColumnAliasProxyHandler";get(e,t){return"table"===t?this.table:e[t]}}class aR{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static [sz]="TableAliasProxyHandler";get(e,t){if(t===am.Symbol.IsAlias)return!0;if(t===am.Symbol.Name||this.replaceOriginalName&&t===am.Symbol.OriginalName)return this.alias;if(t===aa)return{...e[aa],name:this.alias,isAlias:!0};if(t===am.Symbol.Columns){let t=e[am.Symbol.Columns];if(!t)return t;let r={};return Object.keys(t).map(i=>{r[i]=new Proxy(t[i],new aN(new Proxy(e,this)))}),r}let r=e[t];return sq(r,sG)?new Proxy(r,new aN(new Proxy(e,this))):r}}class aI{constructor(e){this.alias=e}static [sz]=null;get(e,t){return"sourceTable"===t?aP(e.sourceTable,this.alias):e[t]}}function aP(e,t){return new Proxy(e,new aR(t,!1))}function aj(e,t){return new Proxy(e,new aN(new Proxy(e.table,new aR(t,!1))))}function aD(e,t){return new ab.Aliased(aL(e.sql,t),e.fieldAlias)}function aL(e,t){return aT.join(e.queryChunks.map(e=>sq(e,sG)?aj(e,t):sq(e,ab)?aL(e,t):sq(e,ab.Aliased)?aD(e,t):e))}function a$(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(e=>e.toLowerCase()).join("_")}function aF(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((e,t,r)=>e+(0===r?t.toLowerCase():`${t[0].toUpperCase()}${t.slice(1)}`),"")}function aM(e){return e}class aB{static [sz]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert="snake_case"===e?a$:"camelCase"===e?aF:aM}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[am.Symbol.Schema]??"public",r=e.table[am.Symbol.OriginalName],i=`${t}.${r}.${e.name}`;return this.cache[i]||this.cacheTable(e.table),this.cache[i]}cacheTable(e){let t=e[am.Symbol.Schema]??"public",r=e[am.Symbol.OriginalName],i=`${t}.${r}`;if(!this.cachedTables[i]){for(let t of Object.values(e[am.Symbol.Columns])){let e=`${i}.${t.name}`;this.cache[e]=this.convert(t.name)}this.cachedTables[i]=!0}}clearCache(){this.cache={},this.cachedTables={}}}class aU extends Error{static [sz]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}}class az extends aU{static [sz]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}class aq extends s6{static [sz]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new aH(e,this.config)}}class aH extends s3{static [sz]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}function aW(e){return new aq(e??"")}class aV extends s6{static [sz]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new aG(e,this.config)}}class aG extends s3{static [sz]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}function aK(e){return new aV(e??"")}function aJ(e,t){return Object.entries(e).reduce((e,[r,i])=>{if("string"!=typeof r)return e;let n=t?[...t,r]:[r];return sq(i,sG)||sq(i,ab)||sq(i,ab.Aliased)?e.push({path:n,field:i}):sq(i,am)?e.push(...aJ(i[am.Symbol.Columns],n)):e.push(...aJ(i,n)),e},[])}function aQ(e,t){let r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(let[e,t]of r.entries())if(t!==i[e])return!1;return!0}function aZ(e,t){let r=Object.entries(t).filter(([,e])=>void 0!==e).map(([t,r])=>sq(r,ab)||sq(r,sG)?[t,r]:[t,new aE(r,e[am.Symbol.Columns][t])]);if(0===r.length)throw Error("No values to set");return Object.fromEntries(r)}function aX(e){return sq(e,ai)?e._.alias:sq(e,aA)?e[aa].name:sq(e,ab)?void 0:e[am.Symbol.IsAlias]?e[am.Symbol.Name]:e[am.Symbol.BaseName]}function aY(e,t){return{name:"string"==typeof e&&e.length>0?e:"",config:"object"==typeof e?e:t}}class a0 extends s6{static [sz]="PgNumericBuilder";constructor(e,t,r){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=r}build(e){return new a1(e,this.config)}}class a1 extends s3{static [sz]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}function a2(e,t){let{name:r,config:i}=aY(e,t);return new a0(r,i?.precision,i?.scale)}class a5 extends s6{static [sz]="PgDateColumnBaseBuilder";defaultNow(){return this.default(aT`now()`)}}class a6 extends a5{constructor(e,t,r){super(e,"string","PgTime"),this.withTimezone=t,this.precision=r,this.config.withTimezone=t,this.config.precision=r}static [sz]="PgTimeBuilder";build(e){return new a3(e,this.config)}}class a3 extends s3{static [sz]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`time${e}${this.withTimezone?" with time zone":""}`}}function a4(e,t={}){let{name:r,config:i}=aY(e,t);return new a6(r,i.withTimezone??!1,i.precision)}class a8 extends a5{static [sz]="PgTimestampBuilder";constructor(e,t,r){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new a7(e,this.config)}}class a7 extends s3{static [sz]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":` (${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()}class a9 extends a5{static [sz]="PgTimestampStringBuilder";constructor(e,t,r){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new oe(e,this.config)}}class oe extends s3{static [sz]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}}function ot(e,t={}){let{name:r,config:i}=aY(e,t);return i?.mode==="string"?new a9(r,i.withTimezone??!1,i.precision):new a8(r,i?.withTimezone??!1,i?.precision)}class or extends a5{static [sz]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new oi(e,this.config)}}class oi extends s3{static [sz]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}}class on extends a5{static [sz]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new os(e,this.config)}}class os extends s3{static [sz]="PgDateString";getSQLType(){return"date"}}function oa(e,t){let{name:r,config:i}=aY(e,t);return i?.mode==="date"?new or(r):new on(r)}class oo extends s6{static [sz]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(aT`gen_random_uuid()`)}build(e){return new ol(e,this.config)}}class ol extends s3{static [sz]="PgUUID";getSQLType(){return"uuid"}}function ou(e){return new oo(e??"")}class oc extends s6{static [sz]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class oh extends oc{static [sz]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new od(e,this.config)}}class od extends s3{static [sz]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class op extends oc{static [sz]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new of(e,this.config)}}class of extends s3{static [sz]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}function om(e,t){let{name:r,config:i}=aY(e,t);return"number"===i.mode?new oh(r):new op(r)}class og extends s6{static [sz]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new oy(e,this.config)}}class oy extends s3{static [sz]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class o_ extends s6{static [sz]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new ov(e,this.config)}}class ov extends s3{static [sz]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}function ob(e,t){let{name:r,config:i}=aY(e,t);return"number"===i.mode?new og(r):new o_(r)}class ow extends s6{static [sz]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new ox(e,this.config)}}class ox extends s3{static [sz]="PgBoolean";getSQLType(){return"boolean"}}function oS(e){return new ow(e??"")}class oE extends s6{static [sz]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new oT(e,this.config)}}class oT extends s3{static [sz]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function ok(e,t={}){let{name:r,config:i}=aY(e,t);return new oE(r,i)}class oO extends s6{static [sz]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new oC(e,this.config)}}class oC extends s3{static [sz]="PgCidr";getSQLType(){return"cidr"}}function oA(e){return new oO(e??"")}class oN extends s6{static [sz]="PgCustomColumnBuilder";constructor(e,t,r){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=r}build(e){return new oR(e,this.config)}}class oR extends s3{static [sz]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return"function"==typeof this.mapFrom?this.mapFrom(e):e}mapToDriverValue(e){return"function"==typeof this.mapTo?this.mapTo(e):e}}function oI(e){return(t,r)=>{let{name:i,config:n}=aY(t,r);return new oN(i,n,e)}}class oP extends s6{static [sz]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new oj(e,this.config)}}class oj extends s3{static [sz]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return"string"==typeof e?Number.parseFloat(e):e}}function oD(e){return new oP(e??"")}class oL extends s6{static [sz]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new o$(e,this.config)}}class o$ extends s3{static [sz]="PgInet";getSQLType(){return"inet"}}function oF(e){return new oL(e??"")}class oM extends oc{static [sz]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new oB(e,this.config)}}class oB extends s3{static [sz]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return"string"==typeof e?Number.parseInt(e):e}}function oU(e){return new oM(e??"")}class oz extends s6{static [sz]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new oq(e,this.config)}}class oq extends s3{static [sz]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}}function oH(e,t={}){let{name:r,config:i}=aY(e,t);return new oz(r,i)}class oW extends s6{static [sz]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new oV(e,this.config)}}class oV extends s3{static [sz]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,i]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r),Number.parseFloat(i)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}}class oG extends s6{static [sz]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new oK(e,this.config)}}class oK extends s3{static [sz]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,i]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(r),c:Number.parseFloat(i)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}function oJ(e,t){let{name:r,config:i}=aY(e,t);return i?.mode&&"tuple"!==i.mode?new oG(r):new oW(r)}class oQ extends s6{static [sz]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new oZ(e,this.config)}}class oZ extends s3{static [sz]="PgMacaddr";getSQLType(){return"macaddr"}}function oX(e){return new oQ(e??"")}class oY extends s6{static [sz]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new o0(e,this.config)}}class o0 extends s3{static [sz]="PgMacaddr8";getSQLType(){return"macaddr8"}}function o1(e){return new oY(e??"")}class o2 extends s6{static [sz]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new o5(e,this.config)}}class o5 extends s3{static [sz]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if("string"==typeof e){let[t,r]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}}class o6 extends s6{static [sz]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new o3(e,this.config)}}class o3 extends s3{static [sz]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if("string"==typeof e){let[t,r]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(r)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}function o4(e,t){let{name:r,config:i}=aY(e,t);return i?.mode&&"tuple"!==i.mode?new o6(r):new o2(r)}function o8(e,t){let r=new DataView(new ArrayBuffer(8));for(let i=0;i<8;i++)r.setUint8(i,e[t+i]);return r.getFloat64(0,!0)}function o7(e){let t=function(e){let t=[];for(let r=0;r<e.length;r+=2)t.push(Number.parseInt(e.slice(r,r+2),16));return new Uint8Array(t)}(e),r=0,i=t[0];r+=1;let n=new DataView(t.buffer),s=n.getUint32(r,1===i);if(r+=4,0x20000000&s&&(n.getUint32(r,1===i),r+=4),(65535&s)==1){let e=o8(t,r),i=o8(t,r+=8);return r+=8,[e,i]}throw Error("Unsupported geometry type")}class o9 extends s6{static [sz]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new le(e,this.config)}}class le extends s3{static [sz]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return o7(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}}class lt extends s6{static [sz]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new lr(e,this.config)}}class lr extends s3{static [sz]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=o7(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}function li(e,t){let{name:r,config:i}=aY(e,t);return i?.mode&&"tuple"!==i.mode?new lt(r):new o9(r)}class ln extends s6{static [sz]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new ls(e,this.config)}}class ls extends s3{static [sz]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>"string"==typeof e?Number.parseFloat(e):e}function la(e){return new ln(e??"")}class lo extends s6{static [sz]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new ll(e,this.config)}}class ll extends s3{static [sz]="PgSerial";getSQLType(){return"serial"}}function lu(e){return new lo(e??"")}class lc extends oc{static [sz]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new lh(e,this.config)}}class lh extends s3{static [sz]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>"string"==typeof e?Number(e):e}function ld(e){return new lc(e??"")}class lp extends s6{static [sz]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new lf(e,this.config)}}class lf extends s3{static [sz]="PgSmallSerial";getSQLType(){return"smallserial"}}function lm(e){return new lp(e??"")}class lg extends s6{static [sz]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new ly(e,this.config)}}class ly extends s3{static [sz]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function l_(e,t={}){let{name:r,config:i}=aY(e,t);return new lg(r,i)}class lv extends s6{static [sz]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new lb(e,this.config)}}class lb extends s3{static [sz]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function lw(e,t={}){let{name:r,config:i}=aY(e,t);return new lv(r,i)}class lx extends s6{static [sz]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new lS(e,this.config)}}class lS extends s3{static [sz]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function lE(e,t){let{name:r,config:i}=aY(e,t);return new lx(r,i)}class lT extends s6{static [sz]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new lk(e,this.config)}}class lk extends s3{static [sz]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(e=>Number.parseFloat(e))}}function lO(e,t){let{name:r,config:i}=aY(e,t);return new lT(r,i)}class lC extends s6{static [sz]="PgSparseVectorBuilder";constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new lA(e,this.config)}}class lA extends s3{static [sz]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function lN(e,t){let{name:r,config:i}=aY(e,t);return new lC(r,i)}class lR extends s6{static [sz]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new lI(e,this.config)}}class lI extends s3{static [sz]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(e=>Number.parseFloat(e))}}function lP(e,t){let{name:r,config:i}=aY(e,t);return new lR(r,i)}let lj=Symbol.for("drizzle:PgInlineForeignKeys"),lD=Symbol.for("drizzle:EnableRLS");class lL extends am{static [sz]="PgTable";static Symbol=Object.assign({},am.Symbol,{InlineForeignKeys:lj,EnableRLS:lD});[lj]=[];[lD]=!1;[am.Symbol.ExtraConfigBuilder]=void 0}class l${static [sz]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new lF(e,this.columns,this.name)}}class lF{constructor(e,t,r){this.table=e,this.columns=t,this.name=r}static [sz]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[lL.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}}function lM(e,t){return"object"!=typeof t||null===t||!("mapToDriverValue"in t)||"function"!=typeof t.mapToDriverValue||a_(e)||sq(e,aE)||sq(e,ak)||sq(e,sG)||sq(e,am)||sq(e,aA)?e:new aE(e,t)}let lB=(e,t)=>aT`${e} = ${lM(t,e)}`,lU=(e,t)=>aT`${e} <> ${lM(t,e)}`;function lz(...e){let t=e.filter(e=>void 0!==e);return 0===t.length?void 0:new ab(1===t.length?t:[new av("("),aT.join(t,new av(" and ")),new av(")")])}function lq(...e){let t=e.filter(e=>void 0!==e);return 0===t.length?void 0:new ab(1===t.length?t:[new av("("),aT.join(t,new av(" or ")),new av(")")])}function lH(e){return aT`not ${e}`}let lW=(e,t)=>aT`${e} > ${lM(t,e)}`,lV=(e,t)=>aT`${e} >= ${lM(t,e)}`,lG=(e,t)=>aT`${e} < ${lM(t,e)}`,lK=(e,t)=>aT`${e} <= ${lM(t,e)}`;function lJ(e,t){return Array.isArray(t)?0===t.length?aT`false`:aT`${e} in ${t.map(t=>lM(t,e))}`:aT`${e} in ${lM(t,e)}`}function lQ(e,t){return Array.isArray(t)?0===t.length?aT`true`:aT`${e} not in ${t.map(t=>lM(t,e))}`:aT`${e} not in ${lM(t,e)}`}function lZ(e){return aT`${e} is null`}function lX(e){return aT`${e} is not null`}function lY(e){return aT`exists ${e}`}function l0(e){return aT`not exists ${e}`}function l1(e,t,r){return aT`${e} between ${lM(t,e)} and ${lM(r,e)}`}function l2(e,t,r){return aT`${e} not between ${lM(t,e)} and ${lM(r,e)}`}function l5(e,t){return aT`${e} like ${t}`}function l6(e,t){return aT`${e} not like ${t}`}function l3(e,t){return aT`${e} ilike ${t}`}function l4(e,t){return aT`${e} not ilike ${t}`}function l8(e){return aT`${e} asc`}function l7(e){return aT`${e} desc`}class l9{constructor(e,t,r){this.sourceTable=e,this.referencedTable=t,this.relationName=r,this.referencedTableName=t[am.Symbol.Name]}static [sz]="Relation";referencedTableName;fieldName}class ue{constructor(e,t){this.table=e,this.config=t}static [sz]="Relations"}class ut extends l9{constructor(e,t,r,i){super(e,t,r?.relationName),this.config=r,this.isNullable=i}static [sz]="One";withFieldName(e){let t=new ut(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}}class ur extends l9{constructor(e,t,r){super(e,t,r?.relationName),this.config=r}static [sz]="Many";withFieldName(e){let t=new ur(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}}function ui(e){return{one:function(t,r){return new ut(e,t,r,r?.fields.reduce((e,t)=>e&&t.notNull,!0)??!1)},many:function(t,r){return new ur(e,t,r)}}}class un extends aA{static [sz]="PgViewBase"}class us{static [sz]="PgDialect";casing;constructor(e){this.casing=new aB(e?.casing)}async migrate(e,t,r){let i="string"==typeof r?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",n="string"==typeof r?"drizzle":r.migrationsSchema??"drizzle",s=aT`
			CREATE TABLE IF NOT EXISTS ${aT.identifier(n)}.${aT.identifier(i)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(aT`CREATE SCHEMA IF NOT EXISTS ${aT.identifier(n)}`),await t.execute(s);let a=(await t.all(aT`select id, hash, created_at from ${aT.identifier(n)}.${aT.identifier(i)} order by created_at desc limit 1`))[0];await t.transaction(async t=>{for await(let r of e)if(!a||Number(a.created_at)<r.folderMillis){for(let e of r.sql)await t.execute(aT.raw(e));await t.execute(aT`insert into ${aT.identifier(n)}.${aT.identifier(i)} ("hash", "created_at") values(${r.hash}, ${r.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[aT`with `];for(let[r,i]of e.entries())t.push(aT`${aT.identifier(i._.alias)} as (${i._.sql})`),r<e.length-1&&t.push(aT`, `);return t.push(aT` `),aT.join(t)}buildDeleteQuery({table:e,where:t,returning:r,withList:i}){let n=this.buildWithCTE(i),s=r?aT` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,a=t?aT` where ${t}`:void 0;return aT`${n}delete from ${e}${a}${s}`}buildUpdateSet(e,t){let r=e[am.Symbol.Columns],i=Object.keys(r).filter(e=>void 0!==t[e]||r[e]?.onUpdateFn!==void 0),n=i.length;return aT.join(i.flatMap((e,i)=>{let s=r[e],a=t[e]??aT.param(s.onUpdateFn(),s),o=aT`${aT.identifier(this.casing.getColumnCasing(s))} = ${a}`;return i<n-1?[o,aT.raw(", ")]:[o]}))}buildUpdateQuery({table:e,set:t,where:r,returning:i,withList:n,from:s,joins:a}){let o=this.buildWithCTE(n),l=e[lL.Symbol.Name],u=e[lL.Symbol.Schema],c=e[lL.Symbol.OriginalName],h=l===c?void 0:l,d=aT`${u?aT`${aT.identifier(u)}.`:void 0}${aT.identifier(c)}${h&&aT` ${aT.identifier(h)}`}`,p=this.buildUpdateSet(e,t),f=s&&aT.join([aT.raw(" from "),this.buildFromTable(s)]),m=this.buildJoins(a),g=i?aT` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,y=r?aT` where ${r}`:void 0;return aT`${o}update ${d} set ${p}${f}${m}${y}${g}`}buildSelection(e,{isSingleTable:t=!1}={}){let r=e.length,i=e.flatMap(({field:e},i)=>{let n=[];if(sq(e,ab.Aliased)&&e.isSelectionField)n.push(aT.identifier(e.fieldAlias));else if(sq(e,ab.Aliased)||sq(e,ab)){let r=sq(e,ab.Aliased)?e.sql:e;t?n.push(new ab(r.queryChunks.map(e=>sq(e,s3)?aT.identifier(this.casing.getColumnCasing(e)):e))):n.push(r),sq(e,ab.Aliased)&&n.push(aT` as ${aT.identifier(e.fieldAlias)}`)}else sq(e,sG)&&(t?n.push(aT.identifier(this.casing.getColumnCasing(e))):n.push(e));return i<r-1&&n.push(aT`, `),n});return aT.join(i)}buildJoins(e){if(!e||0===e.length)return;let t=[];for(let[r,i]of e.entries()){0===r&&t.push(aT` `);let n=i.table,s=i.lateral?aT` lateral`:void 0;if(sq(n,lL)){let e=n[lL.Symbol.Name],r=n[lL.Symbol.Schema],a=n[lL.Symbol.OriginalName],o=e===a?void 0:i.alias;t.push(aT`${aT.raw(i.joinType)} join${s} ${r?aT`${aT.identifier(r)}.`:void 0}${aT.identifier(a)}${o&&aT` ${aT.identifier(o)}`} on ${i.on}`)}else if(sq(n,aA)){let e=n[aa].name,r=n[aa].schema,a=n[aa].originalName,o=e===a?void 0:i.alias;t.push(aT`${aT.raw(i.joinType)} join${s} ${r?aT`${aT.identifier(r)}.`:void 0}${aT.identifier(a)}${o&&aT` ${aT.identifier(o)}`} on ${i.on}`)}else t.push(aT`${aT.raw(i.joinType)} join${s} ${n} on ${i.on}`);r<e.length-1&&t.push(aT` `)}return aT.join(t)}buildFromTable(e){if(sq(e,am)&&e[am.Symbol.OriginalName]!==e[am.Symbol.Name]){let t=aT`${aT.identifier(e[am.Symbol.OriginalName])}`;return e[am.Symbol.Schema]&&(t=aT`${aT.identifier(e[am.Symbol.Schema])}.${t}`),aT`${t} ${aT.identifier(e[am.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:t,fieldsFlat:r,where:i,having:n,table:s,joins:a,orderBy:o,groupBy:l,limit:u,offset:c,lockingClause:h,distinct:d,setOperators:p}){let f,m,g;let y=r??aJ(t);for(let e of y){let t;if(sq(e.field,sG)&&e.field.table[sJ]!==(sq(s,ai)?s._.alias:sq(s,un)?s[aa].name:sq(s,ab)?void 0:s[sJ])&&(t=e.field.table,!a?.some(({alias:e})=>e===(t[am.Symbol.IsAlias]?t[sJ]:t[am.Symbol.BaseName])))){let t=e.field.table[sJ];throw Error(`Your "${e.path.join("->")}" field references a column "${t}"."${e.field.name}", but the table "${t}" is not part of the query! Did you forget to join it?`)}}let v=!a||0===a.length,b=this.buildWithCTE(e);d&&(f=!0===d?aT` distinct`:aT` distinct on (${aT.join(d.on,aT`, `)})`);let w=this.buildSelection(y,{isSingleTable:v}),x=this.buildFromTable(s),S=this.buildJoins(a),E=i?aT` where ${i}`:void 0,T=n?aT` having ${n}`:void 0;o&&o.length>0&&(m=aT` order by ${aT.join(o,aT`, `)}`),l&&l.length>0&&(g=aT` group by ${aT.join(l,aT`, `)}`);let k="object"==typeof u||"number"==typeof u&&u>=0?aT` limit ${u}`:void 0,O=c?aT` offset ${c}`:void 0,C=aT.empty();if(h){let e=aT` for ${aT.raw(h.strength)}`;h.config.of&&e.append(aT` of ${aT.join(Array.isArray(h.config.of)?h.config.of:[h.config.of],aT`, `)}`),h.config.noWait?e.append(aT` no wait`):h.config.skipLocked&&e.append(aT` skip locked`),C.append(e)}let A=aT`${b}select${f} ${w} from ${x}${S}${E}${g}${T}${m}${k}${O}${C}`;return p.length>0?this.buildSetOperations(A,p):A}buildSetOperations(e,t){let[r,...i]=t;if(!r)throw Error("Cannot pass undefined values to any set operator");return 0===i.length?this.buildSetOperationQuery({leftSelect:e,setOperator:r}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:r}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:r,rightSelect:i,limit:n,orderBy:s,offset:a}}){let o;let l=aT`(${e.getSQL()}) `,u=aT`(${i.getSQL()})`;if(s&&s.length>0){let e=[];for(let t of s)if(sq(t,s3))e.push(aT.identifier(t.name));else if(sq(t,ab)){for(let e=0;e<t.queryChunks.length;e++){let r=t.queryChunks[e];sq(r,s3)&&(t.queryChunks[e]=aT.identifier(r.name))}e.push(aT`${t}`)}else e.push(aT`${t}`);o=aT` order by ${aT.join(e,aT`, `)} `}let c="object"==typeof n||"number"==typeof n&&n>=0?aT` limit ${n}`:void 0,h=aT.raw(`${t} ${r?"all ":""}`),d=a?aT` offset ${a}`:void 0;return aT`${l}${h}${u}${o}${c}${d}`}buildInsertQuery({table:e,values:t,onConflict:r,returning:i,withList:n,select:s,overridingSystemValue_:a}){let o=[],l=Object.entries(e[am.Symbol.Columns]).filter(([e,t])=>!t.shouldDisableInsert()),u=l.map(([,e])=>aT.identifier(this.casing.getColumnCasing(e)));if(s)sq(t,ab)?o.push(t):o.push(t.getSQL());else for(let[e,r]of(o.push(aT.raw("values ")),t.entries())){let i=[];for(let[e,t]of l){let n=r[e];if(void 0===n||sq(n,aE)&&void 0===n.value){if(void 0!==t.defaultFn){let e=t.defaultFn(),r=sq(e,ab)?e:aT.param(e,t);i.push(r)}else if(t.default||void 0===t.onUpdateFn)i.push(aT`default`);else{let e=t.onUpdateFn(),r=sq(e,ab)?e:aT.param(e,t);i.push(r)}}else i.push(n)}o.push(i),e<t.length-1&&o.push(aT`, `)}let c=this.buildWithCTE(n),h=aT.join(o),d=i?aT` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,p=r?aT` on conflict ${r}`:void 0,f=!0===a?aT`overriding system value `:void 0;return aT`${c}insert into ${e} ${u} ${f}${h}${p}${d}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:r}){let i=t?aT` concurrently`:void 0,n=r?aT` with no data`:void 0;return aT`refresh materialized view${i} ${e}${n}`}prepareTyping(e){return sq(e,aH)||sq(e,aG)?"json":sq(e,a1)?"decimal":sq(e,a3)?"time":sq(e,a7)||sq(e,oe)?"timestamp":sq(e,oi)||sq(e,os)?"date":sq(e,ol)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:i,tableConfig:n,queryConfig:s,tableAlias:a,nestedQueryRelation:o,joinOn:l}){let u,c=[],h,d,p=[],f,m=[];if(!0===s)c=Object.entries(n.columns).map(([e,t])=>({dbKey:t.name,tsKey:e,field:aj(t,a),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let i=Object.fromEntries(Object.entries(n.columns).map(([e,t])=>[e,aj(t,a)]));if(s.where){let e="function"==typeof s.where?s.where(i,{and:lz,between:l1,eq:lB,exists:lY,gt:lW,gte:lV,ilike:l3,inArray:lJ,isNull:lZ,isNotNull:lX,like:l5,lt:lG,lte:lK,ne:lU,not:lH,notBetween:l2,notExists:l0,notLike:l6,notIlike:l4,notInArray:lQ,or:lq,sql:aT}):s.where;f=e&&aL(e,a)}let o=[],l=[];if(s.columns){let e=!1;for(let[t,r]of Object.entries(s.columns))void 0!==r&&t in n.columns&&(e||!0!==r||(e=!0),l.push(t));l.length>0&&(l=e?l.filter(e=>s.columns?.[e]===!0):Object.keys(n.columns).filter(e=>!l.includes(e)))}else l=Object.keys(n.columns);for(let e of l){let t=n.columns[e];o.push({tsKey:e,value:t})}let u=[];if(s.with&&(u=Object.entries(s.with).filter(e=>!!e[1]).map(([e,t])=>({tsKey:e,queryConfig:t,relation:n.relations[e]}))),s.extras)for(let[e,t]of Object.entries("function"==typeof s.extras?s.extras(i,{sql:aT}):s.extras))o.push({tsKey:e,value:aD(t,a)});for(let{tsKey:e,value:t}of o)c.push({dbKey:sq(t,ab.Aliased)?t.fieldAlias:n.columns[e].name,tsKey:e,field:sq(t,sG)?aj(t,a):t,relationTableTsKey:void 0,isJson:!1,selection:[]});let g="function"==typeof s.orderBy?s.orderBy(i,{sql:aT,asc:l8,desc:l7}):s.orderBy??[];for(let{tsKey:i,queryConfig:n,relation:o}of(Array.isArray(g)||(g=[g]),p=g.map(e=>sq(e,sG)?aj(e,a):aL(e,a)),h=s.limit,d=s.offset,u)){let s=function(e,t,r){if(sq(r,ut)&&r.config)return{fields:r.config.fields,references:r.config.references};let i=t[ag(r.referencedTable)];if(!i)throw Error(`Table "${r.referencedTable[am.Symbol.Name]}" not found in schema`);let n=e[i];if(!n)throw Error(`Table "${i}" not found in schema`);let s=r.sourceTable,a=t[ag(s)];if(!a)throw Error(`Table "${s[am.Symbol.Name]}" not found in schema`);let o=[];for(let e of Object.values(n.relations))(r.relationName&&r!==e&&e.relationName===r.relationName||!r.relationName&&e.referencedTable===r.sourceTable)&&o.push(e);if(o.length>1)throw r.relationName?Error(`There are multiple relations with name "${r.relationName}" in table "${i}"`):Error(`There are multiple relations between "${i}" and "${r.sourceTable[am.Symbol.Name]}". Please specify relation name`);if(o[0]&&sq(o[0],ut)&&o[0].config)return{fields:o[0].config.references,references:o[0].config.fields};throw Error(`There is not enough information to infer relation "${a}.${r.fieldName}"`)}(t,r,o),l=r[ag(o.referencedTable)],u=`${a}_${i}`,h=lz(...s.fields.map((e,t)=>lB(aj(s.references[t],u),aj(e,a)))),d=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:e[l],tableConfig:t[l],queryConfig:sq(o,ut)?!0===n?{limit:1}:{...n,limit:1}:n,tableAlias:u,joinOn:h,nestedQueryRelation:o}),p=aT`${aT.identifier(u)}.${aT.identifier("data")}`.as(i);m.push({on:aT`true`,table:new ai(d.sql,{},u),alias:u,joinType:"left",lateral:!0}),c.push({dbKey:i,tsKey:i,field:p,relationTableTsKey:l,isJson:!0,selection:d.selection})}}if(0===c.length)throw new aU({message:`No fields selected for table "${n.tsName}" ("${a}")`});if(f=lz(l,f),o){let e=aT`json_build_array(${aT.join(c.map(({field:e,tsKey:t,isJson:r})=>r?aT`${aT.identifier(`${a}_${t}`)}.${aT.identifier("data")}`:sq(e,ab.Aliased)?e.sql:e),aT`, `)})`;sq(o,ur)&&(e=aT`coalesce(json_agg(${e}${p.length>0?aT` order by ${aT.join(p,aT`, `)}`:void 0}), '[]'::json)`);let t=[{dbKey:"data",tsKey:"data",field:e.as("data"),isJson:!0,relationTableTsKey:n.tsName,selection:c}];void 0!==h||void 0!==d||p.length>0?(u=this.buildSelectQuery({table:aP(i,a),fields:{},fieldsFlat:[{path:[],field:aT.raw("*")}],where:f,limit:h,offset:d,orderBy:p,setOperators:[]}),f=void 0,h=void 0,d=void 0,p=[]):u=aP(i,a),u=this.buildSelectQuery({table:sq(u,lL)?u:new ai(u,{},a),fields:{},fieldsFlat:t.map(({field:e})=>({path:[],field:sq(e,sG)?aj(e,a):e})),joins:m,where:f,limit:h,offset:d,orderBy:p,setOperators:[]})}else u=this.buildSelectQuery({table:aP(i,a),fields:{},fieldsFlat:c.map(({field:e})=>({path:[],field:sq(e,sG)?aj(e,a):e})),joins:m,where:f,limit:h,offset:d,orderBy:p,setOperators:[]});return{tableTsKey:n.tsName,sql:u,selection:c}}}class ua{static [sz]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if("_"===t)return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===aa)return{...e[aa],selectedFields:new Proxy(e[aa].selectedFields,this)};if("symbol"==typeof t)return e[t];let r=(sq(e,ai)?e._.selectedFields:sq(e,aA)?e[aa].selectedFields:e)[t];if(sq(r,ab.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!r.isSelectionField)return r.sql;let e=r.clone();return e.isSelectionField=!0,e}if(sq(r,ab)){if("sql"===this.config.sqlBehavior)return r;throw Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return sq(r,sG)?this.config.alias?new Proxy(r,new aN(new Proxy(r.table,new aR(this.config.alias,this.config.replaceOriginalName??!1)))):r:"object"!=typeof r||null===r?r:new Proxy(r,new ua(this.config))}}class uo{static [sz]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class ul{static [sz]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}}class uu{static [sz]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let t;let r=!!this.fields;return t=this.fields?this.fields:sq(e,ai)?Object.fromEntries(Object.keys(e._.selectedFields).map(t=>[t,e[t]])):sq(e,un)?e[aa].selectedFields:sq(e,ab)?{}:e[am.Symbol.Columns],new uh({table:e,fields:t,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}class uc extends uo{static [sz]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:r,session:i,dialect:n,withList:s,distinct:a}){super(),this.config={withList:s,table:e,fields:{...t},distinct:a,setOperators:[]},this.isPartialSelect=r,this.session=i,this.dialect=n,this._={selectedFields:t},this.tableName=aX(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}createJoin(e){return(t,r)=>{let i=this.tableName,n=aX(t);if("string"==typeof n&&this.config.joins?.some(e=>e.alias===n))throw Error(`Alias "${n}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof i&&(this.config.fields={[i]:this.config.fields}),"string"==typeof n&&!sq(t,ab))){let e=sq(t,ai)?t._.selectedFields:sq(t,aA)?t[aa].selectedFields:t[am.Symbol.Columns];this.config.fields[n]=e}if("function"==typeof r&&(r=r(new Proxy(this.config.fields,new ua({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:r,table:t,joinType:e,alias:n}),"string"==typeof n)switch(e){case"left":this.joinsNotNullableMap[n]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[n]=!0;break;case"inner":this.joinsNotNullableMap[n]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[n]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return r=>{let i="function"==typeof r?r(up()):r;if(!aQ(this.getSelectedFields(),i.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:i}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new ua({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new ua({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new ua({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new ua({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=e:this.config.orderBy=e;return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new ai(this.getSQL(),this.config.fields,e),new ua({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new ua({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class uh extends uc{static [sz]="PgSelect";_prepare(e){let{session:t,config:r,dialect:i,joinsNotNullableMap:n,authToken:s}=this;if(!t)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");return as.startActiveSpan("drizzle.prepareQuery",()=>{let a=aJ(r.fields),o=t.prepareQuery(i.sqlToQuery(this.getSQL()),a,e,!0);return o.joinsNotNullableMap=n,o.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>as.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))}function ud(e,t){return(r,i,...n)=>{let s=[i,...n].map(r=>({type:e,isAll:t,rightSelect:r}));for(let e of s)if(!aQ(r.getSelectedFields(),e.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(s)}}!function(e,t){for(let r of t)for(let t of Object.getOwnPropertyNames(r.prototype))"constructor"!==t&&Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(r.prototype,t)||Object.create(null))}(uh,[ul]);let up=()=>({union:uf,unionAll:um,intersect:ug,intersectAll:uy,except:u_,exceptAll:uv}),uf=ud("union",!1),um=ud("union",!0),ug=ud("intersect",!1),uy=ud("intersect",!0),u_=ud("except",!1),uv=ud("except",!0);class ub{static [sz]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=sq(e,us)?e:void 0,this.dialectConfig=sq(e,us)?void 0:e}$with(e){let t=this;return{as:r=>("function"==typeof r&&(r=r(t)),new Proxy(new an(r.getSQL(),r.getSelectedFields(),e,!0),new ua({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}with(...e){let t=this;return{select:function(r){return new uu({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e})},selectDistinct:function(e){return new uu({fields:e??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})},selectDistinctOn:function(e,r){return new uu({fields:r??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:e}})}}}select(e){return new uu({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new uu({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new uu({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new us(this.dialectConfig)),this.dialect}}class uw{constructor(e,t,r,i){this.table=e,this.session=t,this.dialect=r,this.withList=i}static [sz]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new ux(this.table,aZ(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}}class ux extends ul{constructor(e,t,r,i,n){super(),this.session=r,this.dialect=i,this.config={set:t,table:e,withList:n,joins:[]},this.tableName=aX(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}static [sz]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let t=aX(e);return"string"==typeof t&&(this.joinsNotNullableMap[t]=!0),this.config.from=e,this}getTableLikeFields(e){return sq(e,lL)?e[am.Symbol.Columns]:sq(e,ai)?e._.selectedFields:e[aa].selectedFields}createJoin(e){return(t,r)=>{let i=aX(t);if("string"==typeof i&&this.config.joins.some(e=>e.alias===i))throw Error(`Alias "${i}" is already used in this query`);if("function"==typeof r){let e=this.config.from&&!sq(this.config.from,ab)?this.getTableLikeFields(this.config.from):void 0;r=r(new Proxy(this.config.table[am.Symbol.Columns],new ua({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),e&&new Proxy(e,new ua({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:r,table:t,joinType:e,alias:i}),"string"==typeof i)switch(e){case"left":this.joinsNotNullableMap[i]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[i]=!0;break;case"inner":this.joinsNotNullableMap[i]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[i]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[am.Symbol.Columns]),this.config.from)){let t=aX(this.config.from);if("string"==typeof t&&this.config.from&&!sq(this.config.from,ab)){let r=this.getTableLikeFields(this.config.from);e[t]=r}for(let t of this.config.joins){let r=aX(t.table);if("string"==typeof r&&!sq(t.table,ab)){let i=this.getTableLikeFields(t.table);e[r]=i}}}return this.config.returning=aJ(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){let t=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return t.joinsNotNullableMap=this.joinsNotNullableMap,t}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);$dynamic(){return this}}class uS{constructor(e,t,r,i,n){this.table=e,this.session=t,this.dialect=r,this.withList=i,this.overridingSystemValue_=n}static [sz]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(0===(e=Array.isArray(e)?e:[e]).length)throw Error("values() must be called with at least one value");let t=e.map(e=>{let t={},r=this.table[am.Symbol.Columns];for(let i of Object.keys(e)){let n=e[i];t[i]=sq(n,ab)?n:new aE(n,r[i])}return t});return new uE(this.table,t,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let t="function"==typeof e?e(new ub):e;if(!sq(t,ab)&&!aQ(this.table[al],t._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new uE(this.table,t,this.session,this.dialect,this.withList,!0)}}class uE extends ul{constructor(e,t,r,i,n,s,a){super(),this.session=r,this.dialect=i,this.config={table:e,values:t,withList:n,select:s,overridingSystemValue_:a}}static [sz]="PgInsert";config;returning(e=this.config.table[am.Symbol.Columns]){return this.config.returning=aJ(e),this}onConflictDoNothing(e={}){if(void 0===e.target)this.config.onConflict=aT`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let r=e.where?aT` where ${e.where}`:void 0;this.config.onConflict=aT`(${aT.raw(t)})${r} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let t=e.where?aT` where ${e.where}`:void 0,r=e.targetWhere?aT` where ${e.targetWhere}`:void 0,i=e.setWhere?aT` where ${e.setWhere}`:void 0,n=this.dialect.buildUpdateSet(this.config.table,aZ(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=aT`(${aT.raw(s)})${r} do update set ${n}${t}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return as.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>as.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));$dynamic(){return this}}class uT extends ul{constructor(e,t,r,i){super(),this.session=t,this.dialect=r,this.config={table:e,withList:i}}static [sz]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[am.Symbol.Columns]){return this.config.returning=aJ(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return as.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>as.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));$dynamic(){return this}}class uk extends ab{constructor(e){super(uk.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=uk.buildCount(e.source,e.filters)}sql;token;static [sz]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,t){return aT`(select count(*) from ${e}${aT.raw(" where ").if(t)}${t})`}static buildCount(e,t){return aT`select count(*) as count from ${e}${aT.raw(" where ").if(t)}${t};`}setToken(e){return this.token=e,this}then(e,t){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}}class uO{constructor(e,t,r,i,n,s,a){this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=i,this.tableConfig=n,this.dialect=s,this.session=a}static [sz]="PgRelationalQueryBuilder";findMany(e){return new uC(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new uC(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}class uC extends ul{constructor(e,t,r,i,n,s,a,o,l){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=i,this.tableConfig=n,this.dialect=s,this.session=a,this.config=o,this.mode=l}static [sz]="PgRelationalQuery";_prepare(e){return as.startActiveSpan("drizzle.prepareQuery",()=>{let{query:t,builtQuery:r}=this._toSQL();return this.session.prepareQuery(r,void 0,e,!0,(e,r)=>{let i=e.map(e=>(function e(t,r,i,n,s=e=>e){let a={};for(let[o,l]of n.entries())if(l.isJson){let n=r.relations[l.tsKey],u=i[o],c="string"==typeof u?JSON.parse(u):u;a[l.tsKey]=sq(n,ut)?c&&e(t,t[l.relationTableTsKey],c,l.selection,s):c.map(r=>e(t,t[l.relationTableTsKey],r,l.selection,s))}else{let e;let t=s(i[o]),r=l.field;e=sq(r,sG)?r:sq(r,ab)?r.decoder:r.sql.decoder,a[l.tsKey]=null===t?null:e.mapFromDriverValue(t)}return a})(this.schema,this.tableConfig,e,t.selection,r));return"first"===this.mode?i[0]:i})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return as.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}}class uA extends ul{constructor(e,t,r,i){super(),this.execute=e,this.sql=t,this.query=r,this.mapBatchResult=i}static [sz]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}}class uN extends ul{constructor(e,t,r){super(),this.session=t,this.dialect=r,this.config={view:e}}static [sz]="PgRefreshMaterializedView";config;concurrently(){if(void 0!==this.config.withNoData)throw Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(void 0!==this.config.concurrently)throw Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return as.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>as.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))}class uR{constructor(e,t,r){if(this.dialect=e,this.session=t,this._=r?{schema:r.schema,fullSchema:r.fullSchema,tableNamesMap:r.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(let[i,n]of Object.entries(this._.schema))this.query[i]=new uO(r.fullSchema,this._.schema,this._.tableNamesMap,r.fullSchema[i],n,e,t)}static [sz]="PgDatabase";query;$with(e){let t=this;return{as:r=>("function"==typeof r&&(r=r(new ub(t.dialect))),new Proxy(new an(r.getSQL(),r.getSelectedFields(),e,!0),new ua({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}$count(e,t){return new uk({source:e,filters:t,session:this.session})}with(...e){let t=this;return{select:function(r){return new uu({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e})},selectDistinct:function(r){return new uu({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})},selectDistinctOn:function(r,i){return new uu({fields:i??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:r}})},update:function(r){return new uw(r,t.session,t.dialect,e)},insert:function(r){return new uS(r,t.session,t.dialect,e)},delete:function(r){return new uT(r,t.session,t.dialect,e)}}}select(e){return new uu({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new uu({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new uu({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new uw(e,this.session,this.dialect)}insert(e){return new uS(e,this.session,this.dialect)}delete(e){return new uT(e,this.session,this.dialect)}refreshMaterializedView(e){return new uN(e,this.session,this.dialect)}authToken;execute(e){let t="string"==typeof e?aT.raw(e):e.getSQL(),r=this.dialect.sqlToQuery(t),i=this.session.prepareQuery(r,void 0,void 0,!1);return new uA(()=>i.execute(void 0,this.authToken),t,r,e=>i.mapResult(e,!0))}transaction(e,t){return this.session.transaction(e,t)}}class uI{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,t){return e}setToken(e){return this.authToken=e,this}static [sz]="PgPreparedQuery";joinsNotNullableMap}class uP{constructor(e){this.dialect=e}static [sz]="PgSession";execute(e,t){return as.startActiveSpan("drizzle.operation",()=>as.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(t).execute(void 0,t))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,t){return Number((await this.execute(e,t))[0].count)}}class uj extends uR{constructor(e,t,r,i=0){super(e,t,r),this.schema=r,this.nestedIndex=i}static [sz]="PgTransaction";rollback(){throw new az}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),"boolean"==typeof e.deferrable&&t.push(e.deferrable?"deferrable":"not deferrable"),aT.raw(t.join(" "))}setTransaction(e){return this.session.execute(aT`set transaction ${this.getTransactionConfigSQL(e)}`)}}class uD extends uI{constructor(e,t,r,i,n,s,a){super({sql:t,params:r}),this.client=e,this.queryString=t,this.params=r,this.logger=i,this.fields=n,this._isResponseInArrayMode=s,this.customResultMapper=a}static [sz]="PostgresJsPreparedQuery";async execute(e={}){return as.startActiveSpan("drizzle.execute",async t=>{let r=aO(this.params,e);t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.logger.logQuery(this.queryString,r);let{fields:i,queryString:n,client:s,joinsNotNullableMap:a,customResultMapper:o}=this;if(!i&&!o)return as.startActiveSpan("drizzle.driver.execute",()=>s.unsafe(n,r));let l=await as.startActiveSpan("drizzle.driver.execute",()=>(t?.setAttributes({"drizzle.query.text":n,"drizzle.query.params":JSON.stringify(r)}),s.unsafe(n,r).values()));return as.startActiveSpan("drizzle.mapResponse",()=>o?o(l):l.map(e=>(function(e,t,r){let i={},n=e.reduce((e,{path:n,field:s},a)=>{let o;o=sq(s,sG)?s:sq(s,ab)?s.decoder:s.sql.decoder;let l=e;for(let[e,u]of n.entries())if(e<n.length-1)u in l||(l[u]={}),l=l[u];else{let e=t[a],c=l[u]=null===e?null:o.mapFromDriverValue(e);if(r&&sq(s,sG)&&2===n.length){let e=n[0];e in i?"string"==typeof i[e]&&i[e]!==s.table[sJ]&&(i[e]=!1):i[e]=null===c&&s.table[sJ]}}return e},{});if(r&&Object.keys(i).length>0)for(let[e,t]of Object.entries(i))"string"!=typeof t||r[t]||(n[e]=null);return n})(i,e,a)))})}all(e={}){return as.startActiveSpan("drizzle.execute",async t=>{let r=aO(this.params,e);return t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.logger.logQuery(this.queryString,r),as.startActiveSpan("drizzle.driver.execute",()=>(t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.client.unsafe(this.queryString,r)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}}class uL extends uP{constructor(e,t,r,i={}){super(t),this.client=e,this.schema=r,this.options=i,this.logger=i.logger??new sV}static [sz]="PostgresJsSession";logger;prepareQuery(e,t,r,i,n){return new uD(this.client,e.sql,e.params,this.logger,t,i,n)}query(e,t){return this.logger.logQuery(e,t),this.client.unsafe(e,t).values()}queryObjects(e,t){return this.client.unsafe(e,t)}transaction(e,t){return this.client.begin(async r=>{let i=new uL(r,this.dialect,this.schema,this.options),n=new u$(this.dialect,i,this.schema);return t&&await n.setTransaction(t),e(n)})}}class u$ extends uj{constructor(e,t,r,i=0){super(e,t,r,i),this.session=t}static [sz]="PostgresJsTransaction";transaction(e){return this.session.client.savepoint(t=>{let r=new uL(t,this.dialect,this.schema,this.session.options);return e(new u$(this.dialect,r,this.schema))})}}class uF extends uR{static [sz]="PostgresJsDatabase"}function uM(e,t={}){let r,i;let n=e=>e;for(let t of["1184","1082","1083","1114"])e.options.parsers[t]=n,e.options.serializers[t]=n;e.options.serializers["114"]=n,e.options.serializers["3802"]=n;let s=new us({casing:t.casing});if(!0===t.logger?r=new sW:!1!==t.logger&&(r=t.logger),t.schema){let e=function(e,t){1===Object.keys(e).length&&"default"in e&&!sq(e.default,am)&&(e=e.default);let r={},i={},n={};for(let[s,a]of Object.entries(e))if(sq(a,am)){let e=ag(a),t=i[e];for(let i of(r[e]=s,n[s]={tsName:s,dbName:a[am.Symbol.Name],schema:a[am.Symbol.Schema],columns:a[am.Symbol.Columns],relations:t?.relations??{},primaryKey:t?.primaryKey??[]},Object.values(a[am.Symbol.Columns])))i.primary&&n[s].primaryKey.push(i);let o=a[am.Symbol.ExtraConfigBuilder]?.(a[am.Symbol.ExtraConfigColumns]);if(o)for(let e of Object.values(o))sq(e,l$)&&n[s].primaryKey.push(...e.columns)}else if(sq(a,ue)){let e;let s=ag(a.table),o=r[s];for(let[r,l]of Object.entries(a.config(t(a.table))))if(o){let t=n[o];t.relations[r]=l,e&&t.primaryKey.push(...e)}else s in i||(i[s]={relations:{},primaryKey:e}),i[s].relations[r]=l}return{tables:n,tableNamesMap:r}}(t.schema,ui);i={fullSchema:t.schema,schema:e.tables,tableNamesMap:e.tableNamesMap}}let a=new uL(e,s,i,{logger:r}),o=new uF(s,a,i);return o.$client=e,o}function uB(...e){if("string"==typeof e[0])return uM(sF(e[0]),e[1]);if(function(e){if("object"!=typeof e||null===e||"Object"!==e.constructor.name)return!1;if("logger"in e){let t=typeof e.logger;return"boolean"===t||"object"===t&&"function"==typeof e.logger.logQuery||"undefined"===t}if("schema"in e){let t=typeof e.logger;return"object"===t||"undefined"===t}if("casing"in e){let t=typeof e.logger;return"string"===t||"undefined"===t}if("mode"in e)return"default"===e.mode&&"planetscale"===e.mode&&void 0===e.mode;if("connection"in e){let t=typeof e.connection;return"string"===t||"object"===t||"undefined"===t}if("client"in e){let t=typeof e.client;return"object"===t||"function"===t||"undefined"===t}return 0===Object.keys(e).length}(e[0])){let{connection:t,client:r,...i}=e[0];if(r)return uM(r,i);if("object"==typeof t&&void 0!==t.url){let{url:e,...r}=t;return uM(sF(e,r),i)}return uM(sF(t),i)}return uM(e[0],e[1])}(uB||(uB={})).mock=function(e){return uM({options:{parsers:{},serializers:{}}},e)},Object.defineProperty(e,"__esModule",{value:!0}),e.userInvites=e.reportSchedules=e.pushSubscriptions=e.researchDrafts=e.users=e.tags=e.scheduledEnrichments=e.savedFilters=e.salesforceSyncLog=e.recommendations=e.projects=e.projectTemplates=e.projectAuditLog=e.produtos=e.pesquisas=e.operationalAlerts=e.notificationPreferences=e.notifications=e.savedFiltersExport=e.exportHistory=e.mercadosUnicos=e.mercadosHistory=e.llmProviderConfigs=e.leadsHistory=e.leads=e.leadConversions=e.intelligentAlertsHistory=e.intelligentAlertsConfigs=e.hibernationWarnings=e.entityTags=e.enrichmentRuns=e.enrichmentQueue=e.enrichmentJobs=e.systemSettings=e.enrichmentConfigs=e.enrichmentCache=e.concorrentesHistory=e.concorrentes=e.clientesMercados=e.clientesHistory=e.clientes=e.analyticsTimeline=e.analyticsPesquisas=e.analyticsMercados=e.analyticsDimensoes=e.alertHistory=e.alertConfigs=e.activityLog=e.frequencyEnum=e.progressStatusEnum=void 0,e.emailConfig=e.loginAttempts=e.passwordResets=void 0;var uU=require("drizzle-orm/pg-core");if(e.progressStatusEnum=(0,uU.pgEnum)("progressStatus",["started","in_progress","almost_done"]),e.frequencyEnum=(0,uU.pgEnum)("frequency",["weekly","monthly"]),e.activityLog=(0,uU.pgTable)("activity_log",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),activityType:(0,uU.varchar)("activityType",{length:50}).notNull(),description:(0,uU.text)(),metadata:(0,uU.jsonb)(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()},function(e){return[(0,uU.index)("idx_project").on(e.projectId),(0,uU.index)("idx_type").on(e.activityType),(0,uU.index)("idx_created").on(e.createdAt)]}),e.alertConfigs=(0,uU.pgTable)("alert_configs",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),name:(0,uU.varchar)({length:255}).notNull(),alertType:(0,uU.varchar)("alertType",{length:50}).notNull(),condition:(0,uU.text)().notNull(),enabled:(0,uU.smallint)().default(1).notNull(),lastTriggeredAt:(0,uU.timestamp)("lastTriggeredAt",{mode:"string"}),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow()}),e.alertHistory=(0,uU.pgTable)("alert_history",{id:(0,uU.serial)(),alertConfigId:(0,uU.integer)("alertConfigId").notNull(),projectId:(0,uU.integer)("projectId").notNull(),alertType:(0,uU.varchar)("alertType",{length:50}).notNull(),condition:(0,uU.text)().notNull(),message:(0,uU.text)().notNull(),triggeredAt:(0,uU.timestamp)("triggeredAt",{mode:"string"}).defaultNow().notNull()}),e.analyticsDimensoes=(0,uU.pgTable)("analytics_dimensoes",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),pesquisaId:(0,uU.integer)("pesquisaId"),dimensaoTipo:(0,uU.varchar)("dimensaoTipo",{length:50}).notNull(),dimensaoValor:(0,uU.varchar)("dimensaoValor",{length:100}).notNull(),totalLeads:(0,uU.integer)("totalLeads").default(0),qualidadeMedia:(0,uU.integer)("qualidadeMedia").default(0),taxaConversaoSf:(0,uU.integer)("taxaConversaoSf").default(0),custoMedioLead:(0,uU.integer)("custoMedioLead").default(0),roi:(0,uU.integer)().default(0),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()}),e.analyticsMercados=(0,uU.pgTable)("analytics_mercados",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),pesquisaId:(0,uU.integer)("pesquisaId"),mercadoId:(0,uU.integer)("mercadoId").notNull(),periodo:(0,uU.timestamp)({mode:"string"}).notNull(),totalClientes:(0,uU.integer)("totalClientes").default(0),totalConcorrentes:(0,uU.integer)("totalConcorrentes").default(0),totalLeadsGerados:(0,uU.integer)("totalLeadsGerados").default(0),taxaCoberturaMercado:(0,uU.integer)("taxaCoberturaMercado").default(0),qualidadeMediaLeads:(0,uU.integer)("qualidadeMediaLeads").default(0),leadsAltaQualidade:(0,uU.integer)("leadsAltaQualidade").default(0),leadsMediaQualidade:(0,uU.integer)("leadsMediaQualidade").default(0),leadsBaixaQualidade:(0,uU.integer)("leadsBaixaQualidade").default(0),leadsEnriquecidos:(0,uU.integer)("leadsEnriquecidos").default(0),taxaSucessoEnriquecimento:(0,uU.integer)("taxaSucessoEnriquecimento").default(0),tempoMedioEnriquecimentoMin:(0,uU.integer)("tempoMedioEnriquecimentoMin").default(0),custoEnriquecimentoTotal:(0,uU.integer)("custoEnriquecimentoTotal").default(0),leadsValidados:(0,uU.integer)("leadsValidados").default(0),leadsAprovados:(0,uU.integer)("leadsAprovados").default(0),leadsDescartados:(0,uU.integer)("leadsDescartados").default(0),taxaAprovacao:(0,uU.integer)("taxaAprovacao").default(0),leadsExportadosSf:(0,uU.integer)("leadsExportadosSf").default(0),leadsConvertidosSf:(0,uU.integer)("leadsConvertidosSf").default(0),taxaConversaoSf:(0,uU.integer)("taxaConversaoSf").default(0),horasPesquisa:(0,uU.integer)("horasPesquisa").default(0),custoTotal:(0,uU.integer)("custoTotal").default(0),roi:(0,uU.integer)().default(0),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()}),e.analyticsPesquisas=(0,uU.pgTable)("analytics_pesquisas",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),pesquisaId:(0,uU.integer)("pesquisaId").notNull(),totalMercadosMapeados:(0,uU.integer)("totalMercadosMapeados").default(0),totalClientesBase:(0,uU.integer)("totalClientesBase").default(0),totalLeadsGerados:(0,uU.integer)("totalLeadsGerados").default(0),taxaConversaoClienteLead:(0,uU.integer)("taxaConversaoClienteLead").default(0),qualidadeMediaGeral:(0,uU.integer)("qualidadeMediaGeral").default(0),distribuicaoQualidade:(0,uU.text)("distribuicaoQualidade"),taxaSucessoEnriquecimento:(0,uU.integer)("taxaSucessoEnriquecimento").default(0),tempoTotalEnriquecimentoHoras:(0,uU.integer)("tempoTotalEnriquecimentoHoras").default(0),custoTotalEnriquecimento:(0,uU.integer)("custoTotalEnriquecimento").default(0),leadsExportadosSf:(0,uU.integer)("leadsExportadosSf").default(0),leadsConvertidosSf:(0,uU.integer)("leadsConvertidosSf").default(0),taxaConversaoSf:(0,uU.integer)("taxaConversaoSf").default(0),valorPipelineGerado:(0,uU.integer)("valorPipelineGerado").default(0),custoTotalPesquisa:(0,uU.integer)("custoTotalPesquisa").default(0),valorGerado:(0,uU.integer)("valorGerado").default(0),roi:(0,uU.integer)().default(0),dataInicio:(0,uU.timestamp)("dataInicio",{mode:"string"}),dataConclusao:(0,uU.timestamp)("dataConclusao",{mode:"string"}),duracaoDias:(0,uU.integer)("duracaoDias").default(0),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()}),e.analyticsTimeline=(0,uU.pgTable)("analytics_timeline",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),data:(0,uU.timestamp)({mode:"string"}).notNull(),leadsGeradosDia:(0,uU.integer)("leadsGeradosDia").default(0),leadsEnriquecidosDia:(0,uU.integer)("leadsEnriquecidosDia").default(0),leadsValidadosDia:(0,uU.integer)("leadsValidadosDia").default(0),leadsExportadosSfDia:(0,uU.integer)("leadsExportadosSfDia").default(0),qualidadeMediaDia:(0,uU.integer)("qualidadeMediaDia").default(0),custoDia:(0,uU.integer)("custoDia").default(0),leadsAcumulados:(0,uU.integer)("leadsAcumulados").default(0),custoAcumulado:(0,uU.integer)("custoAcumulado").default(0),valorGeradoAcumulado:(0,uU.integer)("valorGeradoAcumulado").default(0),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()}),e.clientes=(0,uU.pgTable)("clientes",{id:(0,uU.serial)(),clienteHash:(0,uU.varchar)("clienteHash",{length:255}),nome:(0,uU.varchar)({length:255}).notNull(),cnpj:(0,uU.varchar)({length:20}),siteOficial:(0,uU.varchar)("siteOficial",{length:500}),produtoPrincipal:(0,uU.text)("produtoPrincipal"),segmentacaoB2BB2C:(0,uU.varchar)("segmentacaoB2BB2C",{length:20}),email:(0,uU.varchar)({length:320}),telefone:(0,uU.varchar)({length:50}),linkedin:(0,uU.varchar)({length:500}),instagram:(0,uU.varchar)({length:500}),cidade:(0,uU.varchar)({length:100}),uf:(0,uU.varchar)({length:2}),cnae:(0,uU.varchar)({length:20}),porte:(0,uU.varchar)({length:50}),qualidadeScore:(0,uU.integer)("qualidadeScore"),qualidadeClassificacao:(0,uU.varchar)("qualidadeClassificacao",{length:50}),validationStatus:(0,uU.varchar)("validationStatus",{length:50}).default("pending"),validationNotes:(0,uU.text)("validationNotes"),validatedBy:(0,uU.varchar)("validatedBy",{length:64}),validatedAt:(0,uU.timestamp)("validatedAt",{mode:"string"}),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),projectId:(0,uU.integer)("projectId").default(1).notNull(),regiao:(0,uU.varchar)({length:100}),faturamentoDeclarado:(0,uU.text)("faturamentoDeclarado"),numeroEstabelecimentos:(0,uU.text)("numeroEstabelecimentos"),pesquisaId:(0,uU.integer)("pesquisaId"),latitude:(0,uU.numeric)({precision:10,scale:8}),longitude:(0,uU.numeric)({precision:11,scale:8}),geocodedAt:(0,uU.timestamp)("geocodedAt",{mode:"string"})},function(e){return[(0,uU.index)("idx_clientes_projectId").on(e.projectId),(0,uU.index)("unique_cliente_hash").on(e.clienteHash)]}),e.clientesHistory=(0,uU.pgTable)("clientes_history",{id:(0,uU.serial)(),clienteId:(0,uU.integer)("clienteId").notNull(),field:(0,uU.varchar)({length:100}),oldValue:(0,uU.text)("oldValue"),newValue:(0,uU.text)("newValue"),changeType:(0,uU.varchar)("changeType",{length:50}).default("updated"),changedBy:(0,uU.varchar)("changedBy",{length:64}),changedAt:(0,uU.timestamp)("changedAt",{mode:"string"}).defaultNow()}),e.clientesMercados=(0,uU.pgTable)("clientes_mercados",{id:(0,uU.serial)(),clienteId:(0,uU.integer)("clienteId").notNull(),mercadoId:(0,uU.integer)("mercadoId").notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()},function(e){return[(0,uU.index)("idx_cliente_mercado").on(e.clienteId,e.mercadoId)]}),e.concorrentes=(0,uU.pgTable)("concorrentes",{id:(0,uU.serial)(),concorrenteHash:(0,uU.varchar)("concorrenteHash",{length:255}),mercadoId:(0,uU.integer)("mercadoId").notNull(),nome:(0,uU.varchar)({length:255}).notNull(),cnpj:(0,uU.varchar)({length:20}),site:(0,uU.varchar)({length:500}),produto:(0,uU.text)(),porte:(0,uU.varchar)({length:50}),faturamentoEstimado:(0,uU.text)("faturamentoEstimado"),qualidadeScore:(0,uU.integer)("qualidadeScore"),qualidadeClassificacao:(0,uU.varchar)("qualidadeClassificacao",{length:50}),validationStatus:(0,uU.varchar)("validationStatus",{length:50}).default("pending"),validationNotes:(0,uU.text)("validationNotes"),validatedBy:(0,uU.varchar)("validatedBy",{length:64}),validatedAt:(0,uU.timestamp)("validatedAt",{mode:"string"}),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),projectId:(0,uU.integer)("projectId").default(1).notNull(),cidade:(0,uU.varchar)({length:100}),uf:(0,uU.varchar)({length:2}),faturamentoDeclarado:(0,uU.text)("faturamentoDeclarado"),numeroEstabelecimentos:(0,uU.text)("numeroEstabelecimentos"),pesquisaId:(0,uU.integer)("pesquisaId"),latitude:(0,uU.numeric)({precision:10,scale:8}),longitude:(0,uU.numeric)({precision:11,scale:8}),geocodedAt:(0,uU.timestamp)("geocodedAt",{mode:"string"})},function(e){return[(0,uU.index)("idx_concorrentes_projectId").on(e.projectId),(0,uU.index)("unique_concorrente_hash").on(e.concorrenteHash),(0,uU.index)("idx_concorrente_hash").on(e.concorrenteHash)]}),e.concorrentesHistory=(0,uU.pgTable)("concorrentes_history",{id:(0,uU.serial)(),concorrenteId:(0,uU.integer)("concorrenteId").notNull(),field:(0,uU.varchar)({length:100}),oldValue:(0,uU.text)("oldValue"),newValue:(0,uU.text)("newValue"),changeType:(0,uU.varchar)("changeType",{length:50}).default("updated"),changedBy:(0,uU.varchar)("changedBy",{length:64}),changedAt:(0,uU.timestamp)("changedAt",{mode:"string"}).defaultNow()}),e.enrichmentCache=(0,uU.pgTable)("enrichment_cache",{cnpj:(0,uU.varchar)({length:14}).notNull(),dadosJson:(0,uU.text)("dadosJson").notNull(),fonte:(0,uU.varchar)({length:50}),dataAtualizacao:(0,uU.timestamp)("dataAtualizacao",{mode:"string"}).defaultNow().notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()},function(e){return[(0,uU.index)("idx_data_atualizacao").on(e.dataAtualizacao)]}),e.enrichmentConfigs=(0,uU.pgTable)("enrichment_configs",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),openaiApiKey:(0,uU.text)("openaiApiKey"),serpapiKey:(0,uU.text)("serpapiKey"),receitawsKey:(0,uU.text)("receitawsKey"),produtosPorMercado:(0,uU.integer)("produtosPorMercado").default(3).notNull(),concorrentesPorMercado:(0,uU.integer)("concorrentesPorMercado").default(5).notNull(),leadsPorMercado:(0,uU.integer)("leadsPorMercado").default(5).notNull(),batchSize:(0,uU.integer)("batchSize").default(50).notNull(),checkpointInterval:(0,uU.integer)("checkpointInterval").default(100).notNull(),enableDeduplication:(0,uU.integer)("enableDeduplication").default(1).notNull(),enableQualityScore:(0,uU.integer)("enableQualityScore").default(1).notNull(),enableAutoRetry:(0,uU.integer)("enableAutoRetry").default(1).notNull(),maxRetries:(0,uU.integer)("maxRetries").default(2).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow(),geminiApiKey:(0,uU.text)("geminiApiKey"),anthropicApiKey:(0,uU.text)("anthropicApiKey"),googleMapsApiKey:(0,uU.text)("googleMapsApiKey")},function(e){return[(0,uU.index)("projectId").on(e.projectId)]}),e.systemSettings=(0,uU.pgTable)("system_settings",{id:(0,uU.serial)(),settingKey:(0,uU.varchar)("settingKey",{length:100}).notNull(),settingValue:(0,uU.text)("settingValue"),description:(0,uU.text)(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow()},function(e){return[(0,uU.index)("idx_setting_key").on(e.settingKey)]}),e.enrichmentJobs=(0,uU.pgTable)("enrichment_jobs",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),status:(0,uU.varchar)({length:50}).default("pending").notNull(),totalClientes:(0,uU.integer)("totalClientes").notNull(),processedClientes:(0,uU.integer)("processedClientes").default(0).notNull(),successClientes:(0,uU.integer)("successClientes").default(0).notNull(),failedClientes:(0,uU.integer)("failedClientes").default(0).notNull(),currentBatch:(0,uU.integer)("currentBatch").default(0).notNull(),totalBatches:(0,uU.integer)("totalBatches").notNull(),batchSize:(0,uU.integer)("batchSize").default(5).notNull(),checkpointInterval:(0,uU.integer)("checkpointInterval").default(50).notNull(),startedAt:(0,uU.timestamp)("startedAt",{mode:"string"}),pausedAt:(0,uU.timestamp)("pausedAt",{mode:"string"}),completedAt:(0,uU.timestamp)("completedAt",{mode:"string"}),estimatedTimeRemaining:(0,uU.integer)("estimatedTimeRemaining"),lastClienteId:(0,uU.integer)("lastClienteId"),errorMessage:(0,uU.text)("errorMessage"),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow()}),e.enrichmentQueue=(0,uU.pgTable)("enrichment_queue",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull().references(function(){return e.projects.id},{onDelete:"cascade"}),status:(0,uU.varchar)({length:50}).default("pending"),priority:(0,uU.integer)().default(0),clienteData:(0,uU.jsonb)("clienteData").notNull(),result:(0,uU.jsonb)(),errorMessage:(0,uU.text)("errorMessage"),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),startedAt:(0,uU.timestamp)("startedAt",{mode:"string"}),completedAt:(0,uU.timestamp)("completedAt",{mode:"string"})},function(e){return[(0,uU.index)("idx_queue_status").on(e.status),(0,uU.index)("idx_queue_project").on(e.projectId),(0,uU.index)("idx_queue_priority").on(e.priority)]}),e.enrichmentRuns=(0,uU.pgTable)("enrichment_runs",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),startedAt:(0,uU.timestamp)("startedAt",{mode:"string"}).defaultNow().notNull(),completedAt:(0,uU.timestamp)("completedAt",{mode:"string"}),totalClients:(0,uU.integer)("totalClients").notNull(),processedClients:(0,uU.integer)("processedClients").default(0).notNull(),status:(0,uU.varchar)({length:50}).default("running").notNull(),durationSeconds:(0,uU.integer)("durationSeconds"),errorMessage:(0,uU.text)("errorMessage"),notifiedAt50:(0,uU.integer)("notifiedAt50").default(0).notNull(),notifiedAt75:(0,uU.integer)("notifiedAt75").default(0).notNull(),notifiedAt100:(0,uU.integer)("notifiedAt100").default(0).notNull()}),e.entityTags=(0,uU.pgTable)("entity_tags",{id:(0,uU.serial)(),tagId:(0,uU.integer)("tagId").notNull(),entityType:(0,uU.varchar)("entityType",{length:50}).notNull(),entityId:(0,uU.integer)("entityId").notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()}),e.hibernationWarnings=(0,uU.pgTable)("hibernation_warnings",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),warningDate:(0,uU.timestamp)("warningDate",{mode:"string"}).defaultNow().notNull(),scheduledHibernationDate:(0,uU.timestamp)("scheduledHibernationDate",{mode:"string"}).notNull(),daysInactive:(0,uU.integer)("daysInactive").notNull(),notificationSent:(0,uU.integer)("notificationSent").default(0).notNull(),postponed:(0,uU.integer)().default(0).notNull(),postponedUntil:(0,uU.timestamp)("postponedUntil",{mode:"string"}),hibernated:(0,uU.integer)().default(0).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()}),e.intelligentAlertsConfigs=(0,uU.pgTable)("intelligent_alerts_configs",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),circuitBreakerThreshold:(0,uU.integer)("circuitBreakerThreshold").default(10).notNull(),errorRateThreshold:(0,uU.integer)("errorRateThreshold").default(10).notNull(),processingTimeThreshold:(0,uU.integer)("processingTimeThreshold").default(60).notNull(),notifyOnCompletion:(0,uU.integer)("notifyOnCompletion").default(1).notNull(),notifyOnCircuitBreaker:(0,uU.integer)("notifyOnCircuitBreaker").default(1).notNull(),notifyOnErrorRate:(0,uU.integer)("notifyOnErrorRate").default(1).notNull(),notifyOnProcessingTime:(0,uU.integer)("notifyOnProcessingTime").default(1).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow()},function(e){return[(0,uU.index)("intelligent_alerts_configs_projectId_unique").on(e.projectId)]}),e.intelligentAlertsHistory=(0,uU.pgTable)("intelligent_alerts_history",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),alertType:(0,uU.varchar)("alertType",{length:50}).notNull(),severity:(0,uU.varchar)({length:50}).default("info").notNull(),title:(0,uU.varchar)({length:255}).notNull(),message:(0,uU.text)().notNull(),metricValue:(0,uU.text)("metricValue"),threshold:(0,uU.text)(),jobId:(0,uU.integer)("jobId"),clientsProcessed:(0,uU.integer)("clientsProcessed"),totalClients:(0,uU.integer)("totalClients"),isRead:(0,uU.integer)("isRead").default(0).notNull(),isDismissed:(0,uU.integer)("isDismissed").default(0).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),readAt:(0,uU.timestamp)("readAt",{mode:"string"}),dismissedAt:(0,uU.timestamp)("dismissedAt",{mode:"string"})}),e.leadConversions=(0,uU.pgTable)("lead_conversions",{id:(0,uU.serial)(),leadId:(0,uU.integer)("leadId").notNull(),projectId:(0,uU.integer)("projectId").notNull(),dealValue:(0,uU.numeric)("deal_value",{precision:15,scale:2}),convertedAt:(0,uU.timestamp)("convertedAt",{mode:"string"}).defaultNow(),notes:(0,uU.text)(),status:(0,uU.varchar)({length:50}).default("won"),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()}),e.leads=(0,uU.pgTable)("leads",{id:(0,uU.serial)(),leadHash:(0,uU.varchar)("leadHash",{length:255}),mercadoId:(0,uU.integer)("mercadoId").notNull(),nome:(0,uU.varchar)({length:255}).notNull(),cnpj:(0,uU.varchar)({length:20}),site:(0,uU.varchar)({length:500}),email:(0,uU.varchar)({length:320}),telefone:(0,uU.varchar)({length:50}),tipo:(0,uU.varchar)({length:20}),porte:(0,uU.varchar)({length:50}),regiao:(0,uU.varchar)({length:100}),setor:(0,uU.varchar)({length:100}),qualidadeScore:(0,uU.integer)("qualidadeScore"),qualidadeClassificacao:(0,uU.varchar)("qualidadeClassificacao",{length:50}),leadStage:(0,uU.varchar)("leadStage",{length:50}).default("novo"),stageUpdatedAt:(0,uU.timestamp)("stageUpdatedAt",{mode:"string"}).defaultNow(),validationStatus:(0,uU.varchar)("validationStatus",{length:50}).default("pending"),validationNotes:(0,uU.text)("validationNotes"),validatedBy:(0,uU.varchar)("validatedBy",{length:64}),validatedAt:(0,uU.timestamp)("validatedAt",{mode:"string"}),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),projectId:(0,uU.integer)("projectId").default(1).notNull(),cidade:(0,uU.varchar)({length:100}),uf:(0,uU.varchar)({length:2}),faturamentoDeclarado:(0,uU.text)("faturamentoDeclarado"),numeroEstabelecimentos:(0,uU.text)("numeroEstabelecimentos"),pesquisaId:(0,uU.integer)("pesquisaId"),stage:(0,uU.varchar)({length:50}).default("novo"),latitude:(0,uU.numeric)({precision:10,scale:8}),longitude:(0,uU.numeric)({precision:11,scale:8}),geocodedAt:(0,uU.timestamp)("geocodedAt",{mode:"string"})},function(e){return[(0,uU.index)("idx_leads_projectId").on(e.projectId),(0,uU.index)("unique_lead_hash").on(e.leadHash),(0,uU.index)("idx_lead_hash").on(e.leadHash)]}),e.leadsHistory=(0,uU.pgTable)("leads_history",{id:(0,uU.serial)(),leadId:(0,uU.integer)("leadId").notNull(),field:(0,uU.varchar)({length:100}),oldValue:(0,uU.text)("oldValue"),newValue:(0,uU.text)("newValue"),changeType:(0,uU.varchar)("changeType",{length:50}).default("updated"),changedBy:(0,uU.varchar)("changedBy",{length:64}),changedAt:(0,uU.timestamp)("changedAt",{mode:"string"}).defaultNow()}),e.llmProviderConfigs=(0,uU.pgTable)("llm_provider_configs",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),activeProvider:(0,uU.varchar)("activeProvider",{length:50}).default("openai").notNull(),openaiApiKey:(0,uU.text)("openaiApiKey"),openaiModel:(0,uU.varchar)("openaiModel",{length:100}).default("gpt-4o"),openaiEnabled:(0,uU.integer)("openaiEnabled").default(1).notNull(),geminiApiKey:(0,uU.text)("geminiApiKey"),geminiModel:(0,uU.varchar)("geminiModel",{length:100}).default("gemini-2.0-flash-exp"),geminiEnabled:(0,uU.integer)("geminiEnabled").default(0).notNull(),anthropicApiKey:(0,uU.text)("anthropicApiKey"),anthropicModel:(0,uU.varchar)("anthropicModel",{length:100}).default("claude-3-5-sonnet-20241022"),anthropicEnabled:(0,uU.integer)("anthropicEnabled").default(0).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow()}),e.mercadosHistory=(0,uU.pgTable)("mercados_history",{id:(0,uU.serial)(),mercadoId:(0,uU.integer)("mercadoId").notNull(),field:(0,uU.varchar)({length:100}),oldValue:(0,uU.text)("oldValue"),newValue:(0,uU.text)("newValue"),changeType:(0,uU.varchar)("changeType",{length:50}).default("updated"),changedBy:(0,uU.varchar)("changedBy",{length:64}),changedAt:(0,uU.timestamp)("changedAt",{mode:"string"}).defaultNow()}),e.mercadosUnicos=(0,uU.pgTable)("mercados_unicos",{id:(0,uU.serial)(),mercadoHash:(0,uU.varchar)("mercadoHash",{length:255}),nome:(0,uU.varchar)({length:255}).notNull(),segmentacao:(0,uU.varchar)({length:50}),categoria:(0,uU.varchar)({length:100}),tamanhoMercado:(0,uU.text)("tamanhoMercado"),crescimentoAnual:(0,uU.text)("crescimentoAnual"),tendencias:(0,uU.text)(),principaisPlayers:(0,uU.text)("principaisPlayers"),quantidadeClientes:(0,uU.integer)("quantidadeClientes").default(0),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),projectId:(0,uU.integer)("projectId").default(1).notNull(),pesquisaId:(0,uU.integer)("pesquisaId")},function(e){return[(0,uU.index)("idx_mercados_projectId").on(e.projectId),(0,uU.index)("unique_mercado_hash").on(e.mercadoHash),(0,uU.index)("idx_mercado_hash").on(e.mercadoHash)]}),e.exportHistory=(0,uU.pgTable)("export_history",{id:(0,uU.varchar)({length:64}).primaryKey(),userId:(0,uU.varchar)("userId",{length:64}).references(function(){return e.users.id},{onDelete:"cascade"}).notNull(),projectId:(0,uU.integer)("projectId").references(function(){return e.projects.id},{onDelete:"cascade"}),pesquisaId:(0,uU.integer)("pesquisaId").references(function(){return e.pesquisas.id},{onDelete:"cascade"}),context:(0,uU.text)(),filters:(0,uU.jsonb)(),format:(0,uU.varchar)({length:50}).notNull(),outputType:(0,uU.varchar)("outputType",{length:50}).notNull(),recordCount:(0,uU.integer)("recordCount").default(0).notNull(),fileUrl:(0,uU.text)("fileUrl"),fileSize:(0,uU.integer)("fileSize").default(0),generationTime:(0,uU.integer)("generationTime").default(0),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()},function(e){return[(0,uU.index)("idx_export_user").on(e.userId),(0,uU.index)("idx_export_project").on(e.projectId),(0,uU.index)("idx_export_created").on(e.createdAt)]}),e.savedFiltersExport=(0,uU.pgTable)("saved_filters_export",{id:(0,uU.serial)(),userId:(0,uU.varchar)("userId",{length:64}).references(function(){return e.users.id},{onDelete:"cascade"}).notNull(),projectId:(0,uU.integer)("projectId").references(function(){return e.projects.id},{onDelete:"cascade"}),name:(0,uU.varchar)({length:255}).notNull(),description:(0,uU.text)(),entityType:(0,uU.varchar)("entityType",{length:50}).notNull(),filters:(0,uU.jsonb)().notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow()},function(e){return[(0,uU.index)("idx_saved_filter_user").on(e.userId),(0,uU.index)("idx_saved_filter_project").on(e.projectId)]}),e.notifications=(0,uU.pgTable)("notifications",{id:(0,uU.serial)(),userId:(0,uU.varchar)("userId",{length:64}).references(function(){return e.users.id},{onDelete:"cascade"}),projectId:(0,uU.integer)("projectId").references(function(){return e.projects.id},{onDelete:"cascade"}),type:(0,uU.varchar)({length:50}).notNull(),title:(0,uU.varchar)({length:255}).notNull(),message:(0,uU.text)().notNull(),entityType:(0,uU.varchar)("entityType",{length:50}),entityId:(0,uU.integer)("entityId"),isRead:(0,uU.integer)("isRead").default(0).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()}),e.notificationPreferences=(0,uU.pgTable)("notification_preferences",{id:(0,uU.serial)(),userId:(0,uU.varchar)("userId",{length:64}).references(function(){return e.users.id},{onDelete:"cascade"}).notNull(),type:(0,uU.varchar)({length:50}).notNull(),enabled:(0,uU.integer)().default(1).notNull(),channels:(0,uU.jsonb)().$type().default({inApp:!0}),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow()},function(e){return[(0,uU.index)("idx_user_type").on(e.userId,e.type)]}),e.operationalAlerts=(0,uU.pgTable)("operational_alerts",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),alertType:(0,uU.varchar)("alertType",{length:50}).notNull(),severity:(0,uU.varchar)({length:50}).default("medium").notNull(),titulo:(0,uU.varchar)({length:255}).notNull(),mensagem:(0,uU.text)().notNull(),acaoRecomendada:(0,uU.text)("acaoRecomendada"),valorAtual:(0,uU.text)("valorAtual"),valorEsperado:(0,uU.text)("valorEsperado"),isRead:(0,uU.integer)("isRead").default(0).notNull(),isDismissed:(0,uU.integer)("isDismissed").default(0).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),readAt:(0,uU.timestamp)("readAt",{mode:"string"}),dismissedAt:(0,uU.timestamp)("dismissedAt",{mode:"string"})}),e.pesquisas=(0,uU.pgTable)("pesquisas",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),nome:(0,uU.varchar)({length:255}).notNull(),descricao:(0,uU.text)(),dataImportacao:(0,uU.timestamp)("dataImportacao",{mode:"string"}).defaultNow(),totalClientes:(0,uU.integer)("totalClientes").default(0),clientesEnriquecidos:(0,uU.integer)("clientesEnriquecidos").default(0),status:(0,uU.varchar)({length:50}).default("importado"),ativo:(0,uU.integer)().default(1).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow(),qtdConcorrentesPorMercado:(0,uU.integer)("qtdConcorrentesPorMercado").default(5),qtdLeadsPorMercado:(0,uU.integer)("qtdLeadsPorMercado").default(10),qtdProdutosPorCliente:(0,uU.integer)("qtdProdutosPorCliente").default(3)}),e.produtos=(0,uU.pgTable)("produtos",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),clienteId:(0,uU.integer)("clienteId").notNull(),mercadoId:(0,uU.integer)("mercadoId").notNull(),nome:(0,uU.varchar)({length:255}).notNull(),descricao:(0,uU.text)(),categoria:(0,uU.varchar)({length:100}),preco:(0,uU.text)(),unidade:(0,uU.varchar)({length:50}),ativo:(0,uU.integer)().default(1).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow(),pesquisaId:(0,uU.integer)("pesquisaId")},function(e){return[(0,uU.index)("idx_produto_unique").on(e.clienteId,e.mercadoId,e.nome)]}),e.projectAuditLog=(0,uU.pgTable)("project_audit_log",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),userId:(0,uU.varchar)("userId",{length:64}),action:(0,uU.varchar)({length:50}).notNull(),changes:(0,uU.text)(),metadata:(0,uU.text)(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()}),e.projectTemplates=(0,uU.pgTable)("project_templates",{id:(0,uU.serial)(),name:(0,uU.varchar)({length:100}).notNull(),description:(0,uU.text)(),config:(0,uU.text)().notNull(),isDefault:(0,uU.integer)("isDefault").default(0).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow()}),e.projects=(0,uU.pgTable)("projects",{id:(0,uU.serial)(),nome:(0,uU.varchar)({length:255}).notNull(),descricao:(0,uU.text)(),cor:(0,uU.varchar)({length:7}).default("#3b82f6"),ativo:(0,uU.integer)().default(1).notNull(),status:(0,uU.varchar)({length:50}).default("active").notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow(),executionMode:(0,uU.varchar)("executionMode",{length:50}).default("sequential"),maxParallelJobs:(0,uU.integer)("maxParallelJobs").default(3),isPaused:(0,uU.integer)("isPaused").default(0),lastActivityAt:(0,uU.timestamp)("lastActivityAt",{mode:"string"}).defaultNow()}),e.recommendations=(0,uU.pgTable)("recommendations",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),tipo:(0,uU.varchar)({length:50}).notNull(),prioridade:(0,uU.varchar)({length:50}).default("media").notNull(),titulo:(0,uU.varchar)({length:255}).notNull(),descricao:(0,uU.text)().notNull(),acao:(0,uU.text)().notNull(),leadsAdicionaisEstimado:(0,uU.integer)("leadsAdicionaisEstimado").default(0),qualidadeEsperada:(0,uU.integer)("qualidadeEsperada").default(0),custoEstimado:(0,uU.integer)("custoEstimado").default(0),roiEsperado:(0,uU.integer)("roiEsperado").default(0),isApplied:(0,uU.integer)("isApplied").default(0).notNull(),isDismissed:(0,uU.integer)("isDismissed").default(0).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),appliedAt:(0,uU.timestamp)("appliedAt",{mode:"string"}),dismissedAt:(0,uU.timestamp)("dismissedAt",{mode:"string"})}),e.salesforceSyncLog=(0,uU.pgTable)("salesforce_sync_log",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),pesquisaId:(0,uU.integer)("pesquisaId"),syncType:(0,uU.varchar)("syncType",{length:50}).default("manual").notNull(),totalLeadsExportados:(0,uU.integer)("totalLeadsExportados").default(0),totalLeadsSucesso:(0,uU.integer)("totalLeadsSucesso").default(0),totalLeadsErro:(0,uU.integer)("totalLeadsErro").default(0),status:(0,uU.varchar)({length:50}).default("em_progresso").notNull(),errorMessage:(0,uU.text)("errorMessage"),leadIds:(0,uU.text)("leadIds"),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),completedAt:(0,uU.timestamp)("completedAt",{mode:"string"})}),e.savedFilters=(0,uU.pgTable)("saved_filters",{id:(0,uU.serial)(),userId:(0,uU.varchar)("userId",{length:64}).notNull(),name:(0,uU.varchar)({length:100}).notNull(),filtersJson:(0,uU.text)("filtersJson").notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),projectId:(0,uU.integer)("projectId"),isPublic:(0,uU.integer)("isPublic").default(0).notNull(),shareToken:(0,uU.varchar)("shareToken",{length:64})}),e.scheduledEnrichments=(0,uU.pgTable)("scheduled_enrichments",{id:(0,uU.serial)(),projectId:(0,uU.integer)("projectId").notNull(),scheduledAt:(0,uU.timestamp)("scheduledAt",{mode:"string"}).notNull(),recurrence:(0,uU.varchar)({length:50}).default("once").notNull(),batchSize:(0,uU.integer)("batchSize").default(50),maxClients:(0,uU.integer)("maxClients"),timeout:(0,uU.integer)().default(3600),status:(0,uU.varchar)({length:50}).default("pending").notNull(),errorMessage:(0,uU.text)("errorMessage"),lastRunAt:(0,uU.timestamp)("lastRunAt",{mode:"string"}),nextRunAt:(0,uU.timestamp)("nextRunAt",{mode:"string"}),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow()}),e.tags=(0,uU.pgTable)("tags",{id:(0,uU.serial)(),name:(0,uU.varchar)({length:50}).notNull(),color:(0,uU.varchar)({length:7}).default("#3b82f6"),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow()}),e.users=(0,uU.pgTable)("users",{id:(0,uU.varchar)({length:64}).primaryKey().notNull(),email:(0,uU.varchar)({length:320}).unique().notNull(),nome:(0,uU.varchar)({length:255}).notNull(),empresa:(0,uU.varchar)({length:255}).notNull(),cargo:(0,uU.varchar)({length:100}).notNull(),setor:(0,uU.varchar)({length:100}).notNull(),senhaHash:(0,uU.varchar)("senhaHash",{length:255}).notNull(),role:(0,uU.varchar)({length:50}).default("visualizador").notNull(),ativo:(0,uU.smallint)().default(0).notNull(),liberadoPor:(0,uU.varchar)("liberadoPor",{length:64}),liberadoEm:(0,uU.timestamp)("liberadoEm",{mode:"string"}),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),lastSignedIn:(0,uU.timestamp)("lastSignedIn",{mode:"string"})},function(e){return[(0,uU.index)("idx_email").on(e.email),(0,uU.index)("idx_ativo").on(e.ativo),(0,uU.index)("idx_role").on(e.role)]}),e.researchDrafts=(0,uU.pgTable)("research_drafts",{id:(0,uU.serial)("id").primaryKey(),userId:(0,uU.varchar)("userId",{length:64}).notNull(),projectId:(0,uU.integer)("projectId"),draftData:(0,uU.jsonb)("draftData").notNull(),currentStep:(0,uU.integer)("currentStep").default(1).notNull(),progressStatus:(0,e.progressStatusEnum)("progressStatus").default("started"),createdAt:(0,uU.timestamp)("createdAt").defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt").defaultNow()}),e.pushSubscriptions=(0,uU.pgTable)("push_subscriptions",{id:(0,uU.serial)("id").primaryKey(),userId:(0,uU.varchar)("userId",{length:64}).notNull(),endpoint:(0,uU.text)("endpoint").notNull(),p256dh:(0,uU.text)("p256dh").notNull(),auth:(0,uU.text)("auth").notNull(),userAgent:(0,uU.text)("userAgent"),createdAt:(0,uU.timestamp)("createdAt").defaultNow(),lastUsedAt:(0,uU.timestamp)("lastUsedAt").defaultNow()},function(e){return[(0,uU.index)("idx_userId").on(e.userId)]}),e.reportSchedules=(0,uU.pgTable)("report_schedules",{id:(0,uU.serial)("id").primaryKey(),userId:(0,uU.varchar)("userId",{length:64}).notNull(),projectId:(0,uU.integer)("projectId").notNull(),name:(0,uU.varchar)("name",{length:255}).notNull(),frequency:(0,e.frequencyEnum)("frequency").notNull(),recipients:(0,uU.text)("recipients").notNull(),config:(0,uU.jsonb)("config").notNull(),nextRunAt:(0,uU.timestamp)("nextRunAt",{mode:"string"}).notNull(),lastRunAt:(0,uU.timestamp)("lastRunAt",{mode:"string"}),enabled:(0,uU.smallint)("enabled").default(1).notNull(),createdAt:(0,uU.timestamp)("createdAt").defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt").defaultNow()},function(e){return[(0,uU.index)("idx_userId").on(e.userId),(0,uU.index)("idx_projectId").on(e.projectId),(0,uU.index)("idx_nextRunAt").on(e.nextRunAt)]}),e.userInvites=(0,uU.pgTable)("user_invites",{id:(0,uU.varchar)({length:64}).primaryKey().notNull(),email:(0,uU.varchar)({length:320}).notNull(),perfil:(0,uU.varchar)({length:50}).notNull(),token:(0,uU.varchar)({length:255}).unique().notNull(),criadoPor:(0,uU.varchar)("criadoPor",{length:64}).notNull(),criadoEm:(0,uU.timestamp)("criadoEm",{mode:"string"}).defaultNow().notNull(),expiraEm:(0,uU.timestamp)("expiraEm",{mode:"string"}).notNull(),usado:(0,uU.smallint)().default(0).notNull(),usadoEm:(0,uU.timestamp)("usadoEm",{mode:"string"}),cancelado:(0,uU.smallint)().default(0).notNull()},function(t){return[(0,uU.index)("idx_token").on(t.token),(0,uU.index)("idx_email").on(t.email),(0,uU.index)("idx_usado").on(t.usado),(0,uU.foreignKey)({columns:[t.criadoPor],foreignColumns:[e.users.id],name:"fk_invite_criado_por"})]}),e.passwordResets=(0,uU.pgTable)("password_resets",{id:(0,uU.varchar)({length:64}).primaryKey().notNull(),userId:(0,uU.varchar)("userId",{length:64}).notNull(),token:(0,uU.varchar)({length:255}).unique().notNull(),criadoEm:(0,uU.timestamp)("criadoEm",{mode:"string"}).defaultNow().notNull(),expiraEm:(0,uU.timestamp)("expiraEm",{mode:"string"}).notNull(),usado:(0,uU.smallint)().default(0).notNull()},function(t){return[(0,uU.index)("idx_token").on(t.token),(0,uU.index)("idx_user").on(t.userId),(0,uU.foreignKey)({columns:[t.userId],foreignColumns:[e.users.id],name:"fk_password_reset_user"})]}),e.loginAttempts=(0,uU.pgTable)("login_attempts",{id:(0,uU.serial)().primaryKey().notNull(),email:(0,uU.varchar)({length:320}).notNull(),sucesso:(0,uU.smallint)().notNull(),ip:(0,uU.varchar)({length:45}),userAgent:(0,uU.text)("userAgent"),tentativaEm:(0,uU.timestamp)("tentativaEm",{mode:"string"}).defaultNow().notNull()},function(e){return[(0,uU.index)("idx_email_tentativa").on(e.email,e.tentativaEm)]}),e.emailConfig=(0,uU.pgTable)("email_config",{id:(0,uU.serial)().primaryKey().notNull(),projectId:(0,uU.integer)("projectId").notNull(),provider:(0,uU.varchar)({length:50}).default("resend").notNull(),apiKey:(0,uU.varchar)("apiKey",{length:255}).notNull(),fromEmail:(0,uU.varchar)("fromEmail",{length:320}).notNull(),fromName:(0,uU.varchar)("fromName",{length:255}).notNull(),createdAt:(0,uU.timestamp)("createdAt",{mode:"string"}).defaultNow(),updatedAt:(0,uU.timestamp)("updatedAt",{mode:"string"}).defaultNow()}),!process.env.DATABASE_URL)throw Error("DATABASE_URL is not set");let uz=uB(sF(process.env.DATABASE_URL),{schema:e8}),uq=is.use(async({ctx:e,next:t})=>{if(!e.userId)throw new tF({code:"UNAUTHORIZED",message:"Voc\xea precisa estar autenticado para acessar este recurso"});let r=await uz.query.users.findFirst({where:lB(e8.users.id,e.userId)});if(!r)throw new tF({code:"UNAUTHORIZED",message:"Usu\xe1rio n\xe3o encontrado"});let i=[nO.ADMIN,nO.MANAGER,nO.ANALYST,nO.VIEWER],n=r.role;if(!i.includes(n))throw new tF({code:"FORBIDDEN",message:"Papel de usu\xe1rio inv\xe1lido"});return t({ctx:{...e,userId:e.userId,userRole:n,userName:r.name||void 0,userEmail:r.email||void 0}})});function uH(e){return uq.use(async({ctx:t,next:r})=>{var i,n;if(i=t.userRole,n=e,!nA[i].includes(n))throw new tF({code:"FORBIDDEN",message:`Voc\xea n\xe3o tem permiss\xe3o para: ${e}`});return r({ctx:t})})}function uW(e){return aT`count(${e||aT.raw("*")})`.mapWith(Number)}async function uV(e){if(!e.nome||""===e.nome.trim())throw Error("Nome do projeto \xe9 obrigat\xf3rio");if(!e.ownerId)throw Error("Owner ID \xe9 obrigat\xf3rio");if(await uZ(e.nome,e.ownerId))throw Error(`J\xe1 existe um projeto com o nome "${e.nome}" para este owner`);if(e.codigo&&await uX(e.codigo,e.ownerId))throw Error(`J\xe1 existe um projeto com o c\xf3digo "${e.codigo}" para este owner`);let[t]=await uz.insert(e8.dimProjeto).values({...e,status:e.status||"ativo",createdAt:new Date,updatedAt:new Date}).returning();return t}async function uG(e,t=!1){let r=[lB(e8.dimProjeto.id,e)];t||r.push(lZ(e8.dimProjeto.deletedAt));let[i]=await uz.select().from(e8.dimProjeto).where(lz(...r)).limit(1);return i||null}async function uK(e={}){let{ownerId:t,status:r,busca:i,orderBy:n="created_at",orderDirection:s="desc",page:a=1,limit:o=50,incluirDeletados:l=!1}=e,u=[];l||u.push(lZ(e8.dimProjeto.deletedAt)),t&&u.push(lB(e8.dimProjeto.ownerId,t)),r&&(Array.isArray(r)?u.push(lq(...r.map(e=>lB(e8.dimProjeto.status,e)))):u.push(lB(e8.dimProjeto.status,r))),i&&u.push(lq(l5(e8.dimProjeto.nome,`%${i}%`),l5(e8.dimProjeto.codigo,`%${i}%`),l5(e8.dimProjeto.descricao,`%${i}%`)));let c=u.length>0?lz(...u):void 0,[{total:h}]=await uz.select({total:uW()}).from(e8.dimProjeto).where(c),d=e8.dimProjeto[n]||e8.dimProjeto.createdAt,p=await uz.select().from(e8.dimProjeto).where(c).orderBy(("asc"===s?l8:l7)(d)).limit(o).offset((a-1)*o),f=Math.ceil(h/o);return{data:p,total:h,page:a,limit:o,totalPages:f,hasNext:a<f,hasPrev:a>1}}async function uJ(e,t){let r=await uG(e);if(!r)throw Error(`Projeto com ID ${e} n\xe3o encontrado`);if(t.nome&&t.nome!==r.nome&&await uZ(t.nome,r.ownerId,e))throw Error(`J\xe1 existe um projeto com o nome "${t.nome}" para este owner`);if(t.codigo&&t.codigo!==r.codigo&&await uX(t.codigo,r.ownerId,e))throw Error(`J\xe1 existe um projeto com o c\xf3digo "${t.codigo}" para este owner`);let[i]=await uz.update(e8.dimProjeto).set({...t,updatedAt:new Date}).where(lB(e8.dimProjeto.id,e)).returning();return i}async function uQ(e,t){let[r]=await uz.update(e8.dimProjeto).set({deletedAt:new Date,deletedBy:t,updatedAt:new Date}).where(lB(e8.dimProjeto.id,e)).returning();return r}async function uZ(e,t,r){let i=[lB(e8.dimProjeto.nome,e),lB(e8.dimProjeto.ownerId,t),lZ(e8.dimProjeto.deletedAt)];r&&i.push(lB(e8.dimProjeto.id,r));let[n]=await uz.select({count:uW()}).from(e8.dimProjeto).where(r?lz(...i.slice(0,-1)):lz(...i));return n.count>0}async function uX(e,t,r){let i=[lB(e8.dimProjeto.codigo,e),lB(e8.dimProjeto.ownerId,t),lZ(e8.dimProjeto.deletedAt)];r&&i.push(lB(e8.dimProjeto.id,r));let[n]=await uz.select({count:uW()}).from(e8.dimProjeto).where(r?lz(...i.slice(0,-1)):lz(...i));return n.count>0}async function uY(e){if(!e.nome||""===e.nome.trim())throw Error("Nome da pesquisa \xe9 obrigat\xf3rio");if(!e.projetoId)throw Error("Projeto ID \xe9 obrigat\xf3rio");let[t]=await uz.select().from(e8.dimProjeto).where(lB(e8.dimProjeto.id,e.projetoId)).limit(1);if(!t)throw Error(`Projeto com ID ${e.projetoId} n\xe3o encontrado`);if(await u3(e.nome,e.projetoId))throw Error(`J\xe1 existe uma pesquisa com o nome "${e.nome}" neste projeto`);let[r]=await uz.insert(e8.dimPesquisa).values({projetoId:e.projetoId,nome:e.nome,descricao:e.descricao,objetivo:e.objetivo,status:e.status||"pendente",createdBy:e.createdBy,totalEntidades:0,entidadesEnriquecidas:0,entidadesFalhadas:0,createdAt:new Date,updatedAt:new Date}).returning();return r}async function u0(e,t=!1){let r=[lB(e8.dimPesquisa.id,e)];t||r.push(lZ(e8.dimPesquisa.deletedAt));let[i]=await uz.select().from(e8.dimPesquisa).where(lz(...r)).limit(1);return i||null}async function u1(e={}){let{projetoId:t,status:r,busca:i,orderBy:n="created_at",orderDirection:s="desc",page:a=1,limit:o=50,incluirDeletados:l=!1}=e,u=[];l||u.push(lZ(e8.dimPesquisa.deletedAt)),t&&u.push(lB(e8.dimPesquisa.projetoId,t)),r&&(Array.isArray(r)?u.push(lq(...r.map(e=>lB(e8.dimPesquisa.status,e)))):u.push(lB(e8.dimPesquisa.status,r))),i&&u.push(lq(l5(e8.dimPesquisa.nome,`%${i}%`),l5(e8.dimPesquisa.descricao,`%${i}%`),l5(e8.dimPesquisa.objetivo,`%${i}%`)));let c=u.length>0?lz(...u):void 0,[{total:h}]=await uz.select({total:uW()}).from(e8.dimPesquisa).where(c),d=e8.dimPesquisa[n]||e8.dimPesquisa.createdAt,p=await uz.select().from(e8.dimPesquisa).where(c).orderBy(("asc"===s?l8:l7)(d)).limit(o).offset((a-1)*o),f=Math.ceil(h/o);return{data:p,total:h,page:a,limit:o,totalPages:f,hasNext:a<f,hasPrev:a>1}}async function u2(e,t){let r=await u0(e);if(!r)throw Error(`Pesquisa com ID ${e} n\xe3o encontrada`);if(t.nome&&t.nome!==r.nome&&await u3(t.nome,r.projetoId,e))throw Error(`J\xe1 existe uma pesquisa com o nome "${t.nome}" neste projeto`);let[i]=await uz.update(e8.dimPesquisa).set({...t,updatedAt:new Date}).where(lB(e8.dimPesquisa.id,e)).returning();return i}async function u5(e,t){let[r]=await uz.update(e8.dimPesquisa).set({deletedAt:new Date,deletedBy:t,updatedAt:new Date}).where(lB(e8.dimPesquisa.id,e)).returning();return r}async function u6(e){return u1({projetoId:e})}async function u3(e,t,r){let i=[lB(e8.dimPesquisa.nome,e),lB(e8.dimPesquisa.projetoId,t),lZ(e8.dimPesquisa.deletedAt)];r&&i.push(lB(e8.dimPesquisa.id,r));let[n]=await uz.select({count:uW()}).from(e8.dimPesquisa).where(r?lz(...i.slice(0,-1)):lz(...i));return n.count>0}async function u4(e){if(!e.nome||""===e.nome.trim())throw Error("Nome da entidade \xe9 obrigat\xf3rio");if(!e.tipoEntidade)throw Error("Tipo de entidade \xe9 obrigat\xf3rio");if(!["cliente","lead","concorrente"].includes(e.tipoEntidade))throw Error("Tipo de entidade inv\xe1lido");if(!e.origemTipo)throw Error("Origem tipo \xe9 obrigat\xf3rio");if(e.cnpj){let t=ci(e.cnpj);if(!cn(t))throw Error("CNPJ inv\xe1lido");if(await ct(t))throw Error(`J\xe1 existe uma entidade com o CNPJ ${e.cnpj}`);e.cnpj=t}let t=function(e){if(e.cnpj){let t=ci(e.cnpj);return(0,sd.createHash)("md5").update(t).digest("hex")}let t=e.nome.toLowerCase().trim();return(0,sd.createHash)("md5").update(t).digest("hex")}(e);if(await cr(t))throw Error("J\xe1 existe uma entidade com os mesmos dados");let[r]=await uz.insert(e8.dimEntidade).values({...e,entidadeHash:t,origemData:new Date,createdAt:new Date,updatedAt:new Date}).returning();return r}async function u8(e,t=!1){let r=[lB(e8.dimEntidade.id,e)];t||r.push(lZ(e8.dimEntidade.deletedAt));let[i]=await uz.select().from(e8.dimEntidade).where(lz(...r)).limit(1);return i||null}async function u7(e={}){let{tipoEntidade:t,origemTipo:r,busca:i,cnpj:n,statusQualificacaoId:s,projetoId:a,pesquisaId:o,enriquecido:l,orderBy:u="created_at",orderDirection:c="desc",page:h=1,limit:d=50,incluirDeletados:p=!1}=e,f=[];p||f.push(lZ(e8.dimEntidade.deletedAt)),t&&(Array.isArray(t)?f.push(lq(...t.map(e=>lB(e8.dimEntidade.tipoEntidade,e)))):f.push(lB(e8.dimEntidade.tipoEntidade,t))),r&&(Array.isArray(r)?f.push(lq(...r.map(e=>lB(e8.dimEntidade.origemTipo,e)))):f.push(lB(e8.dimEntidade.origemTipo,r))),n&&f.push(lB(e8.dimEntidade.cnpj,ci(n))),i&&f.push(lq(l5(e8.dimEntidade.nome,`%${i}%`),l5(e8.dimEntidade.nomeFantasia,`%${i}%`),l5(e8.dimEntidade.cnpj,`%${i}%`),l5(e8.dimEntidade.email,`%${i}%`))),s&&f.push(lB(e8.dimEntidade.statusQualificacaoId,s)),void 0!==l&&(l?f.push(aT`${e8.dimEntidade.enriquecidoEm} IS NOT NULL`):f.push(lZ(e8.dimEntidade.enriquecidoEm))),p||f.push(lZ(e8.dimEntidade.deletedAt));let m=f.length>0?lz(...f):void 0,[{total:g}]=await uz.select({total:uW()}).from(e8.dimEntidade).where(m),y=e8.dimEntidade[u]||e8.dimEntidade.createdAt,v=await uz.select().from(e8.dimEntidade).where(m).orderBy(("asc"===c?l8:l7)(y)).limit(d).offset((h-1)*d),b=Math.ceil(g/d);return{data:v,total:g,page:h,limit:d,totalPages:b,hasNext:h<b,hasPrev:h>1}}async function u9(e,t){let r=await u8(e);if(!r)throw Error(`Entidade com ID ${e} n\xe3o encontrada`);if(t.cnpj&&t.cnpj!==r.cnpj){let r=ci(t.cnpj);if(!cn(r))throw Error("CNPJ inv\xe1lido");let i=await ct(r);if(i&&i.id!==e)throw Error(`J\xe1 existe uma entidade com o CNPJ ${t.cnpj}`);t.cnpj=r}let[i]=await uz.update(e8.dimEntidade).set({...t,updatedAt:new Date}).where(lB(e8.dimEntidade.id,e)).returning();return i}async function ce(e,t){let[r]=await uz.update(e8.dimEntidade).set({deletedAt:new Date,deletedBy:t,updatedAt:new Date}).where(lB(e8.dimEntidade.id,e)).returning();return r}async function ct(e,t=!1){let r=ci(e),i=[lB(e8.dimEntidade.cnpj,r)];t||i.push(lZ(e8.dimEntidade.deletedAt));let[n]=await uz.select().from(e8.dimEntidade).where(lz(...i)).limit(1);return n||null}async function cr(e,t=!1){let r=[lB(e8.dimEntidade.entidadeHash,e)];t||r.push(lZ(e8.dimEntidade.deletedAt));let[i]=await uz.select().from(e8.dimEntidade).where(lz(...r)).limit(1);return i||null}function ci(e){return e.replace(/[^\d]/g,"")}function cn(e){let t=ci(e);if(14!==t.length||/^(\d)\1+$/.test(t))return!1;let r=t.length-2,i=t.substring(0,r),n=t.substring(r),s=0,a=r-7;for(let e=r;e>=1;e--)s+=parseInt(i.charAt(r-e))*a--,a<2&&(a=9);let o=s%11<2?0:11-s%11;if(o!==parseInt(n.charAt(0)))return!1;r+=1,i=t.substring(0,r),s=0,a=r-7;for(let e=r;e>=1;e--)s+=parseInt(i.charAt(r-e))*a--,a<2&&(a=9);return(o=s%11<2?0:11-s%11)===parseInt(n.charAt(1))}function cs(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim()}async function ca(e,t,r=.8){let i=cs(e),n=t.toUpperCase().trim(),s=await buscarGeografia(e,t);if(s)return{geografia:s,similaridade:1};let a=await uz.select().from(e8.dimGeografia).where(lB(e8.dimGeografia.uf,n));if(0===a.length)return null;let o=a.map(e=>{let t=function(e,t){let r=function(e,t){let r=e.length,i=t.length,n=Array(r+1).fill(null).map(()=>Array(i+1).fill(0));for(let e=0;e<=r;e++)n[e][0]=e;for(let e=0;e<=i;e++)n[0][e]=e;for(let s=1;s<=r;s++)for(let r=1;r<=i;r++)e[s-1]===t[r-1]?n[s][r]=n[s-1][r-1]:n[s][r]=Math.min(n[s-1][r]+1,n[s][r-1]+1,n[s-1][r-1]+1);return n[r][i]}(e,t),i=Math.max(e.length,t.length);return 0===i?1:1-r/i}(i,cs(e.cidade));return{geografia:e,similaridade:t}});o.sort((e,t)=>t.similaridade-e.similaridade);let l=o[0];return l&&l.similaridade>=r?l:null}uq.use(async({ctx:e,next:t})=>{if(e.userRole!==nO.ADMIN)throw new tF({code:"FORBIDDEN",message:"Esta a\xe7\xe3o requer privil\xe9gios de administrador"});return t({ctx:e})});let co=function(e,t,r,i,n=e){let s=new lL(e,i,n),a="function"==typeof t?t({bigint:om,bigserial:ob,boolean:oS,char:ok,cidr:oA,customType:oI,date:oa,doublePrecision:oD,inet:oF,integer:oU,interval:oH,json:aK,jsonb:aW,line:oJ,macaddr:oX,macaddr8:o1,numeric:a2,point:o4,geometry:li,real:la,serial:lu,smallint:ld,smallserial:lm,text:l_,time:a4,timestamp:ot,uuid:ou,varchar:lw,bit:lE,halfvec:lO,sparsevec:lN,vector:lP}):t,o=Object.fromEntries(Object.entries(a).map(([e,t])=>{t.setName(e);let r=t.build(s);return s[lj].push(...t.buildForeignKeys(r,s)),[e,r]})),l=Object.fromEntries(Object.entries(a).map(([e,t])=>(t.setName(e),[e,t.buildExtraConfigColumn(s)]))),u=Object.assign(s,o);return u[am.Symbol.Columns]=o,u[am.Symbol.ExtraConfigColumns]=l,r&&(u[lL.Symbol.ExtraConfigBuilder]=r),Object.assign(u,{enableRLS:()=>(u[lL.Symbol.EnableRLS]=!0,u)})}("audit_logs",{id:lu("id").primaryKey(),user_id:lw("user_id",{length:255}).notNull(),user_name:l_("user_name"),user_email:lw("user_email",{length:255}),user_role:lw("user_role",{length:50}),action:lw("action",{length:100}).notNull(),resource_type:lw("resource_type",{length:100}).notNull(),resource_id:lw("resource_id",{length:255}),description:l_("description"),changes:aW("changes"),metadata:aW("metadata"),status:lw("status",{length:20}).notNull(),error_message:l_("error_message"),ip_address:lw("ip_address",{length:45}),user_agent:l_("user_agent"),created_at:ot("created_at").defaultNow().notNull()},d,void 0);var cl=function(e){return e.USER="user",e.PROJETO="projeto",e.PESQUISA="pesquisa",e.IMPORTACAO="importacao",e.ENTIDADE="entidade",e.ANALISE="analise",e.SISTEMA="sistema",e}({});async function cu(e){try{let[t]=await uz.insert(co).values({user_id:e.userId,user_name:e.userName,user_email:e.userEmail,user_role:e.userRole,action:e.action,resource_type:e.resourceType,resource_id:e.resourceId,description:e.description,changes:e.changes,metadata:e.metadata,status:e.status,error_message:e.errorMessage,ip_address:e.ipAddress,user_agent:e.userAgent}).returning({id:co.id});return t.id}catch(e){return console.error(" Erro ao registrar log de auditoria:",e),-1}}async function cc(e,t,r,i,n){return cu({userId:e,action:"create",resourceType:t,resourceId:r,description:`Criou ${t} "${i}"`,status:"success",metadata:n})}async function ch(e,t,r,i,n){return cu({userId:e,action:"update",resourceType:t,resourceId:r,description:`Atualizou ${t} #${r}`,changes:i,status:"success",metadata:n})}async function cd(e,t,r,i,n){return cu({userId:e,action:"delete",resourceType:t,resourceId:r,description:i?`Deletou ${t} "${i}"`:`Deletou ${t} #${r}`,status:"success",metadata:n})}let cp=ii({list:uH(nC.PROJETO_READ).input(nS({page:n_().min(1).default(1),limit:n_().min(1).max(100).default(20),busca:ny().optional(),status:nk(["ativo","inativo","arquivado"]).optional(),orderBy:nk(["nome","created_at"]).default("created_at"),orderDirection:nk(["asc","desc"]).default("desc")})).query(async({input:e,ctx:t})=>{let r=t.userId;return await uK({ownerId:r,page:e.page,limit:e.limit,busca:e.busca,status:e.status,orderBy:e.orderBy,orderDirection:e.orderDirection})}),getById:uH(nC.PROJETO_READ).input(nS({id:n_()})).query(async({input:e})=>{let t=await uG(e.id);if(!t)throw Error("Projeto n\xe3o encontrado");return t}),create:uH(nC.PROJETO_CREATE).input(nS({nome:ny().min(1,"Nome \xe9 obrigat\xf3rio"),descricao:ny().optional(),objetivo:ny().optional(),status:nk(["ativo","inativo","arquivado"]).default("ativo")})).mutation(async({input:e,ctx:t})=>{let r=t.userId,i=await uV({nome:e.nome,descricao:e.descricao,objetivo:e.objetivo,status:e.status,owner_id:r});return await cc(t.userId,cl.PROJETO,i.id.toString(),i.nome,{status:i.status}),i}),update:uH(nC.PROJETO_UPDATE).input(nS({id:n_(),nome:ny().min(1).optional(),descricao:ny().optional(),objetivo:ny().optional(),status:nk(["ativo","inativo","arquivado"]).optional()})).mutation(async({input:e,ctx:t})=>{let r=await uG(e.id),i=await uJ(e.id,{nome:e.nome,descricao:e.descricao,objetivo:e.objetivo,status:e.status});if(!i)throw Error("Projeto n\xe3o encontrado");return await ch(t.userId,cl.PROJETO,e.id.toString(),{before:r,after:i}),i}),delete:uH(nC.PROJETO_DELETE).input(nS({id:n_()})).mutation(async({input:e,ctx:t})=>{let r=await uG(e.id);if(!await uQ(e.id))throw Error("Projeto n\xe3o encontrado");return await cd(t.userId,cl.PROJETO,e.id.toString(),r?.nome),{success:!0}})}),cf=ii({list:uH(nC.PESQUISA_READ).input(nS({projetoId:n_().optional(),page:n_().min(1).default(1),limit:n_().min(1).max(100).default(20),busca:ny().optional(),status:nk(["pendente","em_progresso","concluida","falhou","cancelada"]).optional(),orderBy:nk(["nome","created_at"]).default("created_at"),orderDirection:nk(["asc","desc"]).default("desc")})).query(async({input:e})=>await u1({projetoId:e.projetoId,page:e.page,limit:e.limit,busca:e.busca,status:e.status,orderBy:e.orderBy,orderDirection:e.orderDirection})),getById:uH(nC.PESQUISA_READ).input(nS({id:n_()})).query(async({input:e})=>{let t=await u0(e.id);if(!t)throw Error("Pesquisa n\xe3o encontrada");return t}),getByProjeto:uH(nC.PESQUISA_READ).input(nS({projetoId:n_()})).query(async({input:e})=>await u6(e.projetoId)),create:uH(nC.PESQUISA_CREATE).input(nS({projetoId:n_(),nome:ny().min(3,"Nome deve ter no m\xednimo 3 caracteres").max(100),descricao:ny().max(500).optional(),tipo:nk(["clientes","concorrentes","leads","fornecedores","outros"]).optional(),limiteResultados:n_().min(1).max(1e4).optional()})).mutation(async({input:e,ctx:t})=>{let r=[];e.tipo&&r.push(`Tipo: ${e.tipo}`),e.limiteResultados&&r.push(`Limite: ${e.limiteResultados} resultados`);let i=r.length>0?r.join(" | "):void 0;return await uY({projetoId:e.projetoId,nome:e.nome,descricao:e.descricao,objetivo:i,status:"pendente",createdBy:1})}),update:uH(nC.PESQUISA_UPDATE).input(nS({id:n_(),nome:ny().min(3).max(100).optional(),descricao:ny().max(500).optional(),fontes:nx(ny()).optional(),palavras_chave:nx(ny()).optional(),filtros:nT(nw()).optional(),status:nk(["pendente","em_progresso","concluida","falhou","cancelada"]).optional()})).mutation(async({input:e})=>{let t=await u2(e.id,{nome:e.nome,descricao:e.descricao,fontes:e.fontes,palavras_chave:e.palavras_chave,filtros:e.filtros,status:e.status});if(!t)throw Error("Pesquisa n\xe3o encontrada");return t}),delete:uH(nC.PESQUISA_DELETE).input(nS({id:n_()})).mutation(async({input:e})=>{if(!await u5(e.id))throw Error("Pesquisa n\xe3o encontrada");return{success:!0}}),start:uH(nC.PESQUISA_START).input(nS({id:n_()})).mutation(async({input:e})=>{let t=await u2(e.id,{status:"em_progresso"});if(!t)throw Error("Pesquisa n\xe3o encontrada");return t}),stop:uH(nC.PESQUISA_STOP).input(nS({id:n_()})).mutation(async({input:e})=>{let t=await u2(e.id,{status:"cancelada"});if(!t)throw Error("Pesquisa n\xe3o encontrada");return t})});function cm(e,t,r,i,n){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r}function cg(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}let cy=function(){let{crypto:e}=globalThis;if(e?.randomUUID)return cy=e.randomUUID.bind(e),e.randomUUID();let t=new Uint8Array(1),r=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^r()&15>>+e/4).toString(16))};function c_(e){return"object"==typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}let cv=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){let t=Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return Error(JSON.stringify(e))}catch{}}return Error(e)};class cb extends Error{}class cw extends cb{constructor(e,t,r,i){super(`${cw.makeMessage(e,t,r)}`),this.status=e,this.headers=i,this.requestID=i?.get("x-request-id"),this.error=t,this.code=t?.code,this.param=t?.param,this.type=t?.type}static makeMessage(e,t,r){let i=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,r,i){if(!e||!i)return new cS({message:r,cause:cv(t)});let n=t?.error;return 400===e?new cT(e,n,r,i):401===e?new ck(e,n,r,i):403===e?new cO(e,n,r,i):404===e?new cC(e,n,r,i):409===e?new cA(e,n,r,i):422===e?new cN(e,n,r,i):429===e?new cR(e,n,r,i):e>=500?new cI(e,n,r,i):new cw(e,n,r,i)}}class cx extends cw{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class cS extends cw{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class cE extends cS{constructor({message:e}={}){super({message:e??"Request timed out."})}}class cT extends cw{}class ck extends cw{}class cO extends cw{}class cC extends cw{}class cA extends cw{}class cN extends cw{}class cR extends cw{}class cI extends cw{}class cP extends cb{constructor(){super("Could not parse response content as the length limit was reached")}}class cj extends cb{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class cD extends Error{constructor(e){super(e)}}let cL=/^[a-z][a-z0-9+.-]*:/i,c$=e=>cL.test(e),cF=e=>(cF=Array.isArray)(e),cM=cF;function cB(e){return"object"!=typeof e?{}:e??{}}function cU(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}let cz=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new cb(`${e} must be an integer`);if(t<0)throw new cb(`${e} must be a positive integer`);return t},cq=e=>{try{return JSON.parse(e)}catch(e){return}},cH=e=>new Promise(t=>setTimeout(t,e)),cW="6.9.1",cV=()=>"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator,cG=()=>{let e="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cW,"X-Stainless-OS":cJ(Deno.build.os),"X-Stainless-Arch":cK(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cW,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cW,"X-Stainless-OS":cJ(globalThis.process.platform??"unknown"),"X-Stainless-Arch":cK(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let t=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let r=t.exec(navigator.userAgent);if(r){let t=r[1]||0,i=r[2]||0,n=r[3]||0;return{browser:e,version:`${t}.${i}.${n}`}}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cW,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cW,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},cK=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",cJ=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown",cQ=()=>l??(l=cG());function cZ(...e){let t=globalThis.ReadableStream;if(void 0===t)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function cX(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return cZ({start(){},async pull(e){let{done:r,value:i}=await t.next();r?e.close():e.enqueue(i)},async cancel(){await t.return?.()}})}function cY(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function c0(e){if(null===e||"object"!=typeof e)return;if(e[Symbol.asyncIterator]){await e[Symbol.asyncIterator]().return?.();return}let t=e.getReader(),r=t.cancel();t.releaseLock(),await r}let c1=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),c2="RFC3986",c5=e=>String(e),c6={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:c5},c3=(e,t)=>(c3=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty))(e,t),c4=(()=>{let e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();function c8(e,t){if(cF(e)){let r=[];for(let i=0;i<e.length;i+=1)r.push(t(e[i]));return r}return t(e)}let c7={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},c9=function(e,t){Array.prototype.push.apply(e,cF(t)?t:[t])},he={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,r,i,n)=>{if(0===e.length)return e;let s=e;if("symbol"==typeof e?s=Symbol.prototype.toString.call(e):"string"!=typeof e&&(s=String(e)),"iso-8859-1"===r)return escape(s).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});let a="";for(let e=0;e<s.length;e+=1024){let t=s.length>=1024?s.slice(e,e+1024):s,r=[];for(let e=0;e<t.length;++e){let i=t.charCodeAt(e);if(45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122||"RFC1738"===n&&(40===i||41===i)){r[r.length]=t.charAt(e);continue}if(i<128){r[r.length]=c4[i];continue}if(i<2048){r[r.length]=c4[192|i>>6]+c4[128|63&i];continue}if(i<55296||i>=57344){r[r.length]=c4[224|i>>12]+c4[128|i>>6&63]+c4[128|63&i];continue}e+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(e)),r[r.length]=c4[240|i>>18]+c4[128|i>>12&63]+c4[128|i>>6&63]+c4[128|63&i]}a+=r.join("")}return a},encodeValuesOnly:!1,format:c2,formatter:c5,indices:!1,serializeDate:e=>(u??(u=Function.prototype.call.bind(Date.prototype.toISOString)))(e),skipNulls:!1,strictNullHandling:!1},ht={};function hr(e){let t;return(c??(c=(t=new globalThis.TextEncoder).encode.bind(t)))(e)}function hi(e){let t;return(h??(h=(t=new globalThis.TextDecoder).decode.bind(t)))(e)}class hn{constructor(){k.set(this,void 0),O.set(this,void 0),cm(this,k,new Uint8Array,"f"),cm(this,O,null,"f")}decode(e){let t;if(null==e)return[];let r=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?hr(e):e;cm(this,k,function(e){let t=0;for(let r of e)t+=r.length;let r=new Uint8Array(t),i=0;for(let t of e)r.set(t,i),i+=t.length;return r}([cg(this,k,"f"),r]),"f");let i=[];for(;null!=(t=function(e,t){for(let r=t??0;r<e.length;r++){if(10===e[r])return{preceding:r,index:r+1,carriage:!1};if(13===e[r])return{preceding:r,index:r+1,carriage:!0}}return null}(cg(this,k,"f"),cg(this,O,"f")));){if(t.carriage&&null==cg(this,O,"f")){cm(this,O,t.index,"f");continue}if(null!=cg(this,O,"f")&&(t.index!==cg(this,O,"f")+1||t.carriage)){i.push(hi(cg(this,k,"f").subarray(0,cg(this,O,"f")-1))),cm(this,k,cg(this,k,"f").subarray(cg(this,O,"f")),"f"),cm(this,O,null,"f");continue}let e=null!==cg(this,O,"f")?t.preceding-1:t.preceding,r=hi(cg(this,k,"f").subarray(0,e));i.push(r),cm(this,k,cg(this,k,"f").subarray(t.index),"f"),cm(this,O,null,"f")}return i}flush(){return cg(this,k,"f").length?this.decode("\n"):[]}}k=new WeakMap,O=new WeakMap,hn.NEWLINE_CHARS=new Set(["\n","\r"]),hn.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let hs={off:0,error:200,warn:300,info:400,debug:500},ha=(e,t,r)=>{if(e){if(Object.prototype.hasOwnProperty.call(hs,e))return e;hh(r).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(hs))}`)}};function ho(){}function hl(e,t,r){return!t||hs[e]>hs[r]?ho:t[e].bind(t)}let hu={error:ho,warn:ho,info:ho,debug:ho},hc=new WeakMap;function hh(e){let t=e.logger,r=e.logLevel??"off";if(!t)return hu;let i=hc.get(t);if(i&&i[0]===r)return i[1];let n={error:hl("error",t,r),warn:hl("warn",t,r),info:hl("info",t,r),debug:hl("debug",t,r)};return hc.set(t,[r,n]),n}let hd=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([e,t])=>[e,"authorization"===e.toLowerCase()||"cookie"===e.toLowerCase()||"set-cookie"===e.toLowerCase()?"***":t]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);class hp{constructor(e,t,r){this.iterator=e,C.set(this,void 0),this.controller=t,cm(this,C,r,"f")}static fromSSEResponse(e,t,r){let i=!1,n=r?hh(r):console;return new hp(async function*(){if(i)throw new cb("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let r=!1;try{for await(let i of hf(e,t))if(!r){if(i.data.startsWith("[DONE]")){r=!0;continue}if(null!==i.event&&i.event.startsWith("thread.")){let e;try{e=JSON.parse(i.data)}catch(e){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),e}if("error"==i.event)throw new cw(void 0,e.error,e.message,void 0);yield{event:i.event,data:e}}else{let t;try{t=JSON.parse(i.data)}catch(e){throw n.error("Could not parse message into JSON:",i.data),n.error("From chunk:",i.raw),e}if(t&&t.error)throw new cw(void 0,t.error,void 0,e.headers);yield t}}r=!0}catch(e){if(c_(e))return;throw e}finally{r||t.abort()}},t,r)}static fromReadableStream(e,t,r){let i=!1;async function*n(){let t=new hn;for await(let r of cY(e))for(let e of t.decode(r))yield e;for(let e of t.flush())yield e}return new hp(async function*(){if(i)throw new cb("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let e=!1;try{for await(let t of n())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(c_(e))return;throw e}finally{e||t.abort()}},t,r)}[(C=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let e=[],t=[],r=this.iterator(),i=i=>({next:()=>{if(0===i.length){let i=r.next();e.push(i),t.push(i)}return i.shift()}});return[new hp(()=>i(e),this.controller,cg(this,C,"f")),new hp(()=>i(t),this.controller,cg(this,C,"f"))]}toReadableStream(){let e;let t=this;return cZ({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:r,done:i}=await e.next();if(i)return t.close();let n=hr(JSON.stringify(r)+"\n");t.enqueue(n)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}}async function*hf(e,t){if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new cb("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new cb("Attempted to iterate over a response with no body")}let r=new hg,i=new hn;for await(let t of hm(cY(e.body)))for(let e of i.decode(t)){let t=r.decode(e);t&&(yield t)}for(let e of i.flush()){let t=r.decode(e);t&&(yield t)}}async function*hm(e){let t=new Uint8Array;for await(let r of e){let e;if(null==r)continue;let i=r instanceof ArrayBuffer?new Uint8Array(r):"string"==typeof r?hr(r):r,n=new Uint8Array(t.length+i.length);for(n.set(t),n.set(i,t.length),t=n;-1!==(e=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}class hg{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,i]=function(e,t){let r=e.indexOf(":");return -1!==r?[e.substring(0,r),":",e.substring(r+t.length)]:[e,"",""]}(e,":");return i.startsWith(" ")&&(i=i.substring(1)),"event"===t?this.event=i:"data"===t&&this.data.push(i),null}}async function hy(e,t){let{response:r,requestLogID:i,retryOfRequestLogID:n,startTime:s}=t,a=await (async()=>{if(t.options.stream)return(hh(e).debug("response",r.status,r.url,r.headers,r.body),t.options.__streamClass)?t.options.__streamClass.fromSSEResponse(r,t.controller,e):hp.fromSSEResponse(r,t.controller,e);if(204===r.status)return null;if(t.options.__binaryResponse)return r;let i=r.headers.get("content-type"),n=i?.split(";")[0]?.trim();return n?.includes("application/json")||n?.endsWith("+json")?h_(await r.json(),r):await r.text()})();return hh(e).debug(`[${i}] response parsed`,hd({retryOfRequestLogID:n,url:r.url,status:r.status,body:a,durationMs:Date.now()-s})),a}function h_(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class hv extends Promise{constructor(e,t,r=hy){super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=r,A.set(this,void 0),cm(this,A,e,"f")}_thenUnwrap(e){return new hv(cg(this,A,"f"),this.responsePromise,async(t,r)=>h_(e(await this.parseResponse(t,r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(cg(this,A,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}A=new WeakMap;class hb{constructor(e,t,r,i){N.set(this,void 0),cm(this,N,e,"f"),this.options=i,this.response=t,this.body=r}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageRequestOptions()}async getNextPage(){let e=this.nextPageRequestOptions();if(!e)throw new cb("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await cg(this,N,"f").requestAPIList(this.constructor,e)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(N=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}}class hw extends hv{constructor(e,t,r){super(e,t,async(e,t)=>new r(e,t.response,await hy(e,t),t.options))}async *[Symbol.asyncIterator](){for await(let e of(await this))yield e}}class hx extends hb{constructor(e,t,r,i){super(e,t,r,i),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class hS extends hb{constructor(e,t,r,i){super(e,t,r,i),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){let e=this.getPaginatedItems(),t=e[e.length-1]?.id;return t?{...this.options,query:{...cB(this.options.query),after:t}}:null}}class hE extends hb{constructor(e,t,r,i){super(e,t,r,i),this.data=r.data||[],this.has_more=r.has_more||!1,this.last_id=r.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){let e=this.last_id;return e?{...this.options,query:{...cB(this.options.query),after:e}}:null}}let hT=()=>{if("undefined"==typeof File){let{process:e}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof e?.versions?.node&&20>parseInt(e.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function hk(e,t,r){return hT(),new File(e,t??"unknown_file",r)}function hO(e){return("object"==typeof e&&null!==e&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}let hC=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],hA=async(e,t)=>hD(e.body)?{...e,body:await hI(e.body,t)}:e,hN=async(e,t)=>({...e,body:await hI(e.body,t)}),hR=new WeakMap,hI=async(e,t)=>{if(!await function(e){let t="function"==typeof e?e:e.fetch,r=hR.get(t);if(r)return r;let i=(async()=>{try{let e="Response"in t?t.Response:(await t("data:,")).constructor,r=new FormData;if(r.toString()===await new e(r).text())return!1;return!0}catch{return!0}})();return hR.set(t,i),i}(t))throw TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let r=new FormData;return await Promise.all(Object.entries(e||{}).map(([e,t])=>hL(r,e,t))),r},hP=e=>e instanceof Blob&&"name"in e,hj=e=>"object"==typeof e&&null!==e&&(e instanceof Response||hC(e)||hP(e)),hD=e=>{if(hj(e))return!0;if(Array.isArray(e))return e.some(hD);if(e&&"object"==typeof e){for(let t in e)if(hD(e[t]))return!0}return!1},hL=async(e,t,r)=>{if(void 0!==r){if(null==r)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)e.append(t,String(r));else if(r instanceof Response)e.append(t,hk([await r.blob()],hO(r)));else if(hC(r))e.append(t,hk([await new Response(cX(r)).blob()],hO(r)));else if(hP(r))e.append(t,r,hO(r));else if(Array.isArray(r))await Promise.all(r.map(r=>hL(e,t+"[]",r)));else if("object"==typeof r)await Promise.all(Object.entries(r).map(([r,i])=>hL(e,`${t}[${r}]`,i)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}},h$=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,hF=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&h$(e),hM=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob;async function hB(e,t,r){if(hT(),hF(e=await e))return e instanceof File?e:hk([await e.arrayBuffer()],e.name);if(hM(e)){let i=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),hk(await hU(i),t,r)}let i=await hU(e);if(t||(t=hO(e)),!r?.type){let e=i.find(e=>"object"==typeof e&&"type"in e&&e.type);"string"==typeof e&&(r={...r,type:e})}return hk(i,t,r)}async function hU(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(h$(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(hC(e))for await(let r of e)t.push(...await hU(r));else{let t=e?.constructor?.name;throw Error(`Unexpected data type: ${typeof e}${t?`; constructor: ${t}`:""}${function(e){if("object"!=typeof e||null===e)return"";let t=Object.getOwnPropertyNames(e);return`; props: [${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`)}return t}class hz{constructor(e){this._client=e}}function hq(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}let hH=Object.freeze(Object.create(null)),hW=((e=hq)=>function(t,...r){let i;if(1===t.length)return t[0];let n=!1,s=[],a=t.reduce((t,i,a)=>{/[?#]/.test(i)&&(n=!0);let o=r[a],l=(n?encodeURIComponent:e)(""+o);return a!==r.length&&(null==o||"object"==typeof o&&o.toString===Object.getPrototypeOf(Object.getPrototypeOf(o.hasOwnProperty??hH)??hH)?.toString)&&(l=o+"",s.push({start:t.length+i.length,length:l.length,error:`Value of type ${Object.prototype.toString.call(o).slice(8,-1)} is not a valid path parameter`})),t+i+(a===r.length?"":l)},""),o=a.split(/[?#]/,1)[0],l=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(i=l.exec(o));)s.push({start:i.index,length:i[0].length,error:`Value "${i[0]}" can't be safely passed as a path parameter`});if(s.sort((e,t)=>e.start-t.start),s.length>0){let e=0,t=s.reduce((t,r)=>{let i=" ".repeat(r.start-e),n="^".repeat(r.length);return e=r.start+r.length,t+i+n},"");throw new cb(`Path parameters result in path with invalid segments:
${s.map(e=>e.error).join("\n")}
${a}
${t}`)}return a})(hq);class hV extends hz{list(e,t={},r){return this._client.getAPIList(hW`/chat/completions/${e}/messages`,hS,{query:t,...r})}}function hG(e){return void 0!==e&&"function"in e&&void 0!==e.function}function hK(e){return e?.$brand==="auto-parseable-response-format"}function hJ(e){return e?.$brand==="auto-parseable-tool"}function hQ(e,t){let r=e.choices.map(e=>{var r;if("length"===e.finish_reason)throw new cP;if("content_filter"===e.finish_reason)throw new cj;return hX(e.message.tool_calls),{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:e.message.tool_calls?.map(e=>(function(e,t){let r=e.tools?.find(e=>hG(e)&&e.function?.name===t.function.name);return{...t,function:{...t.function,parsed_arguments:hJ(r)?r.$parseRaw(t.function.arguments):r?.function.strict?JSON.parse(t.function.arguments):null}}})(t,e))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?(r=e.message.content,t.response_format?.type!=="json_schema"?null:t.response_format?.type==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(r):JSON.parse(r):null):null}}});return{...e,choices:r}}function hZ(e){return!!hK(e.response_format)||(e.tools?.some(e=>hJ(e)||"function"===e.type&&!0===e.function.strict)??!1)}function hX(e){for(let t of e||[])if("function"!==t.type)throw new cb(`Currently only \`function\` tool calls are supported; Received \`${t.type}\``)}let hY=e=>e?.role==="assistant",h0=e=>e?.role==="tool";class h1{constructor(){R.add(this),this.controller=new AbortController,I.set(this,void 0),P.set(this,()=>{}),j.set(this,()=>{}),D.set(this,void 0),L.set(this,()=>{}),$.set(this,()=>{}),F.set(this,{}),M.set(this,!1),B.set(this,!1),U.set(this,!1),z.set(this,!1),cm(this,I,new Promise((e,t)=>{cm(this,P,e,"f"),cm(this,j,t,"f")}),"f"),cm(this,D,new Promise((e,t)=>{cm(this,L,e,"f"),cm(this,$,t,"f")}),"f"),cg(this,I,"f").catch(()=>{}),cg(this,D,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},cg(this,R,"m",q).bind(this))},0)}_connected(){this.ended||(cg(this,P,"f").call(this),this._emit("connect"))}get ended(){return cg(this,M,"f")}get errored(){return cg(this,B,"f")}get aborted(){return cg(this,U,"f")}abort(){this.controller.abort()}on(e,t){return(cg(this,F,"f")[e]||(cg(this,F,"f")[e]=[])).push({listener:t}),this}off(e,t){let r=cg(this,F,"f")[e];if(!r)return this;let i=r.findIndex(e=>e.listener===t);return i>=0&&r.splice(i,1),this}once(e,t){return(cg(this,F,"f")[e]||(cg(this,F,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{cm(this,z,!0,"f"),"error"!==e&&this.once("error",r),this.once(e,t)})}async done(){cm(this,z,!0,"f"),await cg(this,D,"f")}_emit(e,...t){if(cg(this,M,"f"))return;"end"===e&&(cm(this,M,!0,"f"),cg(this,L,"f").call(this));let r=cg(this,F,"f")[e];if(r&&(cg(this,F,"f")[e]=r.filter(e=>!e.once),r.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];cg(this,z,"f")||r?.length||Promise.reject(e),cg(this,j,"f").call(this,e),cg(this,$,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];cg(this,z,"f")||r?.length||Promise.reject(e),cg(this,j,"f").call(this,e),cg(this,$,"f").call(this,e),this._emit("end")}}_emitFinal(){}}I=new WeakMap,P=new WeakMap,j=new WeakMap,D=new WeakMap,L=new WeakMap,$=new WeakMap,F=new WeakMap,M=new WeakMap,B=new WeakMap,U=new WeakMap,z=new WeakMap,R=new WeakSet,q=function(e){if(cm(this,B,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new cx),e instanceof cx)return cm(this,U,!0,"f"),this._emit("abort",e);if(e instanceof cb)return this._emit("error",e);if(e instanceof Error){let t=new cb(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new cb(String(e)))};class h2 extends h1{constructor(){super(...arguments),H.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);let t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),h0(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(hY(e)&&e.tool_calls)for(let t of e.tool_calls)"function"===t.type&&this._emit("functionToolCall",t.function)}}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new cb("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),cg(this,H,"m",W).call(this)}async finalMessage(){return await this.done(),cg(this,H,"m",V).call(this)}async finalFunctionToolCall(){return await this.done(),cg(this,H,"m",G).call(this)}async finalFunctionToolCallResult(){return await this.done(),cg(this,H,"m",K).call(this)}async totalUsage(){return await this.done(),cg(this,H,"m",J).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=cg(this,H,"m",V).call(this);t&&this._emit("finalMessage",t);let r=cg(this,H,"m",W).call(this);r&&this._emit("finalContent",r);let i=cg(this,H,"m",G).call(this);i&&this._emit("finalFunctionToolCall",i);let n=cg(this,H,"m",K).call(this);null!=n&&this._emit("finalFunctionToolCallResult",n),this._chatCompletions.some(e=>e.usage)&&this._emit("totalUsage",cg(this,H,"m",J).call(this))}async _createChatCompletion(e,t,r){let i=r?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),cg(this,H,"m",Q).call(this,t);let n=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(hQ(n,t))}async _runChatCompletion(e,t,r){for(let e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,r)}async _runTools(e,t,r){let i="tool",{tool_choice:n="auto",stream:s,...a}=t,o="string"!=typeof n&&"function"===n.type&&n?.function?.name,{maxChatCompletions:l=10}=r||{},u=t.tools.map(e=>{if(hJ(e)){if(!e.$callback)throw new cb("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e}),c={};for(let e of u)"function"===e.type&&(c[e.function.name||e.function.function.name]=e.function);let h="tools"in t?u.map(e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e):void 0;for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){let t=await this._createChatCompletion(e,{...a,tool_choice:n,tools:h,messages:[...this.messages]},r),s=t.choices[0]?.message;if(!s)throw new cb("missing message in ChatCompletion response");if(!s.tool_calls?.length)break;for(let e of s.tool_calls){let t;if("function"!==e.type)continue;let r=e.id,{name:n,arguments:s}=e.function,a=c[n];if(a){if(o&&o!==n){let e=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:i,tool_call_id:r,content:e});continue}}else{let e=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${Object.keys(c).map(e=>JSON.stringify(e)).join(", ")}. Please try again`;this._addMessage({role:i,tool_call_id:r,content:e});continue}try{t="function"==typeof a.parse?await a.parse(s):s}catch(t){let e=t instanceof Error?t.message:String(t);this._addMessage({role:i,tool_call_id:r,content:e});continue}let l=await a.function(t,this),u=cg(this,H,"m",Z).call(this,l);if(this._addMessage({role:i,tool_call_id:r,content:u}),o)return}}}}H=new WeakSet,W=function(){return cg(this,H,"m",V).call(this).content??null},V=function(){let e=this.messages.length;for(;e-- >0;){let t=this.messages[e];if(hY(t))return{...t,content:t.content??null,refusal:t.refusal??null}}throw new cb("stream ended without producing a ChatCompletionMessage with role=assistant")},G=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(hY(t)&&t?.tool_calls?.length)return t.tool_calls.filter(e=>"function"===e.type).at(-1)?.function}},K=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(h0(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some(e=>"assistant"===e.role&&e.tool_calls?.some(e=>"function"===e.type&&e.id===t.tool_call_id)))return t.content}},J=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Q=function(e){if(null!=e.n&&e.n>1)throw new cb("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Z=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class h5 extends h2{static runTools(e,t,r){let i=new h5,n={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,t,n)),i}_addMessage(e,t=!0){super._addMessage(e,t),hY(e)&&e.content&&this._emit("content",e.content)}}let h6={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,ALL:511};class h3 extends Error{}class h4 extends Error{}let h8=(e,t)=>{let r=e.length,i=0,n=e=>{throw new h3(`${e} at position ${i}`)},s=e=>{throw new h4(`${e} at position ${i}`)},a=()=>(h(),i>=r&&n("Unexpected end of input"),'"'===e[i])?o():"{"===e[i]?l():"["===e[i]?u():"null"===e.substring(i,i+4)||h6.NULL&t&&r-i<4&&"null".startsWith(e.substring(i))?(i+=4,null):"true"===e.substring(i,i+4)||h6.BOOL&t&&r-i<4&&"true".startsWith(e.substring(i))?(i+=4,!0):"false"===e.substring(i,i+5)||h6.BOOL&t&&r-i<5&&"false".startsWith(e.substring(i))?(i+=5,!1):"Infinity"===e.substring(i,i+8)||h6.INFINITY&t&&r-i<8&&"Infinity".startsWith(e.substring(i))?(i+=8,1/0):"-Infinity"===e.substring(i,i+9)||h6.MINUS_INFINITY&t&&1<r-i&&r-i<9&&"-Infinity".startsWith(e.substring(i))?(i+=9,-1/0):"NaN"===e.substring(i,i+3)||h6.NAN&t&&r-i<3&&"NaN".startsWith(e.substring(i))?(i+=3,NaN):c(),o=()=>{let a=i,o=!1;for(i++;i<r&&('"'!==e[i]||o&&"\\"===e[i-1]);)o="\\"===e[i]&&!o,i++;if('"'==e.charAt(i))try{return JSON.parse(e.substring(a,++i-Number(o)))}catch(e){s(String(e))}else if(h6.STR&t)try{return JSON.parse(e.substring(a,i-Number(o))+'"')}catch(t){return JSON.parse(e.substring(a,e.lastIndexOf("\\"))+'"')}n("Unterminated string literal")},l=()=>{i++,h();let s={};try{for(;"}"!==e[i];){if(h(),i>=r&&h6.OBJ&t)return s;let n=o();h(),i++;try{let e=a();Object.defineProperty(s,n,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(e){if(h6.OBJ&t)return s;throw e}h(),","===e[i]&&i++}}catch(e){if(h6.OBJ&t)return s;n("Expected '}' at end of object")}return i++,s},u=()=>{i++;let r=[];try{for(;"]"!==e[i];)r.push(a()),h(),","===e[i]&&i++}catch(e){if(h6.ARR&t)return r;n("Expected ']' at end of array")}return i++,r},c=()=>{if(0===i){"-"===e&&h6.NUM&t&&n("Not sure what '-' is");try{return JSON.parse(e)}catch(r){if(h6.NUM&t)try{if("."===e[e.length-1])return JSON.parse(e.substring(0,e.lastIndexOf(".")));return JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}s(String(r))}}let a=i;for("-"===e[i]&&i++;e[i]&&!",]}".includes(e[i]);)i++;i!=r||h6.NUM&t||n("Unterminated number literal");try{return JSON.parse(e.substring(a,i))}catch(r){"-"===e.substring(a,i)&&h6.NUM&t&&n("Not sure what '-' is");try{return JSON.parse(e.substring(a,e.lastIndexOf("e")))}catch(e){s(String(e))}}},h=()=>{for(;i<r&&" \n\r	".includes(e[i]);)i++};return a()},h7=e=>(function(e,t=h6.ALL){if("string"!=typeof e)throw TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw Error(`${e} is empty`);return h8(e.trim(),t)})(e,h6.ALL^h6.NUM);class h9 extends h2{constructor(e){super(),X.add(this),Y.set(this,void 0),ee.set(this,void 0),et.set(this,void 0),cm(this,Y,e,"f"),cm(this,ee,[],"f")}get currentChatCompletionSnapshot(){return cg(this,et,"f")}static fromReadableStream(e){let t=new h9(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){let i=new h9(t);return i._run(()=>i._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createChatCompletion(e,t,r){super._createChatCompletion;let i=r?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),cg(this,X,"m",er).call(this);let n=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});for await(let e of(this._connected(),n))cg(this,X,"m",en).call(this,e);if(n.controller.signal?.aborted)throw new cx;return this._addChatCompletion(cg(this,X,"m",eo).call(this))}async _fromReadableStream(e,t){let r;let i=t?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),cg(this,X,"m",er).call(this),this._connected();let n=hp.fromReadableStream(e,this.controller);for await(let e of n)r&&r!==e.id&&this._addChatCompletion(cg(this,X,"m",eo).call(this)),cg(this,X,"m",en).call(this,e),r=e.id;if(n.controller.signal?.aborted)throw new cx;return this._addChatCompletion(cg(this,X,"m",eo).call(this))}[(Y=new WeakMap,ee=new WeakMap,et=new WeakMap,X=new WeakSet,er=function(){this.ended||cm(this,et,void 0,"f")},ei=function(e){let t=cg(this,ee,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},cg(this,ee,"f")[e.index]=t),t},en=function(e){if(this.ended)return;let t=cg(this,X,"m",eu).call(this,e);for(let r of(this._emit("chunk",e,t),e.choices)){let e=t.choices[r.index];null!=r.delta.content&&e.message?.role==="assistant"&&e.message?.content&&(this._emit("content",r.delta.content,e.message.content),this._emit("content.delta",{delta:r.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=r.delta.refusal&&e.message?.role==="assistant"&&e.message?.refusal&&this._emit("refusal.delta",{delta:r.delta.refusal,snapshot:e.message.refusal}),r.logprobs?.content!=null&&e.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:r.logprobs?.content,snapshot:e.logprobs?.content??[]}),r.logprobs?.refusal!=null&&e.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:r.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});let i=cg(this,X,"m",ei).call(this,e);for(let t of(e.finish_reason&&(cg(this,X,"m",ea).call(this,e),null!=i.current_tool_call_index&&cg(this,X,"m",es).call(this,e,i.current_tool_call_index)),r.delta.tool_calls??[]))i.current_tool_call_index!==t.index&&(cg(this,X,"m",ea).call(this,e),null!=i.current_tool_call_index&&cg(this,X,"m",es).call(this,e,i.current_tool_call_index)),i.current_tool_call_index=t.index;for(let t of r.delta.tool_calls??[]){let r=e.message.tool_calls?.[t.index];r?.type&&(r?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:r.function?.name,index:t.index,arguments:r.function.arguments,parsed_arguments:r.function.parsed_arguments,arguments_delta:t.function?.arguments??""}):r?.type)}}},es=function(e,t){if(cg(this,X,"m",ei).call(this,e).done_tool_calls.has(t))return;let r=e.message.tool_calls?.[t];if(!r)throw Error("no tool call snapshot");if(!r.type)throw Error("tool call snapshot missing `type`");if("function"===r.type){let e=cg(this,Y,"f")?.tools?.find(e=>hG(e)&&e.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:t,arguments:r.function.arguments,parsed_arguments:hJ(e)?e.$parseRaw(r.function.arguments):e?.function.strict?JSON.parse(r.function.arguments):null})}else r.type},ea=function(e){let t=cg(this,X,"m",ei).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;let r=cg(this,X,"m",el).call(this);this._emit("content.done",{content:e.message.content,parsed:r?r.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},eo=function(){if(this.ended)throw new cb("stream has ended, this shouldn't happen");let e=cg(this,et,"f");if(!e)throw new cb("request ended without sending any chunks");return cm(this,et,void 0,"f"),cm(this,ee,[],"f"),function(e,t){var r;let{id:i,choices:n,created:s,model:a,system_fingerprint:o,...l}=e;return r={...l,id:i,choices:n.map(({message:t,finish_reason:r,index:i,logprobs:n,...s})=>{if(!r)throw new cb(`missing finish_reason for choice ${i}`);let{content:a=null,function_call:o,tool_calls:l,...u}=t,c=t.role;if(!c)throw new cb(`missing role for choice ${i}`);if(o){let{arguments:e,name:l}=o;if(null==e)throw new cb(`missing function_call.arguments for choice ${i}`);if(!l)throw new cb(`missing function_call.name for choice ${i}`);return{...s,message:{content:a,function_call:{arguments:e,name:l},role:c,refusal:t.refusal??null},finish_reason:r,index:i,logprobs:n}}return l?{...s,index:i,finish_reason:r,logprobs:n,message:{...u,role:c,content:a,refusal:t.refusal??null,tool_calls:l.map((t,r)=>{let{function:n,type:s,id:a,...o}=t,{arguments:l,name:u,...c}=n||{};if(null==a)throw new cb(`missing choices[${i}].tool_calls[${r}].id
${de(e)}`);if(null==s)throw new cb(`missing choices[${i}].tool_calls[${r}].type
${de(e)}`);if(null==u)throw new cb(`missing choices[${i}].tool_calls[${r}].function.name
${de(e)}`);if(null==l)throw new cb(`missing choices[${i}].tool_calls[${r}].function.arguments
${de(e)}`);return{...o,id:a,type:s,function:{...c,name:u,arguments:l}}})}}:{...s,message:{...u,content:a,role:c,refusal:t.refusal??null},finish_reason:r,index:i,logprobs:n}}),created:s,model:a,object:"chat.completion",...o?{system_fingerprint:o}:{}},t&&hZ(t)?hQ(r,t):{...r,choices:r.choices.map(e=>(hX(e.message.tool_calls),{...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}}))}}(e,cg(this,Y,"f"))},el=function(){let e=cg(this,Y,"f")?.response_format;return hK(e)?e:null},eu=function(e){var t,r,i,n;let s=cg(this,et,"f"),{choices:a,...o}=e;for(let{delta:a,finish_reason:l,index:u,logprobs:c=null,...h}of(s?Object.assign(s,o):s=cm(this,et,{...o,choices:[]},"f"),e.choices)){let e=s.choices[u];if(e||(e=s.choices[u]={finish_reason:l,index:u,message:{},logprobs:c,...h}),c){if(e.logprobs){let{content:i,refusal:n,...s}=c;Object.assign(e.logprobs,s),i&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...i)),n&&((r=e.logprobs).refusal??(r.refusal=[]),e.logprobs.refusal.push(...n))}else e.logprobs=Object.assign({},c)}if(l&&(e.finish_reason=l,cg(this,Y,"f")&&hZ(cg(this,Y,"f")))){if("length"===l)throw new cP;if("content_filter"===l)throw new cj}if(Object.assign(e,h),!a)continue;let{content:o,refusal:d,function_call:p,role:f,tool_calls:m,...g}=a;if(Object.assign(e.message,g),d&&(e.message.refusal=(e.message.refusal||"")+d),f&&(e.message.role=f),p&&(e.message.function_call?(p.name&&(e.message.function_call.name=p.name),p.arguments&&((i=e.message.function_call).arguments??(i.arguments=""),e.message.function_call.arguments+=p.arguments)):e.message.function_call=p),o&&(e.message.content=(e.message.content||"")+o,!e.message.refusal&&cg(this,X,"m",el).call(this)&&(e.message.parsed=h7(e.message.content))),m)for(let{index:t,id:r,type:i,function:s,...a}of(e.message.tool_calls||(e.message.tool_calls=[]),m)){let o=(n=e.message.tool_calls)[t]??(n[t]={});Object.assign(o,a),r&&(o.id=r),i&&(o.type=i),s&&(o.function??(o.function={name:s.name??"",arguments:""})),s?.name&&(o.function.name=s.name),s?.arguments&&(o.function.arguments+=s.arguments,function(e,t){if(!e||!("tools"in e)||!e.tools)return!1;let r=e.tools?.find(e=>hG(e)&&e.function?.name===t.function.name);return hG(r)&&(hJ(r)||r?.function.strict||!1)}(cg(this,Y,"f"),o)&&(o.function.parsed_arguments=h7(o.function.arguments)))}}return s},Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("chunk",r=>{let i=t.shift();i?i.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let i of(r=!0,t))i.reject(e);t.length=0}),this.on("error",e=>{for(let i of(r=!0,t))i.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new hp(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function de(e){return JSON.stringify(e)}class dt extends h9{static fromReadableStream(e){let t=new dt(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,r){let i=new dt(t),n={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,t,n)),i}}class dr extends hz{constructor(){super(...arguments),this.messages=new hV(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(hW`/chat/completions/${e}`,t)}update(e,t,r){return this._client.post(hW`/chat/completions/${e}`,{body:t,...r})}list(e={},t){return this._client.getAPIList("/chat/completions",hS,{query:e,...t})}delete(e,t){return this._client.delete(hW`/chat/completions/${e}`,t)}parse(e,t){return function(e){for(let t of e??[]){if("function"!==t.type)throw new cb(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new cb(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(t=>hQ(t,e))}runTools(e,t){return e.stream?dt.runTools(this._client,e,t):h5.runTools(this._client,e,t)}stream(e,t){return h9.createChatCompletion(this._client,e,t)}}dr.Messages=hV;class di extends hz{constructor(){super(...arguments),this.completions=new dr(this._client)}}di.Completions=dr;let dn=Symbol("brand.privateNullableHeaders"),ds=e=>{let t=new Headers,r=new Set;for(let i of e){let e=new Set;for(let[n,s]of function*(e){let t;if(!e)return;if(dn in e){let{values:t,nulls:r}=e;for(let e of(yield*t.entries(),r))yield[e,null];return}let r=!1;for(let i of(e instanceof Headers?t=e.entries():cM(e)?t=e:(r=!0,t=Object.entries(e??{})),t)){let e=i[0];if("string"!=typeof e)throw TypeError("expected header name to be a string");let t=cM(i[1])?i[1]:[i[1]],n=!1;for(let i of t)void 0!==i&&(r&&!n&&(n=!0,yield[e,null]),yield[e,i])}}(i)){let i=n.toLowerCase();e.has(i)||(t.delete(n),e.add(i)),null===s?(t.delete(n),r.add(i)):(t.append(n,s),r.delete(i))}}return{[dn]:!0,values:t,nulls:r}};class da extends hz{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:ds([{Accept:"application/octet-stream"},t?.headers]),__binaryResponse:!0})}}class dl extends hz{create(e,t){return this._client.post("/audio/transcriptions",hN({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class du extends hz{create(e,t){return this._client.post("/audio/translations",hN({body:e,...t,__metadata:{model:e.model}},this._client))}}class dc extends hz{constructor(){super(...arguments),this.transcriptions=new dl(this._client),this.translations=new du(this._client),this.speech=new da(this._client)}}dc.Transcriptions=dl,dc.Translations=du,dc.Speech=da;class dh extends hz{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(hW`/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/batches",hS,{query:e,...t})}cancel(e,t){return this._client.post(hW`/batches/${e}/cancel`,t)}}class dd extends hz{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(hW`/assistants/${e}`,{...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,r){return this._client.post(hW`/assistants/${e}`,{body:t,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e={},t){return this._client.getAPIList("/assistants",hS,{query:e,...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(hW`/assistants/${e}`,{...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}class dp extends hz{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}class df extends hz{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}class dm extends hz{constructor(){super(...arguments),this.sessions=new dp(this._client),this.transcriptionSessions=new df(this._client)}}dm.Sessions=dp,dm.TranscriptionSessions=df;class dg extends hz{create(e,t){return this._client.post("/chatkit/sessions",{body:e,...t,headers:ds([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}cancel(e,t){return this._client.post(hW`/chatkit/sessions/${e}/cancel`,{...t,headers:ds([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}}class dy extends hz{retrieve(e,t){return this._client.get(hW`/chatkit/threads/${e}`,{...t,headers:ds([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}list(e={},t){return this._client.getAPIList("/chatkit/threads",hE,{query:e,...t,headers:ds([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}delete(e,t){return this._client.delete(hW`/chatkit/threads/${e}`,{...t,headers:ds([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}listItems(e,t={},r){return this._client.getAPIList(hW`/chatkit/threads/${e}/items`,hE,{query:t,...r,headers:ds([{"OpenAI-Beta":"chatkit_beta=v1"},r?.headers])})}}class d_ extends hz{constructor(){super(...arguments),this.sessions=new dg(this._client),this.threads=new dy(this._client)}}d_.Sessions=dg,d_.Threads=dy;class dv extends hz{create(e,t,r){return this._client.post(hW`/threads/${e}/messages`,{body:t,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,t,r){let{thread_id:i}=t;return this._client.get(hW`/threads/${i}/messages/${e}`,{...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,t,r){let{thread_id:i,...n}=t;return this._client.post(hW`/threads/${i}/messages/${e}`,{body:n,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t={},r){return this._client.getAPIList(hW`/threads/${e}/messages`,hS,{query:t,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,t,r){let{thread_id:i}=t;return this._client.delete(hW`/threads/${i}/messages/${e}`,{...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}class db extends hz{retrieve(e,t,r){let{thread_id:i,run_id:n,...s}=t;return this._client.get(hW`/threads/${i}/runs/${n}/steps/${e}`,{query:s,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t,r){let{thread_id:i,...n}=t;return this._client.getAPIList(hW`/threads/${i}/runs/${e}/steps`,hS,{query:n,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}let dw=e=>{if("undefined"!=typeof Buffer){let t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}{let t=atob(e),r=t.length,i=new Uint8Array(r);for(let e=0;e<r;e++)i[e]=t.charCodeAt(e);return Array.from(new Float32Array(i.buffer))}},dx=e=>void 0!==globalThis.process?globalThis.process.env?.[e]?.trim()??void 0:void 0!==globalThis.Deno?globalThis.Deno.env?.get?.(e)?.trim():void 0;class dS extends h1{constructor(){super(...arguments),ec.add(this),ed.set(this,[]),ep.set(this,{}),ef.set(this,{}),em.set(this,void 0),eg.set(this,void 0),ey.set(this,void 0),e_.set(this,void 0),ev.set(this,void 0),eb.set(this,void 0),ew.set(this,void 0),ex.set(this,void 0),eS.set(this,void 0)}[(ed=new WeakMap,ep=new WeakMap,ef=new WeakMap,em=new WeakMap,eg=new WeakMap,ey=new WeakMap,e_=new WeakMap,ev=new WeakMap,eb=new WeakMap,ew=new WeakMap,ex=new WeakMap,eS=new WeakMap,ec=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("event",r=>{let i=t.shift();i?i.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let i of(r=!0,t))i.reject(e);t.length=0}),this.on("error",e=>{for(let i of(r=!0,t))i.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let t=new eh;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){let r=t?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();let i=hp.fromReadableStream(e,this.controller);for await(let e of i)cg(this,ec,"m",eE).call(this,e);if(i.controller.signal?.aborted)throw new cx;return this._addRun(cg(this,ec,"m",eT).call(this))}toReadableStream(){return new hp(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,i){let n=new eh;return n._run(()=>n._runToolAssistantStream(e,t,r,{...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createToolAssistantStream(e,t,r,i){let n=i?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));let s={...r,stream:!0},a=await e.submitToolOutputs(t,s,{...i,signal:this.controller.signal});for await(let e of(this._connected(),a))cg(this,ec,"m",eE).call(this,e);if(a.controller.signal?.aborted)throw new cx;return this._addRun(cg(this,ec,"m",eT).call(this))}static createThreadAssistantStream(e,t,r){let i=new eh;return i._run(()=>i._threadAssistantStream(e,t,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),i}static createAssistantStream(e,t,r,i){let n=new eh;return n._run(()=>n._runAssistantStream(e,t,r,{...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"stream"}})),n}currentEvent(){return cg(this,ew,"f")}currentRun(){return cg(this,ex,"f")}currentMessageSnapshot(){return cg(this,em,"f")}currentRunStepSnapshot(){return cg(this,eS,"f")}async finalRunSteps(){return await this.done(),Object.values(cg(this,ep,"f"))}async finalMessages(){return await this.done(),Object.values(cg(this,ef,"f"))}async finalRun(){if(await this.done(),!cg(this,eg,"f"))throw Error("Final run was not received.");return cg(this,eg,"f")}async _createThreadAssistantStream(e,t,r){let i=r?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));let n={...t,stream:!0},s=await e.createAndRun(n,{...r,signal:this.controller.signal});for await(let e of(this._connected(),s))cg(this,ec,"m",eE).call(this,e);if(s.controller.signal?.aborted)throw new cx;return this._addRun(cg(this,ec,"m",eT).call(this))}async _createAssistantStream(e,t,r,i){let n=i?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));let s={...r,stream:!0},a=await e.create(t,s,{...i,signal:this.controller.signal});for await(let e of(this._connected(),a))cg(this,ec,"m",eE).call(this,e);if(a.controller.signal?.aborted)throw new cx;return this._addRun(cg(this,ec,"m",eT).call(this))}static accumulateDelta(e,t){for(let[r,i]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=i;continue}let t=e[r];if(null==t||"index"===r||"type"===r){e[r]=i;continue}if("string"==typeof t&&"string"==typeof i)t+=i;else if("number"==typeof t&&"number"==typeof i)t+=i;else if(cU(t)&&cU(i))t=this.accumulateDelta(t,i);else if(Array.isArray(t)&&Array.isArray(i)){if(t.every(e=>"string"==typeof e||"number"==typeof e)){t.push(...i);continue}for(let e of i){if(!cU(e))throw Error(`Expected array delta entry to be an object but got: ${e}`);let r=e.index;if(null==r)throw console.error(e),Error("Expected array delta entry to have an `index` property");if("number"!=typeof r)throw Error(`Expected array delta entry \`index\` property to be a number but got ${r}`);let i=t[r];null==i?t.push(e):t[r]=this.accumulateDelta(i,e)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${i}, accValue: ${t}`);e[r]=t}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,i){return await this._createAssistantStream(t,e,r,i)}async _runToolAssistantStream(e,t,r,i){return await this._createToolAssistantStream(t,e,r,i)}}eh=dS,eE=function(e){if(!this.ended)switch(cm(this,ew,e,"f"),cg(this,ec,"m",eC).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":cg(this,ec,"m",eI).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":cg(this,ec,"m",eO).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":cg(this,ec,"m",ek).call(this,e);break;case"error":throw Error("Encountered an error event in event processing - errors should be processed earlier")}},eT=function(){if(this.ended)throw new cb("stream has ended, this shouldn't happen");if(!cg(this,eg,"f"))throw Error("Final run has not been received");return cg(this,eg,"f")},ek=function(e){let[t,r]=cg(this,ec,"m",eN).call(this,e,cg(this,em,"f"));for(let e of(cm(this,em,t,"f"),cg(this,ef,"f")[t.id]=t,r)){let r=t.content[e.index];r?.type=="text"&&this._emit("textCreated",r.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let r of e.data.delta.content){if("text"==r.type&&r.text){let e=r.text,i=t.content[r.index];if(i&&"text"==i.type)this._emit("textDelta",e,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=cg(this,ey,"f")){if(cg(this,e_,"f"))switch(cg(this,e_,"f").type){case"text":this._emit("textDone",cg(this,e_,"f").text,cg(this,em,"f"));break;case"image_file":this._emit("imageFileDone",cg(this,e_,"f").image_file,cg(this,em,"f"))}cm(this,ey,r.index,"f")}cm(this,e_,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==cg(this,ey,"f")){let t=e.data.content[cg(this,ey,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,cg(this,em,"f"));break;case"text":this._emit("textDone",t.text,cg(this,em,"f"))}}cg(this,em,"f")&&this._emit("messageDone",e.data),cm(this,em,void 0,"f")}},eO=function(e){let t=cg(this,ec,"m",eA).call(this,e);switch(cm(this,eS,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let r=e.data.delta;if(r.step_details&&"tool_calls"==r.step_details.type&&r.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(let e of r.step_details.tool_calls)e.index==cg(this,ev,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(cg(this,eb,"f")&&this._emit("toolCallDone",cg(this,eb,"f")),cm(this,ev,e.index,"f"),cm(this,eb,t.step_details.tool_calls[e.index],"f"),cg(this,eb,"f")&&this._emit("toolCallCreated",cg(this,eb,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":cm(this,eS,void 0,"f"),"tool_calls"==e.data.step_details.type&&cg(this,eb,"f")&&(this._emit("toolCallDone",cg(this,eb,"f")),cm(this,eb,void 0,"f")),this._emit("runStepDone",e.data,t)}},eC=function(e){cg(this,ed,"f").push(e),this._emit("event",e)},eA=function(e){switch(e.event){case"thread.run.step.created":return cg(this,ep,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=cg(this,ep,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){let i=eh.accumulateDelta(t,r.delta);cg(this,ep,"f")[e.data.id]=i}return cg(this,ep,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":cg(this,ep,"f")[e.data.id]=e.data}if(cg(this,ep,"f")[e.data.id])return cg(this,ep,"f")[e.data.id];throw Error("No snapshot available")},eN=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let i=e.data;if(i.delta.content)for(let e of i.delta.content)if(e.index in t.content){let r=t.content[e.index];t.content[e.index]=cg(this,ec,"m",eR).call(this,e,r)}else t.content[e.index]=e,r.push(e);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},eR=function(e,t){return eh.accumulateDelta(t,e)},eI=function(e){switch(cm(this,ex,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":cm(this,eg,e.data,"f"),cg(this,eb,"f")&&(this._emit("toolCallDone",cg(this,eb,"f")),cm(this,eb,void 0,"f"))}};class dE extends hz{constructor(){super(...arguments),this.steps=new db(this._client)}create(e,t,r){let{include:i,...n}=t;return this._client.post(hW`/threads/${e}/runs`,{query:{include:i},body:n,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers]),stream:t.stream??!1})}retrieve(e,t,r){let{thread_id:i}=t;return this._client.get(hW`/threads/${i}/runs/${e}`,{...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,t,r){let{thread_id:i,...n}=t;return this._client.post(hW`/threads/${i}/runs/${e}`,{body:n,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t={},r){return this._client.getAPIList(hW`/threads/${e}/runs`,hS,{query:t,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}cancel(e,t,r){let{thread_id:i}=t;return this._client.post(hW`/threads/${i}/runs/${e}/cancel`,{...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,t,r){let i=await this.create(e,t,r);return await this.poll(i.id,{thread_id:e},r)}createAndStream(e,t,r){return dS.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){let i=ds([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:n,response:s}=await this.retrieve(e,t,{...r,headers:{...r?.headers,...i}}).withResponse();switch(n.status){case"queued":case"in_progress":case"cancelling":let a=5e3;if(r?.pollIntervalMs)a=r.pollIntervalMs;else{let e=s.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(a=t)}}await cH(a);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return n}}}stream(e,t,r){return dS.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r){let{thread_id:i,...n}=t;return this._client.post(hW`/threads/${i}/runs/${e}/submit_tool_outputs`,{body:n,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers]),stream:t.stream??!1})}async submitToolOutputsAndPoll(e,t,r){let i=await this.submitToolOutputs(e,t,r);return await this.poll(i.id,t,r)}submitToolOutputsStream(e,t,r){return dS.createToolAssistantStream(e,this._client.beta.threads.runs,t,r)}}dE.Steps=db;class dT extends hz{constructor(){super(...arguments),this.runs=new dE(this._client),this.messages=new dv(this._client)}create(e={},t){return this._client.post("/threads",{body:e,...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(hW`/threads/${e}`,{...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,r){return this._client.post(hW`/threads/${e}`,{body:t,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,t){return this._client.delete(hW`/threads/${e}`,{...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers]),stream:e.stream??!1})}async createAndRunPoll(e,t){let r=await this.createAndRun(e,t);return await this.runs.poll(r.id,{thread_id:r.thread_id},t)}createAndRunStream(e,t){return dS.createThreadAssistantStream(e,this._client.beta.threads,t)}}dT.Runs=dE,dT.Messages=dv;class dk extends hz{constructor(){super(...arguments),this.realtime=new dm(this._client),this.chatkit=new d_(this._client),this.assistants=new dd(this._client),this.threads=new dT(this._client)}}dk.Realtime=dm,dk.ChatKit=d_,dk.Assistants=dd,dk.Threads=dT;class dO extends hz{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class dC extends hz{retrieve(e,t,r){let{container_id:i}=t;return this._client.get(hW`/containers/${i}/files/${e}/content`,{...r,headers:ds([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0})}}class dA extends hz{constructor(){super(...arguments),this.content=new dC(this._client)}create(e,t,r){return this._client.post(hW`/containers/${e}/files`,hN({body:t,...r},this._client))}retrieve(e,t,r){let{container_id:i}=t;return this._client.get(hW`/containers/${i}/files/${e}`,r)}list(e,t={},r){return this._client.getAPIList(hW`/containers/${e}/files`,hS,{query:t,...r})}delete(e,t,r){let{container_id:i}=t;return this._client.delete(hW`/containers/${i}/files/${e}`,{...r,headers:ds([{Accept:"*/*"},r?.headers])})}}dA.Content=dC;class dN extends hz{constructor(){super(...arguments),this.files=new dA(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(hW`/containers/${e}`,t)}list(e={},t){return this._client.getAPIList("/containers",hS,{query:e,...t})}delete(e,t){return this._client.delete(hW`/containers/${e}`,{...t,headers:ds([{Accept:"*/*"},t?.headers])})}}dN.Files=dA;class dR extends hz{create(e,t,r){let{include:i,...n}=t;return this._client.post(hW`/conversations/${e}/items`,{query:{include:i},body:n,...r})}retrieve(e,t,r){let{conversation_id:i,...n}=t;return this._client.get(hW`/conversations/${i}/items/${e}`,{query:n,...r})}list(e,t={},r){return this._client.getAPIList(hW`/conversations/${e}/items`,hE,{query:t,...r})}delete(e,t,r){let{conversation_id:i}=t;return this._client.delete(hW`/conversations/${i}/items/${e}`,r)}}class dI extends hz{constructor(){super(...arguments),this.items=new dR(this._client)}create(e={},t){return this._client.post("/conversations",{body:e,...t})}retrieve(e,t){return this._client.get(hW`/conversations/${e}`,t)}update(e,t,r){return this._client.post(hW`/conversations/${e}`,{body:t,...r})}delete(e,t){return this._client.delete(hW`/conversations/${e}`,t)}}dI.Items=dR;class dP extends hz{create(e,t){let r=!!e.encoding_format,i=r?e.encoding_format:"base64";r&&hh(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);let n=this._client.post("/embeddings",{body:{...e,encoding_format:i},...t});return r?n:(hh(this._client).debug("embeddings/decoding base64 embeddings from base64"),n._thenUnwrap(e=>(e&&e.data&&e.data.forEach(e=>{let t=e.embedding;e.embedding=dw(t)}),e)))}}class dj extends hz{retrieve(e,t,r){let{eval_id:i,run_id:n}=t;return this._client.get(hW`/evals/${i}/runs/${n}/output_items/${e}`,r)}list(e,t,r){let{eval_id:i,...n}=t;return this._client.getAPIList(hW`/evals/${i}/runs/${e}/output_items`,hS,{query:n,...r})}}class dD extends hz{constructor(){super(...arguments),this.outputItems=new dj(this._client)}create(e,t,r){return this._client.post(hW`/evals/${e}/runs`,{body:t,...r})}retrieve(e,t,r){let{eval_id:i}=t;return this._client.get(hW`/evals/${i}/runs/${e}`,r)}list(e,t={},r){return this._client.getAPIList(hW`/evals/${e}/runs`,hS,{query:t,...r})}delete(e,t,r){let{eval_id:i}=t;return this._client.delete(hW`/evals/${i}/runs/${e}`,r)}cancel(e,t,r){let{eval_id:i}=t;return this._client.post(hW`/evals/${i}/runs/${e}`,r)}}dD.OutputItems=dj;class dL extends hz{constructor(){super(...arguments),this.runs=new dD(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(hW`/evals/${e}`,t)}update(e,t,r){return this._client.post(hW`/evals/${e}`,{body:t,...r})}list(e={},t){return this._client.getAPIList("/evals",hS,{query:e,...t})}delete(e,t){return this._client.delete(hW`/evals/${e}`,t)}}dL.Runs=dD;class d$ extends hz{create(e,t){return this._client.post("/files",hN({body:e,...t},this._client))}retrieve(e,t){return this._client.get(hW`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",hS,{query:e,...t})}delete(e,t){return this._client.delete(hW`/files/${e}`,t)}content(e,t){return this._client.get(hW`/files/${e}/content`,{...t,headers:ds([{Accept:"application/binary"},t?.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=18e5}={}){let i=new Set(["processed","error","deleted"]),n=Date.now(),s=await this.retrieve(e);for(;!s.status||!i.has(s.status);)if(await cH(t),s=await this.retrieve(e),Date.now()-n>r)throw new cE({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return s}}class dF extends hz{}class dM extends hz{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}}class dB extends hz{constructor(){super(...arguments),this.graders=new dM(this._client)}}dB.Graders=dM;class dU extends hz{create(e,t,r){return this._client.getAPIList(hW`/fine_tuning/checkpoints/${e}/permissions`,hx,{body:t,method:"post",...r})}retrieve(e,t={},r){return this._client.get(hW`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...r})}delete(e,t,r){let{fine_tuned_model_checkpoint:i}=t;return this._client.delete(hW`/fine_tuning/checkpoints/${i}/permissions/${e}`,r)}}class dz extends hz{constructor(){super(...arguments),this.permissions=new dU(this._client)}}dz.Permissions=dU;class dq extends hz{list(e,t={},r){return this._client.getAPIList(hW`/fine_tuning/jobs/${e}/checkpoints`,hS,{query:t,...r})}}class dH extends hz{constructor(){super(...arguments),this.checkpoints=new dq(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(hW`/fine_tuning/jobs/${e}`,t)}list(e={},t){return this._client.getAPIList("/fine_tuning/jobs",hS,{query:e,...t})}cancel(e,t){return this._client.post(hW`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return this._client.getAPIList(hW`/fine_tuning/jobs/${e}/events`,hS,{query:t,...r})}pause(e,t){return this._client.post(hW`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(hW`/fine_tuning/jobs/${e}/resume`,t)}}dH.Checkpoints=dq;class dW extends hz{constructor(){super(...arguments),this.methods=new dF(this._client),this.jobs=new dH(this._client),this.checkpoints=new dz(this._client),this.alpha=new dB(this._client)}}dW.Methods=dF,dW.Jobs=dH,dW.Checkpoints=dz,dW.Alpha=dB;class dV extends hz{}class dG extends hz{constructor(){super(...arguments),this.graderModels=new dV(this._client)}}dG.GraderModels=dV;class dK extends hz{createVariation(e,t){return this._client.post("/images/variations",hN({body:e,...t},this._client))}edit(e,t){return this._client.post("/images/edits",hN({body:e,...t,stream:e.stream??!1},this._client))}generate(e,t){return this._client.post("/images/generations",{body:e,...t,stream:e.stream??!1})}}class dJ extends hz{retrieve(e,t){return this._client.get(hW`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",hx,e)}delete(e,t){return this._client.delete(hW`/models/${e}`,t)}}class dQ extends hz{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class dZ extends hz{accept(e,t,r){return this._client.post(hW`/realtime/calls/${e}/accept`,{body:t,...r,headers:ds([{Accept:"*/*"},r?.headers])})}hangup(e,t){return this._client.post(hW`/realtime/calls/${e}/hangup`,{...t,headers:ds([{Accept:"*/*"},t?.headers])})}refer(e,t,r){return this._client.post(hW`/realtime/calls/${e}/refer`,{body:t,...r,headers:ds([{Accept:"*/*"},r?.headers])})}reject(e,t={},r){return this._client.post(hW`/realtime/calls/${e}/reject`,{body:t,...r,headers:ds([{Accept:"*/*"},r?.headers])})}}class dX extends hz{create(e,t){return this._client.post("/realtime/client_secrets",{body:e,...t})}}class dY extends hz{constructor(){super(...arguments),this.clientSecrets=new dX(this._client),this.calls=new dZ(this._client)}}function d0(e,t){let r=e.output.map(e=>{if("function_call"===e.type)return{...e,parsed_arguments:function(e,t){var r,i,n;let s=(r=e.tools??[],i=t.name,r.find(e=>"function"===e.type&&e.name===i));return{...t,...t,parsed_arguments:(n=s,n?.$brand==="auto-parseable-tool")?s.$parseRaw(t.arguments):s?.strict?JSON.parse(t.arguments):null}}(t,e)};if("message"===e.type){let r=e.content.map(e=>{var r;return"output_text"===e.type?{...e,parsed:(r=e.text,t.text?.format?.type!=="json_schema"?null:"$parseRaw"in t.text?.format?(t.text?.format).$parseRaw(r):JSON.parse(r))}:e});return{...e,content:r}}return e}),i=Object.assign({},e,{output:r});return Object.getOwnPropertyDescriptor(e,"output_text")||d1(i),Object.defineProperty(i,"output_parsed",{enumerable:!0,get(){for(let e of i.output)if("message"===e.type){for(let t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed}return null}}),i}function d1(e){let t=[];for(let r of e.output)if("message"===r.type)for(let e of r.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}dY.ClientSecrets=dX,dY.Calls=dZ;class d2 extends h1{constructor(e){super(),eP.add(this),ej.set(this,void 0),eD.set(this,void 0),eL.set(this,void 0),cm(this,ej,e,"f")}static createResponse(e,t,r){let i=new d2(t);return i._run(()=>i._createOrRetrieveResponse(e,t,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createOrRetrieveResponse(e,t,r){let i;let n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),cg(this,eP,"m",e$).call(this);let s=null;for await(let n of("response_id"in t?(i=await e.responses.retrieve(t.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),s=t.starting_after??null):i=await e.responses.create({...t,stream:!0},{...r,signal:this.controller.signal}),this._connected(),i))cg(this,eP,"m",eF).call(this,n,s);if(i.controller.signal?.aborted)throw new cx;return cg(this,eP,"m",eM).call(this)}[(ej=new WeakMap,eD=new WeakMap,eL=new WeakMap,eP=new WeakSet,e$=function(){this.ended||cm(this,eD,void 0,"f")},eF=function(e,t){if(this.ended)return;let r=(e,r)=>{(null==t||r.sequence_number>t)&&this._emit(e,r)},i=cg(this,eP,"m",eB).call(this,e);switch(r("event",e),e.type){case"response.output_text.delta":{let t=i.output[e.output_index];if(!t)throw new cb(`missing output at index ${e.output_index}`);if("message"===t.type){let i=t.content[e.content_index];if(!i)throw new cb(`missing content at index ${e.content_index}`);if("output_text"!==i.type)throw new cb(`expected content to be 'output_text', got ${i.type}`);r("response.output_text.delta",{...e,snapshot:i.text})}break}case"response.function_call_arguments.delta":{let t=i.output[e.output_index];if(!t)throw new cb(`missing output at index ${e.output_index}`);"function_call"===t.type&&r("response.function_call_arguments.delta",{...e,snapshot:t.arguments});break}default:r(e.type,e)}},eM=function(){if(this.ended)throw new cb("stream has ended, this shouldn't happen");let e=cg(this,eD,"f");if(!e)throw new cb("request ended without sending any events");cm(this,eD,void 0,"f");let t=function(e,t){return t&&hK(t.text?.format)?d0(e,t):{...e,output_parsed:null,output:e.output.map(e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map(e=>({...e,parsed:null}))}:e)}}(e,cg(this,ej,"f"));return cm(this,eL,t,"f"),t},eB=function(e){let t=cg(this,eD,"f");if(!t){if("response.created"!==e.type)throw new cb(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return cm(this,eD,e.response,"f")}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{let r=t.output[e.output_index];if(!r)throw new cb(`missing output at index ${e.output_index}`);let i=r.type,n=e.part;"message"===i&&"reasoning_text"!==n.type?r.content.push(n):"reasoning"===i&&"reasoning_text"===n.type&&(r.content||(r.content=[]),r.content.push(n));break}case"response.output_text.delta":{let r=t.output[e.output_index];if(!r)throw new cb(`missing output at index ${e.output_index}`);if("message"===r.type){let t=r.content[e.content_index];if(!t)throw new cb(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new cb(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{let r=t.output[e.output_index];if(!r)throw new cb(`missing output at index ${e.output_index}`);"function_call"===r.type&&(r.arguments+=e.delta);break}case"response.reasoning_text.delta":{let r=t.output[e.output_index];if(!r)throw new cb(`missing output at index ${e.output_index}`);if("reasoning"===r.type){let t=r.content?.[e.content_index];if(!t)throw new cb(`missing content at index ${e.content_index}`);if("reasoning_text"!==t.type)throw new cb(`expected content to be 'reasoning_text', got ${t.type}`);t.text+=e.delta}break}case"response.completed":cm(this,eD,e.response,"f")}return t},Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("event",r=>{let i=t.shift();i?i.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let i of(r=!0,t))i.reject(e);t.length=0}),this.on("error",e=>{for(let i of(r=!0,t))i.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();let e=cg(this,eL,"f");if(!e)throw new cb("stream ended without producing a ChatCompletion");return e}}class d5 extends hz{list(e,t={},r){return this._client.getAPIList(hW`/responses/${e}/input_items`,hS,{query:t,...r})}}class d6 extends hz{count(e={},t){return this._client.post("/responses/input_tokens",{body:e,...t})}}class d3 extends hz{constructor(){super(...arguments),this.inputItems=new d5(this._client),this.inputTokens=new d6(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(e=>("object"in e&&"response"===e.object&&d1(e),e))}retrieve(e,t={},r){return this._client.get(hW`/responses/${e}`,{query:t,...r,stream:t?.stream??!1})._thenUnwrap(e=>("object"in e&&"response"===e.object&&d1(e),e))}delete(e,t){return this._client.delete(hW`/responses/${e}`,{...t,headers:ds([{Accept:"*/*"},t?.headers])})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(t=>d0(t,e))}stream(e,t){return d2.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(hW`/responses/${e}/cancel`,t)}}d3.InputItems=d5,d3.InputTokens=d6;class d4 extends hz{create(e,t,r){return this._client.post(hW`/uploads/${e}/parts`,hN({body:t,...r},this._client))}}class d8 extends hz{constructor(){super(...arguments),this.parts=new d4(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(hW`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(hW`/uploads/${e}/complete`,{body:t,...r})}}d8.Parts=d4;let d7=async e=>{let t=await Promise.allSettled(e),r=t.filter(e=>"rejected"===e.status);if(r.length){for(let e of r)console.error(e.reason);throw Error(`${r.length} promise(s) failed - see the above errors`)}let i=[];for(let e of t)"fulfilled"===e.status&&i.push(e.value);return i};class d9 extends hz{create(e,t,r){return this._client.post(hW`/vector_stores/${e}/file_batches`,{body:t,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,t,r){let{vector_store_id:i}=t;return this._client.get(hW`/vector_stores/${i}/file_batches/${e}`,{...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}cancel(e,t,r){let{vector_store_id:i}=t;return this._client.post(hW`/vector_stores/${i}/file_batches/${e}/cancel`,{...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,t,r){let i=await this.create(e,t);return await this.poll(e,i.id,r)}listFiles(e,t,r){let{vector_store_id:i,...n}=t;return this._client.getAPIList(hW`/vector_stores/${i}/file_batches/${e}/files`,hS,{query:n,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async poll(e,t,r){let i=ds([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:n,response:s}=await this.retrieve(t,{vector_store_id:e},{...r,headers:i}).withResponse();switch(n.status){case"in_progress":let a=5e3;if(r?.pollIntervalMs)a=r.pollIntervalMs;else{let e=s.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(a=t)}}await cH(a);break;case"failed":case"cancelled":case"completed":return n}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},i){if(null==t||0==t.length)throw Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let n=Math.min(i?.maxConcurrency??5,t.length),s=this._client,a=t.values(),o=[...r];async function l(e){for(let t of e){let e=await s.files.create({file:t,purpose:"assistants"},i);o.push(e.id)}}let u=Array(n).fill(a).map(l);return await d7(u),await this.createAndPoll(e,{file_ids:o})}}class pe extends hz{create(e,t,r){return this._client.post(hW`/vector_stores/${e}/files`,{body:t,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,t,r){let{vector_store_id:i}=t;return this._client.get(hW`/vector_stores/${i}/files/${e}`,{...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,t,r){let{vector_store_id:i,...n}=t;return this._client.post(hW`/vector_stores/${i}/files/${e}`,{body:n,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t={},r){return this._client.getAPIList(hW`/vector_stores/${e}/files`,hS,{query:t,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,t,r){let{vector_store_id:i}=t;return this._client.delete(hW`/vector_stores/${i}/files/${e}`,{...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,t,r){let i=await this.create(e,t,r);return await this.poll(e,i.id,r)}async poll(e,t,r){let i=ds([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){let n=await this.retrieve(t,{vector_store_id:e},{...r,headers:i}).withResponse(),s=n.data;switch(s.status){case"in_progress":let a=5e3;if(r?.pollIntervalMs)a=r.pollIntervalMs;else{let e=n.response.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(a=t)}}await cH(a);break;case"failed":case"completed":return s}}}async upload(e,t,r){let i=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:i.id},r)}async uploadAndPoll(e,t,r){let i=await this.upload(e,t,r);return await this.poll(e,i.id,r)}content(e,t,r){let{vector_store_id:i}=t;return this._client.getAPIList(hW`/vector_stores/${i}/files/${e}/content`,hx,{...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}class pt extends hz{constructor(){super(...arguments),this.files=new pe(this._client),this.fileBatches=new d9(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(hW`/vector_stores/${e}`,{...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,r){return this._client.post(hW`/vector_stores/${e}`,{body:t,...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e={},t){return this._client.getAPIList("/vector_stores",hS,{query:e,...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(hW`/vector_stores/${e}`,{...t,headers:ds([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}search(e,t,r){return this._client.getAPIList(hW`/vector_stores/${e}/search`,hx,{body:t,method:"post",...r,headers:ds([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}pt.Files=pe,pt.FileBatches=d9;class pr extends hz{create(e,t){return this._client.post("/videos",hA({body:e,...t},this._client))}retrieve(e,t){return this._client.get(hW`/videos/${e}`,t)}list(e={},t){return this._client.getAPIList("/videos",hE,{query:e,...t})}delete(e,t){return this._client.delete(hW`/videos/${e}`,t)}downloadContent(e,t={},r){return this._client.get(hW`/videos/${e}/content`,{query:t,...r,headers:ds([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0})}remix(e,t,r){return this._client.post(hW`/videos/${e}/remix`,hA({body:t,...r},this._client))}}class pi extends hz{constructor(){super(...arguments),eU.add(this)}async unwrap(e,t,r=this._client.webhookSecret,i=300){return await this.verifySignature(e,t,r,i),JSON.parse(e)}async verifySignature(e,t,r=this._client.webhookSecret,i=300){if("undefined"==typeof crypto||"function"!=typeof crypto.subtle.importKey||"function"!=typeof crypto.subtle.verify)throw Error("Webhook signature verification is only supported when the `crypto` global is defined");cg(this,eU,"m",ez).call(this,r);let n=ds([t]).values,s=cg(this,eU,"m",eq).call(this,n,"webhook-signature"),a=cg(this,eU,"m",eq).call(this,n,"webhook-timestamp"),o=cg(this,eU,"m",eq).call(this,n,"webhook-id"),l=parseInt(a,10);if(isNaN(l))throw new cD("Invalid webhook timestamp format");let u=Math.floor(Date.now()/1e3);if(u-l>i)throw new cD("Webhook timestamp is too old");if(l>u+i)throw new cD("Webhook timestamp is too new");let c=s.split(" ").map(e=>e.startsWith("v1,")?e.substring(3):e),h=r.startsWith("whsec_")?Buffer.from(r.replace("whsec_",""),"base64"):Buffer.from(r,"utf-8"),d=o?`${o}.${a}.${e}`:`${a}.${e}`,p=await crypto.subtle.importKey("raw",h,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(let e of c)try{let t=Buffer.from(e,"base64");if(await crypto.subtle.verify("HMAC",p,t,new TextEncoder().encode(d)))return}catch{continue}throw new cD("The given webhook signature does not match the expected signature")}}eU=new WeakSet,ez=function(e){if("string"!=typeof e||0===e.length)throw Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},eq=function(e,t){if(!e)throw Error("Headers are required");let r=e.get(t);if(null==r)throw Error(`Missing required header: ${t}`);return r};class pn{constructor({baseURL:e=dx("OPENAI_BASE_URL"),apiKey:t=dx("OPENAI_API_KEY"),organization:r=dx("OPENAI_ORG_ID")??null,project:i=dx("OPENAI_PROJECT_ID")??null,webhookSecret:n=dx("OPENAI_WEBHOOK_SECRET")??null,...s}={}){if(eH.add(this),eV.set(this,void 0),this.completions=new dO(this),this.chat=new di(this),this.embeddings=new dP(this),this.files=new d$(this),this.images=new dK(this),this.audio=new dc(this),this.moderations=new dQ(this),this.models=new dJ(this),this.fineTuning=new dW(this),this.graders=new dG(this),this.vectorStores=new pt(this),this.webhooks=new pi(this),this.beta=new dk(this),this.batches=new dh(this),this.uploads=new d8(this),this.responses=new d3(this),this.realtime=new dY(this),this.conversations=new dI(this),this.evals=new dL(this),this.containers=new dN(this),this.videos=new pr(this),void 0===t)throw new cb("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");let a={apiKey:t,organization:r,project:i,webhookSecret:n,...s,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&cV())throw new cb("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");this.baseURL=a.baseURL,this.timeout=a.timeout??eW.DEFAULT_TIMEOUT,this.logger=a.logger??console;let o="warn";this.logLevel=o,this.logLevel=ha(a.logLevel,"ClientOptions.logLevel",this)??ha(dx("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??o,this.fetchOptions=a.fetchOptions,this.maxRetries=a.maxRetries??2,this.fetch=a.fetch??function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),cm(this,eV,c1,"f"),this._options=a,this.apiKey="string"==typeof t?t:"Missing Key",this.organization=r,this.project=i,this.webhookSecret=n}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){}async authHeaders(e){return ds([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return function(e,t={}){let r,i=e,n=function(e=he){let t;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw TypeError("Encoder has to be a function.");let r=e.charset||he.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let i=c2;if(void 0!==e.format){if(!c3(c6,e.format))throw TypeError("Unknown format option provided.");i=e.format}let n=c6[i],s=he.filter;if(("function"==typeof e.filter||cF(e.filter))&&(s=e.filter),t=e.arrayFormat&&e.arrayFormat in c7?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":he.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw TypeError("`commaRoundTrip` must be a boolean, or absent");let a=void 0===e.allowDots?!0==!!e.encodeDotInKeys||he.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:he.addQueryPrefix,allowDots:a,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:he.allowEmptyArrays,arrayFormat:t,charset:r,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:he.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?he.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:he.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:he.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:he.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:he.encodeValuesOnly,filter:s,format:i,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:he.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:he.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:he.strictNullHandling}}(t);"function"==typeof n.filter?i=(0,n.filter)("",i):cF(n.filter)&&(r=n.filter);let s=[];if("object"!=typeof i||null===i)return"";let a=c7[n.arrayFormat],o="comma"===a&&n.commaRoundTrip;r||(r=Object.keys(i)),n.sort&&r.sort(n.sort);let l=new WeakMap;for(let e=0;e<r.length;++e){let t=r[e];n.skipNulls&&null===i[t]||c9(s,function e(t,r,i,n,s,a,o,l,u,c,h,d,p,f,m,g,y,v){var b,w;let x,S=t,E=v,T=0,k=!1;for(;void 0!==(E=E.get(ht))&&!k;){let e=E.get(t);if(T+=1,void 0!==e){if(e===T)throw RangeError("Cyclic object value");k=!0}void 0===E.get(ht)&&(T=0)}if("function"==typeof c?S=c(r,S):S instanceof Date?S=p?.(S):"comma"===i&&cF(S)&&(S=c8(S,function(e){return e instanceof Date?p?.(e):e})),null===S){if(a)return u&&!g?u(r,he.encoder,y,"key",f):r;S=""}if("string"==typeof(b=S)||"number"==typeof b||"boolean"==typeof b||"symbol"==typeof b||"bigint"==typeof b||(w=S)&&"object"==typeof w&&w.constructor&&w.constructor.isBuffer&&w.constructor.isBuffer(w)){if(u){let e=g?r:u(r,he.encoder,y,"key",f);return[m?.(e)+"="+m?.(u(S,he.encoder,y,"value",f))]}return[m?.(r)+"="+m?.(String(S))]}let O=[];if(void 0===S)return O;if("comma"===i&&cF(S))g&&u&&(S=c8(S,u)),x=[{value:S.length>0?S.join(",")||null:void 0}];else if(cF(c))x=c;else{let e=Object.keys(S);x=h?e.sort(h):e}let C=l?String(r).replace(/\./g,"%2E"):String(r),A=n&&cF(S)&&1===S.length?C+"[]":C;if(s&&cF(S)&&0===S.length)return A+"[]";for(let r=0;r<x.length;++r){let b=x[r],w="object"==typeof b&&void 0!==b.value?b.value:S[b];if(o&&null===w)continue;let E=d&&l?b.replace(/\./g,"%2E"):b,k=cF(S)?"function"==typeof i?i(A,E):A:A+(d?"."+E:"["+E+"]");v.set(t,T);let C=new WeakMap;C.set(ht,v),c9(O,e(w,k,i,n,s,a,o,l,"comma"===i&&g&&cF(S)?null:u,c,h,d,p,f,m,g,y,C))}return O}(i[t],t,a,o,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,l))}let u=s.join(n.delimiter),c=!0===n.addQueryPrefix?"?":"";return n.charsetSentinel&&("iso-8859-1"===n.charset?c+="utf8=%26%2310003%3B&":c+="utf8=%E2%9C%93&"),u.length>0?c+u:""}(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${cW}`}defaultIdempotencyKey(){return`stainless-node-retry-${cy()}`}makeStatusError(e,t,r,i){return cw.generate(e,t,r,i)}async _callApiKey(){let e;let t=this._options.apiKey;if("function"!=typeof t)return!1;try{e=await t()}catch(e){if(e instanceof cb)throw e;throw new cb(`Failed to get token from 'apiKey' function: ${e.message}`,{cause:e})}if("string"!=typeof e||!e)throw new cb(`Expected 'apiKey' function argument to return a string but it returned ${e}`);return this.apiKey=e,!0}buildURL(e,t,r){let i=!cg(this,eH,"m",eG).call(this)&&r||this.baseURL,n=new URL(c$(e)?e:i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return!function(e){if(!e)return!0;for(let t in e)return!1;return!0}(s)&&(t={...s,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,{url:t,options:r}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(r=>({method:e,path:t,...r})))}request(e,t=null){return new hv(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,r){let i=await e,n=i.maxRetries??this.maxRetries;null==t&&(t=n),await this.prepareOptions(i);let{req:s,url:a,timeout:o}=await this.buildRequest(i,{retryCount:n-t});await this.prepareRequest(s,{url:a,options:i});let l="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),u=void 0===r?"":`, retryOf: ${r}`,c=Date.now();if(hh(this).debug(`[${l}] sending request`,hd({retryOfRequestLogID:r,method:i.method,url:a,options:i,headers:s.headers})),i.signal?.aborted)throw new cx;let h=new AbortController,d=await this.fetchWithTimeout(a,s,o,h).catch(cv),p=Date.now();if(d instanceof globalThis.Error){let e=`retrying, ${t} attempts remaining`;if(i.signal?.aborted)throw new cx;let n=c_(d)||/timed? ?out/i.test(String(d)+("cause"in d?String(d.cause):""));if(t)return hh(this).info(`[${l}] connection ${n?"timed out":"failed"} - ${e}`),hh(this).debug(`[${l}] connection ${n?"timed out":"failed"} (${e})`,hd({retryOfRequestLogID:r,url:a,durationMs:p-c,message:d.message})),this.retryRequest(i,t,r??l);if(hh(this).info(`[${l}] connection ${n?"timed out":"failed"} - error; no more retries left`),hh(this).debug(`[${l}] connection ${n?"timed out":"failed"} (error; no more retries left)`,hd({retryOfRequestLogID:r,url:a,durationMs:p-c,message:d.message})),n)throw new cE;throw new cS({cause:d})}let f=[...d.headers.entries()].filter(([e])=>"x-request-id"===e).map(([e,t])=>", "+e+": "+JSON.stringify(t)).join(""),m=`[${l}${u}${f}] ${s.method} ${a} ${d.ok?"succeeded":"failed"} with status ${d.status} in ${p-c}ms`;if(!d.ok){let e=await this.shouldRetry(d);if(t&&e){let e=`retrying, ${t} attempts remaining`;return await c0(d.body),hh(this).info(`${m} - ${e}`),hh(this).debug(`[${l}] response error (${e})`,hd({retryOfRequestLogID:r,url:d.url,status:d.status,headers:d.headers,durationMs:p-c})),this.retryRequest(i,t,r??l,d.headers)}let n=e?"error; no more retries left":"error; not retryable";hh(this).info(`${m} - ${n}`);let s=await d.text().catch(e=>cv(e).message),a=cq(s),o=a?void 0:s;throw hh(this).debug(`[${l}] response error (${n})`,hd({retryOfRequestLogID:r,url:d.url,status:d.status,headers:d.headers,message:o,durationMs:Date.now()-c})),this.makeStatusError(d.status,a,o,d.headers)}return hh(this).info(m),hh(this).debug(`[${l}] response start`,hd({retryOfRequestLogID:r,url:d.url,status:d.status,headers:d.headers,durationMs:p-c})),{response:d,options:i,controller:h,requestLogID:l,retryOfRequestLogID:r,startTime:c}}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}requestAPIList(e,t){return new hw(this,this.makeRequest(t,null,void 0),e)}async fetchWithTimeout(e,t,r,i){let{signal:n,method:s,...a}=t||{};n&&n.addEventListener("abort",()=>i.abort());let o=setTimeout(()=>i.abort(),r),l=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||"object"==typeof a.body&&null!==a.body&&Symbol.asyncIterator in a.body,u={signal:i.signal,...l?{duplex:"half"}:{},method:"GET",...a};s&&(u.method=s.toUpperCase());try{return await this.fetch.call(void 0,e,u)}finally{clearTimeout(o)}}async shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,r,i){let n;let s=i?.get("retry-after-ms");if(s){let e=parseFloat(s);Number.isNaN(e)||(n=e)}let a=i?.get("retry-after");if(a&&!n){let e=parseFloat(a);n=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}if(!(n&&0<=n&&n<6e4)){let r=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,r)}return await cH(n),this.makeRequest(e,t-1,r)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}async buildRequest(e,{retryCount:t=0}={}){let r={...e},{method:i,path:n,query:s,defaultBaseURL:a}=r,o=this.buildURL(n,s,a);"timeout"in r&&cz("timeout",r.timeout),r.timeout=r.timeout??this.timeout;let{bodyHeaders:l,body:u}=this.buildBody({options:r}),c=await this.buildHeaders({options:e,method:i,bodyHeaders:l,retryCount:t});return{req:{method:i,headers:c,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&u instanceof globalThis.ReadableStream&&{duplex:"half"},...u&&{body:u},...this.fetchOptions??{},...r.fetchOptions??{}},url:o,timeout:r.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:r,retryCount:i}){let n={};this.idempotencyHeader&&"get"!==t&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),n[this.idempotencyHeader]=e.idempotencyKey);let s=ds([n,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...cQ(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(s),s.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};let r=ds([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||"string"==typeof e&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:"object"==typeof e&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&"function"==typeof e.next)?{bodyHeaders:void 0,body:cX(e)}:cg(this,eV,"f").call(this,{body:e,headers:r})}}eW=pn,eV=new WeakMap,eH=new WeakSet,eG=function(){return"https://api.openai.com/v1"!==this.baseURL},pn.OpenAI=eW,pn.DEFAULT_TIMEOUT=6e5,pn.OpenAIError=cb,pn.APIError=cw,pn.APIConnectionError=cS,pn.APIConnectionTimeoutError=cE,pn.APIUserAbortError=cx,pn.NotFoundError=cC,pn.ConflictError=cA,pn.RateLimitError=cR,pn.BadRequestError=cT,pn.AuthenticationError=ck,pn.InternalServerError=cI,pn.PermissionDeniedError=cO,pn.UnprocessableEntityError=cN,pn.InvalidWebhookSignatureError=cD,pn.toFile=hB,pn.Completions=dO,pn.Chat=di,pn.Embeddings=dP,pn.Files=d$,pn.Images=dK,pn.Audio=dc,pn.Moderations=dQ,pn.Models=dJ,pn.FineTuning=dW,pn.Graders=dG,pn.VectorStores=pt,pn.Webhooks=pi,pn.Beta=dk,pn.Batches=dh,pn.Uploads=d8,pn.Responses=d3,pn.Realtime=dY,pn.Conversations=dI,pn.Evals=dL,pn.Containers=dN,pn.Videos=pr;let ps=new pn({apiKey:process.env.OPENAI_API_KEY||""});async function pa(e,t){try{var r,i,n;let s=await uz.query.dimEntidade.findFirst({where:lB(e8.dimEntidade.id,e)});if(!s)return{sucesso:!1,entidadeId:e,erro:"Entidade n\xe3o encontrada"};let a=(r=s.nome,i=s.cnpj||void 0,n=s.tipo_entidade||void 0,`Voc\xea \xe9 um especialista em an\xe1lise de empresas brasileiras. Analise a empresa abaixo e retorne APENAS um JSON v\xe1lido com os dados solicitados.

EMPRESA:
- Nome: ${r}
${i?`- CNPJ: ${i}`:""}
${n?`- Tipo: ${n}`:""}

RETORNE UM JSON COM:
{
  "cidade": "cidade onde a empresa est\xe1 localizada (string)",
  "uf": "UF (sigla de 2 letras)",
  "porte": "pequeno|m\xe9dio|grande",
  "setor": "setor de atua\xe7\xe3o (ex: varejo, ind\xfastria, servi\xe7os)",
  "produto_principal": "principal produto ou servi\xe7o oferecido",
  "segmentacao_b2b_b2c": "B2B|B2C|B2B2C",
  "score_qualidade": n\xfamero de 0 a 100 indicando confian\xe7a dos dados,
  "origem_confianca": n\xfamero de 0 a 100 indicando confian\xe7a geral da an\xe1lise
}

REGRAS:
- Retorne APENAS o JSON, sem texto adicional
- Use dados reais se conhecer a empresa
- Se n\xe3o tiver certeza, use valores gen\xe9ricos baseados no nome
- Seja conservador no score_qualidade (use valores baixos se n\xe3o tiver certeza)
- NUNCA invente dados financeiros ou n\xfameros espec\xedficos`),o=(Date.now(),await ps.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:"Voc\xea \xe9 um assistente que retorna apenas JSON v\xe1lido, sem explica\xe7\xf5es adicionais."},{role:"user",content:a}],temperature:.7,max_tokens:500,response_format:{type:"json_object"}}));Date.now();let l=o.choices[0].message.content;if(!l)throw Error("Resposta vazia da IA");let u=JSON.parse(l);u.origem_processo="enriquecimento_ia",u.origem_prompt=a;let c=o.usage?.total_tokens||0;return await uz.update(e8.dimEntidade).set({cidade:u.cidade||s.cidade,uf:u.uf||s.uf,porte:u.porte||s.porte,setor:u.setor||s.setor,produto_principal:u.produto_principal||s.produto_principal,segmentacao_b2b_b2c:u.segmentacao_b2b_b2c||s.segmentacao_b2b_b2c,score_qualidade:u.score_qualidade||s.score_qualidade,enriquecido:!0,enriquecido_em:new Date,enriquecido_por:`user_${t}`,origem_processo:u.origem_processo,origem_prompt:u.origem_prompt,origem_confianca:u.origem_confianca,updated_at:new Date,updated_by:t}).where(lB(e8.dimEntidade.id,e)),{sucesso:!0,entidadeId:e,dados:u,tokens:c,custo:c/1e3*1e-4}}catch(t){return console.error(`Erro ao enriquecer entidade ${e}:`,t),{sucesso:!1,entidadeId:e,erro:t.message}}}async function po(e,t){let r=[];for(let i of e){let e=await pa(i,t);r.push(e),await new Promise(e=>setTimeout(e,1e3))}return r}async function pl(e,t=100){let r=(await uz.query.dimEntidade.findMany({where:lB(e8.dimEntidade.enriquecido,!1),limit:t})).map(e=>e.id);return await po(r,e)}let pu=ii({list:uH(nC.ENTIDADE_READ).input(nS({busca:ny().optional(),tipo:nk(["cliente","lead","concorrente"]).optional(),status_qualificacao_id:n_().optional(),projeto_id:n_().optional(),pesquisa_id:n_().optional(),enriquecido:nv().optional(),limit:n_().default(20),offset:n_().default(0)})).query(async({input:e})=>{let t=Math.floor(e.offset/e.limit)+1;return await u7({busca:e.busca,tipoEntidade:e.tipo,statusQualificacaoId:e.status_qualificacao_id,projetoId:e.projeto_id,pesquisaId:e.pesquisa_id,enriquecido:e.enriquecido,limit:e.limit,page:t})}),getById:uH(nC.ENTIDADE_READ).input(n_()).query(async({input:e})=>await u8(e)),getByCNPJ:uH(nC.ENTIDADE_READ).input(ny()).query(async({input:e})=>await ct(e)),create:uH(nC.ENTIDADE_UPDATE).input(nS({nome:ny().min(1),tipoEntidade:nk(["cliente","lead","concorrente"]),cnpj:ny().optional(),email:ny().email().optional(),telefone:ny().optional(),site:ny().url().optional(),importacaoId:n_().optional()})).mutation(async({input:e,ctx:t})=>await u4({...e,origemTipo:"manual",createdBy:t.userId})),update:uH(nC.ENTIDADE_UPDATE).input(nS({id:n_(),nome:ny().optional(),cnpj:ny().optional(),email:ny().email().optional(),telefone:ny().optional(),celular:ny().optional(),website:ny().optional(),endereco:ny().optional(),cidade:ny().optional(),estado:ny().optional(),cep:ny().optional(),setor:ny().optional(),porte:ny().optional()})).mutation(async({input:e})=>{let{id:t,...r}=e;return await u9(t,r)}),delete:uH(nC.ENTIDADE_DELETE).input(n_()).mutation(async({input:e})=>(await ce(e),{success:!0})),suggestMerge:uH(nC.ENTIDADE_READ).input(n_()).query(async({input:e})=>{let t=await u8(e);if(!t)throw Error("Entidade n\xe3o encontrada");return await e7.sugerirMerge(t)}),enriquecer:uH(nC.ENTIDADE_UPDATE).input(n_()).mutation(async({input:e,ctx:t})=>await pa(e,t.userId)),enriquecerLote:uH(nC.ENTIDADE_UPDATE).input(nx(n_())).mutation(async({input:e,ctx:t})=>await po(e,t.userId)),enriquecerTodasPendentes:uH(nC.ENTIDADE_UPDATE).input(nS({limite:n_().default(100)})).mutation(async({input:e,ctx:t})=>await pl(t.userId,e.limite))});async function pc(e){let[t]=await uz.insert(e8.dimImportacao).values({...e,mapeamentoColunas:e.mapeamentoColunas?JSON.stringify(e.mapeamentoColunas):null,opcoes:e.opcoes?JSON.stringify(e.opcoes):null}).returning();return t}async function ph(e){let t=await uz.query.dimImportacao.findFirst({where:lB(e8.dimImportacao.id,e)});return t?{...t,mapeamentoColunas:t.mapeamentoColunas?JSON.parse(t.mapeamentoColunas):null,opcoes:t.opcoes?JSON.parse(t.opcoes):null}:null}async function pd(e){let t=[];e?.projetoId&&t.push(lB(e8.dimImportacao.projetoId,e.projetoId)),e?.pesquisaId&&t.push(lB(e8.dimImportacao.pesquisaId,e.pesquisaId)),e?.status&&t.push(lB(e8.dimImportacao.status,e.status));let r=t.length>0?lz(...t):void 0;return(await uz.query.dimImportacao.findMany({where:r,orderBy:[l7(e8.dimImportacao.createdAt)],limit:e?.limit||20,offset:e?.offset||0})).map(e=>({...e,mapeamentoColunas:e.mapeamentoColunas?JSON.parse(e.mapeamentoColunas):null,opcoes:e.opcoes?JSON.parse(e.opcoes):null}))}async function pp(e,t){let[r]=await uz.update(e8.dimImportacao).set({...t,updatedAt:new Date}).where(lB(e8.dimImportacao.id,e)).returning();return r}async function pf(e,t){return await pp(e,{status:"processando",startedAt:new Date,progressoPercentual:0,updatedBy:t})}async function pm(e,t){let r=await ph(e);if(!r)throw Error("Importa\xe7\xe3o n\xe3o encontrada");let i=r.startedAt?Math.floor((Date.now()-r.startedAt.getTime())/1e3):0;return await pp(e,{status:"concluido",completedAt:new Date,durationSeconds:i,progressoPercentual:100,updatedBy:t})}async function pg(e,t,r){return await pp(e,{status:"falhou",erroMensagem:t,completedAt:new Date,updatedBy:r})}async function py(e,t){return await pp(e,{status:"cancelado",completedAt:new Date,updatedBy:t})}async function p_(e,t,r,i,n){let s=await ph(e);if(!s)throw Error("Importa\xe7\xe3o n\xe3o encontrada");let a=Math.floor(t/s.totalLinhas*100);return await pp(e,{linhasProcessadas:t,linhasSucesso:r,linhasErro:i,linhasDuplicadas:n,progressoPercentual:a})}async function pv(e){let[t]=await uz.insert(e8.importacaoErros).values({...e,linhaDados:JSON.stringify(e.linhaDados),sugestaoCorrecao:e.sugestaoCorrecao?JSON.stringify(e.sugestaoCorrecao):null}).returning();return t}async function pb(e,t=100){return(await uz.query.importacaoErros.findMany({where:lB(e8.importacaoErros.importacaoId,e),limit:t})).map(e=>({...e,linhaDados:JSON.parse(e.linhaDados),sugestaoCorrecao:e.sugestaoCorrecao?JSON.parse(e.sugestaoCorrecao):null}))}async function pw(e){return await uz.select({tipoErro:e8.importacaoErros.tipoErro,total:uW()}).from(e8.importacaoErros).where(lB(e8.importacaoErros.importacaoId,e)).groupBy(e8.importacaoErros.tipoErro)}async function px(e){let t=await ph(e);if(!t)return null;let r=await pw(e);return{totalLinhas:t.totalLinhas,linhasProcessadas:t.linhasProcessadas||0,linhasSucesso:t.linhasSucesso||0,linhasErro:t.linhasErro||0,linhasDuplicadas:t.linhasDuplicadas||0,linhasGeografiaFuzzy:t.linhasGeografiaFuzzy||0,progressoPercentual:t.progressoPercentual||0,status:t.status,durationSeconds:t.durationSeconds,errosPorTipo:r}}async function pS(e,t=100){return await uz.query.dimEntidade.findMany({where:lB(e8.dimEntidade.importacaoId,e),limit:t})}function pE(e){return e&&""!==e.trim()?sp().createHash("sha256").update(e.trim().toLowerCase()).digest("hex"):null}async function pT(e,t,r,i){try{let i=null;if(e.cnpj){if(i=e.cnpj.replace(/\D/g,""),!function(e){let t=e.replace(/[^\d]/g,"");if(14!==t.length||/^(\d)\1+$/.test(t))return!1;let r=t.length-2,i=t.substring(0,r),n=t.substring(r),s=0,a=r-7;for(let e=r;e>=1;e--)s+=parseInt(i.charAt(r-e))*a--,a<2&&(a=9);let o=s%11<2?0:11-s%11;if(o!==parseInt(n.charAt(0)))return!1;r+=1,i=t.substring(0,r),s=0,a=r-7;for(let e=r;e>=1;e--)s+=parseInt(i.charAt(r-e))*a--,a<2&&(a=9);return(o=s%11<2?0:11-s%11)===parseInt(n.charAt(1))}(i))throw Error("CNPJ inv\xe1lido");if(await uz.query.dimEntidade.findFirst({where:lB(e8.dimEntidade.cnpj,i)}))throw Error("CNPJ j\xe1 existe no banco de dados")}if(e.cidade&&e.uf){let t=await ca(e.cidade,e.uf,.8);t&&t.geografia.id}let n=pE(i),s=pE(e.cpf),a=pE(e.email),o=pE(e.telefone),l=function(e){let t=0,r=["nome","cnpj","email","telefone","cidade","uf","endereco","website","porte","setor","faturamento_estimado","num_funcionarios"];return r.forEach(i=>{e[i]&&""!==e[i]&&(t+=100/r.length)}),Math.round(t)}(e),u=["cnpj","email","telefone","cidade","uf","endereco","website","porte","setor","faturamento_estimado","num_funcionarios"].filter(t=>!e[t]||""===e[t]),[c]=await uz.insert(e8.dimEntidade).values({nome:e.nome,tipo_entidade:e.tipo_entidade,cnpj:i,cpf:e.cpf||null,email:e.email||null,telefone:e.telefone||null,cidade:e.cidade||null,uf:e.uf||null,endereco:e.endereco||null,website:e.website||null,porte:e.porte||null,setor:e.setor||null,faturamento_estimado:e.faturamento_estimado||null,num_funcionarios:e.num_funcionarios||null,cnpj_hash:n,cpf_hash:s,email_hash:a,telefone_hash:o,score_qualidade_dados:l,campos_faltantes:u.length>0?u.join(","):null,origem:"importacao",importacao_id:t,origem_usuario_id:r,enriquecido:!1,enriquecido_em:null,enriquecido_por:null,created_at:new Date,created_by:r,updated_at:new Date,updated_by:null,deleted_at:null,deleted_by:null}).returning();return{sucesso:!0,entidadeId:c.id}}catch(r){return await pv({importacaoId:t,linhaNumero:i,linhaDados:e,tipoErro:r.message.includes("CNPJ")?"duplicata":"validacao",mensagemErro:r.message}),{sucesso:!1,erro:r.message}}}async function pk(e,t,r){let i=0,n=0,s=0;for(let a=0;a<t.length;a++){let o=t[a],l=await pT(o,e,r,a+1);l.sucesso?i++:l.erro?.includes("j\xe1 existe")?s++:n++,((a+1)%10==0||a===t.length-1)&&await p_(e,a+1,i,n,s)}return await pm(e,r.toString()),{sucesso:i,erro:n,duplicadas:s}}let pO=ii({create:uH(nC.IMPORTACAO_CREATE).input(nS({projetoId:n_(),pesquisaId:n_(),nomeArquivo:ny(),tipoArquivo:nk(["csv","xlsx"]),totalLinhas:n_(),mapeamentoColunas:nT(ny()).optional()})).mutation(async({input:e,ctx:t})=>await pc({...e,createdBy:t.userId})),list:uH(nC.IMPORTACAO_READ).input(nS({projetoId:n_().optional(),pesquisaId:n_().optional(),status:ny().optional(),limit:n_().default(20),offset:n_().default(0)})).query(async({input:e})=>await pd(e)),getById:uH(nC.IMPORTACAO_READ).input(n_()).query(async({input:e})=>await ph(e)),start:uH(nC.IMPORTACAO_CREATE).input(n_()).mutation(async({input:e,ctx:t})=>await pf(e,t.userId)),updateProgress:uH(nC.IMPORTACAO_CREATE).input(nS({id:n_(),linhasProcessadas:n_(),linhasSucesso:n_(),linhasErro:n_(),linhasDuplicadas:n_()})).mutation(async({input:e})=>{let{id:t,...r}=e;return await p_(t,r.linhasProcessadas,r.linhasSucesso,r.linhasErro,r.linhasDuplicadas)}),complete:uH(nC.IMPORTACAO_CREATE).input(n_()).mutation(async({input:e,ctx:t})=>await pm(e,t.userId)),fail:uH(nC.IMPORTACAO_CREATE).input(nS({id:n_(),erro:ny()})).mutation(async({input:e,ctx:t})=>await pg(e.id,e.erro,t.userId)),cancel:uH(nC.IMPORTACAO_DELETE).input(n_()).mutation(async({input:e,ctx:t})=>await py(e,t.userId)),getErros:uH(nC.IMPORTACAO_READ).input(nS({importacaoId:n_(),limit:n_().default(100)})).query(async({input:e})=>await pb(e.importacaoId,e.limit)),getEstatisticas:uH(nC.IMPORTACAO_READ).input(n_()).query(async({input:e})=>await px(e)),getEntidades:uH(nC.IMPORTACAO_READ).input(nS({importacaoId:n_(),limit:n_().default(100)})).query(async({input:e})=>await pS(e.importacaoId,e.limit)),processar:uH(nC.IMPORTACAO_CREATE).input(nS({importacaoId:n_(),linhas:nx(nS({nome:ny(),tipo_entidade:nk(["cliente","lead","concorrente"]),cnpj:ny().optional(),cpf:ny().optional(),email:ny().optional(),telefone:ny().optional(),cidade:ny().optional(),uf:ny().optional(),endereco:ny().optional(),website:ny().optional(),porte:ny().optional(),setor:ny().optional(),faturamento_estimado:n_().optional(),num_funcionarios:n_().optional()}))})).mutation(async({input:e,ctx:t})=>await pk(e.importacaoId,e.linhas,t.userId))}),pC=process.env.BUILT_IN_FORGE_API_KEY||"",pA=process.env.BUILT_IN_FORGE_API_URL||"https://api.openai.com/v1";async function pN(e){let t=`
Voc\xea \xe9 um assistente de BI especializado em interpretar consultas em linguagem natural e convert\xea-las em filtros estruturados.

CONSULTA DO USU\xc1RIO:
"${e.query}"

INSTRU\xc7\xd5ES:
1. Identifique os seguintes elementos na consulta:
   - Tipo de entidade (cliente, lead, concorrente)
   - Setor/mercado
   - Regi\xe3o geogr\xe1fica (pa\xeds, estado, cidade)
   - Faixa de receita (m\xednima e m\xe1xima)
   - Faixa de score (m\xednima e m\xe1xima)
   - Segmento (A, B, C)
   - Outros filtros relevantes

2. Retorne um JSON no seguinte formato:
{
  "interpretacao": {
    "tipo": "lead" | "cliente" | "concorrente" | null,
    "setor": "string" | null,
    "regiao": ["string"] | null,
    "receitaMin": number | null,
    "receitaMax": number | null,
    "scoreMin": number | null,
    "scoreMax": number | null,
    "segmento": ["A", "B", "C"] | null,
    "outros": {} | null
  },
  "confianca": number (0-100),
  "sugestoes": ["string"] | null
}

3. Se a consulta for amb\xedgua, reduza a confian\xe7a e adicione sugest\xf5es de refinamento.

4. Seja conservador: se n\xe3o tiver certeza, retorne null para aquele campo.

EXEMPLOS:

Consulta: "Mostre leads de tecnologia no sul com receita acima de 5M"
Resposta:
{
  "interpretacao": {
    "tipo": "lead",
    "setor": "Tecnologia",
    "regiao": ["Rio Grande do Sul", "Santa Catarina", "Paran\xe1"],
    "receitaMin": 5000000,
    "receitaMax": null,
    "scoreMin": null,
    "scoreMax": null,
    "segmento": null,
    "outros": null
  },
  "confianca": 95,
  "sugestoes": null
}

Consulta: "Empresas grandes"
Resposta:
{
  "interpretacao": {
    "tipo": null,
    "setor": null,
    "regiao": null,
    "receitaMin": 50000000,
    "receitaMax": null,
    "scoreMin": null,
    "scoreMax": null,
    "segmento": null,
    "outros": {
      "porte": "Grande"
    }
  },
  "confianca": 60,
  "sugestoes": [
    "Especifique o tipo: clientes, leads ou concorrentes?",
    "Defina 'grande': por receita, n\xfamero de funcion\xe1rios ou outro crit\xe9rio?"
  ]
}

AGORA INTERPRETE A CONSULTA DO USU\xc1RIO E RETORNE APENAS O JSON (sem markdown, sem explica\xe7\xf5es).
`.trim();try{let r=await fetch(`${pA}/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${pC}`},body:JSON.stringify({model:"gpt-4o",messages:[{role:"system",content:"Voc\xea \xe9 um assistente de BI especializado em interpretar consultas em linguagem natural."},{role:"user",content:t}],temperature:e.temperatura||1,response_format:{type:"json_object"}})});if(!r.ok)throw Error(`OpenAI API error: ${r.statusText}`);let i=(await r.json()).choices[0].message.content,n=JSON.parse(i),s=[];return n.interpretacao.tipo&&s.push({campo:"tipoEntidade",operador:"=",valor:n.interpretacao.tipo,label:`Tipo: ${n.interpretacao.tipo}`}),n.interpretacao.setor&&s.push({campo:"mercado.setor",operador:"LIKE",valor:`%${n.interpretacao.setor}%`,label:`Setor: ${n.interpretacao.setor}`}),n.interpretacao.regiao&&n.interpretacao.regiao.length>0&&s.push({campo:"geografia.estado",operador:"IN",valor:n.interpretacao.regiao,label:`Regi\xe3o: ${n.interpretacao.regiao.join(", ")}`}),null!==n.interpretacao.receitaMin&&s.push({campo:"contexto.receitaPotencialAnual",operador:">=",valor:n.interpretacao.receitaMin,label:`Receita m\xednima: R$ ${(n.interpretacao.receitaMin/1e6).toFixed(1)}M`}),null!==n.interpretacao.receitaMax&&s.push({campo:"contexto.receitaPotencialAnual",operador:"<=",valor:n.interpretacao.receitaMax,label:`Receita m\xe1xima: R$ ${(n.interpretacao.receitaMax/1e6).toFixed(1)}M`}),null!==n.interpretacao.scoreMin&&s.push({campo:"contexto.scoreFit",operador:">=",valor:n.interpretacao.scoreMin,label:`Score m\xednimo: ${n.interpretacao.scoreMin}`}),null!==n.interpretacao.scoreMax&&s.push({campo:"contexto.scoreFit",operador:"<=",valor:n.interpretacao.scoreMax,label:`Score m\xe1ximo: ${n.interpretacao.scoreMax}`}),n.interpretacao.segmento&&n.interpretacao.segmento.length>0&&s.push({campo:"contexto.segmentoAbc",operador:"IN",valor:n.interpretacao.segmento,label:`Segmento: ${n.interpretacao.segmento.join(", ")}`}),n.interpretacao.outros&&Object.entries(n.interpretacao.outros).forEach(([e,t])=>{s.push({campo:e,operador:"=",valor:t,label:`${e}: ${t}`})}),{interpretacao:n.interpretacao,filtros:s,confianca:n.confianca||50,sugestoes:n.sugestoes||void 0}}catch(e){return console.error("Erro na busca sem\xe2ntica:",e),{interpretacao:{},filtros:[],confianca:0,sugestoes:["Erro ao interpretar a consulta. Tente reformular ou use filtros manuais."]}}}var pR=i(69872),pI=i.n(pR);function pP(e){return null==e?"N/A":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}function pj(e,t=1){return null==e?"N/A":`${e.toFixed(t)}%`}function pD(e){if(!e)return"N/A";let t="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)}async function pL(e){let t=new(pI()).Workbook,r=t.addWorksheet("Dados");if(e.colunas&&(r.columns=e.colunas.map(e=>({header:e.label,key:e.campo,width:20})),r.getRow(1).font={bold:!0,color:{argb:"FFFFFFFF"}},r.getRow(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF3B82F6"}},r.getRow(1).alignment={vertical:"middle",horizontal:"center"},r.getRow(1).height=25,e.dados.forEach((t,i)=>{let n=r.addRow(t);e.colunas?.forEach((e,t)=>{let r=n.getCell(t+1);switch(e.formato){case"moeda":r.numFmt="R$ #,##0.00";break;case"numero":r.numFmt="#,##0";break;case"percentual":r.numFmt='0.0"%"';break;case"data":r.numFmt="dd/mm/yyyy"}}),i%2==0&&(n.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF9FAFB"}})}),e.incluirResumo)){r.addRow([]).height=5;let t=r.addRow(["TOTAL"]);t.font={bold:!0},t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE5E7EB"}},e.colunas?.forEach((r,i)=>{if("moeda"===r.formato||"numero"===r.formato){let n=String.fromCharCode(65+i),s=`SUM(${n}2:${n}${e.dados.length+1})`;t.getCell(i+1).value={formula:s},"moeda"===r.formato?t.getCell(i+1).numFmt="R$ #,##0.00":t.getCell(i+1).numFmt="#,##0"}})}let n=await t.xlsx.writeBuffer(),s=`${e.titulo||"exportacao"}_${Date.now()}.xlsx`,a=`/tmp/${s}`,o=await Promise.resolve().then(i.t.bind(i,79748,23));return await o.writeFile(a,n),{url:a,nome:s,tamanho:n.byteLength,formato:"excel"}}async function p$(e){let t=[];e.colunas&&(t.push(e.colunas.map(e=>`"${e.label}"`).join(";")),e.dados.forEach(r=>{let i=e.colunas.map(e=>{let t;let i=r[e.campo];switch(e.formato){case"moeda":t=pP(i);break;case"numero":t=i?.toLocaleString("pt-BR")||"";break;case"percentual":t=pj(i);break;case"data":t=pD(i);break;default:t=i?.toString()||""}return`"${t}"`});t.push(i.join(";"))}));let r="\uFEFF"+t.join("\n"),n=`${e.titulo||"exportacao"}_${Date.now()}.csv`,s=`/tmp/${n}`,a=await Promise.resolve().then(i.t.bind(i,79748,23));return await a.writeFile(s,r,"utf-8"),{url:s,nome:n,tamanho:Buffer.byteLength(r,"utf-8"),formato:"csv"}}async function pF(e){let t=JSON.stringify(e.dados,null,2),r=`${e.titulo||"exportacao"}_${Date.now()}.json`,n=`/tmp/${r}`,s=await Promise.resolve().then(i.t.bind(i,79748,23));return await s.writeFile(n,t,"utf-8"),{url:n,nome:r,tamanho:Buffer.byteLength(t,"utf-8"),formato:"json"}}async function pM(e){let t=`# ${e.titulo||"Relat\xf3rio de Intelig\xeancia de Mercado"}

`;t+=`**Data:** ${pD(new Date)}

`,e.incluirResumo&&(t+=`## Resumo

- Total de registros: ${e.dados.length}
`,e.colunas?.forEach(r=>{if("moeda"===r.formato||"numero"===r.formato){let i=e.dados.reduce((e,t)=>e+(t[r.campo]||0),0);"moeda"===r.formato?t+=`- ${r.label}: ${pP(i)}
`:t+=`- ${r.label}: ${i.toLocaleString("pt-BR")}
`}}),t+=`
`),t+=`## Dados

`,e.colunas&&(t+=`| ${e.colunas.map(e=>e.label).join(" | ")} |
| ${e.colunas.map(()=>"---").join(" | ")} |
`,e.dados.forEach(r=>{let i=e.colunas.map(e=>{let t=r[e.campo];switch(e.formato){case"moeda":return pP(t);case"numero":return t?.toLocaleString("pt-BR")||"N/A";case"percentual":return pj(t);case"data":return pD(t);default:return t||"N/A"}});t+=`| ${i.join(" | ")} |
`})),t+=`
---

*Gerado em ${pD(new Date)} \xe0s ${new Date().toLocaleTimeString("pt-BR")}*
`;let r=`${e.titulo||"exportacao"}_${Date.now()}.md`,n=`/tmp/${r}`,s=await Promise.resolve().then(i.t.bind(i,79748,23));return await s.writeFile(n,t,"utf-8"),{url:n,nome:r,tamanho:Buffer.byteLength(t,"utf-8"),formato:"markdown"}}async function pB(e){switch(e.formato){case"excel":return pL(e);case"csv":return p$(e);case"json":return pF(e);case"markdown":return pM(e);default:throw Error(`Formato n\xe3o suportado: ${e.formato}`)}}let pU=nS({campo:ny(),operador:nk(["=","!=",">",">=","<","<=","IN","NOT IN","LIKE","BETWEEN"]),valor:nw(),label:ny().optional()}),pz=nS({query:ny().min(3).max(500),temperatura:n_().min(0).max(2).optional()}),pq=nS({dimensoes:nS({tempo:nE([ny(),n_()]).optional(),geografia:nE([ny(),n_()]).optional(),mercado:nE([ny(),n_()]).optional()}).optional(),filtros:nx(pU),metricas:nx(ny()),agrupamento:nx(ny()).optional(),ordenacao:nx(nS({campo:ny(),direcao:nk(["ASC","DESC"])})).optional(),limit:n_().min(1).max(1e4).optional(),offset:n_().min(0).optional()}),pH=ii({buscaSemantica:uH(nC.ANALISE_READ).input(pz).mutation(async({input:e})=>await pN(e)),consultar:uH(nC.ANALISE_READ).input(pq).query(async({input:e})=>{let t=Date.now(),r=await pW(e.filtros),i=function(e,t){if(0===e)return{tipo:"info",mensagem:"Nenhum registro encontrado com os filtros atuais.",registrosEstimados:0,tempoEstimado:0,sugestoes:[{campo:"all",operador:"=",valor:null,label:"Remover alguns filtros",sugestao:!0,impacto:{registrosAntes:0,registrosDepois:1e3,reducaoPercentual:0,tempoEstimado:2}}]};if(e>1e4){let r=e/1e3*1.5;return{tipo:"warning",mensagem:`Esta consulta retornar\xe1 ${e.toLocaleString("pt-BR")} registros, o que pode levar ${r.toFixed(1)}s para carregar.`,registrosEstimados:e,tempoEstimado:r,sugestoes:function(e,t){let r=[];return e.find(e=>"contexto.segmentoAbc"===e.campo)||r.push({campo:"contexto.segmentoAbc",operador:"IN",valor:["A","B"],label:"Adicionar filtro: Segmento A ou B",sugestao:!0,impacto:{registrosAntes:t,registrosDepois:Math.floor(.4*t),reducaoPercentual:60,tempoEstimado:.4*t/1e3*1.5}}),e.find(e=>"contexto.scoreFit"===e.campo)||r.push({campo:"contexto.scoreFit",operador:">=",valor:70,label:"Adicionar filtro: Score  70",sugestao:!0,impacto:{registrosAntes:t,registrosDepois:Math.floor(.3*t),reducaoPercentual:70,tempoEstimado:.3*t/1e3*1.5}}),r}(t,e)}}if(e>5e3)return{tipo:"info",mensagem:`Consulta retornar\xe1 ${e.toLocaleString("pt-BR")} registros. Considere adicionar filtros para melhorar a performance.`,registrosEstimados:e,tempoEstimado:e/1e3*1.5,sugestoes:[]}}(r,e.filtros);if(r>1e4&&!e.limit)return{dados:[],total:r,pagina:1,porPagina:0,tempoExecucao:Date.now()-t,alert:i};let n=pV(e),s=await uz.execute(n),a=pG(e),o=await uz.execute(a),l=o.rows[0]?.count||0,u=Date.now()-t;return{dados:s.rows,total:Number(l),pagina:e.offset?Math.floor(e.offset/(e.limit||25))+1:1,porPagina:e.limit||s.rows.length,tempoExecucao:u,alert:i}}),exportar:uH(nC.ANALISE_READ).input(nS({formato:nk(["excel","csv","json","markdown"]),filtros:nx(pU),colunas:nx(nS({campo:ny(),label:ny(),formato:nk(["moeda","numero","percentual","data","texto"]).optional()})).optional(),titulo:ny().optional(),incluirGraficos:nv().optional(),incluirResumo:nv().optional()})).mutation(async({input:e})=>{let t=pV({filtros:e.filtros,metricas:["*"],limit:1e4}),r=await uz.execute(t);return await pB({formato:e.formato,dados:r.rows,colunas:e.colunas,titulo:e.titulo,incluirGraficos:e.incluirGraficos,incluirResumo:e.incluirResumo})}),copiar:uH(nC.ANALISE_READ).input(nS({dados:nw(),formato:nk(["texto","markdown","json","csv"])})).query(({input:e})=>(function(e){let t;switch(e.formato){case"texto":var r;t="string"==typeof(r=e.dados)?r:"number"==typeof r?r.toString():"boolean"==typeof r?r?"Sim":"N\xe3o":null==r?"N/A":Array.isArray(r)?r.map((e,t)=>"object"==typeof e?`${t+1}. ${Object.values(e).join(" - ")}`:`${t+1}. ${e}`).join("\n"):"object"==typeof r?Object.entries(r).map(([e,t])=>`${e}: ${t}`).join("\n"):String(r);break;case"markdown":t=function(e){if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return String(e);if(null==e)return"N/A";if(Array.isArray(e)){if(e.length>0&&"object"==typeof e[0]){let t=Object.keys(e[0]),r=`| ${t.join(" | ")} |
`;return r+=`| ${t.map(()=>"---").join(" | ")} |
`,e.forEach(e=>{let i=t.map(t=>e[t]||"N/A");r+=`| ${i.join(" | ")} |
`}),r}return e.map(e=>`- ${e}`).join("\n")}return"object"==typeof e?Object.entries(e).map(([e,t])=>`**${e}:** ${t}`).join("\n\n"):String(e)}(e.dados);break;case"json":t=JSON.stringify(e.dados,null,2);break;case"csv":t=function(e){if(Array.isArray(e)||(e=[e]),0===e.length)return"";if("object"==typeof e[0]){let t=Object.keys(e[0]),r=[];return r.push(t.map(e=>`"${e}"`).join(";")),e.forEach(e=>{let i=t.map(t=>{let r=e[t];return null==r?'""':`"${String(r).replace(/"/g,'""')}"`});r.push(i.join(";"))}),"\uFEFF"+r.join("\n")}return"\uFEFF"+e.map(e=>`"${e}"`).join("\n")}(e.dados);break;default:throw Error(`Formato n\xe3o suportado: ${e.formato}`)}return{conteudo:t,formato:e.formato}})(e)),combinacoesRecomendadas:uH(nC.ANALISE_READ).query(async()=>[{nome:"Leads Qualificados Premium",descricao:"Leads de alto valor com maior probabilidade de convers\xe3o",filtros:[{campo:"tipoEntidade",operador:"=",valor:"lead",label:"Tipo: Lead"},{campo:"contexto.segmentoAbc",operador:"=",valor:"A",label:"Segmento: A"},{campo:"contexto.scoreFit",operador:">=",valor:80,label:"Score  80"},{campo:"contexto.probabilidadeConversao",operador:">=",valor:70,label:"Prob.  70%"}],metricas:{registros:67,receitaPotencial:452e5,scoreMedia:87,taxaConversaoHistorica:68}},{nome:"Oportunidades Regionais Sul",descricao:"Empresas de tecnologia na regi\xe3o Sul com alto potencial",filtros:[{campo:"tipoEntidade",operador:"=",valor:"lead",label:"Tipo: Lead"},{campo:"mercado.setor",operador:"LIKE",valor:"%Tecnologia%",label:"Setor: Tecnologia"},{campo:"geografia.estado",operador:"IN",valor:["RS","SC","PR"],label:"Regi\xe3o: Sul"},{campo:"contexto.receitaPotencialAnual",operador:">=",valor:5e6,label:"Receita  R$ 5M"}],metricas:{registros:47,receitaPotencial:385e5,scoreMedia:75,taxaConversaoHistorica:54}},{nome:"Grandes Contas Sudeste",descricao:"Empresas de grande porte no Sudeste",filtros:[{campo:"tipoEntidade",operador:"=",valor:"lead",label:"Tipo: Lead"},{campo:"geografia.estado",operador:"IN",valor:["SP","RJ","MG","ES"],label:"Regi\xe3o: Sudeste"},{campo:"contexto.receitaPotencialAnual",operador:">=",valor:1e7,label:"Receita  R$ 10M"},{campo:"entidade.numFuncionarios",operador:">=",valor:500,label:"Funcion\xe1rios  500"}],metricas:{registros:89,receitaPotencial:125e6,scoreMedia:82,taxaConversaoHistorica:61}}])});async function pW(e){let t=pG({filtros:e,metricas:["*"]}),r=await uz.execute(t);return Number(r.rows[0]?.count||0)}function pV(e){return aT`
    SELECT e.*, g.*, m.*, c.*
    FROM dim_entidade e
    LEFT JOIN dim_geografia g ON e.geografia_id = g.id
    LEFT JOIN dim_mercado m ON e.mercado_id = m.id
    LEFT JOIN fato_entidade_contexto c ON e.id = c.entidade_id
    WHERE e.deleted_at IS NULL
    LIMIT ${e.limit||25}
    OFFSET ${e.offset||0}
  `}function pG(e){return aT`
    SELECT COUNT(*) as count
    FROM dim_entidade e
    LEFT JOIN dim_geografia g ON e.geografia_id = g.id
    LEFT JOIN dim_mercado m ON e.mercado_id = m.id
    LEFT JOIN fato_entidade_contexto c ON e.id = c.entidade_id
    WHERE e.deleted_at IS NULL
  `}let pK=nS({dataInicio:ny().or(nb()),dataFim:ny().or(nb()),granularidade:nk(["dia","semana","mes","trimestre","ano"]).optional()}),pJ=nS({metrica:ny(),periodo:pK,filtros:nx(nw()).optional(),compararCom:pK.optional()}),pQ=ii({evolucao:uH(nC.ANALISE_READ).input(pJ).query(async({input:e})=>{let{metrica:t,periodo:r,filtros:i,compararCom:n}=e,s=r.granularidade||"mes",a=aT`
        SELECT 
          t.${aT.raw(s)} as periodo,
          ${aT.raw(pZ(t))} as valor
        FROM fato_entidade_contexto c
        INNER JOIN dim_tempo t ON c.tempo_id = t.id
        WHERE t.data BETWEEN ${r.dataInicio} AND ${r.dataFim}
          AND c.deleted_at IS NULL
        GROUP BY t.${aT.raw(s)}
        ORDER BY t.${aT.raw(s)}
      `,o=await uz.execute(a),l=null;if(n){let e=aT`
          SELECT 
            t.${aT.raw(s)} as periodo,
            ${aT.raw(pZ(t))} as valor
          FROM fato_entidade_contexto c
          INNER JOIN dim_tempo t ON c.tempo_id = t.id
          WHERE t.data BETWEEN ${n.dataInicio} AND ${n.dataFim}
            AND c.deleted_at IS NULL
          GROUP BY t.${aT.raw(s)}
          ORDER BY t.${aT.raw(s)}
        `;l=(await uz.execute(e)).rows}return{dados:o.rows,comparacao:l,periodo:r,granularidade:s}}),sazonalidade:uH(nC.ANALISE_READ).input(nS({metrica:ny(),tipo:nk(["mensal","semanal","diaria"]),anos:nx(n_()).optional()})).query(async({input:e})=>{let{metrica:t,tipo:r,anos:i}=e,n="mes";"semanal"===r&&(n="dia_semana"),"diaria"===r&&(n="dia");let s=aT`
        SELECT 
          t.${aT.raw(n)} as periodo,
          ${aT.raw(pZ(t))} as valor,
          COUNT(*) as ocorrencias
        FROM fato_entidade_contexto c
        INNER JOIN dim_tempo t ON c.tempo_id = t.id
        WHERE c.deleted_at IS NULL
          ${i&&i.length>0?aT`AND t.ano IN (${aT.join(i,aT`, `)})`:aT``}
        GROUP BY t.${aT.raw(n)}
        ORDER BY t.${aT.raw(n)}
      `;return{dados:(await uz.execute(s)).rows,tipo:r,anos:i}}),tendencia:uH(nC.ANALISE_READ).input(nS({metrica:ny(),periodo:pK,previsao:n_().optional()})).query(async({input:e})=>{let{metrica:t,periodo:r,previsao:i}=e,n=aT`
        SELECT 
          t.data,
          t.mes,
          t.ano,
          ${aT.raw(pZ(t))} as valor
        FROM fato_entidade_contexto c
        INNER JOIN dim_tempo t ON c.tempo_id = t.id
        WHERE t.data BETWEEN ${r.dataInicio} AND ${r.dataFim}
          AND c.deleted_at IS NULL
        GROUP BY t.data, t.mes, t.ano
        ORDER BY t.data
      `,s=(await uz.execute(n)).rows,a=function(e){if(e.length<2)return{inclinacao:0,intercepto:0,r2:0,direcao:"estavel"};let t=e.length,r=0,i=0,n=0,s=0;e.forEach((e,t)=>{let a=Number(e.valor)||0;r+=t,i+=a,n+=t*a,s+=t*t});let a=(t*n-r*i)/(t*s-r*r),o=(i-a*r)/t,l=i/t,u=0,c=0;e.forEach((e,t)=>{let r=Number(e.valor)||0;u+=Math.pow(r-l,2),c+=Math.pow(r-(a*t+o),2)});let h=1-c/u,d="estavel";return Math.abs(a)>.01&&(d=a>0?"crescente":"decrescente"),{inclinacao:a,intercepto:o,r2:h,direcao:d}}(s),o=null;return i&&i>0&&(o=function(e,t,r){let i=[],n=new Date(e[e.length-1].data);for(let s=1;s<=r;s++){let r=new Date(n);r.setMonth(r.getMonth()+s);let a=e.length+s-1,o=t.inclinacao*a+t.intercepto;i.push({data:r.toISOString().split("T")[0],valor:Math.max(0,o),tipo:"previsao"})}return i}(s,a,i)),{dados:s,tendencia:a,previsao:o}}),comparacao:uH(nC.ANALISE_READ).input(nS({metrica:ny(),periodos:nx(nS({nome:ny(),dataInicio:ny().or(nb()),dataFim:ny().or(nb())}))})).query(async({input:e})=>{let{metrica:t,periodos:r}=e;return await Promise.all(r.map(async e=>{let r=aT`
            SELECT 
              ${aT.raw(pZ(t))} as valor,
              COUNT(*) as registros
            FROM fato_entidade_contexto c
            INNER JOIN dim_tempo t ON c.tempo_id = t.id
            WHERE t.data BETWEEN ${e.dataInicio} AND ${e.dataFim}
              AND c.deleted_at IS NULL
          `,i=await uz.execute(r);return{nome:e.nome,periodo:e,valor:i.rows[0]?.valor||0,registros:i.rows[0]?.registros||0}}))}),calendarioCalor:uH(nC.ANALISE_READ).input(nS({metrica:ny(),ano:n_(),mes:n_().optional()})).query(async({input:e})=>{let{metrica:t,ano:r,mes:i}=e,n=aT`
        SELECT 
          t.data,
          t.dia,
          t.mes,
          t.dia_semana,
          ${aT.raw(pZ(t))} as valor
        FROM fato_entidade_contexto c
        INNER JOIN dim_tempo t ON c.tempo_id = t.id
        WHERE t.ano = ${r}
          ${i?aT`AND t.mes = ${i}`:aT``}
          AND c.deleted_at IS NULL
        GROUP BY t.data, t.dia, t.mes, t.dia_semana
        ORDER BY t.data
      `;return{dados:(await uz.execute(n)).rows,ano:r,mes:i}})});function pZ(e){return({receita_potencial:"SUM(c.receita_potencial_anual)",score_fit:"AVG(c.score_fit)",probabilidade_conversao:"AVG(c.probabilidade_conversao)",ltv:"AVG(c.ltv_estimado)",cac:"AVG(c.cac_estimado)",ticket_medio:"AVG(c.ticket_medio_estimado)",count:"COUNT(*)"})[e]||`AVG(c.${e})`}let pX=nS({latitude:n_().min(-90).max(90),longitude:n_().min(-180).max(180)}),pY=nS({norte:n_(),sul:n_(),leste:n_(),oeste:n_()}),p0=ii({dadosMapa:uH(nC.ANALISE_READ).input(nS({bbox:pY.optional(),filtros:nx(nw()).optional(),metrica:ny().optional(),agrupar:nv().optional()})).query(async({input:e})=>{let{bbox:t,filtros:r,metrica:i,agrupar:n}=e,s=aT`
        SELECT 
          g.id,
          g.latitude,
          g.longitude,
          g.cidade,
          g.estado,
          g.pais,
          COUNT(e.id) as total_entidades,
          ${i?aT.raw(`SUM(c.${i})`):aT`0`} as valor_metrica
        FROM dim_geografia g
        LEFT JOIN dim_entidade e ON e.geografia_id = g.id AND e.deleted_at IS NULL
        LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
        WHERE g.deleted_at IS NULL
      `;t&&(s=aT`${s}
          AND g.latitude BETWEEN ${t.sul} AND ${t.norte}
          AND g.longitude BETWEEN ${t.oeste} AND ${t.leste}
        `),s=aT`${s}
        GROUP BY g.id, g.latitude, g.longitude, g.cidade, g.estado, g.pais
        HAVING COUNT(e.id) > 0
        ORDER BY total_entidades DESC
      `;let a=await uz.execute(s);return n?{tipo:"clusters",dados:function(e){let t=[],r=new Set;return e.forEach((i,n)=>{if(r.has(n))return;let s={latitude:i.latitude,longitude:i.longitude,pontos:[i],total_entidades:i.total_entidades,valor_metrica:i.valor_metrica};e.forEach((e,t)=>{!(n===t||r.has(t))&&50>=function(e,t,r,i){let n=(r-e)*Math.PI/180,s=(i-t)*Math.PI/180,a=Math.sin(n/2)*Math.sin(n/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(s/2)*Math.sin(s/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371}(i.latitude,i.longitude,e.latitude,e.longitude)&&(s.pontos.push(e),s.total_entidades+=e.total_entidades,s.valor_metrica+=e.valor_metrica,r.add(t))}),s.pontos.length>1&&(s.latitude=s.pontos.reduce((e,t)=>e+t.latitude,0)/s.pontos.length,s.longitude=s.pontos.reduce((e,t)=>e+t.longitude,0)/s.pontos.length),t.push(s),r.add(n)}),t}(a.rows)}:{tipo:"pontos",dados:a.rows}}),heatmap:uH(nC.ANALISE_READ).input(nS({metrica:ny(),granularidade:nk(["cidade","estado","regiao","pais"]).optional()})).query(async({input:e})=>{let{metrica:t,granularidade:r="estado"}=e,i="cidade"===r?"g.cidade":"estado"===r?"g.estado":"regiao"===r?"g.regiao":"g.pais",n=aT`
        SELECT 
          ${aT.raw(i)} as local,
          AVG(g.latitude) as latitude,
          AVG(g.longitude) as longitude,
          ${aT.raw(`SUM(c.${t})`)} as valor,
          COUNT(DISTINCT e.id) as total_entidades
        FROM dim_geografia g
        INNER JOIN dim_entidade e ON e.geografia_id = g.id AND e.deleted_at IS NULL
        INNER JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
        WHERE g.deleted_at IS NULL
        GROUP BY ${aT.raw(i)}
        ORDER BY valor DESC
      `,s=await uz.execute(n),a=s.rows.map(e=>Number(e.valor)||0),o=Math.max(...a),l=Math.min(...a);return{dados:s.rows.map(e=>({...e,intensidade:o>l?(Number(e.valor)-l)/(o-l):.5})),granularidade:r,metrica:t,estatisticas:{min:l,max:o,media:a.reduce((e,t)=>e+t,0)/a.length}}}),drillDown:uH(nC.ANALISE_READ).input(nS({nivel:nk(["pais","macrorregiao","mesorregiao","microrregiao","estado","cidade"]),valor:ny(),metrica:ny().optional()})).query(async({input:e})=>{let{nivel:t,valor:r,metrica:i}=e,n=function(e){let t=["pais","macrorregiao","mesorregiao","microrregiao","estado","cidade"],r=t.indexOf(e);return -1===r||r===t.length-1?null:t[r+1]}(t);if(!n){let e=aT`
          SELECT 
            e.id,
            e.nome,
            e.tipo_entidade,
            g.cidade,
            g.estado,
            g.latitude,
            g.longitude,
            ${i?aT.raw(`c.${i}`):aT`NULL`} as valor
          FROM dim_entidade e
          INNER JOIN dim_geografia g ON e.geografia_id = g.id
          LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
          WHERE g.${aT.raw(t)} = ${r}
            AND e.deleted_at IS NULL
            AND g.deleted_at IS NULL
          ORDER BY e.nome
        `;return{nivel:"entidades",dados:(await uz.execute(e)).rows}}let s=aT`
        SELECT 
          g.${aT.raw(n)} as nome,
          COUNT(DISTINCT e.id) as total_entidades,
          ${i?aT.raw(`SUM(c.${i})`):aT`0`} as valor,
          AVG(g.latitude) as latitude,
          AVG(g.longitude) as longitude
        FROM dim_geografia g
        LEFT JOIN dim_entidade e ON e.geografia_id = g.id AND e.deleted_at IS NULL
        LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
        WHERE g.${aT.raw(t)} = ${r}
          AND g.deleted_at IS NULL
        GROUP BY g.${aT.raw(n)}
        HAVING COUNT(DISTINCT e.id) > 0
        ORDER BY valor DESC
      `;return{nivel:n,dados:(await uz.execute(s)).rows}}),topPorRegiao:uH(nC.ANALISE_READ).input(nS({nivel:nk(["pais","estado","cidade"]),metrica:ny(),limite:n_().min(1).max(100).optional()})).query(async({input:e})=>{let{nivel:t,metrica:r,limite:i=10}=e,n=aT`
        SELECT 
          g.${aT.raw(t)} as regiao,
          ${aT.raw(`SUM(c.${r})`)} as valor,
          COUNT(DISTINCT e.id) as total_entidades,
          AVG(g.latitude) as latitude,
          AVG(g.longitude) as longitude
        FROM dim_geografia g
        INNER JOIN dim_entidade e ON e.geografia_id = g.id AND e.deleted_at IS NULL
        INNER JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
        WHERE g.deleted_at IS NULL
        GROUP BY g.${aT.raw(t)}
        ORDER BY valor DESC
        LIMIT ${i}
      `;return{nivel:t,metrica:r,dados:(await uz.execute(n)).rows}}),compararRegioes:uH(nC.ANALISE_READ).input(nS({regioes:nx(nS({nivel:nk(["pais","estado","cidade"]),valor:ny()})),metricas:nx(ny())})).query(async({input:e})=>{let{regioes:t,metricas:r}=e;return await Promise.all(t.map(async e=>{let t=r.map(e=>`SUM(c.${e}) as ${e}`).join(", "),i=aT`
            SELECT 
              ${aT.raw(t)},
              COUNT(DISTINCT e.id) as total_entidades
            FROM dim_geografia g
            INNER JOIN dim_entidade e ON e.geografia_id = g.id AND e.deleted_at IS NULL
            INNER JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
            WHERE g.${aT.raw(e.nivel)} = ${e.valor}
              AND g.deleted_at IS NULL
          `,n=await uz.execute(i);return{regiao:e.valor,nivel:e.nivel,metricas:n.rows[0]||{}}}))}),geocodingReverso:uH(nC.ANALISE_READ).input(pX).query(async({input:e})=>{let{latitude:t,longitude:r}=e,i=aT`
        SELECT 
          *,
          (
            6371 * acos(
              cos(radians(${t})) * 
              cos(radians(latitude)) * 
              cos(radians(longitude) - radians(${r})) + 
              sin(radians(${t})) * 
              sin(radians(latitude))
            )
          ) AS distancia_km
        FROM dim_geografia
        WHERE deleted_at IS NULL
        ORDER BY distancia_km
        LIMIT 1
      `;return(await uz.execute(i)).rows[0]||null})}),p1=nS({nivel:nk(["setor","subsetor","nicho"]),valor:ny().optional()}),p2=ii({list:is.input(nS({busca:ny().optional(),categoria:ny().optional(),segmentacao:ny().optional(),crescimento:nk(["positivo","estavel","negativo"]).optional(),atratividade:nk(["alta","media","baixa"]).optional(),saturacao:nk(["baixo","medio","alto"]).optional(),limit:n_().min(1).max(100).optional(),offset:n_().min(0).optional()})).query(async({input:e})=>{let{busca:t,categoria:r,segmentacao:i,crescimento:n,atratividade:s,saturacao:a,limit:o=20,offset:l=0}=e,u=[],c=[];t&&(u.push(`(m.nome ILIKE $${c.length+1} OR m.tendencias ILIKE $${c.length+1} OR m.principais_players ILIKE $${c.length+1})`),c.push(`%${t}%`)),r&&(u.push(`m.categoria = $${c.length+1}`),c.push(r)),i&&(u.push(`m.segmentacao = $${c.length+1}`),c.push(i)),n&&("positivo"===n?u.push("CAST(REGEXP_REPLACE(m.crescimento_anual, '[^0-9.-]', '', 'g') AS NUMERIC) > 5"):"estavel"===n?u.push("CAST(REGEXP_REPLACE(m.crescimento_anual, '[^0-9.-]', '', 'g') AS NUMERIC) BETWEEN 0 AND 5"):"negativo"===n&&u.push("CAST(REGEXP_REPLACE(m.crescimento_anual, '[^0-9.-]', '', 'g') AS NUMERIC) < 0")),s&&("alta"===s?u.push("m.score_atratividade >= 80"):"media"===s?u.push("m.score_atratividade BETWEEN 50 AND 79"):"baixa"===s&&u.push("m.score_atratividade < 50")),a&&(u.push(`m.nivel_saturacao = $${c.length+1}`),c.push(a));let h=u.length>0?`WHERE ${u.join(" AND ")}`:"";c.push(o,l);let d=`
        SELECT 
          m.*,
          COUNT(*) OVER() as total_count
        FROM dim_mercado m
        ${h}
        ORDER BY m.created_at DESC
        LIMIT $${c.length-1} OFFSET $${c.length}
      `,p=await uz.execute(aT.raw(d,c));return{data:p.rows,total:p.rows[0]?.total_count||0}}),getById:is.input(nS({id:n_()})).query(async({input:e})=>{let t=await uz.query.dimMercado.findFirst({where:lB(e8.dimMercado.id,e.id)});if(!t)throw Error("Mercado n\xe3o encontrado");return t}),hierarquia:uH(nC.ANALISE_READ).input(nS({tipo:nk(["arvore","sunburst","treemap"]).optional(),metrica:ny().optional()})).query(async({input:e})=>{let{tipo:t="arvore",metrica:r}=e,i=aT`
        SELECT 
          m.id,
          m.nome,
          m.setor,
          m.subsetor,
          m.nicho,
          COUNT(DISTINCT e.id) as total_entidades,
          ${r?aT.raw(`SUM(c.${r})`):aT`0`} as valor
        FROM dim_mercado m
        LEFT JOIN dim_entidade e ON e.mercado_id = m.id AND e.deleted_at IS NULL
        LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
        WHERE m.deleted_at IS NULL
        GROUP BY m.id, m.nome, m.setor, m.subsetor, m.nicho
        ORDER BY m.setor, m.subsetor, m.nicho
      `,n=function(e,t){return"arvore"===t?p5(e):"sunburst"===t||"treemap"===t?p5(e):e}((await uz.execute(i)).rows,t);return{tipo:t,metrica:r,dados:n}}),drillDown:uH(nC.ANALISE_READ).input(p1).query(async({input:e})=>{let{nivel:t,valor:r}=e,i=function(e){let t=["setor","subsetor","nicho"],r=t.indexOf(e);return -1===r||r===t.length-1?null:t[r+1]}(t);if(!i){let e=aT`
          SELECT 
            e.id,
            e.nome,
            e.tipo_entidade,
            m.nome as mercado,
            c.receita_potencial_anual,
            c.score_fit
          FROM dim_entidade e
          INNER JOIN dim_mercado m ON e.mercado_id = m.id
          LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
          WHERE m.${aT.raw(t)} = ${r}
            AND e.deleted_at IS NULL
            AND m.deleted_at IS NULL
          ORDER BY c.score_fit DESC
        `;return{nivel:"entidades",dados:(await uz.execute(e)).rows}}let n=aT`
        SELECT 
          m.${aT.raw(i)} as nome,
          COUNT(DISTINCT e.id) as total_entidades,
          SUM(c.receita_potencial_anual) as receita_total,
          AVG(c.score_fit) as score_medio
        FROM dim_mercado m
        LEFT JOIN dim_entidade e ON e.mercado_id = m.id AND e.deleted_at IS NULL
        LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
        WHERE m.${aT.raw(t)} = ${r}
          AND m.deleted_at IS NULL
        GROUP BY m.${aT.raw(i)}
        HAVING COUNT(DISTINCT e.id) > 0
        ORDER BY receita_total DESC
      `;return{nivel:i,dados:(await uz.execute(n)).rows}}),analiseConcorrencia:uH(nC.ANALISE_READ).input(nS({mercadoId:n_(),incluirMetricas:nv().optional()})).query(async({input:e})=>{let{mercadoId:t,incluirMetricas:r=!0}=e,i=await uz.query.dimMercado.findFirst({where:lB(e8.dimMercado.id,t)});if(!i)throw Error("Mercado n\xe3o encontrado");let n=aT`
        SELECT 
          e.id,
          e.nome,
          e.tipo_entidade,
          c.receita_potencial_anual,
          c.score_fit,
          comp.share_of_voice,
          comp.vantagem_competitiva_score,
          comp.ameaca_nivel
        FROM dim_entidade e
        INNER JOIN dim_mercado m ON e.mercado_id = m.id
        LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
        LEFT JOIN fato_entidade_competidor comp ON comp.competidor_id = e.id AND comp.deleted_at IS NULL
        WHERE m.id = ${t}
          AND e.tipo_entidade = 'concorrente'
          AND e.deleted_at IS NULL
        ORDER BY comp.share_of_voice DESC
      `,s=await uz.execute(n),a=null;if(r){let e=aT`
          SELECT 
            COUNT(DISTINCT e.id) as total_players,
            SUM(c.receita_potencial_anual) as receita_total_mercado,
            AVG(c.score_fit) as score_medio,
            SUM(CASE WHEN e.tipo_entidade = 'cliente' THEN 1 ELSE 0 END) as total_clientes,
            SUM(CASE WHEN e.tipo_entidade = 'concorrente' THEN 1 ELSE 0 END) as total_concorrentes,
            SUM(CASE WHEN e.tipo_entidade = 'lead' THEN 1 ELSE 0 END) as total_leads
          FROM dim_entidade e
          LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
          WHERE e.mercado_id = ${t}
            AND e.deleted_at IS NULL
        `;a=(await uz.execute(e)).rows[0]}return{mercado:i,concorrentes:s.rows,metricas:a}}),oportunidades:uH(nC.ANALISE_READ).input(nS({limite:n_().min(1).max(100).optional(),filtroScore:n_().min(0).max(100).optional()})).query(async({input:e})=>{let{limite:t=10,filtroScore:r=70}=e,i=aT`
        SELECT 
          m.id,
          m.nome as mercado,
          m.setor,
          m.subsetor,
          COUNT(DISTINCT CASE WHEN e.tipo_entidade = 'lead' THEN e.id END) as total_leads,
          SUM(CASE WHEN e.tipo_entidade = 'lead' THEN c.receita_potencial_anual ELSE 0 END) as receita_potencial,
          AVG(CASE WHEN e.tipo_entidade = 'lead' THEN c.score_fit END) as score_medio_leads,
          COUNT(DISTINCT CASE WHEN e.tipo_entidade = 'concorrente' THEN e.id END) as total_concorrentes
        FROM dim_mercado m
        LEFT JOIN dim_entidade e ON e.mercado_id = m.id AND e.deleted_at IS NULL
        LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
        WHERE m.deleted_at IS NULL
        GROUP BY m.id, m.nome, m.setor, m.subsetor
        HAVING AVG(CASE WHEN e.tipo_entidade = 'lead' THEN c.score_fit END) >= ${r}
          AND COUNT(DISTINCT CASE WHEN e.tipo_entidade = 'lead' THEN e.id END) > 0
        ORDER BY receita_potencial DESC
        LIMIT ${t}
      `;return(await uz.execute(i)).rows}),comparar:uH(nC.ANALISE_READ).input(nS({mercadoIds:nx(n_()),metricas:nx(ny()).optional()})).query(async({input:e})=>{let{mercadoIds:t,metricas:r=["receita_potencial_anual","score_fit"]}=e;return await Promise.all(t.map(async e=>{let t=await uz.query.dimMercado.findFirst({where:lB(e8.dimMercado.id,e)}),i=r.map(e=>`AVG(c.${e}) as ${e}`).join(", "),n=aT`
            SELECT 
              ${aT.raw(i)},
              COUNT(DISTINCT e.id) as total_entidades,
              COUNT(DISTINCT CASE WHEN e.tipo_entidade = 'cliente' THEN e.id END) as total_clientes,
              COUNT(DISTINCT CASE WHEN e.tipo_entidade = 'concorrente' THEN e.id END) as total_concorrentes,
              COUNT(DISTINCT CASE WHEN e.tipo_entidade = 'lead' THEN e.id END) as total_leads
            FROM dim_entidade e
            LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
            WHERE e.mercado_id = ${e}
              AND e.deleted_at IS NULL
          `;return{mercado:t,metricas:(await uz.execute(n)).rows[0]||{}}}))}),tendencias:uH(nC.ANALISE_READ).input(nS({mercadoId:n_().optional(),periodo:nS({dataInicio:ny().or(nb()),dataFim:ny().or(nb())})})).query(async({input:e})=>{let{mercadoId:t,periodo:r}=e,i=aT`
        SELECT 
          t.mes,
          t.ano,
          m.nome as mercado,
          COUNT(DISTINCT e.id) as total_entidades,
          SUM(c.receita_potencial_anual) as receita_total,
          AVG(c.score_fit) as score_medio
        FROM dim_tempo t
        INNER JOIN fato_entidade_contexto c ON c.tempo_id = t.id AND c.deleted_at IS NULL
        INNER JOIN dim_entidade e ON c.entidade_id = e.id AND e.deleted_at IS NULL
        INNER JOIN dim_mercado m ON e.mercado_id = m.id
        WHERE t.data BETWEEN ${r.dataInicio} AND ${r.dataFim}
          ${t?aT`AND m.id = ${t}`:aT``}
        GROUP BY t.mes, t.ano, m.nome
        ORDER BY t.ano, t.mes
      `;return(await uz.execute(i)).rows})});function p5(e){let t={nome:"Mercados",children:[]},r=new Map;return e.forEach(e=>{r.has(e.setor)||r.set(e.setor,{nome:e.setor,children:[],total_entidades:0,valor:0});let t=r.get(e.setor);t.total_entidades+=e.total_entidades,t.valor+=e.valor;let i=t.children.find(t=>t.nome===e.subsetor);i||(i={nome:e.subsetor,children:[],total_entidades:0,valor:0},t.children.push(i)),i.total_entidades+=e.total_entidades,i.valor+=e.valor,i.children.push({nome:e.nicho,mercado_id:e.id,total_entidades:e.total_entidades,valor:e.valor})}),t.children=Array.from(r.values()),t}let p6=ii({detalhes360:uH(nC.ANALISE_READ).input(nS({entidadeId:n_()})).query(async({input:e})=>{let{entidadeId:t}=e,r=await uz.query.dimEntidade.findFirst({where:lB(e8.dimEntidade.id,t),with:{geografia:!0,mercado:!0}});if(!r)throw Error("Entidade n\xe3o encontrada");let i=await uz.query.fatoEntidadeContexto.findFirst({where:lB(e8.fatoEntidadeContexto.entidadeId,t)}),n=await uz.query.fatoEntidadeProduto.findMany({where:lB(e8.fatoEntidadeProduto.entidadeId,t),with:{produto:!0}}),s=null;if("cliente"===r.tipoEntidade){let e=aT`
          SELECT 
            e.id,
            e.nome,
            comp.*
          FROM fato_entidade_competidor comp
          INNER JOIN dim_entidade e ON comp.competidor_id = e.id
          WHERE comp.cliente_id = ${t}
            AND comp.deleted_at IS NULL
            AND e.deleted_at IS NULL
          ORDER BY comp.share_of_voice DESC
        `;s=(await uz.execute(e)).rows}let a=null;if("cliente"===r.tipoEntidade){let e=aT`
          SELECT 
            e.id,
            e.nome,
            c.receita_potencial_anual,
            c.score_fit,
            c.probabilidade_conversao,
            c.segmento_abc
          FROM dim_entidade e
          INNER JOIN fato_entidade_contexto c ON c.entidade_id = e.id
          WHERE e.tipo_entidade = 'lead'
            AND e.mercado_id = ${r.mercadoId}
            AND e.deleted_at IS NULL
            AND c.deleted_at IS NULL
          ORDER BY c.score_fit DESC
          LIMIT 10
        `;a=(await uz.execute(e)).rows}let o=aT`
        SELECT 
          t.data,
          t.mes,
          t.ano,
          c.receita_potencial_anual,
          c.score_fit,
          c.probabilidade_conversao
        FROM fato_entidade_contexto c
        INNER JOIN dim_tempo t ON c.tempo_id = t.id
        WHERE c.entidade_id = ${t}
          AND c.deleted_at IS NULL
        ORDER BY t.data DESC
        LIMIT 12
      `;return{entidade:r,contexto:i,produtos:n,concorrentes:s,leads:a,historico:(await uz.execute(o)).rows}}),listar:uH(nC.ANALISE_READ).input(nS({tipo:nk(["cliente","concorrente","lead"]).optional(),mercadoId:n_().optional(),geografiaId:n_().optional(),filtros:nx(nw()).optional(),ordenacao:nS({campo:ny(),direcao:nk(["ASC","DESC"])}).optional(),pagina:n_().min(1).optional(),porPagina:n_().min(1).max(100).optional()})).query(async({input:e})=>{let{tipo:t,mercadoId:r,geografiaId:i,ordenacao:n,pagina:s=1,porPagina:a=25}=e,o=aT`
        SELECT 
          e.*,
          g.cidade,
          g.estado,
          g.pais,
          m.nome as mercado_nome,
          c.receita_potencial_anual,
          c.score_fit,
          c.probabilidade_conversao,
          c.segmento_abc
        FROM dim_entidade e
        LEFT JOIN dim_geografia g ON e.geografia_id = g.id
        LEFT JOIN dim_mercado m ON e.mercado_id = m.id
        LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
        WHERE e.deleted_at IS NULL
      `;if(t&&(o=aT`${o} AND e.tipo_entidade = ${t}`),r&&(o=aT`${o} AND e.mercado_id = ${r}`),i&&(o=aT`${o} AND e.geografia_id = ${i}`),n){let e=n.campo.includes(".")?n.campo:`e.${n.campo}`;o=aT`${o} ORDER BY ${aT.raw(e)} ${aT.raw(n.direcao)}`}else o=aT`${o} ORDER BY c.score_fit DESC`;o=aT`${o} LIMIT ${a} OFFSET ${(s-1)*a}`;let l=await uz.execute(o),u=aT`
        SELECT COUNT(*) as total
        FROM dim_entidade e
        WHERE e.deleted_at IS NULL
      `;t&&(u=aT`${u} AND e.tipo_entidade = ${t}`),r&&(u=aT`${u} AND e.mercado_id = ${r}`),i&&(u=aT`${u} AND e.geografia_id = ${i}`);let c=await uz.execute(u),h=Number(c.rows[0]?.total||0);return{dados:l.rows,paginacao:{pagina:s,porPagina:a,total:h,totalPaginas:Math.ceil(h/a)}}}),similares:uH(nC.ANALISE_READ).input(nS({entidadeId:n_(),limite:n_().min(1).max(50).optional()})).query(async({input:e})=>{let{entidadeId:t,limite:r=10}=e,i=await uz.query.dimEntidade.findFirst({where:lB(e8.dimEntidade.id,t)});if(!i)throw Error("Entidade n\xe3o encontrada");let n=aT`
        SELECT 
          e.*,
          g.cidade,
          g.estado,
          m.nome as mercado_nome,
          c.receita_potencial_anual,
          c.score_fit,
          c.probabilidade_conversao,
          (
            CASE 
              WHEN e.mercado_id = ${i.mercadoId} THEN 50
              ELSE 0
            END +
            CASE 
              WHEN e.geografia_id = ${i.geografiaId} THEN 30
              ELSE 0
            END +
            CASE 
              WHEN ABS(c.receita_potencial_anual - (
                SELECT receita_potencial_anual 
                FROM fato_entidade_contexto 
                WHERE entidade_id = ${t}
              )) < 1000000 THEN 20
              ELSE 0
            END
          ) as score_similaridade
        FROM dim_entidade e
        LEFT JOIN dim_geografia g ON e.geografia_id = g.id
        LEFT JOIN dim_mercado m ON e.mercado_id = m.id
        LEFT JOIN fato_entidade_contexto c ON c.entidade_id = e.id AND c.deleted_at IS NULL
        WHERE e.id != ${t}
          AND e.deleted_at IS NULL
        ORDER BY score_similaridade DESC, c.score_fit DESC
        LIMIT ${r}
      `;return(await uz.execute(n)).rows}),recomendacoes:uH(nC.ANALISE_READ).input(nS({entidadeId:n_()})).query(async({input:e})=>{let{entidadeId:t}=e,r=await uz.query.fatoEntidadeContexto.findFirst({where:lB(e8.fatoEntidadeContexto.entidadeId,t)});if(!r)return[];let i=[];return r.scoreFit&&r.scoreFit<50&&i.push({tipo:"alerta",prioridade:"alta",titulo:"Score de fit baixo",descricao:`O score de fit (${r.scoreFit}) est\xe1 abaixo do ideal. Considere revisar o perfil ou desqualificar.`,acoes:["Revisar perfil da empresa","Atualizar informa\xe7\xf5es","Desqualificar lead"]}),r.probabilidadeConversao&&r.probabilidadeConversao>70&&i.push({tipo:"oportunidade",prioridade:"alta",titulo:"Alta probabilidade de convers\xe3o",descricao:`Probabilidade de convers\xe3o de ${r.probabilidadeConversao}%. Priorize o contato.`,acoes:["Agendar reuni\xe3o","Enviar proposta","Fazer follow-up"]}),"A"===r.segmentoAbc&&i.push({tipo:"destaque",prioridade:"media",titulo:"Cliente premium (Segmento A)",descricao:"Este \xe9 um cliente de alto valor. Mantenha relacionamento pr\xf3ximo.",acoes:["Agendar QBR","Oferecer upsell","Solicitar case de sucesso"]}),r.receitaPotencialAnual&&r.receitaPotencialAnual>5e6&&i.push({tipo:"oportunidade",prioridade:"alta",titulo:"Alto potencial de receita",descricao:`Receita potencial de R$ ${(r.receitaPotencialAnual/1e6).toFixed(1)}M. Grande oportunidade.`,acoes:["Envolver executivo","Preparar proposta customizada","Mapear stakeholders"]}),r.ehClienteIdeal&&i.push({tipo:"destaque",prioridade:"alta",titulo:"Cliente ideal identificado",descricao:"Esta empresa se encaixa perfeitamente no perfil de cliente ideal (ICP).",acoes:["Priorizar na prospec\xe7\xe3o","Alocar SDR senior","Preparar abordagem personalizada"]}),i}),rastreabilidade:uH(nC.ANALISE_READ).input(nS({entidadeId:n_()})).query(async({input:e})=>{let{entidadeId:t}=e,r=await uz.query.dimEntidade.findFirst({where:lB(e8.dimEntidade.id,t)});if(!r)throw Error("Entidade n\xe3o encontrada");let i=await uz.query.fatoEntidadeContexto.findFirst({where:lB(e8.fatoEntidadeContexto.entidadeId,t)});return{entidade:{origem:r.origem,criadoEm:r.createdAt,criadoPor:r.createdBy,atualizadoEm:r.updatedAt,atualizadoPor:r.updatedBy},contexto:i?{origem:i.origem,criadoEm:i.createdAt,criadoPor:i.createdBy,atualizadoEm:i.updatedAt,atualizadoPor:i.updatedBy}:null}}),atualizar:uH(nC.ANALISE_WRITE).input(nS({id:n_(),nome:ny().optional(),cnpj:ny().optional(),email:ny().email().optional().nullable(),telefone:ny().optional().nullable(),celular:ny().optional().nullable(),website:ny().optional().nullable(),endereco:ny().optional().nullable(),cidade:ny().optional().nullable(),estado:ny().optional().nullable(),cep:ny().optional().nullable(),setor:ny().optional().nullable(),porte:ny().optional().nullable()})).mutation(async({input:e,ctx:t})=>{let{id:r,...i}=e;if(!await uz.query.dimEntidade.findFirst({where:lB(e8.dimEntidade.id,r)}))throw Error("Entidade n\xe3o encontrada");return(await uz.update(e8.dimEntidade).set({...i,updatedAt:new Date,updatedBy:t.user?.email||"sistema"}).where(lB(e8.dimEntidade.id,r)).returning())[0]}),excluir:uH(nC.ANALISE_WRITE).input(nS({id:n_()})).mutation(async({input:e,ctx:t})=>{let{id:r}=e;if(!await uz.query.dimEntidade.findFirst({where:lB(e8.dimEntidade.id,r)}))throw Error("Entidade n\xe3o encontrada");return await uz.update(e8.dimEntidade).set({deletedAt:new Date,updatedBy:t.user?.email||"sistema"}).where(lB(e8.dimEntidade.id,r)),{success:!0}})}),p3=ii({list:is.query(async()=>await uz.select().from(e8.dimStatusQualificacao).orderBy(l8(e8.dimStatusQualificacao.ordem)))}),p4=ii({listar:uH(nC.ANALISE_READ).input(nS({search:ny().optional(),categoria:ny().optional(),subcategoria:ny().optional(),sku:ny().optional(),ean:ny().optional(),ncm:ny().optional(),precoMin:n_().optional(),precoMax:n_().optional(),ativo:nv().optional(),ordenacao:nS({campo:ny(),direcao:nk(["ASC","DESC"])}).optional(),pagina:n_().min(1).optional(),porPagina:n_().min(1).max(100).optional()})).query(async({input:e})=>{let{search:t,categoria:r,subcategoria:i,sku:n,ean:s,ncm:a,precoMin:o,precoMax:l,ativo:u,ordenacao:c,pagina:h=1,porPagina:d=20}=e;console.log("[PRODUTO API] Iniciando list com input:",JSON.stringify(e));let p=[lZ(e8.dimProdutoCatalogo.deletedAt)];t&&p.push(lq(l3(e8.dimProdutoCatalogo.nome,`%${t}%`),l3(e8.dimProdutoCatalogo.descricao,`%${t}%`))),r&&p.push(lB(e8.dimProdutoCatalogo.categoria,r)),i&&p.push(lB(e8.dimProdutoCatalogo.subcategoria,i)),n&&p.push(l3(e8.dimProdutoCatalogo.sku,`%${n}%`)),s&&p.push(lB(e8.dimProdutoCatalogo.ean,s)),a&&p.push(lB(e8.dimProdutoCatalogo.ncm,a)),void 0!==o&&p.push(lV(e8.dimProdutoCatalogo.preco,o.toString())),void 0!==l&&p.push(lK(e8.dimProdutoCatalogo.preco,l.toString())),void 0!==u&&p.push(lB(e8.dimProdutoCatalogo.ativo,u));let f=l7(e8.dimProdutoCatalogo.createdAt);if(c){let e=e8.dimProdutoCatalogo[c.campo];f="ASC"===c.direcao?l8(e):l7(e)}let m=await uz.select().from(e8.dimProdutoCatalogo).where(lz(...p)).orderBy(f).limit(d).offset((h-1)*d),[{total:g}]=await uz.select({total:uW()}).from(e8.dimProdutoCatalogo).where(lz(...p));return{dados:m,paginacao:{pagina:h,porPagina:d,total:Number(g),totalPaginas:Math.ceil(Number(g)/d)}}}),getById:uH(nC.ANALISE_READ).input(nS({produtoId:n_()})).query(async({input:e})=>{let{produtoId:t}=e;try{let e=await uz.select().from(e8.dimProdutoCatalogo).where(lz(lB(e8.dimProdutoCatalogo.id,t),lZ(e8.dimProdutoCatalogo.deletedAt))).limit(1);if(0===e.length)throw Error("Produto n\xe3o encontrado");return e[0]}catch(e){throw console.error("Erro ao buscar produto:",e),Error(`Falha ao buscar produto: ${e.message}`)}}),getCategorias:uH(nC.ANALISE_READ).query(async()=>{try{return(await uz.selectDistinct({categoria:e8.dimProdutoCatalogo.categoria}).from(e8.dimProdutoCatalogo).where(lz(lZ(e8.dimProdutoCatalogo.deletedAt),aT`${e8.dimProdutoCatalogo.categoria} IS NOT NULL`)).orderBy(l8(e8.dimProdutoCatalogo.categoria))).map(e=>e.categoria)}catch(e){return console.error("Erro ao listar categorias:",e),[]}}),getSubcategorias:uH(nC.ANALISE_READ).input(nS({categoria:ny().optional()})).query(async({input:e})=>{let{categoria:t}=e;try{let e=[lZ(e8.dimProdutoCatalogo.deletedAt),aT`${e8.dimProdutoCatalogo.subcategoria} IS NOT NULL`];return t&&e.push(lB(e8.dimProdutoCatalogo.categoria,t)),(await uz.selectDistinct({subcategoria:e8.dimProdutoCatalogo.subcategoria}).from(e8.dimProdutoCatalogo).where(lz(...e)).orderBy(l8(e8.dimProdutoCatalogo.subcategoria))).map(e=>e.subcategoria)}catch(e){return console.error("Erro ao listar subcategorias:",e),[]}}),getStats:uH(nC.ANALISE_READ).query(async()=>{try{return(await uz.select({total:uW(),ativos:aT`COUNT(CASE WHEN ${e8.dimProdutoCatalogo.ativo} = true THEN 1 END)`,inativos:aT`COUNT(CASE WHEN ${e8.dimProdutoCatalogo.ativo} = false THEN 1 END)`,categorias:aT`COUNT(DISTINCT ${e8.dimProdutoCatalogo.categoria})`,preco_medio:aT`AVG(${e8.dimProdutoCatalogo.preco})`,preco_min:aT`MIN(${e8.dimProdutoCatalogo.preco})`,preco_max:aT`MAX(${e8.dimProdutoCatalogo.preco})`}).from(e8.dimProdutoCatalogo).where(lZ(e8.dimProdutoCatalogo.deletedAt)))[0]}catch(e){return console.error("Erro ao buscar estat\xedsticas:",e),{total:0,ativos:0,inativos:0,categorias:0,preco_medio:0,preco_min:0,preco_max:0}}}),getEntidades:uH(nC.ANALISE_READ).input(nS({produtoId:n_(),pagina:n_().min(1).optional(),porPagina:n_().min(1).max(100).optional()})).query(async({input:e})=>{let{produtoId:t,pagina:r=1,porPagina:i=20}=e;try{let e=await uz.execute({sql:`
            SELECT 
              e.*,
              ep.quantidade,
              ep.valor_unitario,
              ep.valor_total
            FROM fato_entidade_produto ep
            INNER JOIN dim_entidade e ON ep.entidade_id = e.id
            WHERE ep.produto_id = $1
              AND ep.deleted_at IS NULL
              AND e.deleted_at IS NULL
            ORDER BY ep.created_at DESC
            LIMIT $2 OFFSET $3
          `,args:[t,i,(r-1)*i]}),n=await uz.execute({sql:`
            SELECT COUNT(*) as total
            FROM fato_entidade_produto ep
            INNER JOIN dim_entidade e ON ep.entidade_id = e.id
            WHERE ep.produto_id = $1
              AND ep.deleted_at IS NULL
              AND e.deleted_at IS NULL
          `,args:[t]}),s=Number(n.rows[0]?.total||0);return{dados:e.rows,paginacao:{pagina:r,porPagina:i,total:s,totalPaginas:Math.ceil(s/i)}}}catch(e){return console.error("Erro ao listar entidades do produto:",e),{dados:[],paginacao:{pagina:r,porPagina:i,total:0,totalPaginas:0}}}}),getMercados:uH(nC.ANALISE_READ).input(nS({produtoId:n_(),pagina:n_().min(1).optional(),porPagina:n_().min(1).max(100).optional()})).query(async({input:e})=>{let{produtoId:t,pagina:r=1,porPagina:i=20}=e;try{let e=await uz.execute({sql:`
            SELECT 
              m.*,
              pm.share_of_market,
              pm.volume_vendas
            FROM fato_produto_mercado pm
            INNER JOIN dim_mercado m ON pm.mercado_id = m.id
            WHERE pm.produto_id = $1
              AND pm.deleted_at IS NULL
              AND m.deleted_at IS NULL
            ORDER BY pm.share_of_market DESC
            LIMIT $2 OFFSET $3
          `,args:[t,i,(r-1)*i]}),n=await uz.execute({sql:`
            SELECT COUNT(*) as total
            FROM fato_produto_mercado pm
            INNER JOIN dim_mercado m ON pm.mercado_id = m.id
            WHERE pm.produto_id = $1
              AND pm.deleted_at IS NULL
              AND m.deleted_at IS NULL
          `,args:[t]}),s=Number(n.rows[0]?.total||0);return{dados:e.rows,paginacao:{pagina:r,porPagina:i,total:s,totalPaginas:Math.ceil(s/i)}}}catch(e){return console.error("Erro ao listar mercados do produto:",e),{dados:[],paginacao:{pagina:r,porPagina:i,total:0,totalPaginas:0}}}})}),p8=ii({getDashboardData:is.query(async()=>{let e=aT`
        SELECT 
          (SELECT COUNT(*) FROM dim_projeto WHERE deleted_at IS NULL) as total_projetos,
          (SELECT COUNT(*) FROM dim_pesquisa WHERE deleted_at IS NULL) as total_pesquisas,
          (SELECT COUNT(*) FROM dim_entidade WHERE deleted_at IS NULL) as total_entidades,
          (SELECT COUNT(*) FROM dim_entidade WHERE tipo_entidade = 'cliente' AND deleted_at IS NULL) as total_clientes,
          (SELECT COUNT(*) FROM dim_entidade WHERE tipo_entidade = 'lead' AND deleted_at IS NULL) as total_leads,
          (SELECT COUNT(*) FROM dim_entidade WHERE tipo_entidade = 'concorrente' AND deleted_at IS NULL) as total_concorrentes,
          (SELECT COUNT(*) FROM dim_produto) as total_produtos,
          (SELECT COUNT(*) FROM dim_mercado) as total_mercados
      `,t=(await uz.execute(e)).rows[0]||{};return{kpis:{totalProjetos:Number(t.total_projetos)||0,totalPesquisas:Number(t.total_pesquisas)||0,totalEntidades:Number(t.total_entidades)||0,totalClientes:Number(t.total_clientes)||0,totalLeads:Number(t.total_leads)||0,totalConcorrentes:Number(t.total_concorrentes)||0,totalProdutos:Number(t.total_produtos)||0,totalMercados:Number(t.total_mercados)||0,receitaPotencial:0,scoreMedioFit:0,taxaConversao:0,crescimentoMensal:0},distribuicao:{porTipo:[],porSegmento:[]},topMercados:[],topRegioes:[],atividadesRecentes:[]}}),totalizadores:is.input(nS({projetoId:n_().nullable().optional(),pesquisaId:n_().nullable().optional()}).optional()).query(async({input:e})=>{let{projetoId:t,pesquisaId:r}=e||{},i=[];t&&i.push(`projeto_id = ${t}`),r&&i.push(`pesquisa_id = ${r}`);let n=i.length>0?`AND ${i.join(" AND ")}`:"",s=aT.raw(`
        SELECT 
          'clientes' as tipo,
          'Clientes' as label,
          COUNT(*) FILTER (WHERE deleted_at IS NULL) as total_geral,
          COUNT(*) FILTER (WHERE deleted_at IS NULL ${n}) as total_filtrado,
          'clientes' as icon,
          'green' as color,
          'Ativo' as status,
          'green' as "statusColor",
          '/entidades?tipo=cliente' as endpoint
        FROM dim_entidade WHERE tipo_entidade = 'cliente'
        UNION ALL
        SELECT 
          'leads' as tipo,
          'Leads' as label,
          COUNT(*) FILTER (WHERE deleted_at IS NULL) as total_geral,
          COUNT(*) FILTER (WHERE deleted_at IS NULL ${n}) as total_filtrado,
          'leads' as icon,
          'yellow' as color,
          'Ativo' as status,
          'yellow' as "statusColor",
          '/entidades?tipo=lead' as endpoint
        FROM dim_entidade WHERE tipo_entidade = 'lead'
        UNION ALL
        SELECT 
          'concorrentes' as tipo,
          'Concorrentes' as label,
          COUNT(*) FILTER (WHERE deleted_at IS NULL) as total_geral,
          COUNT(*) FILTER (WHERE deleted_at IS NULL ${n}) as total_filtrado,
          'concorrentes' as icon,
          'red' as color,
          'Ativo' as status,
          'red' as "statusColor",
          '/entidades?tipo=concorrente' as endpoint
        FROM dim_entidade WHERE tipo_entidade = 'concorrente'
        UNION ALL
        SELECT 
          'produtos' as tipo,
          'Produtos' as label,
          COUNT(*) as total_geral,
          COUNT(*) as total_filtrado,
          'produtos' as icon,
          'blue' as color,
          'Ativo' as status,
          'blue' as "statusColor",
          '/produtos' as endpoint
        FROM dim_produto
        UNION ALL
        SELECT 
          'mercados' as tipo,
          'Mercados' as label,
          COUNT(*) as total_geral,
          COUNT(*) as total_filtrado,
          'mercados' as icon,
          'purple' as color,
          'Ativo' as status,
          'purple' as "statusColor",
          '/mercados' as endpoint
        FROM dim_mercado
        UNION ALL
        SELECT 
          'projetos' as tipo,
          'Projetos' as label,
          COUNT(*) FILTER (WHERE deleted_at IS NULL) as total_geral,
          COUNT(*) FILTER (WHERE deleted_at IS NULL) as total_filtrado,
          'projetos' as icon,
          'indigo' as color,
          'Ativo' as status,
          'indigo' as "statusColor",
          '/projetos' as endpoint
        FROM dim_projeto
        UNION ALL
        SELECT 
          'pesquisas' as tipo,
          'Pesquisas' as label,
          COUNT(*) FILTER (WHERE deleted_at IS NULL) as total_geral,
          COUNT(*) FILTER (WHERE deleted_at IS NULL ${n}) as total_filtrado,
          'pesquisas' as icon,
          'pink' as color,
          'Ativo' as status,
          'pink' as "statusColor",
          '/pesquisas' as endpoint
        FROM dim_pesquisa
      `);return{success:!0,filtros:{projeto_id:t||null,projeto_nome:null,pesquisa_id:r||null,pesquisa_nome:null},totalizadores:(await uz.execute(s)).rows.map(e=>({...e,percentual:e.total_geral>0?Math.round(e.total_filtrado/e.total_geral*100):0})),timestamp:new Date().toISOString()}})}),p7=ii({health:is.query(()=>({status:"ok",timestamp:new Date().toISOString()})),projetos:cp,pesquisas:cf,entidades:pu,importacao:pO,cubo:pH,temporal:pQ,geografia:p0,mercado:p2,entidade:p6,statusQualificacao:p3,produto:p4,dashboard:p8});var p9=i(921);let fe=e=>e?(...t)=>e(...t):(...e)=>fetch(...e);class ft extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class fr extends ft{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class fi extends ft{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class fn extends ft{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(eK||(eK={}));class fs{constructor(e,{headers:t={},customFetch:r,region:i=eK.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=fe(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return(0,p9.__awaiter)(this,arguments,void 0,function*(e,t={}){var r;let i,n;try{let s;let{headers:a,method:o,body:l,signal:u,timeout:c}=t,h={},{region:d}=t;d||(d=this.region);let p=new URL(`${this.url}/${e}`);d&&"any"!==d&&(h["x-region"]=d,p.searchParams.set("forceFunctionRegion",d)),l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?"undefined"!=typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",s=l):"string"==typeof l?(h["Content-Type"]="text/plain",s=l):"undefined"!=typeof FormData&&l instanceof FormData?s=l:(h["Content-Type"]="application/json",s=JSON.stringify(l)):s=l;let f=u;c&&(n=new AbortController,i=setTimeout(()=>n.abort(),c),u?(f=n.signal,u.addEventListener("abort",()=>n.abort())):f=n.signal);let m=yield this.fetch(p.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),a),body:s,signal:f}).catch(e=>{throw new fr(e)}),g=m.headers.get("x-relay-error");if(g&&"true"===g)throw new fi(m);if(!m.ok)throw new fn(m);let y=(null!==(r=m.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return{data:"application/json"===y?yield m.json():"application/octet-stream"===y||"application/pdf"===y?yield m.blob():"text/event-stream"===y?m:"multipart/form-data"===y?yield m.formData():yield m.text(),error:null,response:m}}catch(e){return{data:null,error:e,response:e instanceof fn||e instanceof fi?e.context:void 0}}finally{i&&clearTimeout(i)}})}}var fa=i(30003),fo=i.t(fa,2);let{PostgrestClient:fl,PostgrestQueryBuilder:fu,PostgrestFilterBuilder:fc,PostgrestTransformBuilder:fh,PostgrestBuilder:fd,PostgrestError:fp}=fa||fo;class ff{constructor(){}static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process){let e=process.versions;if(e&&e.node){let t=parseInt(e.node.replace(/^v/,"").split(".")[0]);return t>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{let e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}let fm="1.0.0";(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(eJ||(eJ={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(eQ||(eQ={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(eZ||(eZ={})),(eX||(eX={})).websocket="websocket",function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(eY||(eY={}));class fg{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=e?e:[]}encode(e,t){return e.event!==this.BROADCAST_EVENT||e.payload instanceof ArrayBuffer||"string"!=typeof e.payload.event?t(JSON.stringify([e.join_ref,e.ref,e.topic,e.event,e.payload])):t(this._binaryEncodeUserBroadcastPush(e))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null===(t=e.payload)||void 0===t?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;let i=null!==(r=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==r?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(e){var t,r;let i=null!==(r=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==r?r:{},n=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,n)}_encodeUserBroadcastPush(e,t,r){let i=e.topic,n=null!==(p=e.ref)&&void 0!==p?p:"",s=null!==(f=e.join_ref)&&void 0!==f?f:"",a=e.payload.event,o=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},l=0===Object.keys(o).length?"":JSON.stringify(o);if(s.length>255)throw Error(`joinRef length ${s.length} exceeds maximum of 255`);if(n.length>255)throw Error(`ref length ${n.length} exceeds maximum of 255`);if(i.length>255)throw Error(`topic length ${i.length} exceeds maximum of 255`);if(a.length>255)throw Error(`userEvent length ${a.length} exceeds maximum of 255`);if(l.length>255)throw Error(`metadata length ${l.length} exceeds maximum of 255`);let u=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+n.length+i.length+a.length+l.length,c=new ArrayBuffer(this.HEADER_LENGTH+u),h=new DataView(c),d=0;h.setUint8(d++,this.KINDS.userBroadcastPush),h.setUint8(d++,s.length),h.setUint8(d++,n.length),h.setUint8(d++,i.length),h.setUint8(d++,a.length),h.setUint8(d++,l.length),h.setUint8(d++,t),Array.from(s,e=>h.setUint8(d++,e.charCodeAt(0))),Array.from(n,e=>h.setUint8(d++,e.charCodeAt(0))),Array.from(i,e=>h.setUint8(d++,e.charCodeAt(0))),Array.from(a,e=>h.setUint8(d++,e.charCodeAt(0))),Array.from(l,e=>h.setUint8(d++,e.charCodeAt(0)));var p,f,m=new Uint8Array(c.byteLength+r.byteLength);return m.set(new Uint8Array(c),0),m.set(new Uint8Array(r),c.byteLength),m.buffer}decode(e,t){if(this._isArrayBuffer(e))return t(this._binaryDecode(e));if("string"==typeof e){let[r,i,n,s,a]=JSON.parse(e);return t({join_ref:r,ref:i,topic:n,event:s,payload:a})}return t({})}_binaryDecode(e){let t=new DataView(e),r=t.getUint8(0),i=new TextDecoder;if(r===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,i)}_decodeUserBroadcast(e,t,r){let i=t.getUint8(1),n=t.getUint8(2),s=t.getUint8(3),a=t.getUint8(4),o=this.HEADER_LENGTH+4,l=r.decode(e.slice(o,o+i));o+=i;let u=r.decode(e.slice(o,o+n));o+=n;let c=r.decode(e.slice(o,o+s));o+=s;let h=e.slice(o,e.byteLength),d=a===this.JSON_ENCODING?JSON.parse(r.decode(h)):h,p={type:this.BROADCAST_EVENT,event:u,payload:d};return s>0&&(p.meta=JSON.parse(c)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||(null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return e&&"object"==typeof e?Object.fromEntries(Object.entries(e).filter(([e])=>t.includes(e))):{}}}class fy{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(e0||(e0={}));let f_=(e,t,r={})=>{var i;let n=null!==(i=r.skipTypes)&&void 0!==i?i:[];return t?Object.keys(t).reduce((r,i)=>(r[i]=fv(i,e,t,n),r),{}):{}},fv=(e,t,r,i)=>{let n=t.find(t=>t.name===e),s=null==n?void 0:n.type,a=r[e];return s&&!i.includes(s)?fb(s,a):fw(a)},fb=(e,t)=>{if("_"===e.charAt(0))return fT(t,e.slice(1,e.length));switch(e){case e0.bool:return fx(t);case e0.float4:case e0.float8:case e0.int2:case e0.int4:case e0.int8:case e0.numeric:case e0.oid:return fS(t);case e0.json:case e0.jsonb:return fE(t);case e0.timestamp:return fk(t);case e0.abstime:case e0.date:case e0.daterange:case e0.int4range:case e0.int8range:case e0.money:case e0.reltime:case e0.text:case e0.time:case e0.timestamptz:case e0.timetz:case e0.tsrange:case e0.tstzrange:default:return fw(t)}},fw=e=>e,fx=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},fS=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},fE=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},fT=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,i=e[r];if("{"===e[0]&&"}"===i){let i;let n=e.slice(1,r);try{i=JSON.parse("["+n+"]")}catch(e){i=n?n.split(","):[]}return i.map(e=>fb(t,e))}return e},fk=e=>"string"==typeof e?e.replace(" ","T"):e,fO=e=>{let t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class fC{constructor(e,t,r={},i=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(e1||(e1={}));class fA{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fA.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=fA.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],i()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=fA.syncDiff(this.state,e,t,r),i())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,i){let n=this.cloneDeep(e),s=this.transformState(t),a={},o={};return this.map(n,(e,t)=>{s[e]||(o[e]=t)}),this.map(s,(e,t)=>{let r=n[e];if(r){let i=t.map(e=>e.presence_ref),n=r.map(e=>e.presence_ref),s=t.filter(e=>0>n.indexOf(e.presence_ref)),l=r.filter(e=>0>i.indexOf(e.presence_ref));s.length>0&&(a[e]=s),l.length>0&&(o[e]=l)}else a[e]=t}),this.syncDiff(n,{joins:a,leaves:o},r,i)}static syncDiff(e,t,r,i){let{joins:n,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(n,(t,i)=>{var n;let s=null!==(n=e[t])&&void 0!==n?n:[];if(e[t]=this.cloneDeep(i),s.length>0){let r=e[t].map(e=>e.presence_ref),i=s.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...i)}r(t,s,i)}),this.map(s,(t,r)=>{let n=e[t];if(!n)return;let s=r.map(e=>e.presence_ref);n=n.filter(e=>0>s.indexOf(e.presence_ref)),e[t]=n,i(t,n,r),0===n.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let i=e[r];return"metas"in i?t[r]=i.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(e2||(e2={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(e5||(e5={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(e6||(e6={}));class fN{constructor(e,t={config:{}},r){var i,n;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=eQ.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new fC(this,eZ.join,this.params,this.timeout),this.rejoinTimer=new fy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=eQ.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=eQ.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=eQ.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=eQ.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=eQ.errored,this.rejoinTimer.scheduleTimeout())}),this._on(eZ.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new fA(this),this.broadcastEndpointURL=fO(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(n=null===(i=this.params.config)||void 0===i?void 0:i.broadcast)||void 0===n?void 0:n.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,i,n;if(this.socket.isConnected()||this.socket.connect(),this.state==eQ.closed){let{config:{broadcast:s,presence:a,private:o}}=this.params,l=null!==(i=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==i?i:[],u=!!this.bindings[e5.PRESENCE]&&this.bindings[e5.PRESENCE].length>0||(null===(n=this.params.config.presence)||void 0===n?void 0:n.enabled)===!0,c={},h={broadcast:s,presence:Object.assign(Object.assign({},a),{enabled:u}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(e6.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(e6.CLOSED)),this.updateJoinPayload(Object.assign({config:h},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket.setAuth(),void 0===t){null==e||e(e6.SUBSCRIBED);return}{let i=this.bindings.postgres_changes,n=null!==(r=null==i?void 0:i.length)&&void 0!==r?r:0,s=[];for(let r=0;r<n;r++){let n=i[r],{filter:{event:a,schema:o,table:l,filter:u}}=n,c=t&&t[r];if(c&&c.event===a&&c.schema===o&&c.table===l&&c.filter===u)s.push(Object.assign(Object.assign({},n),{id:c.id}));else{this.unsubscribe(),this.state=eQ.errored,null==e||e(e6.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=s,e&&e(e6.SUBSCRIBED);return}}).receive("error",t=>{this.state=eQ.errored,null==e||e(e6.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(e6.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===eQ.joined&&e===e5.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var i;let n=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(null==t)return Promise.reject("Payload is required for httpSend()");let s={method:"POST",headers:{Authorization:n,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(i=r.timeout)&&void 0!==i?i:this.timeout);if(202===a.status)return{success:!0};let o=a.statusText;try{let e=await a.json();o=e.error||e.message||o}catch(e){}return Promise.reject(Error(o))}async send(e,t={}){var r,i;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var i,n,s;let a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(n=null===(i=this.params)||void 0===i?void 0:i.config)||void 0===n?void 0:n.broadcast)||void 0===s?void 0:s.ack)||r("ok"),a.receive("ok",()=>r("ok")),a.receive("error",()=>r("error")),a.receive("timeout",()=>r("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");let{event:n,payload:s}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:s,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await (null===(i=e.body)||void 0===i?void 0:i.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=eQ.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(eZ.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{(r=new fC(this,eZ.leave,{},e)).receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=eQ.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){let i=new AbortController,n=setTimeout(()=>i.abort(),r),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(n),s}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new fC(this,e,t,r);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){let e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var i,n;let s=e.toLocaleLowerCase(),{close:a,error:o,leave:l,join:u}=eZ;if(r&&[a,o,l,u].indexOf(s)>=0&&r!==this._joinRef())return;let c=this._onMessage(s,t,r);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(i=this.bindings.postgres_changes)||void 0===i||i.filter(e=>{var t,r,i;return(null===(t=e.filter)||void 0===t?void 0:t.event)==="*"||(null===(i=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===i?void 0:i.toLocaleLowerCase())===s}).map(e=>e.callback(c,r)):null===(n=this.bindings[s])||void 0===n||n.filter(e=>{var r,i,n,a,o,l;if(!["broadcast","presence","postgres_changes"].includes(s))return e.type.toLocaleLowerCase()===s;if("id"in e){let s=e.id,a=null===(r=e.filter)||void 0===r?void 0:r.event;return s&&(null===(i=t.ids)||void 0===i?void 0:i.includes(s))&&("*"===a||(null==a?void 0:a.toLocaleLowerCase())===(null===(n=t.data)||void 0===n?void 0:n.type.toLocaleLowerCase()))}{let r=null===(o=null===(a=null==e?void 0:e.filter)||void 0===a?void 0:a.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof c&&"ids"in c){let e=c.data,{schema:t,table:r,commit_timestamp:i,type:n,errors:s}=e;c=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:i,eventType:n,new:{},old:{},errors:s}),this._getPayloadRecords(e))}e.callback(c,r)})}_isClosed(){return this.state===eQ.closed}_isJoined(){return this.state===eQ.joined}_isJoining(){return this.state===eQ.joining}_isLeaving(){return this.state===eQ.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let i=e.toLocaleLowerCase(),n={type:i,filter:t,callback:r};return this.bindings[i]?this.bindings[i].push(n):this.bindings[i]=[n],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var i;return!((null===(i=e.type)||void 0===i?void 0:i.toLocaleLowerCase())===r&&fN.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(eZ.close,{},e)}_onError(e){this._on(eZ.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=eQ.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=f_(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=f_(e.columns,e.old_record)),t}}let fR=()=>{},fI={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},fP=[1e3,2e3,5e3,1e4],fj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class fD{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=fI.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=fR,this.ref=0,this.reconnectTimer=null,this.vsn=fm,this.logger=fR,this.conn=null,this.sendBuffer=[],this.serializer=new fg,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),!(null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${eX.websocket}`,this.httpEndpoint=fO(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ff.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");let e=t.message;if(e.includes("Node.js"))throw Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting()){if(this._setConnectionState("disconnecting",!0),this.conn){let r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(e?this.conn.close(e,null!=t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case eJ.connecting:return eY.Connecting;case eJ.open:return eY.Open;case eJ.closing:return eY.Closing;default:return eY.Closed}}isConnected(){return this.connectionState()===eY.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){let r=`realtime:${e}`,i=this.getChannels().find(e=>e.topic===r);if(i)return i;{let r=new fN(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){let{topic:t,event:r,payload:i,ref:n}=e,s=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${n})`,i),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},fI.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(e){this.log("error","error in heartbeat callback",e)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);let{topic:t,event:r,payload:i,ref:n}=e,s=n?`(${n})`:"",a=i.status||"";this.log("receive",`${a} ${t} ${r} ${s}`.trim(),i),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,i,n)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===eJ.open||this.conn.readyState===eJ.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(eZ.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${r}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([fj],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;t=e||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t,version:"realtime-js/2.86.0"}),e.joinedOnce&&e._isJoined()&&e._push(eZ.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(t){this.log("error",`error in ${e} callback`,t)}})}catch(t){this.log("error",`error triggering ${e} callbacks`,t)}}_setupReconnectionTimer(){this.reconnectTimer=new fy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},fI.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,i,n,s,a,o,l,u,c,h,d;switch(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:1e4,this.heartbeatIntervalMs=null!==(i=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==i?i:fI.HEARTBEAT_INTERVAL,this.worker=null!==(n=null==e?void 0:e.worker)&&void 0!==n&&n,this.accessToken=null!==(s=null==e?void 0:e.accessToken)&&void 0!==s?s:null,this.heartbeatCallback=null!==(a=null==e?void 0:e.heartbeatCallback)&&void 0!==a?a:fR,this.vsn=null!==(o=null==e?void 0:e.vsn)&&void 0!==o?o:fm,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null==e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>fP[e-1]||1e4,this.vsn){case fm:this.encode=null!==(u=null==e?void 0:e.encode)&&void 0!==u?u:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null==e?void 0:e.decode)&&void 0!==c?c:(e,t)=>t(JSON.parse(e));break;case"2.0.0":this.encode=null!==(h=null==e?void 0:e.encode)&&void 0!==h?h:this.serializer.encode.bind(this.serializer),this.decode=null!==(d=null==e?void 0:e.decode)&&void 0!==d?d:this.serializer.decode.bind(this.serializer);break;default:throw Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}class fL extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function f$(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class fF extends fL{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class fM extends fL{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let fB=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),fU=()=>Response,fz=e=>{if(Array.isArray(e))return e.map(e=>fz(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,r])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=fz(r)}),t},fq=e=>{if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},fH=e=>!(!e||"string"!=typeof e||0===e.length||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\"))&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e),fW=e=>{var t;return e.msg||e.message||e.error_description||("string"==typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},fV=(e,t,r)=>(0,p9.__awaiter)(void 0,void 0,void 0,function*(){e instanceof(yield fU())&&!(null==r?void 0:r.noResolveJson)?e.json().then(r=>{let i=e.status||500,n=(null==r?void 0:r.statusCode)||i+"";t(new fF(fW(r),i,n))}).catch(e=>{t(new fM(fW(e),e))}):t(new fM(fW(e),e))}),fG=(e,t,r,i)=>{let n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&i?(fq(i)?(n.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),n.body=JSON.stringify(i)):n.body=i,(null==t?void 0:t.duplex)&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),r)):n};function fK(e,t,r,i,n,s){return(0,p9.__awaiter)(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,fG(t,i,n,s)).then(e=>{if(!e.ok)throw e;return(null==i?void 0:i.noResolveJson)?e:e.json()}).then(e=>a(e)).catch(e=>fV(e,o,i))})})}function fJ(e,t,r,i){return(0,p9.__awaiter)(this,void 0,void 0,function*(){return fK(e,"GET",t,r,i)})}function fQ(e,t,r,i,n){return(0,p9.__awaiter)(this,void 0,void 0,function*(){return fK(e,"POST",t,i,n,r)})}function fZ(e,t,r,i,n){return(0,p9.__awaiter)(this,void 0,void 0,function*(){return fK(e,"PUT",t,i,n,r)})}function fX(e,t,r,i,n){return(0,p9.__awaiter)(this,void 0,void 0,function*(){return fK(e,"DELETE",t,i,n,r)})}class fY{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}}class f0{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[e3]="BlobDownloadBuilder",this.promise=null}asStream(){return new fY(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{let e=yield this.downloadFn();return{data:yield e.blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}}e3=Symbol.toStringTag;let f1={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},f2={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class f5{constructor(e,t={},r,i){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=fB(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,i){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{let n;let s=Object.assign(Object.assign({},f2),i),a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)}),o=s.metadata;"undefined"!=typeof Blob&&r instanceof Blob?((n=new FormData).append("cacheControl",s.cacheControl),o&&n.append("metadata",this.encodeMetadata(o)),n.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?((n=r).has("cacheControl")||n.append("cacheControl",s.cacheControl),o&&!n.has("metadata")&&n.append("metadata",this.encodeMetadata(o))):(n=r,a["cache-control"]=`max-age=${s.cacheControl}`,a["content-type"]=s.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o))),("undefined"!=typeof ReadableStream&&n instanceof ReadableStream||n&&"object"==typeof n&&"pipe"in n&&"function"==typeof n.pipe)&&!s.duplex&&(s.duplex="half")),(null==i?void 0:i.headers)&&(a=Object.assign(Object.assign({},a),i.headers));let l=this._removeEmptyFolders(t),u=this._getFinalPath(l),c=yield("PUT"==e?fZ:fQ)(this.fetch,`${this.url}/object/${u}`,n,Object.assign({headers:a},(null==s?void 0:s.duplex)?{duplex:s.duplex}:{}));return{data:{path:l,id:c.Id,fullPath:c.Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}upload(e,t,r){return(0,p9.__awaiter)(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,i){return(0,p9.__awaiter)(this,void 0,void 0,function*(){let n=this._removeEmptyFolders(e),s=this._getFinalPath(n),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",t);try{let e;let t=Object.assign({upsert:f2.upsert},i),s=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,s["cache-control"]=`max-age=${t.cacheControl}`,s["content-type"]=t.contentType);let o=yield fZ(this.fetch,a.toString(),e,{headers:s});return{data:{path:n,fullPath:o.Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(i["x-upsert"]="true");let n=yield fQ(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),s=new URL(this.url+n.url),a=s.searchParams.get("token");if(!a)throw new fL("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:a},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}update(e,t,r){return(0,p9.__awaiter)(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield fQ(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}copy(e,t,r){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:{path:(yield fQ(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),n=yield fQ(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),s=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n={signedUrl:encodeURI(`${this.url}${n.signedURL}${s}`)},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{let i=yield fQ(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:i.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${n}`):null})),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}download(e,t){let r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",i=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=i?`?${i}`:"",s=this._getFinalPath(e);return new f0(()=>fJ(this.fetch,`${this.url}/${r}/${s}${n}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}info(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let e=yield fJ(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:fz(e),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}exists(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield function(e,t,r,i){return(0,p9.__awaiter)(this,void 0,void 0,function*(){return fK(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),void 0)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e)&&e instanceof fM){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){let r=this._getFinalPath(e),i=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&i.push(n);let s=void 0!==(null==t?void 0:t.transform),a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==a&&i.push(a);let o=i.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s?"render/image":"object"}/public/${r}${o}`)}}}remove(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield fX(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}list(e,t,r){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{let i=Object.assign(Object.assign(Object.assign({},f1),t),{prefix:e||""});return{data:yield fQ(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}listV2(e,t){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{let r=Object.assign({},e);return{data:yield fQ(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let f6="2.86.0",f3={"X-Client-Info":`storage-js/${f6}`};class f4{constructor(e,t={},r,i){this.shouldThrowOnError=!1;let n=new URL(e);(null==i?void 0:i.useNewHostname)&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},f3),t),this.fetch=fB(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{let t=this.listBucketOptionsToQueryString(e);return{data:yield fJ(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}getBucket(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield fJ(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}createBucket(e){return(0,p9.__awaiter)(this,arguments,void 0,function*(e,t={public:!1}){try{return{data:yield fQ(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield fZ(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}emptyBucket(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield fQ(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}deleteBucket(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield fX(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}listBucketOptionsToQueryString(e){let t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}var f8=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};async function f7(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:`Bearer ${e.token}`}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}function f9(e){return e.join("\x1f")}var me=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){let t=e?{parent:f9(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){let r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${f9(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${f9(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${f9(e.namespace)}`}),!0}catch(e){if(e instanceof f8&&404===e.status)return!1;throw e}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(e){if(e instanceof f8&&409===e.status)return;throw e}}};function mt(e){return e.join("\x1f")}var mr=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${mt(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){let r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${mt(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){let r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${mt(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${mt(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){let t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${mt(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){let t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${mt(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(e){if(e instanceof f8&&404===e.status)return!1;throw e}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof f8&&409===r.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},mi=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);let r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=function(e){let t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:i,query:n,body:s,headers:a}){let o=function(e,t,r){let i=new URL(t,e);if(r)for(let[e,t]of Object.entries(r))void 0!==t&&i.searchParams.set(e,t);return i.toString()}(e.baseUrl,i,n),l=await f7(e.auth),u=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...l,...a},body:s?JSON.stringify(s):void 0}),c=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),d=h&&c?JSON.parse(c):c;if(!u.ok){let e=h?d:void 0,t=e?.error;throw new f8(t?.message??`Request failed with status ${u.status}`,{status:u.status,icebergType:t?.type,icebergCode:t?.code,details:e})}return{status:u.status,headers:u.headers,data:d}}}}({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new me(this.client,t),this.tableOps=new mr(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};class mn{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},f3),t),this.fetch=fB(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield fQ(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}listBuckets(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{let t=new URLSearchParams;(null==e?void 0:e.limit)!==void 0&&t.set("limit",e.limit.toString()),(null==e?void 0:e.offset)!==void 0&&t.set("offset",e.offset.toString()),(null==e?void 0:e.sortColumn)&&t.set("sortColumn",e.sortColumn),(null==e?void 0:e.sortOrder)&&t.set("sortOrder",e.sortOrder),(null==e?void 0:e.search)&&t.set("search",e.search);let r=t.toString(),i=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield fJ(this.fetch,i,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}deleteBucket(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield fX(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(f$(e))return{data:null,error:e};throw e}})}from(e){if(!fH(e))throw new fL("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");return new mi({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>(0,p9.__awaiter)(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch})}}let ms={"X-Client-Info":`storage-js/${f6}`,"Content-Type":"application/json"};class ma extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function mo(e){return"object"==typeof e&&null!==e&&"__isStorageVectorsError"in e}class ml extends ma{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class mu extends ma{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}!function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"}(e4||(e4={}));let mc=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),mh=e=>{if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},md=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),mp=(e,t,r)=>(0,p9.__awaiter)(void 0,void 0,void 0,function*(){if(!(e&&"object"==typeof e&&"status"in e&&"ok"in e&&"number"==typeof e.status)||(null==r?void 0:r.noResolveJson))t(new mu(md(e),e));else{let r=e.status||500;"function"==typeof e.json?e.json().then(e=>{let i=(null==e?void 0:e.statusCode)||(null==e?void 0:e.code)||r+"";t(new ml(md(e),r,i))}).catch(()=>{t(new ml(e.statusText||`HTTP ${r} error`,r,r+""))}):t(new ml(e.statusText||`HTTP ${r} error`,r,r+""))}}),mf=(e,t,r,i)=>{let n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&i?(mh(i)?(n.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),n.body=JSON.stringify(i)):n.body=i,Object.assign(Object.assign({},n),r)):n};function mm(e,t,r,i,n){return(0,p9.__awaiter)(this,void 0,void 0,function*(){return function(e,t,r,i,n,s){return(0,p9.__awaiter)(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,mf(t,i,n,s)).then(e=>{if(!e.ok)throw e;if(null==i?void 0:i.noResolveJson)return e;let t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():{}}).then(e=>a(e)).catch(e=>mp(e,o,i))})})}(e,"POST",t,i,n,r)})}class mg{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ms),t),this.fetch=mc(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:(yield mm(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}getIndex(e,t){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield mm(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}listIndexes(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield mm(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}deleteIndex(e,t){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:(yield mm(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}}class my{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ms),t),this.fetch=mc(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw Error("Vector batch size must be between 1 and 500 items");return{data:(yield mm(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}getVectors(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield mm(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}listVectors(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield mm(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}queryVectors(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield mm(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}deleteVectors(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw Error("Keys batch size must be between 1 and 500 items");return{data:(yield mm(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}}class m_{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ms),t),this.fetch=mc(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:(yield mm(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}getBucket(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:yield mm(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}listBuckets(){return(0,p9.__awaiter)(this,arguments,void 0,function*(e={}){try{return{data:yield mm(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}deleteBucket(e){return(0,p9.__awaiter)(this,void 0,void 0,function*(){try{return{data:(yield mm(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(mo(e))return{data:null,error:e};throw e}})}}class mv extends m_{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new mb(this.url,this.headers,e,this.fetch)}createBucket(e){let t=Object.create(null,{createBucket:{get:()=>super.createBucket}});return(0,p9.__awaiter)(this,void 0,void 0,function*(){return t.createBucket.call(this,e)})}getBucket(e){let t=Object.create(null,{getBucket:{get:()=>super.getBucket}});return(0,p9.__awaiter)(this,void 0,void 0,function*(){return t.getBucket.call(this,e)})}listBuckets(){let e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return(0,p9.__awaiter)(this,arguments,void 0,function*(t={}){return e.listBuckets.call(this,t)})}deleteBucket(e){let t=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return(0,p9.__awaiter)(this,void 0,void 0,function*(){return t.deleteBucket.call(this,e)})}}class mb extends mg{constructor(e,t,r,i){super(e,t,i),this.vectorBucketName=r}createIndex(e){let t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return(0,p9.__awaiter)(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){let e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return(0,p9.__awaiter)(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){let t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return(0,p9.__awaiter)(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){let t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return(0,p9.__awaiter)(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new mw(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class mw extends my{constructor(e,t,r,i,n){super(e,t,n),this.vectorBucketName=r,this.indexName=i}putVectors(e){let t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return(0,p9.__awaiter)(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){let t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return(0,p9.__awaiter)(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){let e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return(0,p9.__awaiter)(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){let t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return(0,p9.__awaiter)(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){let t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return(0,p9.__awaiter)(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class mx extends f4{constructor(e,t={},r,i){super(e,t,r,i)}from(e){return new f5(this.url,this.headers,e,this.fetch)}get vectors(){return new mv(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new mn(this.url+"/iceberg",this.headers,this.fetch)}}let mS="";"undefined"!=typeof Deno?mS="deno":"undefined"!=typeof document?mS="web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?mS="react-native":mS="node";let mE={headers:{"X-Client-Info":`supabase-js-${mS}/2.86.0`}},mT={schema:"public"},mk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},mO={},mC=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),mA=()=>Headers,mN=(e,t,r)=>{let i=mC(r),n=mA();return async(r,s)=>{var a;let o=null!==(a=await t())&&void 0!==a?a:e,l=new n(null==s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),i(r,Object.assign(Object.assign({},s),{headers:l}))}},mR="2.86.0",mI={"X-Client-Info":`gotrue-js/${mR}`},mP="X-Supabase-Api-Version",mj={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},mD=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class mL extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function m$(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class mF extends mL{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class mM extends mL{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class mB extends mL{constructor(e,t,r,i){super(e,r,i),this.name=t,this.status=r}}class mU extends mB{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class mz extends mB{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class mq extends mB{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class mH extends mB{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class mW extends mB{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class mV extends mB{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function mG(e){return m$(e)&&"AuthRetryableFetchError"===e.name}class mK extends mB{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class mJ extends mB{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}let mQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),mZ=" 	\n\r=".split(""),mX=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<mZ.length;t+=1)e[mZ[t].charCodeAt(0)]=-2;for(let t=0;t<mQ.length;t+=1)e[mQ[t].charCodeAt(0)]=t;return e})();function mY(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;)r(mQ[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6;else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;)r(mQ[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6}function m0(e,t,r){let i=mX[e];if(i>-1)for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else if(-2===i)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}function m1(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},i={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},s=e=>{(function(e,t,r){if(0===t.utf8seq){if(e<=127){r(e);return}for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}})(e,i,r)};for(let t=0;t<e.length;t+=1)m0(e.charCodeAt(t),n,s);return t.join("")}function m2(e){let t=[],r={queue:0,queuedBits:0},i=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)m0(e.charCodeAt(t),r,i);return new Uint8Array(t)}function m5(e){let t=[],r={queue:0,queuedBits:0},i=e=>{t.push(e)};return e.forEach(e=>mY(e,r,i)),mY(null,r,i),t.join("")}let m6=()=>"undefined"!=typeof window&&"undefined"!=typeof document,m3={tested:!1,writable:!1},m4=()=>{if(!m6())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(m3.tested)return m3.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),m3.tested=!0,m3.writable=!0}catch(e){m3.tested=!0,m3.writable=!1}return m3.writable},m8=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),m7=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,m9=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ge=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},gt=async(e,t)=>{await e.removeItem(t)};class gr{constructor(){this.promise=new gr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function gi(e){let t=e.split(".");if(3!==t.length)throw new mJ("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!mD.test(t[e]))throw new mJ("JWT not in base64url format");return{header:JSON.parse(m1(t[0])),payload:JSON.parse(m1(t[1])),signature:m2(t[2]),raw:{header:t[0],payload:t[1]}}}async function gn(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function gs(e){return("0"+e.toString(16)).substr(-2)}async function ga(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function go(e){return"undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder?btoa(await ga(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e)}async function gl(e,t,r=!1){let i=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let i=0;i<56;i++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,gs).join("")}(),n=i;r&&(n+="/PASSWORD_RECOVERY"),await m9(e,`${t}-code-verifier`,n);let s=await go(i),a=i===s?"plain":"s256";return[s,a]}gr.promiseConstructor=Promise;let gu=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,gc=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function gh(e){if(!gc.test(e))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gd(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){let e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function gp(e){return JSON.parse(JSON.stringify(e))}let gf=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),gm=[502,503,504];async function gg(e){var t;let r,i;if(!m7(e))throw new mV(gf(e),0);if(gm.includes(e.status))throw new mV(gf(e),e.status);try{r=await e.json()}catch(e){throw new mM(gf(e),e)}let n=function(e){let t=e.headers.get(mP);if(!t||!t.match(gu))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(n&&n.getTime()>=mj["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?i=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(i=r.error_code),i){if("weak_password"===i)throw new mK(gf(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===i)throw new mU}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new mK(gf(r),e.status,r.weak_password.reasons);throw new mF(gf(r),e.status||500,i)}let gy=(e,t,r,i)=>{let n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),n.body=JSON.stringify(i),Object.assign(Object.assign({},n),r))};async function g_(e,t,r,i){var n;let s=Object.assign({},null==i?void 0:i.headers);s[mP]||(s[mP]=mj["2024-01-01"].name),(null==i?void 0:i.jwt)&&(s.Authorization=`Bearer ${i.jwt}`);let a=null!==(n=null==i?void 0:i.query)&&void 0!==n?n:{};(null==i?void 0:i.redirectTo)&&(a.redirect_to=i.redirectTo);let o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await gv(e,t,r+o,{headers:s,noResolveJson:null==i?void 0:i.noResolveJson},{},null==i?void 0:i.body);return(null==i?void 0:i.xform)?null==i?void 0:i.xform(l):{data:Object.assign({},l),error:null}}async function gv(e,t,r,i,n,s){let a;let o=gy(t,i,n,s);try{a=await e(r,Object.assign({},o))}catch(e){throw console.error(e),new mV(gf(e),0)}if(a.ok||await gg(a),null==i?void 0:i.noResolveJson)return a;try{return await a.json()}catch(e){await gg(e)}}function gb(e){var t,r;let i=null;return e.access_token&&e.refresh_token&&e.expires_in&&(i=Object.assign({},e),!e.expires_at)&&(i.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)),{data:{session:i,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function gw(e){let t=gb(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function gx(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function gS(e){return{data:e,error:null}}function gE(e){let{action_link:t,email_otp:r,hashed_token:i,redirect_to:n,verification_type:s}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:i,redirect_to:n,verification_type:s},user:Object.assign({},(0,p9.__rest)(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function gT(e){return e}let gk=["global","local","others"];class gO{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=m8(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=gk[0]){if(0>gk.indexOf(t))throw Error(`@supabase/auth-js: Parameter scope must be one of ${gk.join(", ")}`);try{return await g_(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(m$(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await g_(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:gx})}catch(e){if(m$(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=(0,p9.__rest)(e,["options"]),i=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(i.new_email=null==r?void 0:r.newEmail,delete i.newEmail),await g_(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:gE,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(m$(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await g_(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:gx})}catch(e){if(m$(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,i,n,s,a,o;try{let l={nextPage:null,lastPage:0,total:0},u=await g_(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(n=null===(i=null==e?void 0:e.perPage)||void 0===i?void 0:i.toString())&&void 0!==n?n:""},xform:gT});if(u.error)throw u.error;let c=await u.json(),h=null!==(s=u.headers.get("x-total-count"))&&void 0!==s?s:0,d=null!==(o=null===(a=u.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[];return d.length>0&&(d.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(m$(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){gh(e);try{return await g_(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:gx})}catch(e){if(m$(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){gh(e);try{return await g_(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:gx})}catch(e){if(m$(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){gh(e);try{return await g_(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:gx})}catch(e){if(m$(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){gh(e.userId);try{let{data:t,error:r}=await g_(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(m$(e))return{data:null,error:e};throw e}}async _deleteFactor(e){gh(e.userId),gh(e.id);try{return{data:await g_(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(m$(e))return{data:null,error:e};throw e}}async _listOAuthClients(e){var t,r,i,n,s,a,o;try{let l={nextPage:null,lastPage:0,total:0},u=await g_(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(n=null===(i=null==e?void 0:e.perPage)||void 0===i?void 0:i.toString())&&void 0!==n?n:""},xform:gT});if(u.error)throw u.error;let c=await u.json(),h=null!==(s=u.headers.get("x-total-count"))&&void 0!==s?s:0,d=null!==(o=null===(a=u.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[];return d.length>0&&(d.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(m$(e))return{data:{clients:[]},error:e};throw e}}async _createOAuthClient(e){try{return await g_(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(m$(e))return{data:null,error:e};throw e}}async _getOAuthClient(e){try{return await g_(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(m$(e))return{data:null,error:e};throw e}}async _updateOAuthClient(e,t){try{return await g_(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(m$(e))return{data:null,error:e};throw e}}async _deleteOAuthClient(e){try{return await g_(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(m$(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(e){try{return await g_(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(m$(e))return{data:null,error:e};throw e}}}function gC(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let gA={debug:!!(globalThis&&m4()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class gN extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class gR extends gN{}async function gI(e,t,r){gA.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),gA.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async i=>{if(i){gA.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{gA.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(0===t)throw gA.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new gR(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(gA.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function gP(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}class gj extends Error{constructor({message:e,code:t,cause:r,name:i}){var n;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=null!==(n=null!=i?i:r instanceof Error?r.name:void 0)&&void 0!==n?n:"Unknown Error",this.code=t}}class gD extends gj{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}class gL{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}let g$=new gL;function gF(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function gM(){var e,t;return!!(m6()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"==typeof(null===(e=null==navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"==typeof(null===(t=null==navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}async function gB(e){try{let t=await navigator.credentials.create(e);if(!t)return{data:null,error:new gD("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new gD("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){var r,i,n;let{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new gj({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if((null===(r=s.authenticatorSelection)||void 0===r?void 0:r.requireResidentKey)===!0)return new gj({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if("conditional"===t.mediation&&(null===(i=s.authenticatorSelection)||void 0===i?void 0:i.userVerification)==="required")return new gj({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if((null===(n=s.authenticatorSelection)||void 0===n?void 0:n.userVerification)==="required")return new gj({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new gj({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new gj({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new gj(0===s.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!gF(t))return new gj({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(s.rp.id!==t)return new gj({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new gj({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new gj({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new gj({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}async function gU(e){try{let t=await navigator.credentials.get(e);if(!t)return{data:null,error:new gD("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new gD("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new gj({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new gj({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!gF(t))return new gj({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new gj({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new gj({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new gj({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}let gz={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},gq={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function gH(...e){let t=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),r=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),i={};for(let n of e)if(n)for(let e in n){let s=n[e];if(void 0!==s){if(Array.isArray(s))i[e]=s;else if(r(s))i[e]=s;else if(t(s)){let r=i[e];t(r)?i[e]=gH(r,s):i[e]=gH(s)}else i[e]=s}}return i}class gW{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:i},n){try{var s,a,o,l;let{data:u,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!u)return{data:null,error:c};let h=null!=i?i:g$.createNewAbortSignal();if("create"===u.webauthn.type){let{user:e}=u.webauthn.credential_options.publicKey;e.name||(e.name=`${e.id}:${r}`),e.displayName||(e.displayName=e.name)}switch(u.webauthn.type){case"create":{let t=(s=u.webauthn.credential_options.publicKey,a=null==n?void 0:n.create,gH(gz,s,a||{})),{data:r,error:i}=await gB({publicKey:t,signal:h});if(r)return{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:r}},error:null};return{data:null,error:i}}case"request":{let t=(o=u.webauthn.credential_options.publicKey,l=null==n?void 0:n.request,gH(gq,o,l||{})),{data:r,error:i}=await gU(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:t,signal:h}));if(r)return{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:r}},error:null};return{data:null,error:i}}}}catch(e){if(m$(e))return{data:null,error:e};return{data:null,error:new mM("Unexpected error in challenge",e)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:r="undefined"!=typeof window?[window.location.origin]:void 0,signal:i}={}},n){if(!t)return{data:null,error:new mL("rpId is required for WebAuthn authentication")};try{if(!gM())return{data:null,error:new mM("Browser does not support WebAuthn",null)};let{data:s,error:a}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:i},{request:n});if(!s)return{data:null,error:a};let{webauthn:o}=s;return this._verify({factorId:e,challengeId:s.challengeId,webauthn:{type:o.type,rpId:t,rpOrigins:r,credential_response:o.credential_response}})}catch(e){if(m$(e))return{data:null,error:e};return{data:null,error:new mM("Unexpected error in authenticate",e)}}}async _register({friendlyName:e,webauthn:{rpId:t="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:r="undefined"!=typeof window?[window.location.origin]:void 0,signal:i}={}},n){if(!t)return{data:null,error:new mL("rpId is required for WebAuthn registration")};try{if(!gM())return{data:null,error:new mM("Browser does not support WebAuthn",null)};let{data:s,error:a}=await this._enroll({friendlyName:e});if(!s)return await this.client.mfa.listFactors().then(t=>{var r;return null===(r=t.data)||void 0===r?void 0:r.all.find(t=>"webauthn"===t.factor_type&&t.friendly_name===e&&"unverified"!==t.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null==e?void 0:e.id}):void 0),{data:null,error:a};let{data:o,error:l}=await this._challenge({factorId:s.id,friendlyName:s.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:i},{create:n});if(!o)return{data:null,error:l};return this._verify({factorId:s.id,challengeId:o.challengeId,webauthn:{rpId:t,rpOrigins:r,type:o.webauthn.type,credential_response:o.webauthn.credential_response}})}catch(e){if(m$(e))return{data:null,error:e};return{data:null,error:new mM("Unexpected error in register",e)}}}}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();let gV={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mI,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function gG(e,t,r){return await r()}let gK={};class gJ{get jwks(){var e,t;return null!==(t=null===(e=gK[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){gK[this.storageKey]=Object.assign(Object.assign({},gK[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=gK[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){gK[this.storageKey]=Object.assign(Object.assign({},gK[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;let n=Object.assign(Object.assign({},gV),e);if(this.storageKey=n.storageKey,this.instanceID=null!==(t=gJ.nextInstanceID[this.storageKey])&&void 0!==t?t:0,gJ.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.instanceID>0&&m6()){let e=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(e),this.logDebugMessages&&console.trace(e)}if(this.persistSession=n.persistSession,this.autoRefreshToken=n.autoRefreshToken,this.admin=new gO({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=m8(n.fetch),this.lock=n.lock||gG,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,this.throwOnError=n.throwOnError,n.lock?this.lock=n.lock:m6()&&(null===(r=null==globalThis?void 0:globalThis.navigator)||void 0===r?void 0:r.locks)?this.lock=gI:this.lock=gG,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new gW(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:m4()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=gC(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=gC(this.memoryStorage)),m6()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(i=this.broadcastChannel)||void 0===i||i.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${mR}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},r="none";if(m6()&&(t=function(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),m6()&&this.detectSessionInUrl&&"none"!==r){let{data:i,error:n}=await this._getSessionFromURL(t,r);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),m$(n)&&"AuthImplicitGrantRedirectError"===n.name){let t=null===(e=n.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:n}}return await this._removeSession(),{error:n}}let{session:s,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",s,"redirect type",a),await this._saveSession(s),setTimeout(async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(m$(e))return this._returnResult({error:e});return this._returnResult({error:new mM("Unexpected error during initialization",e)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,i;try{let{data:n,error:s}=await g_(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(i=null==e?void 0:e.options)||void 0===i?void 0:i.captchaToken}},xform:gb});if(s||!n)return this._returnResult({data:{user:null,session:null},error:s});let a=n.session,o=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:o,session:a},error:null})}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signUp(e){var t,r,i;try{let n;if("email"in e){let{email:r,password:i,options:s}=e,a=null,o=null;"pkce"===this.flowType&&([a,o]=await gl(this.storage,this.storageKey)),n=await g_(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==s?void 0:s.emailRedirectTo,body:{email:r,password:i,data:null!==(t=null==s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:a,code_challenge_method:o},xform:gb})}else if("phone"in e){let{phone:t,password:s,options:a}=e;n=await g_(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:s,data:null!==(r=null==a?void 0:a.data)&&void 0!==r?r:{},channel:null!==(i=null==a?void 0:a.channel)&&void 0!==i?i:"sms",gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:gb})}else throw new mq("You must provide either an email or phone number and a password");let{data:s,error:a}=n;if(a||!s)return this._returnResult({data:{user:null,session:null},error:a});let o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:r,password:i,options:n}=e;t=await g_(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:gw})}else if("phone"in e){let{phone:r,password:i,options:n}=e;t=await g_(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:gw})}else throw new mq("You must provide either an email or phone number and a password");let{data:r,error:i}=t;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!r||!r.session||!r.user){let e=new mz;return this._returnResult({data:{user:null,session:null},error:e})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(e){var t,r,i,n;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){let{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,i,n,s,a,o,l,u,c,h,d;let p,f;if("message"in e)p=e.message,f=e.signature;else{let c;let{chain:h,wallet:m,statement:g,options:y}=e;if(m6()){if("object"==typeof m)c=m;else{let e=window;if("ethereum"in e&&"object"==typeof e.ethereum&&"request"in e.ethereum&&"function"==typeof e.ethereum.request)c=e.ethereum;else throw Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}}else{if("object"!=typeof m||!(null==y?void 0:y.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");c=m}let v=new URL(null!==(t=null==y?void 0:y.url)&&void 0!==t?t:window.location.href),b=await c.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||0===b.length)throw Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let w=gP(b[0]),x=null===(r=null==y?void 0:y.signInWithEthereum)||void 0===r?void 0:r.chainId;x||(x=parseInt(await c.request({method:"eth_chainId"}),16)),p=function(e){var t;let{chainId:r,domain:i,expirationTime:n,issuedAt:s=new Date,nonce:a,notBefore:o,requestId:l,resources:u,scheme:c,uri:h,version:d}=e;if(!Number.isInteger(r))throw Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!i)throw Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!h)throw Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==d)throw Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`);let p=gP(e.address),f=c?`${c}://${i}`:i,m=e.statement?`${e.statement}
`:"",g=`${f} wants you to sign in with your Ethereum account:
${p}

${m}`,y=`URI: ${h}
Version: ${d}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(n&&(y+=`
Expiration Time: ${n.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),l&&(y+=`
Request ID: ${l}`),u){let e="\nResources:";for(let t of u){if(!t||"string"!=typeof t)throw Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${t}`);e+=`
- ${t}`}y+=e}return`${g}
${y}`}({domain:v.host,address:w,statement:g,uri:v.href,version:"1",chainId:x,nonce:null===(i=null==y?void 0:y.signInWithEthereum)||void 0===i?void 0:i.nonce,issuedAt:null!==(s=null===(n=null==y?void 0:y.signInWithEthereum)||void 0===n?void 0:n.issuedAt)&&void 0!==s?s:new Date,expirationTime:null===(a=null==y?void 0:y.signInWithEthereum)||void 0===a?void 0:a.expirationTime,notBefore:null===(o=null==y?void 0:y.signInWithEthereum)||void 0===o?void 0:o.notBefore,requestId:null===(l=null==y?void 0:y.signInWithEthereum)||void 0===l?void 0:l.requestId,resources:null===(u=null==y?void 0:y.signInWithEthereum)||void 0===u?void 0:u.resources}),f=await c.request({method:"personal_sign",params:[(d=p,"0x"+Array.from(new TextEncoder().encode(d),e=>e.toString(16).padStart(2,"0")).join("")),w]})}try{let{data:t,error:r}=await g_(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:f},(null===(c=e.options)||void 0===c?void 0:c.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:gb});if(r)throw r;if(!t||!t.session||!t.user){let e=new mz;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSolana(e){var t,r,i,n,s,a,o,l,u,c,h,d;let p,f;if("message"in e)p=e.message,f=e.signature;else{let h;let{chain:d,wallet:m,statement:g,options:y}=e;if(m6()){if("object"==typeof m)h=m;else{let e=window;if("solana"in e&&"object"==typeof e.solana&&("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))h=e.solana;else throw Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}}else{if("object"!=typeof m||!(null==y?void 0:y.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");h=m}let v=new URL(null!==(t=null==y?void 0:y.url)&&void 0!==t?t:window.location.href);if("signIn"in h&&h.signIn){let e;let t=await h.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==y?void 0:y.signInWithSolana),{version:"1",domain:v.host,uri:v.href}),g?{statement:g}:null));if(Array.isArray(t)&&t[0]&&"object"==typeof t[0])e=t[0];else if(t&&"object"==typeof t&&"signedMessage"in t&&"signature"in t)e=t;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in e&&"signature"in e&&("string"==typeof e.signedMessage||e.signedMessage instanceof Uint8Array)&&e.signature instanceof Uint8Array)p="string"==typeof e.signedMessage?e.signedMessage:new TextDecoder().decode(e.signedMessage),f=e.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in h)||"function"!=typeof h.signMessage||!("publicKey"in h)||"object"!=typeof h||!h.publicKey||!("toBase58"in h.publicKey)||"function"!=typeof h.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${v.host} wants you to sign in with your Solana account:`,h.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${v.href}`,`Issued At: ${null!==(i=null===(r=null==y?void 0:y.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==i?i:new Date().toISOString()}`,...(null===(n=null==y?void 0:y.signInWithSolana)||void 0===n?void 0:n.notBefore)?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...(null===(s=null==y?void 0:y.signInWithSolana)||void 0===s?void 0:s.expirationTime)?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...(null===(a=null==y?void 0:y.signInWithSolana)||void 0===a?void 0:a.chainId)?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...(null===(o=null==y?void 0:y.signInWithSolana)||void 0===o?void 0:o.nonce)?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...(null===(l=null==y?void 0:y.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...(null===(c=null===(u=null==y?void 0:y.signInWithSolana)||void 0===u?void 0:u.resources)||void 0===c?void 0:c.length)?["Resources",...y.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");let e=await h.signMessage(new TextEncoder().encode(p),"utf8");if(!e||!(e instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");f=e}}try{let{data:t,error:r}=await g_(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:m5(f)},(null===(h=e.options)||void 0===h?void 0:h.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:gb});if(r)throw r;if(!t||!t.session||!t.user){let e=new mz;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _exchangeCodeForSession(e){let t=await ge(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(null!=t?t:"").split("/");try{let{data:t,error:n}=await g_(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:gb});if(await gt(this.storage,`${this.storageKey}-code-verifier`),n)throw n;if(!t||!t.session||!t.user){let e=new mz;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!=i?i:null}),error:n})}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null,redirectType:null},error:e});throw e}}async signInWithIdToken(e){try{let{options:t,provider:r,token:i,access_token:n,nonce:s}=e,{data:a,error:o}=await g_(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:n,nonce:s,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:gb});if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!a||!a.session||!a.user){let e=new mz;return this._returnResult({data:{user:null,session:null},error:e})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:a,error:o})}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(e){var t,r,i,n,s;try{if("email"in e){let{email:i,options:n}=e,s=null,a=null;"pkce"===this.flowType&&([s,a]=await gl(this.storage,this.storageKey));let{error:o}=await g_(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},create_user:null===(r=null==n?void 0:n.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:s,code_challenge_method:a},redirectTo:null==n?void 0:n.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}if("phone"in e){let{phone:t,options:r}=e,{data:a,error:o}=await g_(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(i=null==r?void 0:r.data)&&void 0!==i?i:{},create_user:null===(n=null==r?void 0:r.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(s=null==r?void 0:r.channel)&&void 0!==s?s:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:o})}throw new mq("You must provide either an email or phone number.")}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async verifyOtp(e){var t,r;try{let i,n;"options"in e&&(i=null===(t=e.options)||void 0===t?void 0:t.redirectTo,n=null===(r=e.options)||void 0===r?void 0:r.captchaToken);let{data:s,error:a}=await g_(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:i,xform:gb});if(a)throw a;if(!s)throw Error("An error occurred on token verification.");let o=s.session,l=s.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSSO(e){var t,r,i,n,s;try{let a=null,o=null;"pkce"===this.flowType&&([a,o]=await gl(this.storage,this.storageKey));let l=await g_(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(i=null==e?void 0:e.options)||void 0===i?void 0:i.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:gS});return(null===(n=l.data)||void 0===n?void 0:n.url)&&m6()&&!(null===(s=e.options)||void 0===s?void 0:s.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new mU;let{error:i}=await g_(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:r,type:i,options:n}=e,{error:s}=await g_(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},redirectTo:null==n?void 0:n.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:s})}if("phone"in e){let{phone:r,type:i,options:n}=e,{data:s,error:a}=await g_(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:a})}throw new mq("You must provide either an email or phone number and a type")}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let t=null,r=await ge(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),null!==r&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};let i=!!t.expires_at&&1e3*t.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(this.userStorage){let e=await ge(this.userStorage,this.storageKey+"-user");(null==e?void 0:e.user)?t.user=e.user:t.user=gd()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){var e;let r={value:this.suppressGetSessionWarning};t.user=(e=t.user,new Proxy(e,{get:(e,t,i)=>{if("__isInsecureUserWarningProxy"===t)return!0;if("symbol"==typeof t){let r=t.toString();if("Symbol(Symbol.toPrimitive)"===r||"Symbol(Symbol.toStringTag)"===r||"Symbol(util.inspect.custom)"===r||"Symbol(nodejs.util.inspect.custom)"===r)return Reflect.get(e,t,i)}return r.value||"string"!=typeof t||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),r.value=!0),Reflect.get(e,t,i)}})),r.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}let{data:n,error:s}=await this._callRefreshToken(t.refresh_token);if(s)return this._returnResult({data:{session:null},error:s});return this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await g_(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:gx});return await this._useSession(async e=>{var t,r,i;let{data:n,error:s}=e;if(s)throw s;return(null===(t=n.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await g_(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(i=null===(r=n.session)||void 0===r?void 0:r.access_token)&&void 0!==i?i:void 0,xform:gx}):{data:{user:null},error:new mU}})}catch(e){if(m$(e))return m$(e)&&"AuthSessionMissingError"===e.name&&(await this._removeSession(),await gt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:i,error:n}=r;if(n)throw n;if(!i.session)throw new mU;let s=i.session,a=null,o=null;"pkce"===this.flowType&&null!=e.email&&([a,o]=await gl(this.storage,this.storageKey));let{data:l,error:u}=await g_(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:s.access_token,xform:gx});if(u)throw u;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),this._returnResult({data:{user:s.user},error:null})})}catch(e){if(m$(e))return this._returnResult({data:{user:null},error:e});throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new mU;let t=Date.now()/1e3,r=t,i=!0,n=null,{payload:s}=gi(e.access_token);if(s.exp&&(i=(r=s.exp)<=t),i){let{data:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!t)return{data:{user:null,session:null},error:null};n=t}else{let{data:i,error:s}=await this._getUser(e.access_token);if(s)throw s;n={access_token:e.access_token,refresh_token:e.refresh_token,user:i.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return this._returnResult({data:{user:n.user,session:n},error:null})}catch(e){if(m$(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:i,error:n}=t;if(n)throw n;e=null!==(r=i.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new mU;let{data:i,error:n}=await this._callRefreshToken(e.refresh_token);return n?this._returnResult({data:{user:null,session:null},error:n}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(e,t){try{if(!m6())throw new mH("No browser detected.");if(e.error||e.error_description||e.error_code)throw new mH(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new mW("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new mH("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new mW("No code detected.");let{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;let i=new URL(window.location.href);return i.searchParams.delete("code"),window.history.replaceState(window.history.state,"",i.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:i,access_token:n,refresh_token:s,expires_in:a,expires_at:o,token_type:l}=e;if(!n||!a||!s||!l)throw new mH("No session defined in URL");let u=Math.round(Date.now()/1e3),c=parseInt(a),h=u+c;o&&(h=parseInt(o));let d=h-u;1e3*d<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${c}s`);let p=h-c;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,u);let{data:f,error:m}=await this._getUser(n);if(m)throw m;let g={provider_token:r,provider_refresh_token:i,access_token:n,expires_in:c,expires_at:h,refresh_token:s,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:e.type},error:null})}catch(e){if(m$(e))return this._returnResult({data:{session:null,redirectType:null},error:e});throw e}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await ge(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:i,error:n}=t;if(n)return this._returnResult({error:n});let s=null===(r=i.session)||void 0===r?void 0:r.access_token;if(s){let{error:t}=await this.admin.signOut(s,e);if(t&&!(m$(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await gt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){let t=Symbol("auth-callback"),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,i;try{let{data:{session:i},error:n}=t;if(n)throw n;await (null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(t){await (null===(i=this.stateChangeEmitters.get(e))||void 0===i?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,i=null;"pkce"===this.flowType&&([r,i]=await gl(this.storage,this.storageKey,!0));try{return await g_(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{let{data:r,error:i}=await this._useSession(async t=>{var r,i,n,s,a;let{data:o,error:l}=t;if(l)throw l;let u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(i=e.options)||void 0===i?void 0:i.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:!0});return await g_(this.fetch,"GET",u,{headers:this.headers,jwt:null!==(a=null===(s=o.session)||void 0===s?void 0:s.access_token)&&void 0!==a?a:void 0})});if(i)throw i;return!m6()||(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),this._returnResult({data:{provider:e.provider,url:null==r?void 0:r.url},error:null})}catch(t){if(m$(t))return this._returnResult({data:{provider:e.provider,url:null},error:t});throw t}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{let{error:i,data:{session:n}}=t;if(i)throw i;let{options:s,provider:a,token:o,access_token:l,nonce:u}=e,{data:c,error:h}=await g_(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!==(r=null==n?void 0:n.access_token)&&void 0!==r?r:void 0,body:{provider:a,id_token:o,access_token:l,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:gb});if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!c||!c.session||!c.user)return this._returnResult({data:{user:null,session:null},error:new mz});return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("USER_UPDATED",c.session)),this._returnResult({data:c,error:h})}catch(e){if(m$(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,i;let{data:n,error:s}=t;if(s)throw s;return await g_(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(i=null===(r=n.session)||void 0===r?void 0:r.access_token)&&void 0!==i?i:void 0})})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,i;let n=Date.now();return await (r=async r=>(r>0&&await gn(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await g_(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:gb})),i=(e,t)=>{let r=200*Math.pow(2,e);return t&&mG(t)&&Date.now()+r-n<3e4},new Promise((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{let t=await r(n);if(!i(n,null,t)){e(t);return}}catch(e){if(!i(n,e)){t(e);return}}})()}))}catch(e){if(this._debug(t,"error",e),m$(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),m6()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let i=await ge(this.storage,this.storageKey);if(i&&this.userStorage){let t=await ge(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!t&&(t={user:i.user},await m9(this.userStorage,this.storageKey+"-user",t)),i.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:gd()}else if(i&&!i.user&&!i.user){let e=await ge(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(i.user=e.user,await gt(this.storage,this.storageKey+"-user"),await m9(this.storage,this.storageKey,i)):i.user=gd()}if(this._debug(r,"session from storage",i),!this._isValidSession(i)){this._debug(r,"session is not valid"),null!==i&&await this._removeSession();return}let n=(null!==(t=i.expires_at)&&void 0!==t?t:1/0)*1e3-Date.now()<9e4;if(this._debug(r,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&i.refresh_token){let{error:e}=await this._callRefreshToken(i.refresh_token);e&&(console.error(e),mG(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(i.user&&!0===i.user.__isUserNotAvailableProxy)try{let{data:e,error:t}=await this._getUser(i.access_token);!t&&(null==e?void 0:e.user)?(i.user=e.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(e){console.error("Error getting user data:",e),this._debug(r,"error getting user data, skipping SIGNED_IN notification",e)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(e){this._debug(r,"error",e),console.error(e);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new mU;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new gr;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new mU;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let i={data:t.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(e){if(this._debug(i,"error",e),m$(e)){let r={data:null,error:e};return mG(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(r),r}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,r=!0){let i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let i=[],n=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){i.push(e)}});if(await Promise.all(n),i.length>0){for(let e=0;e<i.length;e+=1)console.error(i[e]);throw i[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;let t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await m9(this.userStorage,this.storageKey+"-user",{user:t.user});let e=Object.assign({},t);delete e.user;let i=gp(e);await m9(this.storage,this.storageKey,i)}else{let e=gp(t);await m9(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await gt(this.storage,this.storageKey),await gt(this.storage,this.storageKey+"-code-verifier"),await gt(this.storage,this.storageKey+"-user"),this.userStorage&&await gt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&m6()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let i=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),i<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof gN)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!m6()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let i=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let[e,t]=await gl(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});i.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);i.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:i,error:n}=t;return n?this._returnResult({data:null,error:n}):await g_(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token})})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,i;let{data:n,error:s}=t;if(s)return this._returnResult({data:null,error:s});let a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:o,error:l}=await g_(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===o.type&&(null===(i=null==o?void 0:o.totp)||void 0===i?void 0:i.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),this._returnResult({data:o,error:null}))})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r,i,n;let{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});let o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?(i=e.webauthn.credential_response,"toJSON"in i&&"function"==typeof i.toJSON?i.toJSON():{id:i.id,rawId:i.id,response:{attestationObject:m5(new Uint8Array(i.response.attestationObject)),clientDataJSON:m5(new Uint8Array(i.response.clientDataJSON))},type:"public-key",clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:null!==(n=i.authenticatorAttachment)&&void 0!==n?n:void 0}):function(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();let r=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:m5(new Uint8Array(i.authenticatorData)),clientDataJSON:m5(new Uint8Array(i.clientDataJSON)),signature:m5(new Uint8Array(i.signature)),userHandle:i.userHandle?m5(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:null!==(t=e.authenticatorAttachment)&&void 0!==t?t:void 0}}(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:u}=await g_(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:u}))})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:i,error:n}=t;if(n)return this._returnResult({data:null,error:n});let s=await g_(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token});if(s.error)return s;let{data:a}=s;if("webauthn"!==a.type)return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential creation options are required");if("undefined"!=typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);let{challenge:t,user:r,excludeCredentials:i}=e,n=(0,p9.__rest)(e,["challenge","user","excludeCredentials"]),s=m2(t).buffer,a=Object.assign(Object.assign({},r),{id:m2(r.id).buffer}),o=Object.assign(Object.assign({},n),{challenge:s,user:a});if(i&&i.length>0){o.excludeCredentials=Array(i.length);for(let e=0;e<i.length;e++){let t=i[e];o.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:m2(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return o}(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential request options are required");if("undefined"!=typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);let{challenge:t,allowCredentials:r}=e,i=(0,p9.__rest)(e,["challenge","allowCredentials"]),n=m2(t).buffer,s=Object.assign(Object.assign({},i),{challenge:n});if(r&&r.length>0){s.allowCredentials=Array(r.length);for(let e=0;e<r.length;e++){let t=r[e];s.allowCredentials[e]=Object.assign(Object.assign({},t),{id:m2(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return s}(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;let{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};let i={all:[],phone:[],totp:[],webauthn:[]};for(let r of null!==(e=null==t?void 0:t.factors)&&void 0!==e?e:[])i.all.push(r),"verified"===r.status&&i[r.factor_type].push(r);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;let{data:{session:r},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:n}=gi(r.access_token),s=null;n.aal&&(s=n.aal);let a=s;return(null!==(t=null===(e=r.user.factors)||void 0===e?void 0:e.filter(e=>"verified"===e.status))&&void 0!==t?t:[]).length>0&&(a="aal2"),{data:{currentLevel:s,nextLevel:a,currentAuthenticationMethods:n.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{let{data:{session:r},error:i}=t;return i?this._returnResult({data:null,error:i}):r?await g_(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new mU})})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{let{data:{session:i},error:n}=r;if(n)return this._returnResult({data:null,error:n});if(!i)return this._returnResult({data:null,error:new mU});let s=await g_(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return s.data&&s.data.redirect_url&&m6()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{let{data:{session:i},error:n}=r;if(n)return this._returnResult({data:null,error:n});if(!i)return this._returnResult({data:null,error:new mU});let s=await g_(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return s.data&&s.data.redirect_url&&m6()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}async _listOAuthGrants(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await g_(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new mU})})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{let{data:{session:r},error:i}=t;return i?this._returnResult({data:null,error:i}):r?(await g_(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new mU})})}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;let i=Date.now();if((r=this.jwks.keys.find(t=>t.kid===e))&&this.jwks_cached_at+6e5>i)return r;let{data:n,error:s}=await g_(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return n.keys&&0!==n.keys.length&&(this.jwks=n,this.jwks_cached_at=i,r=n.keys.find(t=>t.kid===e))?r:null}async getClaims(e,t={}){try{let r=e;if(!r){let{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});r=e.session.access_token}let{header:i,payload:n,signature:s,raw:{header:a,payload:o}}=gi(r);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(n.exp);let l=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks);if(!l){let{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:n,header:i,signature:s},error:null}}let u=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(i.alg),c=await crypto.subtle.importKey("jwk",l,u,!0,["verify"]);if(!await crypto.subtle.verify(u,c,s,function(e){let t=[];return function(e,t){for(let r=0;r<e.length;r+=1){let i=e.charCodeAt(r);if(i>55295&&i<=56319){let t=(i-55296)*1024&65535;i=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127){t(e);return}if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(i,t)}}(e,e=>t.push(e)),new Uint8Array(t)}(`${a}.${o}`)))throw new mJ("Invalid JWT signature");return{data:{claims:n,header:i,signature:s},error:null}}catch(e){if(m$(e))return this._returnResult({data:null,error:e});throw e}}}gJ.nextInstanceID={};let gQ=gJ;class gZ extends gQ{constructor(e){super(e)}}class gX{constructor(e,t,r){var i,n,s;this.supabaseUrl=e,this.supabaseKey=t;let a=function(e){let t=null==e?void 0:e.trim();if(!t)throw Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(t.endsWith("/")?t:t+"/")}catch(e){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}(e);if(!t)throw Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);let o=`sb-${a.hostname.split(".")[0]}-auth-token`,l=function(e,t){var r,i;let{db:n,auth:s,realtime:a,global:o}=e,{db:l,auth:u,realtime:c,global:h}=t,d={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},c),a),storage:{},global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},null!==(r=null==h?void 0:h.headers)&&void 0!==r?r:{}),null!==(i=null==o?void 0:o.headers)&&void 0!==i?i:{})}),accessToken:async()=>""};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=r?r:{},{db:mT,realtime:mO,auth:Object.assign(Object.assign({},mk),{storageKey:o}),global:mE});this.storageKey=null!==(i=l.auth.storageKey)&&void 0!==i?i:"",this.headers=null!==(n=l.global.headers)&&void 0!==n?n:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(s=l.auth)&&void 0!==s?s:{},this.headers,l.global.fetch),this.fetch=mN(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new fl(new URL("rest/v1",a).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new mx(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new fs(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();let{data:r}=await this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,userStorage:n,storageKey:s,flowType:a,lock:o,debug:l,throwOnError:u},c,h){let d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new gZ({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,userStorage:n,flowType:a,lock:o,debug:l,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new fD(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}(function(){if("undefined"!=typeof window||"undefined"==typeof process)return!1;let e=process.version;if(null==e)return!1;let t=e.match(/^v(\d+)\./);return!!t&&18>=parseInt(t[1],10)})()&&console.warn(`  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217`);let gY=process.env.SUPABASE_URL||"",g0=process.env.SUPABASE_ANON_KEY||"",g1=null,g2=gY&&g0?(g1||(g1=new gX(gY,g0,p)),g1):null;async function g5(e){try{if(!g2)return null;let{data:t,error:r}=await g2.auth.getUser(e);if(r||!t.user)return null;return{id:t.user.id,email:t.user.email||"",nome:t.user.user_metadata?.name,avatar:t.user.user_metadata?.avatar_url}}catch(e){return console.error("Erro ao obter usu\xe1rio do token:",e),null}}async function g6({req:e}){let t=function(e){if(!e)return null;let t=e.split(" ");return 2!==t.length||"Bearer"!==t[0]?null:t[1]}(e.headers.get("authorization")||void 0),r=null;return t&&(r=await g5(t)),{req:e,user:r,userId:r?.id||null}}let g3="nodejs",g4="force-dynamic",g8=e=>rJ({endpoint:"/api/trpc",req:e,router:p7,createContext:()=>g6({req:e})}),g7=new te.AppRouteRouteModule({definition:{kind:tt.RouteKind.APP_ROUTE,page:"/api/trpc/[trpc]/route",pathname:"/api/trpc/[trpc]",filename:"route",bundlePath:"app/api/trpc/[trpc]/route"},resolvedPagePath:"/home/ubuntu/inteligencia-de-mercado/app/api/trpc/[trpc]/route.ts",nextConfigOutput:"standalone",userland:e9}),{workAsyncStorage:g9,workUnitAsyncStorage:ye,serverHooks:yt}=g7;function yr(){return(0,tr.patchFetch)({workAsyncStorage:g9,workUnitAsyncStorage:ye})}},3024:()=>{},12752:()=>{},38837:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CsvFormatterStream=void 0;let i=r(27910),n=r(59938);class s extends i.Transform{constructor(e){super({writableObjectMode:e.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=e,this.rowFormatter=new n.RowFormatter(e),this.hasWrittenBOM=!e.writeBOM}transform(e){return this.rowFormatter.rowTransform=e,this}_transform(e,t,r){let i=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(e,(e,t)=>e?(i=!0,r(e)):(t&&t.forEach(e=>{this.push(Buffer.from(e,"utf8"))}),i=!0,r()))}catch(e){if(i)throw e;r(e)}}_flush(e){this.rowFormatter.finish((t,r)=>t?e(t):(r&&r.forEach(e=>{this.push(Buffer.from(e,"utf8"))}),e()))}}t.CsvFormatterStream=s},81183:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormatterOptions=void 0;class r{constructor(e={}){var t;this.objectMode=!0,this.delimiter=",",this.rowDelimiter="\n",this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,e||{}),void 0===(null==e?void 0:e.quoteHeaders)&&(this.quoteHeaders=this.quoteColumns),(null==e?void 0:e.quote)===!0?this.quote='"':(null==e?void 0:e.quote)===!1&&(this.quote=""),"string"!=typeof(null==e?void 0:e.escape)&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&(null===(t=e.writeHeaders)||void 0===t||t),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}t.FormatterOptions=r},62214:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FieldFormatter=void 0;let n=i(r(90559)),s=i(r(35211)),a=i(r(94546));class o{constructor(e){this._headers=null,this.formatterOptions=e,null!==e.headers&&(this.headers=e.headers),this.REPLACE_REGEXP=RegExp(e.quote,"g");let t=`[${e.delimiter}${a.default(e.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(t)}set headers(e){this._headers=e}shouldQuote(e,t){let r=t?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return n.default(r)?r:Array.isArray(r)?r[e]:null!==this._headers&&r[this._headers[e]]}format(e,t,r){let i=`${s.default(e)?"":e}`.replace(/\0/g,""),{formatterOptions:n}=this;return""!==n.quote&&-1!==i.indexOf(n.quote)?this.quoteField(i.replace(this.REPLACE_REGEXP,n.escapedQuote)):-1!==i.search(this.ESCAPE_REGEXP)||this.shouldQuote(t,r)?this.quoteField(i):i}quoteField(e){let{quote:t}=this.formatterOptions;return`${t}${e}${t}`}}t.FieldFormatter=o},9706:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RowFormatter=void 0;let n=i(r(21903)),s=i(r(25832)),a=r(62214),o=r(88034);class l{constructor(e){this.rowCount=0,this.formatterOptions=e,this.fieldFormatter=new a.FieldFormatter(e),this.headers=e.headers,this.shouldWriteHeaders=e.shouldWriteHeaders,this.hasWrittenHeaders=!1,null!==this.headers&&(this.fieldFormatter.headers=this.headers),e.transform&&(this.rowTransform=e.transform)}static isRowHashArray(e){return!!Array.isArray(e)&&Array.isArray(e[0])&&2===e[0].length}static isRowArray(e){return Array.isArray(e)&&!this.isRowHashArray(e)}static gatherHeaders(e){return l.isRowHashArray(e)?e.map(e=>e[0]):Array.isArray(e)?e:Object.keys(e)}static createTransform(e){return o.isSyncTransform(e)?(t,r)=>{let i=null;try{i=e(t)}catch(e){return r(e)}return r(null,i)}:(t,r)=>{e(t,r)}}set rowTransform(e){if(!n.default(e))throw TypeError("The transform should be a function");this._rowTransform=l.createTransform(e)}format(e,t){this.callTransformer(e,(r,i)=>{if(r)return t(r);if(!e)return t(null);let n=[];if(i){let{shouldFormatColumns:e,headers:t}=this.checkHeaders(i);if(this.shouldWriteHeaders&&t&&!this.hasWrittenHeaders&&(n.push(this.formatColumns(t,!0)),this.hasWrittenHeaders=!0),e){let e=this.gatherColumns(i);n.push(this.formatColumns(e,!1))}}return t(null,n)})}finish(e){let t=[];if(this.formatterOptions.alwaysWriteHeaders&&0===this.rowCount){if(!this.headers)return e(Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));t.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&t.push(this.formatterOptions.rowDelimiter),e(null,t)}checkHeaders(e){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};let t=l.gatherHeaders(e);return(this.headers=t,this.fieldFormatter.headers=t,this.shouldWriteHeaders)?{shouldFormatColumns:!s.default(t,e),headers:t}:{shouldFormatColumns:!0,headers:null}}gatherColumns(e){if(null===this.headers)throw Error("Headers is currently null");return Array.isArray(e)?l.isRowHashArray(e)?this.headers.map((t,r)=>{let i=e[r];return i?i[1]:""}):l.isRowArray(e)&&!this.shouldWriteHeaders?e:this.headers.map((t,r)=>e[r]):this.headers.map(t=>e[t])}callTransformer(e,t){return this._rowTransform?this._rowTransform(e,t):t(null,e)}formatColumns(e,t){let r=e.map((e,r)=>this.fieldFormatter.format(e,r,t)).join(this.formatterOptions.delimiter),{rowCount:i}=this;return(this.rowCount+=1,i)?[this.formatterOptions.rowDelimiter,r].join(""):r}}t.RowFormatter=l},59938:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FieldFormatter=t.RowFormatter=void 0;var i=r(9706);Object.defineProperty(t,"RowFormatter",{enumerable:!0,get:function(){return i.RowFormatter}});var n=r(62214);Object.defineProperty(t,"FieldFormatter",{enumerable:!0,get:function(){return n.FieldFormatter}})},95539:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t},a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.writeToPath=t.writeToString=t.writeToBuffer=t.writeToStream=t.write=t.format=t.FormatterOptions=t.CsvFormatterStream=void 0;let o=r(28354),l=r(27910),u=s(r(29021)),c=r(81183),h=r(38837);a(r(88034),t);var d=r(38837);Object.defineProperty(t,"CsvFormatterStream",{enumerable:!0,get:function(){return d.CsvFormatterStream}});var p=r(81183);Object.defineProperty(t,"FormatterOptions",{enumerable:!0,get:function(){return p.FormatterOptions}}),t.format=e=>new h.CsvFormatterStream(new c.FormatterOptions(e)),t.write=(e,r)=>{let i=t.format(r),n=o.promisify((e,t)=>{i.write(e,void 0,t)});return e.reduce((e,t)=>e.then(()=>n(t)),Promise.resolve()).then(()=>i.end()).catch(e=>{i.emit("error",e)}),i},t.writeToStream=(e,r,i)=>t.write(r,i).pipe(e),t.writeToBuffer=(e,r={})=>{let i=[],n=new l.Writable({write(e,t,r){i.push(e),r()}});return new Promise((s,a)=>{n.on("error",a).on("finish",()=>s(Buffer.concat(i))),t.write(e,r).pipe(n)})},t.writeToString=(e,r)=>t.writeToBuffer(e,r).then(e=>e.toString()),t.writeToPath=(e,r,i)=>{let n=u.createWriteStream(e,{encoding:"utf8"});return t.write(r,i).pipe(n)}},88034:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSyncTransform=void 0,t.isSyncTransform=e=>1===e.length},74569:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CsvParserStream=void 0;let i=r(41204),n=r(27910),s=r(62518),a=r(38928);class o extends n.Transform{constructor(e){super({objectMode:e.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=e,this.parser=new a.Parser(e),this.headerTransformer=new s.HeaderTransformer(e),this.decoder=new i.StringDecoder(e.encoding),this.rowTransformerValidator=new s.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(e){return this.rowTransformerValidator.rowTransform=e,this}validate(e){return this.rowTransformerValidator.rowValidator=e,this}emit(e,...t){return"end"===e?(this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1):super.emit(e,...t)}_transform(e,t,r){if(this.hasHitRowLimit)return r();let i=o.wrapDoneCallback(r);try{let{lines:t}=this,r=t+this.decoder.write(e),n=this.parse(r,!0);return this.processRows(n,i)}catch(e){return i(e)}}_flush(e){let t=o.wrapDoneCallback(e);if(this.hasHitRowLimit)return t();try{let e=this.lines+this.decoder.end(),r=this.parse(e,!1);return this.processRows(r,t)}catch(e){return t(e)}}parse(e,t){if(!e)return[];let{line:r,rows:i}=this.parser.parse(e,t);return this.lines=r,i}processRows(e,t){let r=e.length,i=n=>{let s=e=>{if(e)return t(e);if(n%100==0){setImmediate(()=>i(n+1));return}return i(n+1)};if(this.checkAndEmitHeaders(),n>=r||this.hasHitRowLimit)return t();if(this.parsedLineCount+=1,this.shouldSkipLine)return s();let a=e[n];this.rowCount+=1,this.parsedRowCount+=1;let o=this.rowCount;return this.transformRow(a,(e,t)=>{if(e)return this.rowCount-=1,s(e);if(!t)return s(Error("expected transform result"));if(t.isValid){if(t.row)return this.pushRow(t.row,s)}else this.emit("data-invalid",t.row,o,t.reason);return s()})};i(0)}transformRow(e,t){try{this.headerTransformer.transform(e,(r,i)=>r?t(r):i?i.isValid?i.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(i.row,t):this.skipRow(t):(this.rowCount-=1,this.parsedRowCount-=1,t(null,{row:null,isValid:!0})):this.shouldEmitRows?t(null,{isValid:!1,row:e}):this.skipRow(t):t(Error("Expected result from header transform")))}catch(e){t(e)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(e){return this.rowCount-=1,e(null,{row:null,isValid:!0})}pushRow(e,t){try{this.parserOptions.objectMode?this.push(e):this.push(JSON.stringify(e)),t()}catch(e){t(e)}}static wrapDoneCallback(e){let t=!1;return(r,...i)=>{if(r){if(t)throw r;t=!0,e(r);return}e(...i)}}}t.CsvParserStream=o},92865:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ParserOptions=void 0;let n=i(r(94546)),s=i(r(35211));class a{constructor(e){var t;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,e||{}),this.delimiter.length>1)throw Error("delimiter option must be one character long");this.escapedDelimiter=n.default(this.delimiter),this.escapeChar=null!==(t=this.escape)&&void 0!==t?t:this.quote,this.supportsComments=!s.default(this.comment),this.NEXT_TOKEN_REGEXP=RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}t.ParserOptions=a},43810:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t},a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.parseString=t.parseFile=t.parseStream=t.parse=t.ParserOptions=t.CsvParserStream=void 0;let o=s(r(29021)),l=r(27910),u=r(92865),c=r(74569);a(r(1735),t);var h=r(74569);Object.defineProperty(t,"CsvParserStream",{enumerable:!0,get:function(){return h.CsvParserStream}});var d=r(92865);Object.defineProperty(t,"ParserOptions",{enumerable:!0,get:function(){return d.ParserOptions}}),t.parse=e=>new c.CsvParserStream(new u.ParserOptions(e)),t.parseStream=(e,t)=>e.pipe(new c.CsvParserStream(new u.ParserOptions(t))),t.parseFile=(e,t={})=>o.createReadStream(e).pipe(new c.CsvParserStream(new u.ParserOptions(t))),t.parseString=(e,t)=>{let r=new l.Readable;return r.push(e),r.push(null),r.pipe(new c.CsvParserStream(new u.ParserOptions(t)))}},97589:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=void 0;let i=r(45202),n=r(19895),s=r(89837);class a{constructor(e){this.parserOptions=e,this.rowParser=new n.RowParser(this.parserOptions)}static removeBOM(e){return e&&65279===e.charCodeAt(0)?e.slice(1):e}parse(e,t){let r=new i.Scanner({line:a.removeBOM(e),parserOptions:this.parserOptions,hasMoreData:t});return this.parserOptions.supportsComments?this.parseWithComments(r):this.parseWithoutComments(r)}parseWithoutComments(e){let t=[],r=!0;for(;r;)r=this.parseRow(e,t);return{line:e.line,rows:t}}parseWithComments(e){let{parserOptions:t}=this,r=[];for(let i=e.nextCharacterToken;null!==i;i=e.nextCharacterToken)if(s.Token.isTokenComment(i,t)){if(null===e.advancePastLine()||!e.hasMoreCharacters)return{line:e.lineFromCursor,rows:r};e.truncateToCursor()}else if(!this.parseRow(e,r))break;return{line:e.line,rows:r}}parseRow(e,t){if(!e.nextNonSpaceToken)return!1;let r=this.rowParser.parse(e);return null!==r&&(!!(this.parserOptions.ignoreEmpty&&n.RowParser.isEmptyRow(r))||(t.push(r),!0))}}t.Parser=a},19895:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RowParser=void 0;let i=r(89791),n=r(89837);class s{constructor(e){this.parserOptions=e,this.columnParser=new i.ColumnParser(e)}static isEmptyRow(e){return""===e.join("").replace(/\s+/g,"")}parse(e){let{parserOptions:t}=this,{hasMoreData:r}=e,i=[],s=this.getStartToken(e,i);for(;s;){if(n.Token.isTokenRowDelimiter(s)){if(e.advancePastToken(s),!e.hasMoreCharacters&&n.Token.isTokenCarriageReturn(s,t)&&r)return null;return e.truncateToCursor(),i}if(!this.shouldSkipColumnParse(e,s,i)){let t=this.columnParser.parse(e);if(null===t)return null;i.push(t)}s=e.nextNonSpaceToken}return r?null:(e.truncateToCursor(),i)}getStartToken(e,t){let r=e.nextNonSpaceToken;return null!==r&&n.Token.isTokenDelimiter(r,this.parserOptions)?(t.push(""),e.nextNonSpaceToken):r}shouldSkipColumnParse(e,t,r){let{parserOptions:i}=this;if(n.Token.isTokenDelimiter(t,i)){e.advancePastToken(t);let s=e.nextCharacterToken;if(!e.hasMoreCharacters||null!==s&&n.Token.isTokenRowDelimiter(s)||null!==s&&n.Token.isTokenDelimiter(s,i))return r.push(""),!0}return!1}}t.RowParser=s},45202:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scanner=void 0;let i=r(89837),n=/((?:\r\n)|\n|\r)/;class s{constructor(e){this.cursor=0,this.line=e.line,this.lineLength=this.line.length,this.parserOptions=e.parserOptions,this.hasMoreData=e.hasMoreData,this.cursor=e.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){let{lineFromCursor:e}=this,t=this.parserOptions.NEXT_TOKEN_REGEXP;if(-1===e.search(t))return null;let r=t.exec(e);if(null==r)return null;let n=r[1],s=this.cursor+(r.index||0);return new i.Token({token:n,startCursor:s,endCursor:s+n.length-1})}get nextCharacterToken(){let{cursor:e,lineLength:t}=this;return t<=e?null:new i.Token({token:this.line[e],startCursor:e,endCursor:e})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){let e=n.exec(this.lineFromCursor);return e?(this.cursor+=(e.index||0)+e[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(e){return this.cursor=e,this}advanceToToken(e){return this.cursor=e.startCursor,this}advancePastToken(e){return this.cursor=e.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}t.Scanner=s},89837:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Token=void 0;class r{constructor(e){this.token=e.token,this.startCursor=e.startCursor,this.endCursor=e.endCursor}static isTokenRowDelimiter(e){let t=e.token;return"\r"===t||"\n"===t||"\r\n"===t}static isTokenCarriageReturn(e,t){return e.token===t.carriageReturn}static isTokenComment(e,t){return t.supportsComments&&!!e&&e.token===t.comment}static isTokenEscapeCharacter(e,t){return e.token===t.escapeChar}static isTokenQuote(e,t){return e.token===t.quote}static isTokenDelimiter(e,t){return e.token===t.delimiter}}t.Token=r},13007:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnFormatter=void 0;class r{constructor(e){e.trim?this.format=e=>e.trim():e.ltrim?this.format=e=>e.trimLeft():e.rtrim?this.format=e=>e.trimRight():this.format=e=>e}}t.ColumnFormatter=r},21786:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnParser=void 0;let i=r(59313),n=r(35522),s=r(89837);class a{constructor(e){this.parserOptions=e,this.quotedColumnParser=new n.QuotedColumnParser(e),this.nonQuotedColumnParser=new i.NonQuotedColumnParser(e)}parse(e){let{nextNonSpaceToken:t}=e;return null!==t&&s.Token.isTokenQuote(t,this.parserOptions)?(e.advanceToToken(t),this.quotedColumnParser.parse(e)):this.nonQuotedColumnParser.parse(e)}}t.ColumnParser=a},59313:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonQuotedColumnParser=void 0;let i=r(13007),n=r(89837);class s{constructor(e){this.parserOptions=e,this.columnFormatter=new i.ColumnFormatter(e)}parse(e){if(!e.hasMoreCharacters)return null;let{parserOptions:t}=this,r=[],i=e.nextCharacterToken;for(;i&&!(n.Token.isTokenDelimiter(i,t)||n.Token.isTokenRowDelimiter(i));i=e.nextCharacterToken)r.push(i.token),e.advancePastToken(i);return this.columnFormatter.format(r.join(""))}}t.NonQuotedColumnParser=s},35522:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuotedColumnParser=void 0;let i=r(13007),n=r(89837);class s{constructor(e){this.parserOptions=e,this.columnFormatter=new i.ColumnFormatter(e)}parse(e){if(!e.hasMoreCharacters)return null;let t=e.cursor,{foundClosingQuote:r,col:i}=this.gatherDataBetweenQuotes(e);if(!r){if(e.advanceTo(t),!e.hasMoreData)throw Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${e.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(e),i}gatherDataBetweenQuotes(e){let{parserOptions:t}=this,r=!1,i=!1,s=[],a=e.nextCharacterToken;for(;!i&&null!==a;a=e.nextCharacterToken){let o=n.Token.isTokenQuote(a,t);if(!r&&o)r=!0;else if(r){if(n.Token.isTokenEscapeCharacter(a,t)){e.advancePastToken(a);let r=e.nextCharacterToken;null!==r&&(n.Token.isTokenQuote(r,t)||n.Token.isTokenEscapeCharacter(r,t))?(s.push(r.token),a=r):o?i=!0:s.push(a.token)}else o?i=!0:s.push(a.token)}e.advancePastToken(a)}return{col:this.columnFormatter.format(s.join("")),foundClosingQuote:i}}checkForMalformedColumn(e){let{parserOptions:t}=this,{nextNonSpaceToken:r}=e;if(r){let i=n.Token.isTokenDelimiter(r,t),s=n.Token.isTokenRowDelimiter(r);if(!(i||s)){let i=e.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw Error(`Parse Error: expected: '${t.escapedDelimiter}' OR new line got: '${r.token}'. at '${i}`)}e.advanceToToken(r)}else e.hasMoreData||e.advancePastLine()}}t.QuotedColumnParser=s},89791:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnFormatter=t.QuotedColumnParser=t.NonQuotedColumnParser=t.ColumnParser=void 0;var i=r(21786);Object.defineProperty(t,"ColumnParser",{enumerable:!0,get:function(){return i.ColumnParser}});var n=r(59313);Object.defineProperty(t,"NonQuotedColumnParser",{enumerable:!0,get:function(){return n.NonQuotedColumnParser}});var s=r(35522);Object.defineProperty(t,"QuotedColumnParser",{enumerable:!0,get:function(){return s.QuotedColumnParser}});var a=r(13007);Object.defineProperty(t,"ColumnFormatter",{enumerable:!0,get:function(){return a.ColumnFormatter}})},38928:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuotedColumnParser=t.NonQuotedColumnParser=t.ColumnParser=t.Token=t.Scanner=t.RowParser=t.Parser=void 0;var i=r(97589);Object.defineProperty(t,"Parser",{enumerable:!0,get:function(){return i.Parser}});var n=r(19895);Object.defineProperty(t,"RowParser",{enumerable:!0,get:function(){return n.RowParser}});var s=r(45202);Object.defineProperty(t,"Scanner",{enumerable:!0,get:function(){return s.Scanner}});var a=r(89837);Object.defineProperty(t,"Token",{enumerable:!0,get:function(){return a.Token}});var o=r(89791);Object.defineProperty(t,"ColumnParser",{enumerable:!0,get:function(){return o.ColumnParser}}),Object.defineProperty(t,"NonQuotedColumnParser",{enumerable:!0,get:function(){return o.NonQuotedColumnParser}}),Object.defineProperty(t,"QuotedColumnParser",{enumerable:!0,get:function(){return o.QuotedColumnParser}})},82986:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderTransformer=void 0;let n=i(r(29769)),s=i(r(21903)),a=i(r(71506)),o=i(r(65925));class l{constructor(e){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=e,!0===e.headers?this.shouldUseFirstRow=!0:Array.isArray(e.headers)?this.setHeaders(e.headers):s.default(e.headers)&&(this.headersTransform=e.headers)}transform(e,t){return this.shouldMapRow(e)?t(null,this.processRow(e)):t(null,{row:null,isValid:!0})}shouldMapRow(e){let{parserOptions:t}=this;if(!this.headersTransform&&t.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(e)){if(this.headersTransform)this.setHeaders(this.headersTransform(e));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(e)}return!1}return!0}processRow(e){if(!this.headers)return{row:e,isValid:!0};let{parserOptions:t}=this;if(!t.discardUnmappedColumns&&e.length>this.headersLength){if(!t.strictColumnHandling)throw Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${e.length}`);return{row:e,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${e.length}`}}return t.strictColumnHandling&&e.length<this.headersLength?{row:e,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${e.length}`}:{row:this.mapHeaders(e),isValid:!0}}mapHeaders(e){let t={},{headers:r,headersLength:i}=this;for(let s=0;s<i;s+=1){let i=r[s];if(!n.default(i)){let r=e[s];n.default(r)?t[i]="":t[i]=r}}return t}setHeaders(e){var t;let r=e.filter(e=>!!e);if(a.default(r).length!==r.length){let e=o.default(r),t=Object.keys(e).filter(t=>e[t].length>1);throw Error(`Duplicate headers found ${JSON.stringify(t)}`)}this.headers=e,this.receivedHeaders=!0,this.headersLength=(null===(t=this.headers)||void 0===t?void 0:t.length)||0}}t.HeaderTransformer=l},60181:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RowTransformerValidator=void 0;let n=i(r(21903)),s=r(1735);class a{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(e){return s.isSyncTransform(e)?(t,r)=>{let i=null;try{i=e(t)}catch(e){return r(e)}return r(null,i)}:e}static createValidator(e){return s.isSyncValidate(e)?(t,r)=>{r(null,{row:t,isValid:e(t)})}:(t,r)=>{e(t,(e,i,n)=>e?r(e):i?r(null,{row:t,isValid:i,reason:n}):r(null,{row:t,isValid:!1,reason:n}))}}set rowTransform(e){if(!n.default(e))throw TypeError("The transform should be a function");this._rowTransform=a.createTransform(e)}set rowValidator(e){if(!n.default(e))throw TypeError("The validate should be a function");this._rowValidator=a.createValidator(e)}transformAndValidate(e,t){return this.callTransformer(e,(e,r)=>e?t(e):r?this.callValidator(r,(e,i)=>e?t(e):i&&!i.isValid?t(null,{row:r,isValid:!1,reason:i.reason}):t(null,{row:r,isValid:!0})):t(null,{row:null,isValid:!0}))}callTransformer(e,t){return this._rowTransform?this._rowTransform(e,t):t(null,e)}callValidator(e,t){return this._rowValidator?this._rowValidator(e,t):t(null,{row:e,isValid:!0})}}t.RowTransformerValidator=a},62518:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderTransformer=t.RowTransformerValidator=void 0;var i=r(60181);Object.defineProperty(t,"RowTransformerValidator",{enumerable:!0,get:function(){return i.RowTransformerValidator}});var n=r(82986);Object.defineProperty(t,"HeaderTransformer",{enumerable:!0,get:function(){return n.HeaderTransformer}})},1735:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSyncValidate=t.isSyncTransform=void 0,t.isSyncTransform=e=>1===e.length,t.isSyncValidate=e=>1===e.length},30755:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(921).__importDefault(r(70926));class n{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,n,s;let a=null,o=null,l=null,u=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){let r=await e.text();""===r||(o="text/csv"===this.headers.get("Accept")?r:this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?r:JSON.parse(r))}let i=null===(r=this.headers.get("Prefer"))||void 0===r?void 0:r.match(/count=(exact|planned|estimated)/),s=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");i&&s&&s.length>1&&(l=parseInt(s[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,u=406,c="Not Acceptable"):o=1===o.length?o[0]:null)}else{let t=await e.text();try{a=JSON.parse(t),Array.isArray(a)&&404===e.status&&(o=[],a=null,u=200,c="OK")}catch(r){404===e.status&&""===t?(u=204,c="No Content"):a={message:t}}if(a&&this.isMaybeSingle&&(null===(s=null==a?void 0:a.details)||void 0===s?void 0:s.includes("0 rows"))&&(a=null,u=200,c="OK"),a&&this.shouldThrowOnError)throw new i.default(a)}return{error:a,data:o,count:l,status:u,statusText:c}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,i,n,s,a;let o="",l=null==e?void 0:e.cause;if(l){let s=null!==(t=null==l?void 0:l.message)&&void 0!==t?t:"",a=null!==(r=null==l?void 0:l.code)&&void 0!==r?r:"";o=`${null!==(i=null==e?void 0:e.name)&&void 0!==i?i:"FetchError"}: ${null==e?void 0:e.message}

Caused by: ${null!==(n=null==l?void 0:l.name)&&void 0!==n?n:"Error"}: ${s}`,a&&(o+=` (${a})`),(null==l?void 0:l.stack)&&(o+=`
${l.stack}`)}else o=null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:"";return{error:{message:`${null!==(a=null==e?void 0:e.name)&&void 0!==a?a:"FetchError"}: ${null==e?void 0:e.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}}t.default=n},46793:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(921),n=i.__importDefault(r(10141)),s=i.__importDefault(r(36129));class a{constructor(e,{headers:t={},schema:r,fetch:i}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=i}from(e){if(!e||"string"!=typeof e||""===e.trim())throw Error("Invalid relation name: relation must be a non-empty string.");let t=new URL(`${this.url}/${e}`);return new n.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new a(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:i=!1,count:n}={}){var a;let o,l;let u=new URL(`${this.url}/rpc/${e}`);r||i?(o=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{u.searchParams.append(e,t)})):(o="POST",l=t);let c=new Headers(this.headers);return n&&c.set("Prefer",`count=${n}`),new s.default({method:o,url:u,headers:c,schema:this.schemaName,body:l,fetch:null!==(a=this.fetch)&&void 0!==a?a:fetch})}}t.default=a},70926:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=r},36129:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(921).__importDefault(r(2221)),n=RegExp("[,()]");class s extends i.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&n.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:i}={}){let n="";"plain"===i?n="pl":"phrase"===i?n="ph":"websearch"===i&&(n="w");let s=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}t.default=s},10141:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(921).__importDefault(r(36129));class n{constructor(e,{headers:t={},schema:r,fetch:i}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=i}select(e,t){let{head:r=!1,count:n}=null!=t?t:{},s=!1,a=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)).join("");return this.url.searchParams.set("select",a),n&&this.headers.append("Prefer",`count=${n}`),new i.default({method:r?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){var a;if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),void 0!==t&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer",`count=${n}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(a=this.fetch)&&void 0!==a?a:fetch})}update(e,{count:t}={}){var r;return t&&this.headers.append("Prefer",`count=${t}`),new i.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}delete({count:e}={}){var t;return e&&this.headers.append("Prefer",`count=${e}`),new i.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}}t.default=n},2221:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(921).__importDefault(r(30755));class n extends i.default{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:i,referencedTable:n=i}={}){let s=n?`${n}.order`:"order",a=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let i=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:i=r}={}){let n=void 0===i?"offset":`${i}.offset`,s=void 0===i?"limit":`${i}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:i=!1,wal:n=!1,format:s="text"}={}){var a;let o=[e?"analyze":null,t?"verbose":null,r?"settings":null,i?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!==(a=this.headers.get("Accept"))&&void 0!==a?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${l}"; options=${o};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}}t.default=n},30003:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;let i=r(921),n=i.__importDefault(r(46793));t.PostgrestClient=n.default;let s=i.__importDefault(r(10141));t.PostgrestQueryBuilder=s.default;let a=i.__importDefault(r(36129));t.PostgrestFilterBuilder=a.default;let o=i.__importDefault(r(2221));t.PostgrestTransformBuilder=o.default;let l=i.__importDefault(r(30755));t.PostgrestBuilder=l.default;let u=i.__importDefault(r(70926));t.PostgrestError=u.default,t.default={PostgrestClient:n.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:u.default}},16330:(e,t,r)=>{var i=r(2720),n=r(33873),s=r(58107),a=r(47162),o=r(46753),l=r(35933),u=r(88939),c=e.exports={},h=/[\/\\]/g,d=function(e,t){var r=[];return s(e).forEach(function(e){var i=0===e.indexOf("!");i&&(e=e.slice(1));var n=t(e);r=i?a(r,n):o(r,n)}),r};c.exists=function(){var e=n.join.apply(n,arguments);return i.existsSync(e)},c.expand=function(...e){var t=l(e[0])?e.shift():{},r=Array.isArray(e[0])?e[0]:e;if(0===r.length)return[];var s=d(r,function(e){return u.sync(e,t)});return t.filter&&(s=s.filter(function(e){e=n.join(t.cwd||"",e);try{if("function"==typeof t.filter)return t.filter(e);return i.statSync(e)[t.filter]()}catch(e){return!1}})),s},c.expandMapping=function(e,t,r){r=Object.assign({rename:function(e,t){return n.join(e||"",t)}},r);var i=[],s={};return c.expand(r,e).forEach(function(e){var a=e;r.flatten&&(a=n.basename(a)),r.ext&&(a=a.replace(/(\.[^\/]*)?$/,r.ext));var o=r.rename(t,a,r);r.cwd&&(e=n.join(r.cwd,e)),o=o.replace(h,"/"),e=e.replace(h,"/"),s[o]?s[o].src.push(e):(i.push({src:[e],dest:o}),s[o]=i[i.length-1])}),i},c.normalizeFilesArray=function(e){var t=[];return(e.forEach(function(e){("src"in e||"dest"in e)&&t.push(e)}),0===t.length)?[]:t=_(t).chain().forEach(function(e){"src"in e&&e.src&&(Array.isArray(e.src)?e.src=s(e.src):e.src=[e.src])}).map(function(e){var t=Object.assign({},e);if(delete t.src,delete t.dest,e.expand)return c.expandMapping(e.src,e.dest,t).map(function(t){var r=Object.assign({},e);return r.orig=Object.assign({},e),r.src=t.src,r.dest=t.dest,["expand","cwd","flatten","rename","ext"].forEach(function(e){delete r[e]}),r});var r=Object.assign({},e);return r.orig=Object.assign({},e),"src"in r&&Object.defineProperty(r,"src",{enumerable:!0,get:function r(){var i;return"result"in r||(i=Array.isArray(i=e.src)?s(i):[i],r.result=c.expand(t,i)),r.result}}),"dest"in r&&(r.dest=e.dest),r}).flatten().value()}},61070:(e,t,r)=>{var i=r(2720),n=r(33873);r(28354);var s=r(98417),a=r(13498),o=r(15859),l=r(27910).Stream,u=r(32662).PassThrough,c=e.exports={};c.file=r(16330),c.collectStream=function(e,t){var r=[],i=0;e.on("error",t),e.on("data",function(e){r.push(e),i+=e.length}),e.on("end",function(){var e=new Buffer(i),n=0;r.forEach(function(t){t.copy(e,n),n+=t.length}),t(null,e)})},c.dateify=function(e){return(e=e||new Date)instanceof Date||(e="string"==typeof e?new Date(e):new Date),e},c.defaults=function(e,t,r){var i=arguments;return i[0]=i[0]||{},o(...i)},c.isStream=function(e){return e instanceof l},c.lazyReadStream=function(e){return new s.Readable(function(){return i.createReadStream(e)})},c.normalizeInputSource=function(e){if(null===e)return new Buffer(0);if("string"==typeof e)return new Buffer(e);if(c.isStream(e)&&!e._readableState){var t=new u;return e.pipe(t),t}return e},c.sanitizePath=function(e){return a(e,!1).replace(/^\w+:/,"").replace(/^(\.\.\/|\/)+/,"")},c.trailingSlashIt=function(e){return"/"!==e.slice(-1)?e+"/":e},c.unixifyPath=function(e){return a(e,!1).replace(/^\w+:/,"")},c.walkdir=function(e,t,r){var s=[];"function"==typeof t&&(r=t,t=e),i.readdir(e,function(a,o){var l,u,h=0;if(a)return r(a);!function a(){if(!(l=o[h++]))return r(null,s);u=n.join(e,l),i.stat(u,function(e,r){s.push({path:u,relative:n.relative(t,u).replace(/\\/g,"/"),stats:r}),r&&r.isDirectory()?c.walkdir(u,t,function(e,t){t.forEach(function(e){s.push(e)}),a()}):a()})}()})}},33898:(e,t,r)=>{var i=r(2720),n=r(33873),s=r(58107),a=r(47162),o=r(46753),l=r(35933),u=r(88939),c=e.exports={},h=/[\/\\]/g,d=function(e,t){var r=[];return s(e).forEach(function(e){var i=0===e.indexOf("!");i&&(e=e.slice(1));var n=t(e);r=i?a(r,n):o(r,n)}),r};c.exists=function(){var e=n.join.apply(n,arguments);return i.existsSync(e)},c.expand=function(...e){var t=l(e[0])?e.shift():{},r=Array.isArray(e[0])?e[0]:e;if(0===r.length)return[];var s=d(r,function(e){return u.sync(e,t)});return t.filter&&(s=s.filter(function(e){e=n.join(t.cwd||"",e);try{if("function"==typeof t.filter)return t.filter(e);return i.statSync(e)[t.filter]()}catch(e){return!1}})),s},c.expandMapping=function(e,t,r){r=Object.assign({rename:function(e,t){return n.join(e||"",t)}},r);var i=[],s={};return c.expand(r,e).forEach(function(e){var a=e;r.flatten&&(a=n.basename(a)),r.ext&&(a=a.replace(/(\.[^\/]*)?$/,r.ext));var o=r.rename(t,a,r);r.cwd&&(e=n.join(r.cwd,e)),o=o.replace(h,"/"),e=e.replace(h,"/"),s[o]?s[o].src.push(e):(i.push({src:[e],dest:o}),s[o]=i[i.length-1])}),i},c.normalizeFilesArray=function(e){var t=[];return(e.forEach(function(e){("src"in e||"dest"in e)&&t.push(e)}),0===t.length)?[]:t=_(t).chain().forEach(function(e){"src"in e&&e.src&&(Array.isArray(e.src)?e.src=s(e.src):e.src=[e.src])}).map(function(e){var t=Object.assign({},e);if(delete t.src,delete t.dest,e.expand)return c.expandMapping(e.src,e.dest,t).map(function(t){var r=Object.assign({},e);return r.orig=Object.assign({},e),r.src=t.src,r.dest=t.dest,["expand","cwd","flatten","rename","ext"].forEach(function(e){delete r[e]}),r});var r=Object.assign({},e);return r.orig=Object.assign({},e),"src"in r&&Object.defineProperty(r,"src",{enumerable:!0,get:function r(){var i;return"result"in r||(i=Array.isArray(i=e.src)?s(i):[i],r.result=c.expand(t,i)),r.result}}),"dest"in r&&(r.dest=e.dest),r}).flatten().value()}},96782:(e,t,r)=>{var i=r(2720),n=r(33873),s=r(98417),a=r(13498),o=r(15859),l=r(27910).Stream,u=r(68280).PassThrough,c=e.exports={};c.file=r(33898),c.collectStream=function(e,t){var r=[],i=0;e.on("error",t),e.on("data",function(e){r.push(e),i+=e.length}),e.on("end",function(){var e=Buffer.alloc(i),n=0;r.forEach(function(t){t.copy(e,n),n+=t.length}),t(null,e)})},c.dateify=function(e){return(e=e||new Date)instanceof Date||(e="string"==typeof e?new Date(e):new Date),e},c.defaults=function(e,t,r){var i=arguments;return i[0]=i[0]||{},o(...i)},c.isStream=function(e){return e instanceof l},c.lazyReadStream=function(e){return new s.Readable(function(){return i.createReadStream(e)})},c.normalizeInputSource=function(e){return null===e?Buffer.alloc(0):"string"==typeof e?Buffer.from(e):c.isStream(e)?e.pipe(new u):e},c.sanitizePath=function(e){return a(e,!1).replace(/^\w+:/,"").replace(/^(\.\.\/|\/)+/,"")},c.trailingSlashIt=function(e){return"/"!==e.slice(-1)?e+"/":e},c.unixifyPath=function(e){return a(e,!1).replace(/^\w+:/,"")},c.walkdir=function(e,t,r){var s=[];"function"==typeof t&&(r=t,t=e),i.readdir(e,function(a,o){var l,u,h=0;if(a)return r(a);!function a(){if(!(l=o[h++]))return r(null,s);u=n.join(e,l),i.stat(u,function(e,r){s.push({path:u,relative:n.relative(t,u).replace(/\\/g,"/"),stats:r}),r&&r.isDirectory()?c.walkdir(u,t,function(e,t){t.forEach(function(e){s.push(e)}),a()}):a()})}()})}},14319:(e,t,r)=>{var i=r(7956),n={},s=function(e,t){return s.create(e,t)};s.create=function(e,t){if(n[e]){var r=new i(e,t);return r.setFormat(e),r.setModule(new n[e](t)),r}throw Error("create("+e+"): format not registered")},s.registerFormat=function(e,t){if(n[e])throw Error("register("+e+"): format already registered");if("function"!=typeof t)throw Error("register("+e+"): format module invalid");if("function"!=typeof t.prototype.append||"function"!=typeof t.prototype.finalize)throw Error("register("+e+"): format module missing methods");n[e]=t},s.isRegisteredFormat=function(e){return!!n[e]},s.registerFormat("zip",r(55663)),s.registerFormat("tar",r(80543)),s.registerFormat("json",r(39912)),e.exports=s},7956:(e,t,r)=>{var i=r(29021),n=r(33162),s=r(75450),a=r(33873),o=r(61070),l=r(28354).inherits,u=r(20577),c=r(68280).Transform,h="win32"===process.platform,d=function(e,t){if(!(this instanceof d))return new d(e,t);"string"!=typeof e&&(t=e,e="zip"),t=this.options=o.defaults(t,{highWaterMark:1048576,statConcurrency:4}),c.call(this,t),this._format=!1,this._module=!1,this._pending=0,this._pointer=0,this._entriesCount=0,this._entriesProcessedCount=0,this._fsEntriesTotalBytes=0,this._fsEntriesProcessedBytes=0,this._queue=s.queue(this._onQueueTask.bind(this),1),this._queue.drain(this._onQueueDrain.bind(this)),this._statQueue=s.queue(this._onStatQueueTask.bind(this),t.statConcurrency),this._statQueue.drain(this._onQueueDrain.bind(this)),this._state={aborted:!1,finalize:!1,finalizing:!1,finalized:!1,modulePiped:!1},this._streams=[]};l(d,c),d.prototype._abort=function(){this._state.aborted=!0,this._queue.kill(),this._statQueue.kill(),this._queue.idle()&&this._shutdown()},d.prototype._append=function(e,t){var r={source:null,filepath:e};(t=t||{}).name||(t.name=e),t.sourcePath=e,r.data=t,this._entriesCount++,t.stats&&t.stats instanceof i.Stats?(r=this._updateQueueTaskWithStats(r,t.stats))&&(t.stats.size&&(this._fsEntriesTotalBytes+=t.stats.size),this._queue.push(r)):this._statQueue.push(r)},d.prototype._finalize=function(){this._state.finalizing||this._state.finalized||this._state.aborted||(this._state.finalizing=!0,this._moduleFinalize(),this._state.finalizing=!1,this._state.finalized=!0)},d.prototype._maybeFinalize=function(){return!this._state.finalizing&&!this._state.finalized&&!this._state.aborted&&!!(this._state.finalize&&0===this._pending&&this._queue.idle()&&this._statQueue.idle())&&(this._finalize(),!0)},d.prototype._moduleAppend=function(e,t,r){if(this._state.aborted){r();return}this._module.append(e,t,(function(e){if(this._task=null,this._state.aborted){this._shutdown();return}if(e){this.emit("error",e),setImmediate(r);return}this.emit("entry",t),this._entriesProcessedCount++,t.stats&&t.stats.size&&(this._fsEntriesProcessedBytes+=t.stats.size),this.emit("progress",{entries:{total:this._entriesCount,processed:this._entriesProcessedCount},fs:{totalBytes:this._fsEntriesTotalBytes,processedBytes:this._fsEntriesProcessedBytes}}),setImmediate(r)}).bind(this))},d.prototype._moduleFinalize=function(){"function"==typeof this._module.finalize?this._module.finalize():"function"==typeof this._module.end?this._module.end():this.emit("error",new u("NOENDMETHOD"))},d.prototype._modulePipe=function(){this._module.on("error",this._onModuleError.bind(this)),this._module.pipe(this),this._state.modulePiped=!0},d.prototype._moduleSupports=function(e){return!!this._module.supports&&!!this._module.supports[e]&&this._module.supports[e]},d.prototype._moduleUnpipe=function(){this._module.unpipe(this),this._state.modulePiped=!1},d.prototype._normalizeEntryData=function(e,t){e=o.defaults(e,{type:"file",name:null,date:null,mode:null,prefix:null,sourcePath:null,stats:!1}),t&&!1===e.stats&&(e.stats=t);var r="directory"===e.type;return e.name&&("string"==typeof e.prefix&&""!==e.prefix&&(e.name=e.prefix+"/"+e.name,e.prefix=null),e.name=o.sanitizePath(e.name),"symlink"!==e.type&&"/"===e.name.slice(-1)?(r=!0,e.type="directory"):r&&(e.name+="/")),"number"==typeof e.mode?h?e.mode&=511:e.mode&=4095:e.stats&&null===e.mode?(h?e.mode=511&e.stats.mode:e.mode=4095&e.stats.mode,h&&r&&(e.mode=493)):null===e.mode&&(e.mode=r?493:420),e.stats&&null===e.date?e.date=e.stats.mtime:e.date=o.dateify(e.date),e},d.prototype._onModuleError=function(e){this.emit("error",e)},d.prototype._onQueueDrain=function(){!this._state.finalizing&&!this._state.finalized&&!this._state.aborted&&this._state.finalize&&0===this._pending&&this._queue.idle()&&this._statQueue.idle()&&this._finalize()},d.prototype._onQueueTask=function(e,t){var r=()=>{e.data.callback&&e.data.callback(),t()};if(this._state.finalizing||this._state.finalized||this._state.aborted){r();return}this._task=e,this._moduleAppend(e.source,e.data,r)},d.prototype._onStatQueueTask=function(e,t){if(this._state.finalizing||this._state.finalized||this._state.aborted){t();return}i.lstat(e.filepath,(function(r,i){if(this._state.aborted){setImmediate(t);return}if(r){this._entriesCount--,this.emit("warning",r),setImmediate(t);return}(e=this._updateQueueTaskWithStats(e,i))&&(i.size&&(this._fsEntriesTotalBytes+=i.size),this._queue.push(e)),setImmediate(t)}).bind(this))},d.prototype._shutdown=function(){this._moduleUnpipe(),this.end()},d.prototype._transform=function(e,t,r){e&&(this._pointer+=e.length),r(null,e)},d.prototype._updateQueueTaskWithStats=function(e,t){if(t.isFile())e.data.type="file",e.data.sourceType="stream",e.source=o.lazyReadStream(e.filepath);else if(t.isDirectory()&&this._moduleSupports("directory"))e.data.name=o.trailingSlashIt(e.data.name),e.data.type="directory",e.data.sourcePath=o.trailingSlashIt(e.filepath),e.data.sourceType="buffer",e.source=Buffer.concat([]);else{if(!(t.isSymbolicLink()&&this._moduleSupports("symlink")))return t.isDirectory()?this.emit("warning",new u("DIRECTORYNOTSUPPORTED",e.data)):t.isSymbolicLink()?this.emit("warning",new u("SYMLINKNOTSUPPORTED",e.data)):this.emit("warning",new u("ENTRYNOTSUPPORTED",e.data)),null;var r=i.readlinkSync(e.filepath),n=a.dirname(e.filepath);e.data.type="symlink",e.data.linkname=a.relative(n,a.resolve(n,r)),e.data.sourceType="buffer",e.source=Buffer.concat([])}return e.data=this._normalizeEntryData(e.data,t),e},d.prototype.abort=function(){return this._state.aborted||this._state.finalized||this._abort(),this},d.prototype.append=function(e,t){if(this._state.finalize||this._state.aborted)return this.emit("error",new u("QUEUECLOSED")),this;if("string"!=typeof(t=this._normalizeEntryData(t)).name||0===t.name.length)return this.emit("error",new u("ENTRYNAMEREQUIRED")),this;if("directory"===t.type&&!this._moduleSupports("directory"))return this.emit("error",new u("DIRECTORYNOTSUPPORTED",{name:t.name})),this;if(e=o.normalizeInputSource(e),Buffer.isBuffer(e))t.sourceType="buffer";else{if(!o.isStream(e))return this.emit("error",new u("INPUTSTEAMBUFFERREQUIRED",{name:t.name})),this;t.sourceType="stream"}return this._entriesCount++,this._queue.push({data:t,source:e}),this},d.prototype.directory=function(e,t,r){if(this._state.finalize||this._state.aborted)return this.emit("error",new u("QUEUECLOSED")),this;if("string"!=typeof e||0===e.length)return this.emit("error",new u("DIRECTORYDIRPATHREQUIRED")),this;this._pending++,!1===t?t="":"string"!=typeof t&&(t=e);var i=!1;"function"==typeof r?(i=r,r={}):"object"!=typeof r&&(r={});var s=n(e,{stat:!0,dot:!0});return s.on("error",(function(e){this.emit("error",e)}).bind(this)),s.on("match",(function(n){s.pause();var a=!1,o=Object.assign({},r);o.name=n.relative,o.prefix=t,o.stats=n.stat,o.callback=s.resume.bind(s);try{if(i){if(o=i(o),!1===o)a=!0;else if("object"!=typeof o)throw new u("DIRECTORYFUNCTIONINVALIDDATA",{dirpath:e})}}catch(e){this.emit("error",e);return}if(a){s.resume();return}this._append(n.absolute,o)}).bind(this)),s.on("end",(function(){this._pending--,this._maybeFinalize()}).bind(this)),this},d.prototype.file=function(e,t){return this._state.finalize||this._state.aborted?this.emit("error",new u("QUEUECLOSED")):"string"!=typeof e||0===e.length?this.emit("error",new u("FILEFILEPATHREQUIRED")):this._append(e,t),this},d.prototype.glob=function(e,t,r){this._pending++;var i=n((t=o.defaults(t,{stat:!0,pattern:e})).cwd||".",t);return i.on("error",(function(e){this.emit("error",e)}).bind(this)),i.on("match",(function(e){i.pause();var t=Object.assign({},r);t.callback=i.resume.bind(i),t.stats=e.stat,t.name=e.relative,this._append(e.absolute,t)}).bind(this)),i.on("end",(function(){this._pending--,this._maybeFinalize()}).bind(this)),this},d.prototype.finalize=function(){if(this._state.aborted){var e=new u("ABORTED");return this.emit("error",e),Promise.reject(e)}if(this._state.finalize){var t=new u("FINALIZING");return this.emit("error",t),Promise.reject(t)}this._state.finalize=!0,0===this._pending&&this._queue.idle()&&this._statQueue.idle()&&this._finalize();var r=this;return new Promise(function(e,t){var i;r._module.on("end",function(){i||e()}),r._module.on("error",function(e){i=!0,t(e)})})},d.prototype.setFormat=function(e){return this._format?this.emit("error",new u("FORMATSET")):this._format=e,this},d.prototype.setModule=function(e){return this._state.aborted?this.emit("error",new u("ABORTED")):this._state.module?this.emit("error",new u("MODULESET")):(this._module=e,this._modulePipe()),this},d.prototype.symlink=function(e,t,r){if(this._state.finalize||this._state.aborted)return this.emit("error",new u("QUEUECLOSED")),this;if("string"!=typeof e||0===e.length)return this.emit("error",new u("SYMLINKFILEPATHREQUIRED")),this;if("string"!=typeof t||0===t.length)return this.emit("error",new u("SYMLINKTARGETREQUIRED",{filepath:e})),this;if(!this._moduleSupports("symlink"))return this.emit("error",new u("SYMLINKNOTSUPPORTED",{filepath:e})),this;var i={};return i.type="symlink",i.name=e.replace(/\\/g,"/"),i.linkname=t.replace(/\\/g,"/"),i.sourceType="buffer","number"==typeof r&&(i.mode=r),this._entriesCount++,this._queue.push({data:i,source:Buffer.concat([])}),this},d.prototype.pointer=function(){return this._pointer},d.prototype.use=function(e){return this._streams.push(e),this},e.exports=d},20577:(e,t,r)=>{var i=r(28354);let n={ABORTED:"archive was aborted",DIRECTORYDIRPATHREQUIRED:"diretory dirpath argument must be a non-empty string value",DIRECTORYFUNCTIONINVALIDDATA:"invalid data returned by directory custom data function",ENTRYNAMEREQUIRED:"entry name must be a non-empty string value",FILEFILEPATHREQUIRED:"file filepath argument must be a non-empty string value",FINALIZING:"archive already finalizing",QUEUECLOSED:"queue closed",NOENDMETHOD:"no suitable finalize/end method defined by module",DIRECTORYNOTSUPPORTED:"support for directory entries not defined by module",FORMATSET:"archive format already set",INPUTSTEAMBUFFERREQUIRED:"input source must be valid Stream or Buffer instance",MODULESET:"module already set",SYMLINKNOTSUPPORTED:"support for symlink entries not defined by module",SYMLINKFILEPATHREQUIRED:"symlink filepath argument must be a non-empty string value",SYMLINKTARGETREQUIRED:"symlink target argument must be a non-empty string value",ENTRYNOTSUPPORTED:"entry not supported"};function s(e,t){Error.captureStackTrace(this,this.constructor),this.message=n[e]||e,this.code=e,this.data=t}i.inherits(s,Error),e.exports=s},39912:(e,t,r)=>{var i=r(28354).inherits,n=r(68280).Transform,s=r(65971),a=r(61070),o=function(e){if(!(this instanceof o))return new o(e);e=this.options=a.defaults(e,{}),n.call(this,e),this.supports={directory:!0,symlink:!0},this.files=[]};i(o,n),o.prototype._transform=function(e,t,r){r(null,e)},o.prototype._writeStringified=function(){var e=JSON.stringify(this.files);this.write(e)},o.prototype.append=function(e,t,r){var i=this;function n(e,n){if(e){r(e);return}t.size=n.length||0,t.crc32=s.unsigned(n),i.files.push(t),r(null,t)}t.crc32=0,"buffer"===t.sourceType?n(null,e):"stream"===t.sourceType&&a.collectStream(e,n)},o.prototype.finalize=function(){this._writeStringified(),this.end()},e.exports=o},80543:(e,t,r)=>{var i=r(74075),n=r(47851),s=r(61070),a=function(e){if(!(this instanceof a))return new a(e);"object"!=typeof(e=this.options=s.defaults(e,{gzip:!1})).gzipOptions&&(e.gzipOptions={}),this.supports={directory:!0,symlink:!0},this.engine=n.pack(e),this.compressor=!1,e.gzip&&(this.compressor=i.createGzip(e.gzipOptions),this.compressor.on("error",this._onCompressorError.bind(this)))};a.prototype._onCompressorError=function(e){this.engine.emit("error",e)},a.prototype.append=function(e,t,r){var i=this;function n(e,n){if(e){r(e);return}i.engine.entry(t,n,function(e){r(e,t)})}if(t.mtime=t.date,"buffer"===t.sourceType)n(null,e);else if("stream"===t.sourceType&&t.stats){t.size=t.stats.size;var a=i.engine.entry(t,function(e){r(e,t)});e.pipe(a)}else"stream"===t.sourceType&&s.collectStream(e,n)},a.prototype.finalize=function(){this.engine.finalize()},a.prototype.on=function(){return this.engine.on.apply(this.engine,arguments)},a.prototype.pipe=function(e,t){return this.compressor?this.engine.pipe.apply(this.engine,[this.compressor]).pipe(e,t):this.engine.pipe.apply(this.engine,arguments)},a.prototype.unpipe=function(){return this.compressor?this.compressor.unpipe.apply(this.compressor,arguments):this.engine.unpipe.apply(this.engine,arguments)},e.exports=a},55663:(e,t,r)=>{var i=r(89635),n=r(61070),s=function(e){if(!(this instanceof s))return new s(e);e=this.options=n.defaults(e,{comment:"",forceUTC:!1,namePrependSlash:!1,store:!1}),this.supports={directory:!0,symlink:!0},this.engine=new i(e)};s.prototype.append=function(e,t,r){this.engine.entry(e,t,r)},s.prototype.finalize=function(){this.engine.finalize()},s.prototype.on=function(){return this.engine.on.apply(this.engine,arguments)},s.prototype.pipe=function(){return this.engine.pipe.apply(this.engine,arguments)},s.prototype.unpipe=function(){return this.engine.unpipe.apply(this.engine,arguments)},e.exports=s},61746:e=>{"use strict";function t(e,t,n){e instanceof RegExp&&(e=r(e,n)),t instanceof RegExp&&(t=r(t,n));var s=i(e,t,n);return s&&{start:s[0],end:s[1],pre:n.slice(0,s[0]),body:n.slice(s[0]+e.length,s[1]),post:n.slice(s[1]+t.length)}}function r(e,t){var r=t.match(e);return r?r[0]:null}function i(e,t,r){var i,n,s,a,o,l=r.indexOf(e),u=r.indexOf(t,l+1),c=l;if(l>=0&&u>0){if(e===t)return[l,u];for(i=[],s=r.length;c>=0&&!o;)c==l?(i.push(c),l=r.indexOf(e,c+1)):1==i.length?o=[i.pop(),u]:((n=i.pop())<s&&(s=n,a=u),u=r.indexOf(t,c+1)),c=l<u&&l>=0?l:u;i.length&&(o=[s,a])}return o}e.exports=t,t.range=i},62269:(e,t,r)=>{e=r.nmd(e);var i,n=function(e){"use strict";var t=c(0x20000000000000),r="0123456789abcdefghijklmnopqrstuvwxyz",i="function"==typeof BigInt;function s(e,t,r,i){return void 0===e?s[0]:void 0!==t&&(10!=+t||r)?B(e,t,r,i):W(e)}function a(e,t){this.value=e,this.sign=t,this.isSmall=!1}function o(e){this.value=e,this.sign=e<0,this.isSmall=!0}function l(e){this.value=e}function u(e){return -0x20000000000000<e&&e<0x20000000000000}function c(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function h(e){d(e);var r=e.length;if(r<4&&0>C(e,t))switch(r){case 0:return 0;case 1:return e[0];case 2:return e[0]+1e7*e[1];default:return e[0]+(e[1]+1e7*e[2])*1e7}return e}function d(e){for(var t=e.length;0===e[--t];);e.length=t+1}function p(e){for(var t=Array(e),r=-1;++r<e;)t[r]=0;return t}function f(e){return e>0?Math.floor(e):Math.ceil(e)}function m(e,t){var r,i,n=e.length,s=t.length,a=Array(n),o=0;for(i=0;i<s;i++)o=(r=e[i]+t[i]+o)>=1e7?1:0,a[i]=r-1e7*o;for(;i<n;)o=1e7===(r=e[i]+o)?1:0,a[i++]=r-1e7*o;return o>0&&a.push(o),a}function g(e,t){return e.length>=t.length?m(e,t):m(t,e)}function y(e,t){var r,i,n=e.length,s=Array(n);for(i=0;i<n;i++)t=Math.floor((r=e[i]-1e7+t)/1e7),s[i]=r-1e7*t,t+=1;for(;t>0;)s[i++]=t%1e7,t=Math.floor(t/1e7);return s}function v(e,t){var r,i,n=e.length,s=t.length,a=Array(n),o=0;for(r=0;r<s;r++)(i=e[r]-o-t[r])<0?(i+=1e7,o=1):o=0,a[r]=i;for(r=s;r<n;r++){if((i=e[r]-o)<0)i+=1e7;else{a[r++]=i;break}a[r]=i}for(;r<n;r++)a[r]=e[r];return d(a),a}function b(e,t,r){var i,n,s=e.length,l=Array(s),u=-t;for(i=0;i<s;i++)u=Math.floor((n=e[i]+u)/1e7),n%=1e7,l[i]=n<0?n+1e7:n;return"number"==typeof(l=h(l))?(r&&(l=-l),new o(l)):new a(l,r)}function w(e,t){var r,i,n,s,a=e.length,o=t.length,l=p(a+o);for(n=0;n<a;++n){s=e[n];for(var u=0;u<o;++u)i=Math.floor((r=s*t[u]+l[n+u])/1e7),l[n+u]=r-1e7*i,l[n+u+1]+=i}return d(l),l}function x(e,t){var r,i,n=e.length,s=Array(n),a=0;for(i=0;i<n;i++)a=Math.floor((r=e[i]*t+a)/1e7),s[i]=r-1e7*a;for(;a>0;)s[i++]=a%1e7,a=Math.floor(a/1e7);return s}function S(e,t){for(var r=[];t-- >0;)r.push(0);return r.concat(e)}function E(e,t,r){return e<1e7?new a(x(t,e),r):new a(w(t,c(e)),r)}function T(e){var t,r,i,n,s=e.length,a=p(s+s);for(i=0;i<s;i++){r=0-(n=e[i])*n;for(var o=i;o<s;o++)r=Math.floor((t=n*e[o]*2+a[i+o]+r)/1e7),a[i+o]=t-1e7*r;a[i+s]=r}return d(a),a}function k(e,t){var r,i,n,s,a=e.length,o=p(a);for(n=0,r=a-1;r>=0;--r)i=f((s=1e7*n+e[r])/t),n=s-i*t,o[r]=0|i;return[o,0|n]}function O(e,t){var r,n,u=W(t);if(i)return[new l(e.value/u.value),new l(e.value%u.value)];var m=e.value,g=u.value;if(0===g)throw Error("Cannot divide by zero");if(e.isSmall)return u.isSmall?[new o(f(m/g)),new o(m%g)]:[s[0],e];if(u.isSmall){if(1===g)return[e,s[0]];if(-1==g)return[e.negate(),s[0]];var y=Math.abs(g);if(y<1e7){r=h((n=k(m,y))[0]);var b=n[1];return(e.sign&&(b=-b),"number"==typeof r)?(e.sign!==u.sign&&(r=-r),[new o(r),new o(b)]):[new a(r,e.sign!==u.sign),new o(b)]}g=c(y)}var w=C(m,g);if(-1===w)return[s[0],e];if(0===w)return[s[e.sign===u.sign?1:-1],s[0]];r=(n=m.length+g.length<=200?function(e,t){var r,i,n,s,a,o,l,u=e.length,c=t.length,d=p(t.length),f=t[c-1],m=Math.ceil(1e7/(2*f)),g=x(e,m),y=x(t,m);for(g.length<=u&&g.push(0),y.push(0),f=y[c-1],i=u-c;i>=0;i--){for(r=1e7-1,g[i+c]!==f&&(r=Math.floor((1e7*g[i+c]+g[i+c-1])/f)),n=0,s=0,o=y.length,a=0;a<o;a++)n+=r*y[a],l=Math.floor(n/1e7),s+=g[i+a]-(n-1e7*l),n=l,s<0?(g[i+a]=s+1e7,s=-1):(g[i+a]=s,s=0);for(;0!==s;){for(r-=1,n=0,a=0;a<o;a++)(n+=g[i+a]-1e7+y[a])<0?(g[i+a]=n+1e7,n=0):(g[i+a]=n,n=1);s+=n}d[i]=r}return g=k(g,m)[0],[h(d),h(g)]}(m,g):function(e,t){for(var r,i,n,s,a,o=e.length,l=t.length,u=[],c=[];o;){if(c.unshift(e[--o]),d(c),0>C(c,t)){u.push(0);continue}i=c.length,n=1e7*c[i-1]+c[i-2],s=1e7*t[l-1]+t[l-2],i>l&&(n=(n+1)*1e7),r=Math.ceil(n/s);do{if(0>=C(a=x(t,r),c))break;r--}while(r);u.push(r),c=v(c,a)}return u.reverse(),[h(u),h(c)]}(m,g))[0];var S=e.sign!==u.sign,E=n[1],T=e.sign;return"number"==typeof r?(S&&(r=-r),r=new o(r)):r=new a(r,S),"number"==typeof E?(T&&(E=-E),E=new o(E)):E=new a(E,T),[r,E]}function C(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var r=e.length-1;r>=0;r--)if(e[r]!==t[r])return e[r]>t[r]?1:-1;return 0}function A(e){var t=e.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function N(e,t){for(var r,i,s,a=e.prev(),o=a,l=0;o.isEven();)o=o.divide(2),l++;e:for(i=0;i<t.length;i++)if(!e.lesser(t[i])&&!((s=n(t[i]).modPow(o,e)).isUnit()||s.equals(a))){for(r=l-1;0!=r&&!(s=s.square().mod(e)).isUnit();r--)if(s.equals(a))continue e;return!1}return!0}a.prototype=Object.create(s.prototype),o.prototype=Object.create(s.prototype),l.prototype=Object.create(s.prototype),a.prototype.add=function(e){var t=W(e);if(this.sign!==t.sign)return this.subtract(t.negate());var r=this.value,i=t.value;return t.isSmall?new a(y(r,Math.abs(i)),this.sign):new a(g(r,i),this.sign)},a.prototype.plus=a.prototype.add,o.prototype.add=function(e){var t=W(e),r=this.value;if(r<0!==t.sign)return this.subtract(t.negate());var i=t.value;if(t.isSmall){if(u(r+i))return new o(r+i);i=c(Math.abs(i))}return new a(y(i,Math.abs(r)),r<0)},o.prototype.plus=o.prototype.add,l.prototype.add=function(e){return new l(this.value+W(e).value)},l.prototype.plus=l.prototype.add,a.prototype.subtract=function(e){var t,r,i=W(e);if(this.sign!==i.sign)return this.add(i.negate());var n=this.value,s=i.value;return i.isSmall?b(n,Math.abs(s),this.sign):(t=this.sign,(C(n,s)>=0?r=v(n,s):(r=v(s,n),t=!t),"number"==typeof(r=h(r)))?(t&&(r=-r),new o(r)):new a(r,t))},a.prototype.minus=a.prototype.subtract,o.prototype.subtract=function(e){var t=W(e),r=this.value;if(r<0!==t.sign)return this.add(t.negate());var i=t.value;return t.isSmall?new o(r-i):b(i,Math.abs(r),r>=0)},o.prototype.minus=o.prototype.subtract,l.prototype.subtract=function(e){return new l(this.value-W(e).value)},l.prototype.minus=l.prototype.subtract,a.prototype.negate=function(){return new a(this.value,!this.sign)},o.prototype.negate=function(){var e=this.sign,t=new o(-this.value);return t.sign=!e,t},l.prototype.negate=function(){return new l(-this.value)},a.prototype.abs=function(){return new a(this.value,!1)},o.prototype.abs=function(){return new o(Math.abs(this.value))},l.prototype.abs=function(){return new l(this.value>=0?this.value:-this.value)},a.prototype.multiply=function(e){var t,r,i,n=W(e),o=this.value,l=n.value,u=this.sign!==n.sign;if(n.isSmall){if(0===l)return s[0];if(1===l)return this;if(-1===l)return this.negate();if((i=Math.abs(l))<1e7)return new a(x(o,i),u);l=c(i)}return -.012*(t=o.length)-.012*(r=l.length)+15e-6*t*r>0?new a(function e(t,r){var i=Math.max(t.length,r.length);if(i<=30)return w(t,r);i=Math.ceil(i/2);var n=t.slice(i),s=t.slice(0,i),a=r.slice(i),o=r.slice(0,i),l=e(s,o),u=e(n,a),c=e(g(s,n),g(o,a)),h=g(g(l,S(v(v(c,l),u),i)),S(u,2*i));return d(h),h}(o,l),u):new a(w(o,l),u)},a.prototype.times=a.prototype.multiply,o.prototype._multiplyBySmall=function(e){return u(e.value*this.value)?new o(e.value*this.value):E(Math.abs(e.value),c(Math.abs(this.value)),this.sign!==e.sign)},a.prototype._multiplyBySmall=function(e){return 0===e.value?s[0]:1===e.value?this:-1===e.value?this.negate():E(Math.abs(e.value),this.value,this.sign!==e.sign)},o.prototype.multiply=function(e){return W(e)._multiplyBySmall(this)},o.prototype.times=o.prototype.multiply,l.prototype.multiply=function(e){return new l(this.value*W(e).value)},l.prototype.times=l.prototype.multiply,a.prototype.square=function(){return new a(T(this.value),!1)},o.prototype.square=function(){var e=this.value*this.value;return u(e)?new o(e):new a(T(c(Math.abs(this.value))),!1)},l.prototype.square=function(e){return new l(this.value*this.value)},a.prototype.divmod=function(e){var t=O(this,e);return{quotient:t[0],remainder:t[1]}},l.prototype.divmod=o.prototype.divmod=a.prototype.divmod,a.prototype.divide=function(e){return O(this,e)[0]},l.prototype.over=l.prototype.divide=function(e){return new l(this.value/W(e).value)},o.prototype.over=o.prototype.divide=a.prototype.over=a.prototype.divide,a.prototype.mod=function(e){return O(this,e)[1]},l.prototype.mod=l.prototype.remainder=function(e){return new l(this.value%W(e).value)},o.prototype.remainder=o.prototype.mod=a.prototype.remainder=a.prototype.mod,a.prototype.pow=function(e){var t,r,i,n=W(e),a=this.value,l=n.value;if(0===l)return s[1];if(0===a)return s[0];if(1===a)return s[1];if(-1===a)return n.isEven()?s[1]:s[-1];if(n.sign)return s[0];if(!n.isSmall)throw Error("The exponent "+n.toString()+" is too large.");if(this.isSmall&&u(t=Math.pow(a,l)))return new o(f(t));for(r=this,i=s[1];!0&l&&(i=i.times(r),--l),0!==l;)l/=2,r=r.square();return i},o.prototype.pow=a.prototype.pow,l.prototype.pow=function(e){var t=W(e),r=this.value,i=t.value,n=BigInt(0),a=BigInt(1),o=BigInt(2);if(i===n)return s[1];if(r===n)return s[0];if(r===a)return s[1];if(r===BigInt(-1))return t.isEven()?s[1]:s[-1];if(t.isNegative())return new l(n);for(var u=this,c=s[1];(i&a)===a&&(c=c.times(u),--i),i!==n;)i/=o,u=u.square();return c},a.prototype.modPow=function(e,t){if(e=W(e),(t=W(t)).isZero())throw Error("Cannot take modPow with modulus 0");var r=s[1],i=this.mod(t);for(e.isNegative()&&(e=e.multiply(s[-1]),i=i.modInv(t));e.isPositive();){if(i.isZero())return s[0];e.isOdd()&&(r=r.multiply(i).mod(t)),e=e.divide(2),i=i.square().mod(t)}return r},l.prototype.modPow=o.prototype.modPow=a.prototype.modPow,a.prototype.compareAbs=function(e){var t=W(e),r=this.value,i=t.value;return t.isSmall?1:C(r,i)},o.prototype.compareAbs=function(e){var t=W(e),r=Math.abs(this.value),i=t.value;return t.isSmall?r===(i=Math.abs(i))?0:r>i?1:-1:-1},l.prototype.compareAbs=function(e){var t=this.value,r=W(e).value;return(t=t>=0?t:-t)===(r=r>=0?r:-r)?0:t>r?1:-1},a.prototype.compare=function(e){if(e===1/0)return -1;if(e===-1/0)return 1;var t=W(e),r=this.value,i=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:C(r,i)*(this.sign?-1:1)},a.prototype.compareTo=a.prototype.compare,o.prototype.compare=function(e){if(e===1/0)return -1;if(e===-1/0)return 1;var t=W(e),r=this.value,i=t.value;return t.isSmall?r==i?0:r>i?1:-1:r<0!==t.sign?r<0?-1:1:r<0?1:-1},o.prototype.compareTo=o.prototype.compare,l.prototype.compare=function(e){if(e===1/0)return -1;if(e===-1/0)return 1;var t=this.value,r=W(e).value;return t===r?0:t>r?1:-1},l.prototype.compareTo=l.prototype.compare,a.prototype.equals=function(e){return 0===this.compare(e)},l.prototype.eq=l.prototype.equals=o.prototype.eq=o.prototype.equals=a.prototype.eq=a.prototype.equals,a.prototype.notEquals=function(e){return 0!==this.compare(e)},l.prototype.neq=l.prototype.notEquals=o.prototype.neq=o.prototype.notEquals=a.prototype.neq=a.prototype.notEquals,a.prototype.greater=function(e){return this.compare(e)>0},l.prototype.gt=l.prototype.greater=o.prototype.gt=o.prototype.greater=a.prototype.gt=a.prototype.greater,a.prototype.lesser=function(e){return 0>this.compare(e)},l.prototype.lt=l.prototype.lesser=o.prototype.lt=o.prototype.lesser=a.prototype.lt=a.prototype.lesser,a.prototype.greaterOrEquals=function(e){return this.compare(e)>=0},l.prototype.geq=l.prototype.greaterOrEquals=o.prototype.geq=o.prototype.greaterOrEquals=a.prototype.geq=a.prototype.greaterOrEquals,a.prototype.lesserOrEquals=function(e){return 0>=this.compare(e)},l.prototype.leq=l.prototype.lesserOrEquals=o.prototype.leq=o.prototype.lesserOrEquals=a.prototype.leq=a.prototype.lesserOrEquals,a.prototype.isEven=function(){return(1&this.value[0])==0},o.prototype.isEven=function(){return(1&this.value)==0},l.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},a.prototype.isOdd=function(){return(1&this.value[0])==1},o.prototype.isOdd=function(){return(1&this.value)==1},l.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},a.prototype.isPositive=function(){return!this.sign},o.prototype.isPositive=function(){return this.value>0},l.prototype.isPositive=o.prototype.isPositive,a.prototype.isNegative=function(){return this.sign},o.prototype.isNegative=function(){return this.value<0},l.prototype.isNegative=o.prototype.isNegative,a.prototype.isUnit=function(){return!1},o.prototype.isUnit=function(){return 1===Math.abs(this.value)},l.prototype.isUnit=function(){return this.abs().value===BigInt(1)},a.prototype.isZero=function(){return!1},o.prototype.isZero=function(){return 0===this.value},l.prototype.isZero=function(){return this.value===BigInt(0)},a.prototype.isDivisibleBy=function(e){var t=W(e);return!t.isZero()&&(!!t.isUnit()||(0===t.compareAbs(2)?this.isEven():this.mod(t).isZero()))},l.prototype.isDivisibleBy=o.prototype.isDivisibleBy=a.prototype.isDivisibleBy,a.prototype.isPrime=function(e){var t=A(this);if(void 0!==t)return t;var r=this.abs(),i=r.bitLength();if(i<=64)return N(r,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var s=Math.log(2)*i.toJSNumber(),a=Math.ceil(!0===e?2*Math.pow(s,2):s),o=[],l=0;l<a;l++)o.push(n(l+2));return N(r,o)},l.prototype.isPrime=o.prototype.isPrime=a.prototype.isPrime,a.prototype.isProbablePrime=function(e,t){var r=A(this);if(void 0!==r)return r;for(var i=this.abs(),s=void 0===e?5:e,a=[],o=0;o<s;o++)a.push(n.randBetween(2,i.minus(2),t));return N(i,a)},l.prototype.isProbablePrime=o.prototype.isProbablePrime=a.prototype.isProbablePrime,a.prototype.modInv=function(e){for(var t,r,i,s=n.zero,a=n.one,o=W(e),l=this.abs();!l.isZero();)t=o.divide(l),r=s,i=o,s=a,o=l,a=r.subtract(t.multiply(a)),l=i.subtract(t.multiply(l));if(!o.isUnit())throw Error(this.toString()+" and "+e.toString()+" are not co-prime");return(-1===s.compare(0)&&(s=s.add(e)),this.isNegative())?s.negate():s},l.prototype.modInv=o.prototype.modInv=a.prototype.modInv,a.prototype.next=function(){var e=this.value;return this.sign?b(e,1,this.sign):new a(y(e,1),this.sign)},o.prototype.next=function(){var e=this.value;return e+1<0x20000000000000?new o(e+1):new a(t,!1)},l.prototype.next=function(){return new l(this.value+BigInt(1))},a.prototype.prev=function(){var e=this.value;return this.sign?new a(y(e,1),!0):b(e,1,this.sign)},o.prototype.prev=function(){var e=this.value;return e-1>-0x20000000000000?new o(e-1):new a(t,!0)},l.prototype.prev=function(){return new l(this.value-BigInt(1))};for(var R=[1];2*R[R.length-1]<=1e7;)R.push(2*R[R.length-1]);var I=R.length,P=R[I-1];function j(e){return 1e7>=Math.abs(e)}function D(e,t,r){t=W(t);for(var i=e.isNegative(),s=t.isNegative(),a=i?e.not():e,o=s?t.not():t,l=0,u=0,c=null,h=null,d=[];!a.isZero()||!o.isZero();)l=(c=O(a,P))[1].toJSNumber(),i&&(l=P-1-l),u=(h=O(o,P))[1].toJSNumber(),s&&(u=P-1-u),a=c[0],o=h[0],d.push(r(l,u));for(var p=0!==r(i?1:0,s?1:0)?n(-1):n(0),f=d.length-1;f>=0;f-=1)p=p.multiply(P).add(n(d[f]));return p}function L(e){var t=e.value,r="number"==typeof t?0x40000000|t:"bigint"==typeof t?t|BigInt(0x40000000):t[0]+1e7*t[1]|0x40004000;return r&-r}function $(e,t){return e=W(e),t=W(t),e.greater(t)?e:t}function F(e,t){return e=W(e),t=W(t),e.lesser(t)?e:t}function M(e,t){if(e=W(e).abs(),t=W(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var r,i,n=s[1];e.isEven()&&t.isEven();)r=F(L(e),L(t)),e=e.divide(r),t=t.divide(r),n=n.multiply(r);for(;e.isEven();)e=e.divide(L(e));do{for(;t.isEven();)t=t.divide(L(t));e.greater(t)&&(i=t,t=e,e=i),t=t.subtract(e)}while(!t.isZero());return n.isUnit()?e:e.multiply(n)}a.prototype.shiftLeft=function(e){var t=W(e).toJSNumber();if(!j(t))throw Error(String(t)+" is too large for shifting.");if(t<0)return this.shiftRight(-t);var r=this;if(r.isZero())return r;for(;t>=I;)r=r.multiply(P),t-=I-1;return r.multiply(R[t])},l.prototype.shiftLeft=o.prototype.shiftLeft=a.prototype.shiftLeft,a.prototype.shiftRight=function(e){var t,r=W(e).toJSNumber();if(!j(r))throw Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var i=this;r>=I;){if(i.isZero()||i.isNegative()&&i.isUnit())return i;i=(t=O(i,P))[1].isNegative()?t[0].prev():t[0],r-=I-1}return(t=O(i,R[r]))[1].isNegative()?t[0].prev():t[0]},l.prototype.shiftRight=o.prototype.shiftRight=a.prototype.shiftRight,a.prototype.not=function(){return this.negate().prev()},l.prototype.not=o.prototype.not=a.prototype.not,a.prototype.and=function(e){return D(this,e,function(e,t){return e&t})},l.prototype.and=o.prototype.and=a.prototype.and,a.prototype.or=function(e){return D(this,e,function(e,t){return e|t})},l.prototype.or=o.prototype.or=a.prototype.or,a.prototype.xor=function(e){return D(this,e,function(e,t){return e^t})},l.prototype.xor=o.prototype.xor=a.prototype.xor,a.prototype.bitLength=function(){var e=this;return(0>e.compareTo(n(0))&&(e=e.negate().subtract(n(1))),0===e.compareTo(n(0)))?n(0):n(function e(t,r){if(0>=r.compareTo(t)){var i=e(t,r.square(r)),s=i.p,a=i.e,o=s.multiply(r);return 0>=o.compareTo(t)?{p:o,e:2*a+1}:{p:s,e:2*a}}return{p:n(1),e:0}}(e,n(2)).e).add(n(1))},l.prototype.bitLength=o.prototype.bitLength=a.prototype.bitLength;var B=function(e,t,i,n){i=i||r,e=String(e),n||(e=e.toLowerCase(),i=i.toLowerCase());var s,a=e.length,o=Math.abs(t),l={};for(s=0;s<i.length;s++)l[i[s]]=s;for(s=0;s<a;s++){var u=e[s];if("-"!==u&&u in l&&l[u]>=o){if("1"===u&&1===o)continue;throw Error(u+" is not a valid digit in base "+t+".")}}t=W(t);var c=[],h="-"===e[0];for(s=h?1:0;s<e.length;s++){var u=e[s];if(u in l)c.push(W(l[u]));else if("<"===u){var d=s;do s++;while(">"!==e[s]&&s<e.length);c.push(W(e.slice(d+1,s)))}else throw Error(u+" is not a valid character")}return U(c,t,h)};function U(e,t,r){var i,n=s[0],a=s[1];for(i=e.length-1;i>=0;i--)n=n.add(e[i].times(a)),a=a.times(t);return r?n.negate():n}function z(e,t){if((t=n(t)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw Error("Cannot convert nonzero numbers to base 0.")}if(t.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var i=!1;if(e.isNegative()&&t.isPositive()&&(i=!0,e=e.abs()),t.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:i};for(var s,a=[],o=e;o.isNegative()||o.compareAbs(t)>=0;){o=(s=o.divmod(t)).quotient;var l=s.remainder;l.isNegative()&&(l=t.minus(l).abs(),o=o.next()),a.push(l.toJSNumber())}return a.push(o.toJSNumber()),{value:a.reverse(),isNegative:i}}function q(e,t,i){var n=z(e,t);return(n.isNegative?"-":"")+n.value.map(function(e){var t;return e<(t=(t=i)||r).length?t[e]:"<"+e+">"}).join("")}function H(e){if(u(+e)){var t=+e;if(t===f(t))return i?new l(BigInt(t)):new o(t);throw Error("Invalid integer: "+e)}var r="-"===e[0];r&&(e=e.slice(1));var n=e.split(/e/i);if(n.length>2)throw Error("Invalid integer: "+n.join("e"));if(2===n.length){var s=n[1];if("+"===s[0]&&(s=s.slice(1)),(s=+s)!==f(s)||!u(s))throw Error("Invalid integer: "+s+" is not a valid exponent.");var c=n[0],h=c.indexOf(".");if(h>=0&&(s-=c.length-h-1,c=c.slice(0,h)+c.slice(h+1)),s<0)throw Error("Cannot include negative exponent part for integers");c+=Array(s+1).join("0"),e=c}if(!/^([0-9][0-9]*)$/.test(e))throw Error("Invalid integer: "+e);if(i)return new l(BigInt(r?"-"+e:e));for(var p=[],m=e.length,g=m-7;m>0;)p.push(+e.slice(g,m)),(g-=7)<0&&(g=0),m-=7;return d(p),new a(p,r)}function W(e){return"number"==typeof e?function(e){if(i)return new l(BigInt(e));if(u(e)){if(e!==f(e))throw Error(e+" is not an integer.");return new o(e)}return H(e.toString())}(e):"string"==typeof e?H(e):"bigint"==typeof e?new l(e):e}a.prototype.toArray=function(e){return z(this,e)},o.prototype.toArray=function(e){return z(this,e)},l.prototype.toArray=function(e){return z(this,e)},a.prototype.toString=function(t,r){if(e===t&&(t=10),10!==t||r)return q(this,t,r);for(var i,n=this.value,s=n.length,a=String(n[--s]);--s>=0;)i=String(n[s]),a+="0000000".slice(i.length)+i;return(this.sign?"-":"")+a},o.prototype.toString=function(t,r){return(e===t&&(t=10),10!=t||r)?q(this,t,r):String(this.value)},l.prototype.toString=o.prototype.toString,l.prototype.toJSON=a.prototype.toJSON=o.prototype.toJSON=function(){return this.toString()},a.prototype.valueOf=function(){return parseInt(this.toString(),10)},a.prototype.toJSNumber=a.prototype.valueOf,o.prototype.valueOf=function(){return this.value},o.prototype.toJSNumber=o.prototype.valueOf,l.prototype.valueOf=l.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var V=0;V<1e3;V++)s[V]=W(V),V>0&&(s[-V]=W(-V));return s.one=s[1],s.zero=s[0],s.minusOne=s[-1],s.max=$,s.min=F,s.gcd=M,s.lcm=function(e,t){return e=W(e).abs(),t=W(t).abs(),e.divide(M(e,t)).multiply(t)},s.isInstance=function(e){return e instanceof a||e instanceof o||e instanceof l},s.randBetween=function(e,t,r){e=W(e);var i=r||Math.random,n=F(e,t=W(t)),a=$(e,t).subtract(n).add(1);if(a.isSmall)return n.add(Math.floor(i()*a));for(var o=z(a,1e7).value,l=[],u=!0,c=0;c<o.length;c++){var h=u?o[c]+(c+1<o.length?o[c+1]/1e7:0):1e7,d=f(i()*h);l.push(d),d<o[c]&&(u=!1)}return n.add(s.fromArray(l,1e7,!1))},s.fromArray=function(e,t,r){return U(e.map(W),W(t||10),r)},s}();e.hasOwnProperty("exports")&&(e.exports=n),void 0!==(i=(function(){return n}).call(t,r,t,e))&&(e.exports=i)},30086:(e,t,r)=>{var i=r(81172),n=r(94735).EventEmitter,s=r(67653),a=r(53642),o=r(27910).Stream;function l(e){for(var t=0,r=0;r<e.length;r++)t+=Math.pow(256,r)*e[r];return t}function u(e){for(var t=0,r=0;r<e.length;r++)t+=Math.pow(256,e.length-r-1)*e[r];return t}function c(e){var t=u(e);return(128&e[0])==128&&(t-=Math.pow(256,e.length)),t}function h(e){var t=l(e);return(128&e[e.length-1])==128&&(t-=Math.pow(256,e.length)),t}function d(e){var t={};return[1,2,4,8].forEach(function(r){var i=8*r;t["word"+i+"le"]=t["word"+i+"lu"]=e(r,l),t["word"+i+"ls"]=e(r,h),t["word"+i+"be"]=t["word"+i+"bu"]=e(r,u),t["word"+i+"bs"]=e(r,c)}),t.word8=t.word8u=t.word8be,t.word8s=t.word8bs,t}(t=e.exports=function(e,r){if(Buffer.isBuffer(e))return t.parse(e);var i=t.stream();return e&&e.pipe?e.pipe(i):e&&(e.on(r||"data",function(e){i.write(e)}),e.on("end",function(){i.end()})),i}).stream=function(e){if(e)return t.apply(null,arguments);var r=null;function l(e,t,i){r={bytes:e,skip:i,cb:function(e){r=null,t(e)}},c()}var u=null;function c(){if(!r){g&&(m=!0);return}if("function"==typeof r)r();else{var e,t=u+r.bytes;p.length>=t&&(null==u?(e=p.splice(0,t),r.skip||(e=e.slice())):(r.skip||(e=p.slice(u,t)),u=t),r.skip?r.cb():r.cb(e))}}var h=i.light(function(e){function t(){m||e.next()}var i=d(function(e,r){return function(i){l(e,function(e){f.set(i,r(e)),t()})}});return i.tap=function(t){e.nest(t,f.store)},i.into=function(t,r){f.get(t)||f.set(t,{});var i=f;f=a(i.get(t)),e.nest(function(){r.apply(this,arguments),this.tap(function(){f=i})},f.store)},i.flush=function(){f.store={},t()},i.loop=function(r){var i=!1;e.nest(!1,function n(){this.vars=f.store,r.call(this,function(){i=!0,t()},f.store),this.tap((function(){i?e.next():n.call(this)}).bind(this))},f.store)},i.buffer=function(e,r){"string"==typeof r&&(r=f.get(r)),l(r,function(r){f.set(e,r),t()})},i.skip=function(e){"string"==typeof e&&(e=f.get(e)),l(e,function(){t()})},i.scan=function(e,i){if("string"==typeof i)i=new Buffer(i);else if(!Buffer.isBuffer(i))throw Error("search must be a Buffer or a string");var n=0;r=function(){var s=p.indexOf(i,u+n),a=s-u-n;-1!==s?(r=null,null!=u?(f.set(e,p.slice(u,u+n+a)),u+=n+a+i.length):(f.set(e,p.slice(0,n+a)),p.splice(0,n+a+i.length)),t(),c()):a=Math.max(p.length-i.length-u-n,0),n+=a},c()},i.peek=function(t){u=0,e.nest(function(){t.call(this,f.store),this.tap(function(){u=null})})},i});h.writable=!0;var p=s();h.write=function(e){p.push(e),c()};var f=a(),m=!1,g=!1;return h.end=function(){g=!0},h.pipe=o.prototype.pipe,Object.getOwnPropertyNames(n.prototype).forEach(function(e){h[e]=n.prototype[e]}),h},t.parse=function(e){var t=d(function(n,s){return function(a){if(r+n<=e.length){var o=e.slice(r,r+n);r+=n,i.set(a,s(o))}else i.set(a,null);return t}}),r=0,i=a();return t.vars=i.store,t.tap=function(e){return e.call(t,i.store),t},t.into=function(e,r){i.get(e)||i.set(e,{});var n=i;return i=a(n.get(e)),r.call(t,i.store),i=n,t},t.loop=function(e){for(var r=!1,n=function(){r=!0};!1===r;)e.call(t,n,i.store);return t},t.buffer=function(n,s){"string"==typeof s&&(s=i.get(s));var a=e.slice(r,Math.min(e.length,r+s));return r+=s,i.set(n,a),t},t.skip=function(e){return"string"==typeof e&&(e=i.get(e)),r+=e,t},t.scan=function(n,s){if("string"==typeof s)s=new Buffer(s);else if(!Buffer.isBuffer(s))throw Error("search must be a Buffer or a string");i.set(n,null);for(var a=0;a+r<=e.length-s.length+1;a++){for(var o=0;o<s.length&&e[r+a+o]===s[o];o++);if(o===s.length)break}return i.set(n,e.slice(r,r+a)),r+=a+s.length,t},t.peek=function(e){var n=r;return e.call(t,i.store),r=n,t},t.flush=function(){return i.store={},t},t.eof=function(){return r>=e.length},t}},53642:e=>{e.exports=function(e){function t(e,t){var i=r.store,n=e.split(".");n.slice(0,-1).forEach(function(e){void 0===i[e]&&(i[e]={}),i=i[e]});var s=n[n.length-1];return 1==arguments.length?i[s]:i[s]=t}var r={get:function(e){return t(e)},set:function(e,r){return t(e,r)},store:e||{}};return r}},64436:(e,t,r)=>{"use strict";let{Buffer:i}=r(79428),n=Symbol.for("BufferList");function s(e){if(!(this instanceof s))return new s(e);s._init.call(this,e)}s._init=function(e){Object.defineProperty(this,n,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)},s.prototype._new=function(e){return new s(e)},s.prototype._offset=function(e){if(0===e)return[0,0];let t=0;for(let r=0;r<this._bufs.length;r++){let i=t+this._bufs[r].length;if(e<i||r===this._bufs.length-1)return[r,e-t];t=i}},s.prototype._reverseOffset=function(e){let t=e[0],r=e[1];for(let e=0;e<t;e++)r+=this._bufs[e].length;return r},s.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]},s.prototype.slice=function(e,t){return"number"==typeof e&&e<0&&(e+=this.length),"number"==typeof t&&t<0&&(t+=this.length),this.copy(null,0,e,t)},s.prototype.copy=function(e,t,r,n){if(("number"!=typeof r||r<0)&&(r=0),("number"!=typeof n||n>this.length)&&(n=this.length),r>=this.length||n<=0)return e||i.alloc(0);let s=!!e,a=this._offset(r),o=n-r,l=o,u=s&&t||0,c=a[1];if(0===r&&n===this.length){if(!s)return 1===this._bufs.length?this._bufs[0]:i.concat(this._bufs,this.length);for(let t=0;t<this._bufs.length;t++)this._bufs[t].copy(e,u),u+=this._bufs[t].length;return e}if(l<=this._bufs[a[0]].length-c)return s?this._bufs[a[0]].copy(e,t,c,c+l):this._bufs[a[0]].slice(c,c+l);s||(e=i.allocUnsafe(o));for(let t=a[0];t<this._bufs.length;t++){let r=this._bufs[t].length-c;if(l>r)this._bufs[t].copy(e,u,c),u+=r;else{this._bufs[t].copy(e,u,c,c+l),u+=r;break}l-=r,c&&(c=0)}return e.length>u?e.slice(0,u):e},s.prototype.shallowSlice=function(e,t){if(e=e||0,t="number"!=typeof t?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let r=this._offset(e),i=this._offset(t),n=this._bufs.slice(r[0],i[0]+1);return 0===i[1]?n.pop():n[n.length-1]=n[n.length-1].slice(0,i[1]),0!==r[1]&&(n[0]=n[0].slice(r[1])),this._new(n)},s.prototype.toString=function(e,t,r){return this.slice(t,r).toString(e)},s.prototype.consume=function(e){if(Number.isNaN(e=Math.trunc(e))||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this},s.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e},s.prototype.append=function(e){if(null==e)return this;if(e.buffer)this._appendBuffer(i.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else"number"==typeof e&&(e=e.toString()),this._appendBuffer(i.from(e));return this},s.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length},s.prototype.indexOf=function(e,t,r){if(void 0===r&&"string"==typeof t&&(r=t,t=void 0),"function"==typeof e||Array.isArray(e))throw TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"==typeof e?e=i.from([e]):"string"==typeof e?e=i.from(e,r):this._isBufferList(e)?e=e.slice():Array.isArray(e.buffer)?e=i.from(e.buffer,e.byteOffset,e.byteLength):i.isBuffer(e)||(e=i.from(e)),isNaN(t=Number(t||0))&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;let n=this._offset(t),s=n[0],a=n[1];for(;s<this._bufs.length;s++){let t=this._bufs[s];for(;a<t.length;)if(t.length-a>=e.length){let r=t.indexOf(e,a);if(-1!==r)return this._reverseOffset([s,r]);a=t.length-e.length+1}else{let t=this._reverseOffset([s,a]);if(this._match(t,e))return t;a++}a=0}return -1},s.prototype._match=function(e,t){if(this.length-e<t.length)return!1;for(let r=0;r<t.length;r++)if(this.get(e+r)!==t[r])return!1;return!0},function(){let e={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let t in e)!function(t){null===e[t]?s.prototype[t]=function(e,r){return this.slice(e,e+r)[t](0,r)}:s.prototype[t]=function(r=0){return this.slice(r,r+e[t])[t](0)}}(t)}(),s.prototype._isBufferList=function(e){return e instanceof s||s.isBufferList(e)},s.isBufferList=function(e){return null!=e&&e[n]},e.exports=s},42396:(e,t,r)=>{"use strict";let i=r(68280).Duplex,n=r(76225),s=r(64436);function a(e){if(!(this instanceof a))return new a(e);if("function"==typeof e){this._callback=e;let t=(function(e){this._callback&&(this._callback(e),this._callback=null)}).bind(this);this.on("pipe",function(e){e.on("error",t)}),this.on("unpipe",function(e){e.removeListener("error",t)}),e=null}s._init.call(this,e),i.call(this)}n(a,i),Object.assign(a.prototype,s.prototype),a.prototype._new=function(e){return new a(e)},a.prototype._write=function(e,t,r){this._appendBuffer(e),"function"==typeof r&&r()},a.prototype._read=function(e){if(!this.length)return this.push(null);e=Math.min(e,this.length),this.push(this.slice(0,e)),this.consume(e)},a.prototype.end=function(e){i.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},a.prototype._destroy=function(e,t){this._bufs.length=0,this.length=0,t(e)},a.prototype._isBufferList=function(e){return e instanceof a||e instanceof s||a.isBufferList(e)},a.isBufferList=s.isBufferList,e.exports=a,e.exports.BufferListStream=a,e.exports.BufferList=s},44147:e=>{"use strict";e.exports=function(e){var t=e._SomePromiseArray;function r(e){var r=new t(e),i=r.promise();return r.setHowMany(1),r.setUnwrap(),r.init(),i}e.any=function(e){return r(e)},e.prototype.any=function(){return r(this)}}},96661:(e,t,r)=>{"use strict";try{throw Error()}catch(e){i=e}var i,n=r(9848),s=r(67198),a=r(50069);function o(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new s(16),this._normalQueue=new s(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=n}function l(e,t,r){this._lateQueue.push(e,t,r),this._queueTick()}function u(e,t,r){this._normalQueue.push(e,t,r),this._queueTick()}function c(e){this._normalQueue._pushOne(e),this._queueTick()}o.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},o.prototype.hasCustomScheduler=function(){return this._customScheduler},o.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},o.prototype.disableTrampolineIfNecessary=function(){a.hasDevTools&&(this._trampolineEnabled=!1)},o.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},o.prototype.fatalError=function(e,t){t?(process.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),process.exit(2)):this.throwLater(e)},o.prototype.throwLater=function(e,t){if(1==arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(e){throw Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},a.hasDevTools?(o.prototype.invokeLater=function(e,t,r){this._trampolineEnabled?l.call(this,e,t,r):this._schedule(function(){setTimeout(function(){e.call(t,r)},100)})},o.prototype.invoke=function(e,t,r){this._trampolineEnabled?u.call(this,e,t,r):this._schedule(function(){e.call(t,r)})},o.prototype.settlePromises=function(e){this._trampolineEnabled?c.call(this,e):this._schedule(function(){e._settlePromises()})}):(o.prototype.invokeLater=l,o.prototype.invoke=u,o.prototype.settlePromises=c),o.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if("function"!=typeof t){t._settlePromises();continue}var r=e.shift(),i=e.shift();t.call(r,i)}},o.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},o.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},o.prototype._reset=function(){this._isTickUsed=!1},e.exports=o,e.exports.firstLineError=i},15546:e=>{"use strict";e.exports=function(e,t,r,i){var n=!1,s=function(e,t){this._reject(t)},a=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(s,s,null,this,e)},o=function(e,t){(0x3010000&this._bitField)==0&&this._resolveCallback(t.target)},l=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(s){n||(n=!0,e.prototype._propagateFrom=i.propagateFromFunction(),e.prototype._boundValue=i.boundValueFunction());var u=r(s),c=new e(t);c._propagateFrom(this,1);var h=this._target();if(c._setBoundTo(u),u instanceof e){var d={promiseRejectionQueued:!1,promise:c,target:h,bindingPromise:u};h._then(t,a,void 0,c,d),u._then(o,l,void 0,c,d),c._setOnCancel(u)}else c._resolveCallback(h);return c},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return(2097152&this._bitField)==2097152},e.bind=function(t,r){return e.resolve(r).bind(t)}}},72886:(e,t,r)=>{"use strict";"undefined"!=typeof Promise&&(i=Promise);var i,n=r(22628)();n.noConflict=function(){try{Promise===n&&(Promise=i)}catch(e){}return n},e.exports=n},89614:(e,t,r)=>{"use strict";var i=Object.create;if(i){var n=i(null),s=i(null);n[" size"]=s[" size"]=0}e.exports=function(e){var t,i,a=r(50069),o=a.canEvaluate,l=a.isIdentifier,u=function(e){return Function("ensureMethod","                                    \n        return function(obj) {                                               \n            'use strict'                                                     \n            var len = this.length;                                           \n            ensureMethod(obj, 'methodName');                                 \n            switch(len) {                                                    \n                case 1: return obj.methodName(this[0]);                      \n                case 2: return obj.methodName(this[0], this[1]);             \n                case 3: return obj.methodName(this[0], this[1], this[2]);    \n                case 0: return obj.methodName();                             \n                default:                                                     \n                    return obj.methodName.apply(obj, this);                  \n            }                                                                \n        };                                                                   \n        ".replace(/methodName/g,e))(d)},c=function(e){return Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",e))},h=function(e,t,r){var i=r[e];if("function"!=typeof i){if(!l(e))return null;if(i=t(e),r[e]=i,r[" size"]++,r[" size"]>512){for(var n=Object.keys(r),s=0;s<256;++s)delete r[n[s]];r[" size"]=n.length-256}}return i};function d(t,r){var i;if(null!=t&&(i=t[r]),"function"!=typeof i){var n="Object "+a.classString(t)+" has no method '"+a.toString(r)+"'";throw new e.TypeError(n)}return i}function p(e){return d(e,this.pop()).apply(e,this)}function f(e){return e[this]}function m(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}t=function(e){return h(e,u,n)},i=function(e){return h(e,c,s)},e.prototype.call=function(e){for(var r=arguments.length,i=Array(Math.max(r-1,0)),n=1;n<r;++n)i[n-1]=arguments[n];if(o){var s=t(e);if(null!==s)return this._then(s,void 0,void 0,i,void 0)}return i.push(e),this._then(p,void 0,void 0,i,void 0)},e.prototype.get=function(e){var t;if("number"==typeof e)t=m;else if(o){var r=i(e);t=null!==r?r:f}else t=f;return this._then(t,void 0,void 0,e,void 0)}}},39727:(e,t,r)=>{"use strict";e.exports=function(e,t,i,n){var s=r(50069),a=s.tryCatch,o=s.errorObj,l=e._async;e.prototype.break=e.prototype.cancel=function(){if(!n.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var r=e._cancellationParent;if(null!=r&&r._isCancellable())e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=r;else{e._isFollowing()?e._followee().cancel():e._cancelBranched();break}}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),l.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(e,t){if(s.isArray(e))for(var r=0;r<e.length;++r)this._doInvokeOnCancel(e[r],t);else if(void 0!==e){if("function"==typeof e){if(!t){var i=a(e).call(this._boundValue());i===o&&(this._attachExtraTrace(i.e),l.throwLater(i.e))}}else e._resultCancelled(this)}},e.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),l.invoke(this._doInvokeOnCancel,this,e)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},37703:(e,t,r)=>{"use strict";e.exports=function(e){var t=r(50069),i=r(73070).keys,n=t.tryCatch,s=t.errorObj;return function(r,a,o){return function(l){var u=o._boundValue();t:for(var c=0;c<r.length;++c){var h=r[c];if(h===Error||null!=h&&h.prototype instanceof Error){if(l instanceof h)return n(a).call(u,l)}else if("function"==typeof h){var d=n(h).call(u,l);if(d===s)return d;if(d)return n(a).call(u,l)}else if(t.isObject(l)){for(var p=i(h),f=0;f<p.length;++f){var m=p[f];if(h[m]!=l[m])continue t}return n(a).call(u,l)}}return e}}}},64614:e=>{"use strict";e.exports=function(e){var t=!1,r=[];function i(){this._trace=new i.CapturedTrace(n())}function n(){var e=r.length-1;if(e>=0)return r[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},i.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,r.push(this._trace))},i.prototype._popContext=function(){if(void 0!==this._trace){var e=r.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},i.CapturedTrace=null,i.create=function(){if(t)return new i},i.deactivateLongStackTraces=function(){},i.activateLongStackTraces=function(){var r=e.prototype._pushContext,s=e.prototype._popContext,a=e._peekContext,o=e.prototype._peekContext,l=e.prototype._promiseCreated;i.deactivateLongStackTraces=function(){e.prototype._pushContext=r,e.prototype._popContext=s,e._peekContext=a,e.prototype._peekContext=o,e.prototype._promiseCreated=l,t=!1},t=!0,e.prototype._pushContext=i.prototype._pushContext,e.prototype._popContext=i.prototype._popContext,e._peekContext=e.prototype._peekContext=n,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},i}},54035:(e,t,r)=>{"use strict";e.exports=function(e,t){var i,n,s,a=e._getDomain,o=e._async,l=r(82158).Warning,u=r(50069),c=u.canAttachTrace,h=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,d=/\((?:timers\.js):\d+:\d+\)/,p=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,f=null,m=null,g=!1,y=!!(0!=u.env("BLUEBIRD_DEBUG")&&(u.env("BLUEBIRD_DEBUG")||"development"===u.env("NODE_ENV"))),v=!!(0!=u.env("BLUEBIRD_WARNINGS")&&(y||u.env("BLUEBIRD_WARNINGS"))),b=!!(0!=u.env("BLUEBIRD_LONG_STACK_TRACES")&&(y||u.env("BLUEBIRD_LONG_STACK_TRACES"))),w=0!=u.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(v||!!u.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){(524288&this._bitField)==0&&(this._setRejectionIsUnhandled(),o.invokeLater(this._notifyUnhandledRejection,this,void 0))},e.prototype._notifyUnhandledRejectionIsHandled=function(){q("rejectionHandled",i,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=0x10000000|this._bitField},e.prototype._returnedNonUndefined=function(){return(0x10000000&this._bitField)!=0},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),q("unhandledRejection",n,e,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(e,t,r){return M(e,t,r||this)},e.onPossiblyUnhandledRejection=function(e){var t=a();n="function"==typeof e?null===t?e:u.domainBind(t,e):void 0},e.onUnhandledRejectionHandled=function(e){var t=a();i="function"==typeof e?null===t?e:u.domainBind(t,e):void 0};var x=function(){};e.longStackTraces=function(){if(o.haveItemsQueued()&&!Z.longStackTraces)throw Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!Z.longStackTraces&&W()){var r=e.prototype._captureStackTrace,i=e.prototype._attachExtraTrace;Z.longStackTraces=!0,x=function(){if(o.haveItemsQueued()&&!Z.longStackTraces)throw Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=r,e.prototype._attachExtraTrace=i,t.deactivateLongStackTraces(),o.enableTrampoline(),Z.longStackTraces=!1},e.prototype._captureStackTrace=$,e.prototype._attachExtraTrace=F,t.activateLongStackTraces(),o.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return Z.longStackTraces&&W()};var S=function(){try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return u.global.dispatchEvent(e),function(e,t){var r=new CustomEvent(e.toLowerCase(),{detail:t,cancelable:!0});return!u.global.dispatchEvent(r)}}if("function"==typeof Event){var e=new Event("CustomEvent");return u.global.dispatchEvent(e),function(e,t){var r=new Event(e.toLowerCase(),{cancelable:!0});return r.detail=t,!u.global.dispatchEvent(r)}}var e=document.createEvent("CustomEvent");return e.initCustomEvent("testingtheevent",!1,!0,{}),u.global.dispatchEvent(e),function(e,t){var r=document.createEvent("CustomEvent");return r.initCustomEvent(e.toLowerCase(),!1,!0,t),!u.global.dispatchEvent(r)}}catch(e){}return function(){return!1}}(),E=u.isNode?function(){return process.emit.apply(process,arguments)}:u.global?function(e){var t="on"+e.toLowerCase(),r=u.global[t];return!!r&&(r.apply(u.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function T(e,t){return{promise:t}}var k={promiseCreated:T,promiseFulfilled:T,promiseRejected:T,promiseResolved:T,promiseCancelled:T,promiseChained:function(e,t,r){return{promise:t,child:r}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,r){return{reason:t,promise:r}},rejectionHandled:T},O=function(e){var t=!1;try{t=E.apply(null,arguments)}catch(e){o.throwLater(e),t=!0}var r=!1;try{r=S(e,k[e].apply(null,arguments))}catch(e){o.throwLater(e),r=!0}return r||t};function C(){return!1}function A(e,t,r){var i=this;try{e(t,r,function(e){if("function"!=typeof e)throw TypeError("onCancel must be a function, got: "+u.toString(e));i._attachCancellationCallback(e)})}catch(e){return e}}function N(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?u.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function R(){return this._onCancelField}function I(e){this._onCancelField=e}function P(){this._cancellationParent=void 0,this._onCancelField=void 0}function j(e,t){if((1&t)!=0){this._cancellationParent=e;var r=e._branchesRemainingToCancel;void 0===r&&(r=0),e._branchesRemainingToCancel=r+1}(2&t)!=0&&e._isBound()&&this._setBoundTo(e._boundTo)}e.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&x()),"warnings"in t){var r=t.warnings;Z.warnings=!!r,w=Z.warnings,u.isObject(r)&&"wForgottenReturn"in r&&(w=!!r.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!Z.cancellation){if(o.haveItemsQueued())throw Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=P,e.prototype._propagateFrom=j,e.prototype._onCancel=R,e.prototype._setOnCancel=I,e.prototype._attachCancellationCallback=N,e.prototype._execute=A,D=j,Z.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!Z.monitoring?(Z.monitoring=!0,e.prototype._fireEvent=O):!t.monitoring&&Z.monitoring&&(Z.monitoring=!1,e.prototype._fireEvent=C)),e},e.prototype._fireEvent=C,e.prototype._execute=function(e,t,r){try{e(t,r)}catch(e){return e}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(e){},e.prototype._attachCancellationCallback=function(e){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(e,t){};var D=function(e,t){(2&t)!=0&&e._isBound()&&this._setBoundTo(e._boundTo)};function L(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function $(){this._trace=new J(this._peekContext())}function F(e,t){if(c(e)){var r=this._trace;if(void 0!==r&&t&&(r=r._parent),void 0!==r)r.attachExtraTrace(e);else if(!e.__stackCleaned__){var i=U(e);u.notEnumerableProp(e,"stack",i.message+"\n"+i.stack.join("\n")),u.notEnumerableProp(e,"__stackCleaned__",!0)}}}function M(t,r,i){if(Z.warnings){var n,s=new l(t);if(r)i._attachExtraTrace(s);else if(Z.longStackTraces&&(n=e._peekContext()))n.attachExtraTrace(s);else{var a=U(s);s.stack=a.message+"\n"+a.stack.join("\n")}O("warning",s)||z(s,"",!0)}}function B(e){for(var t=[],r=0;r<e.length;++r){var i=e[r],n="    (No stack trace)"===i||f.test(i),s=n&&V(i);n&&!s&&(g&&" "!==i.charAt(0)&&(i="    "+i),t.push(i))}return t}function U(e){var t=e.stack,r=e.toString();return t="string"==typeof t&&t.length>0?function(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),r=0;r<t.length;++r){var i=t[r];if("    (No stack trace)"===i||f.test(i))break}return r>0&&"SyntaxError"!=e.name&&(t=t.slice(r)),t}(e):["    (No stack trace)"],{message:r,stack:"SyntaxError"==e.name?t:B(t)}}function z(e,t,r){if("undefined"!=typeof console){var i;if(u.isObject(e)){var n=e.stack;i=t+m(n,e)}else i=t+String(e);"function"==typeof s?s(i,r):("function"==typeof console.log||"object"==typeof console.log)&&console.log(i)}}function q(e,t,r,i){var n=!1;try{"function"==typeof t&&(n=!0,"rejectionHandled"===e?t(i):t(r,i))}catch(e){o.throwLater(e)}"unhandledRejection"===e?O(e,r,i)||n||z(r,"Unhandled rejection "):O(e,i)}function H(e){var t,r;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{if(t=e&&"function"==typeof e.toString?e.toString():u.toString(e),/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+((r=t).length<41?r:r.substr(0,38)+"...")+">, no stack trace)"}function W(){return"function"==typeof Q}var V=function(){return!1},G=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function K(e){var t=e.match(G);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function J(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);Q(this,J),t>32&&this.uncycle()}u.inherits(J,Error),t.CapturedTrace=J,J.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],r={},i=0,n=this;void 0!==n;++i)t.push(n),n=n._parent;e=this._length=i;for(var i=e-1;i>=0;--i){var s=t[i].stack;void 0===r[s]&&(r[s]=i)}for(var i=0;i<e;++i){var a=r[t[i].stack];if(void 0!==a&&a!==i){a>0&&(t[a-1]._parent=void 0,t[a-1]._length=1),t[i]._parent=void 0,t[i]._length=1;var o=i>0?t[i-1]:this;a<e-1?(o._parent=t[a+1],o._parent.uncycle(),o._length=o._parent._length+1):(o._parent=void 0,o._length=1);for(var l=o._length+1,u=i-2;u>=0;--u)t[u]._length=l,l++;return}}}},J.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=U(e),r=t.message,i=[t.stack],n=this;void 0!==n;)i.push(B(n.stack.split("\n"))),n=n._parent;(function(e){for(var t=e[0],r=1;r<e.length;++r){for(var i=e[r],n=t.length-1,s=t[n],a=-1,o=i.length-1;o>=0;--o)if(i[o]===s){a=o;break}for(var o=a;o>=0;--o){var l=i[o];if(t[n]===l)t.pop(),n--;else break}t=i}})(i),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(i),u.notEnumerableProp(e,"stack",function(e,t){for(var r=0;r<t.length-1;++r)t[r].push("From previous event:"),t[r]=t[r].join("\n");return r<t.length&&(t[r]=t[r].join("\n")),e+"\n"+t.join("\n")}(r,i)),u.notEnumerableProp(e,"__stackCleaned__",!0)}};var Q=function(){var e,t=/^\s*at\s*/,r=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():H(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,f=t,m=r;var i=Error.captureStackTrace;return V=function(e){return h.test(e)},function(e,t){Error.stackTraceLimit+=6,i(e,t),Error.stackTraceLimit-=6}}var n=Error();if("string"==typeof n.stack&&n.stack.split("\n")[0].indexOf("stackDetection@")>=0)return f=/@/,m=r,g=!0,function(e){e.stack=Error().stack};try{throw Error()}catch(t){e="stack"in t}return"stack"in n||!e||"number"!=typeof Error.stackTraceLimit?(m=function(e,t){return"string"==typeof e?e:("object"==typeof t||"function"==typeof t)&&void 0!==t.name&&void 0!==t.message?t.toString():H(t)},null):(f=t,m=r,function(e){Error.stackTraceLimit+=6;try{throw Error()}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}([]);"undefined"==typeof console||void 0===console.warn||(s=function(e){console.warn(e)},u.isNode&&process.stderr.isTTY?s=function(e,t){console.warn((t?"\x1b[33m":"\x1b[31m")+e+"\x1b[0m\n")}:u.isNode||"string"!=typeof Error().stack||(s=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var Z={warnings:v,longStackTraces:!1,cancellation:!1,monitoring:!1};return b&&e.longStackTraces(),{longStackTraces:function(){return Z.longStackTraces},warnings:function(){return Z.warnings},cancellation:function(){return Z.cancellation},monitoring:function(){return Z.monitoring},propagateFromFunction:function(){return D},boundValueFunction:function(){return L},checkForgottenReturns:function(e,t,r,i,n){if(void 0===e&&null!==t&&w&&!(void 0!==n&&n._returnedNonUndefined())&&(65535&i._bitField)!=0){r&&(r+=" ");var s="",a="";if(t._trace){for(var o=t._trace.stack.split("\n"),l=B(o),u=l.length-1;u>=0;--u){var c=l[u];if(!d.test(c)){var h=c.match(p);h&&(s="at "+h[1]+":"+h[2]+":"+h[3]+" ");break}}if(l.length>0){for(var f=l[0],u=0;u<o.length;++u)if(o[u]===f){u>0&&(a="\n"+o[u-1]);break}}}var m="a promise was created in a "+r+"handler "+s+"but was not returned from it, see http://goo.gl/rRqMUw"+a;i._warn(m,!0,t)}},setBounds:function(e,t){if(W()){for(var r,i,n=e.stack.split("\n"),s=t.stack.split("\n"),a=-1,o=-1,l=0;l<n.length;++l){var u=K(n[l]);if(u){r=u.fileName,a=u.line;break}}for(var l=0;l<s.length;++l){var u=K(s[l]);if(u){i=u.fileName,o=u.line;break}}a<0||o<0||!r||!i||r!==i||a>=o||(V=function(e){if(h.test(e))return!0;var t=K(e);return!!t&&t.fileName===r&&a<=t.line&&t.line<=o})}},warn:M,deprecated:function(e,t){var r=e+" is deprecated and will be removed in a future version.";return t&&(r+=" Use "+t+" instead."),M(r)},CapturedTrace:J,fireDomEvent:S,fireGlobalEvent:E}}},5919:e=>{"use strict";e.exports=function(e){function t(){return this.value}function r(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(r){return r instanceof e&&r.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:r},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(r,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:e},void 0);var t=arguments[1];return this.caught(e,function(){throw t})},e.prototype.catchReturn=function(r){if(arguments.length<=1)return r instanceof e&&r.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:r},void 0);var i=arguments[1];return i instanceof e&&i.suppressUnhandledRejections(),this.caught(r,function(){return i})}}},63712:e=>{"use strict";e.exports=function(e,t){var r=e.reduce,i=e.all;function n(){return i(this)}e.prototype.each=function(e){return r(this,e,t,0)._then(n,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return r(this,e,t,t)},e.each=function(e,i){return r(e,i,t,0)._then(n,void 0,void 0,e,void 0)},e.mapSeries=function(e,i){return r(e,i,t,t)}}},82158:(e,t,r)=>{"use strict";var i,n,s=r(73070),a=s.freeze,o=r(50069),l=o.inherits,u=o.notEnumerableProp;function c(e,t){function r(i){if(!(this instanceof r))return new r(i);u(this,"message","string"==typeof i?i:t),u(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return l(r,Error),r}var h=c("Warning","warning"),d=c("CancellationError","cancellation error"),p=c("TimeoutError","timeout error"),f=c("AggregateError","aggregate error");try{i=TypeError,n=RangeError}catch(e){i=c("TypeError","type error"),n=c("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),g=0;g<m.length;++g)"function"==typeof Array.prototype[m[g]]&&(f.prototype[m[g]]=Array.prototype[m[g]]);s.defineProperty(f.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),f.prototype.isOperational=!0;var y=0;function v(e){if(!(this instanceof v))return new v(e);u(this,"name","OperationalError"),u(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(u(this,"message",e.message),u(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}f.prototype.toString=function(){var e=Array(4*y+1).join(" "),t="\n"+e+"AggregateError of:\n";e=Array(4*++y+1).join(" ");for(var r=0;r<this.length;++r){for(var i=this[r]===this?"[Circular AggregateError]":this[r]+"",n=i.split("\n"),s=0;s<n.length;++s)n[s]=e+n[s];t+=(i=n.join("\n"))+"\n"}return y--,t},l(v,Error);var b=Error.__BluebirdErrorTypes__;b||(b=a({CancellationError:d,TimeoutError:p,OperationalError:v,RejectionError:v,AggregateError:f}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:i,RangeError:n,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:h}},73070:e=>{var t=function(){return void 0===this}();if(t)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:t,propertyIsWritable:function(e,t){var r=Object.getOwnPropertyDescriptor(e,t);return!!(!r||r.writable||r.set)}};else{var r={}.hasOwnProperty,i={}.toString,n={}.constructor.prototype,s=function(e){var t=[];for(var i in e)r.call(e,i)&&t.push(i);return t};e.exports={isArray:function(e){try{return"[object Array]"===i.call(e)}catch(e){return!1}},keys:s,names:s,defineProperty:function(e,t,r){return e[t]=r.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(e){return n}},isES5:t,propertyIsWritable:function(){return!0}}}},64299:e=>{"use strict";e.exports=function(e,t){var r=e.map;e.prototype.filter=function(e,i){return r(this,e,i,t)},e.filter=function(e,i,n){return r(e,i,n,t)}}},45238:(e,t,r)=>{"use strict";e.exports=function(e,t){var i=r(50069),n=e.CancellationError,s=i.errorObj;function a(e,t,r){this.promise=e,this.type=t,this.handler=r,this.called=!1,this.cancelPromise=null}function o(e){this.finallyHandler=e}function l(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function u(){return h.call(this,this.promise._target()._settledValue())}function c(e){if(!l(this,e))return s.e=e,s}function h(r){var i=this.promise,a=this.handler;if(!this.called){this.called=!0;var h=this.isFinallyHandler()?a.call(i._boundValue()):a.call(i._boundValue(),r);if(void 0!==h){i._setReturnedNonUndefined();var d=t(h,i);if(d instanceof e){if(null!=this.cancelPromise){if(d._isCancelled()){var p=new n("late cancellation observer");return i._attachExtraTrace(p),s.e=p,s}d.isPending()&&d._attachCancellationCallback(new o(this))}return d._then(u,c,void 0,this,void 0)}}}return i.isRejected()?(l(this),s.e=r,s):(l(this),r)}return a.prototype.isFinallyHandler=function(){return 0===this.type},o.prototype._resultCancelled=function(){l(this.finallyHandler)},e.prototype._passThrough=function(e,t,r,i){return"function"!=typeof e?this.then():this._then(r,i,void 0,new a(this,t,e),void 0)},e.prototype.lastly=e.prototype.finally=function(e){return this._passThrough(e,0,h,h)},e.prototype.tap=function(e){return this._passThrough(e,1,h)},a}},23107:(e,t,r)=>{"use strict";e.exports=function(e,t,i,n,s,a){var o=r(82158).TypeError,l=r(50069),u=l.errorObj,c=l.tryCatch,h=[];function d(t,r,n,s){if(a.cancellation()){var o=new e(i),l=this._finallyPromise=new e(i);this._promise=o.lastly(function(){return l}),o._captureStackTrace(),o._setOnCancel(this)}else(this._promise=new e(i))._captureStackTrace();this._stack=s,this._generatorFunction=t,this._receiver=r,this._generator=void 0,this._yieldHandlers="function"==typeof n?[n].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}l.inherits(d,s),d.prototype._isResolved=function(){return null===this._promise},d.prototype._cleanup=function(){this._promise=this._generator=null,a.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},d.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=c(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var r=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),t=c(this._generator.throw).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},d.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=c(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=c(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},d.prototype.promise=function(){return this._promise},d.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},d.prototype._continue=function(t){var r=this._promise;if(t===u)return(this._cleanup(),this._cancellationPhase)?r.cancel():r._rejectCallback(t.e,!1);var i=t.value;if(!0===t.done)return(this._cleanup(),this._cancellationPhase)?r.cancel():r._resolveCallback(i);var s=n(i,this._promise);if(!(s instanceof e)&&null===(s=function(t,r,i){for(var s=0;s<r.length;++s){i._pushContext();var a=c(r[s])(t);if(i._popContext(),a===u){i._pushContext();var o=e.reject(u.e);return i._popContext(),o}var l=n(a,i);if(l instanceof e)return l}return null}(s,this._yieldHandlers,this._promise))){this._promiseRejected(new o("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",i)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));return}var a=(s=s._target())._bitField;(0x3010000&a)==0?(this._yieldedPromise=s,s._proxy(this,null)):(0x2000000&a)!=0?e._async.invoke(this._promiseFulfilled,this,s._value()):(0x1000000&a)!=0?e._async.invoke(this._promiseRejected,this,s._reason()):this._promiseCancelled()},e.coroutine=function(e,t){if("function"!=typeof e)throw new o("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=Object(t).yieldHandler,i=Error().stack;return function(){var t=e.apply(this,arguments),n=new d(void 0,void 0,r,i),s=n.promise();return n._generator=t,n._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new o("expecting a function but got "+l.classString(e));h.push(e)},e.spawn=function(r){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof r)return t("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var i=new d(r,this),n=i.promise();return i._run(e.spawn),n}}},45901:(e,t,r)=>{"use strict";e.exports=function(e,t,i,n,s,a){var o,l=r(50069),u=l.canEvaluate,c=l.tryCatch,h=l.errorObj;if(u){for(var d,p,f=[],m=[],g=[],y=0;y<8;++y)f.push(function(t){for(var r=Array(t),i=0;i<r.length;++i)r[i]="this.p"+(i+1);var n=r.join(" = ")+" = null;",a="var promise;\n"+r.map(function(e){return"                                                         \n                promise = "+e+";                                      \n                if (promise instanceof Promise) {                            \n                    promise.cancel();                                        \n                }                                                            \n            "}).join("\n"),o=r.join(", "),l="Holder$"+t,u="return function(tryCatch, errorObj, Promise, async) {    \n            'use strict';                                                    \n            function [TheName](fn) {                                         \n                [TheProperties]                                              \n                this.fn = fn;                                                \n                this.asyncNeeded = true;                                     \n                this.now = 0;                                                \n            }                                                                \n                                                                             \n            [TheName].prototype._callFunction = function(promise) {          \n                promise._pushContext();                                      \n                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n                promise._popContext();                                       \n                if (ret === errorObj) {                                      \n                    promise._rejectCallback(ret.e, false);                   \n                } else {                                                     \n                    promise._resolveCallback(ret);                           \n                }                                                            \n            };                                                               \n                                                                             \n            [TheName].prototype.checkFulfillment = function(promise) {       \n                var now = ++this.now;                                        \n                if (now === [TheTotal]) {                                    \n                    if (this.asyncNeeded) {                                  \n                        async.invoke(this._callFunction, this, promise);     \n                    } else {                                                 \n                        this._callFunction(promise);                         \n                    }                                                        \n                                                                             \n                }                                                            \n            };                                                               \n                                                                             \n            [TheName].prototype._resultCancelled = function() {              \n                [CancellationCode]                                           \n            };                                                               \n                                                                             \n            return [TheName];                                                \n        }(tryCatch, errorObj, Promise, async);                               \n        ";return Function("tryCatch","errorObj","Promise","async",u=u.replace(/\[TheName\]/g,l).replace(/\[TheTotal\]/g,t).replace(/\[ThePassedArguments\]/g,o).replace(/\[TheProperties\]/g,n).replace(/\[CancellationCode\]/g,a))(c,h,e,s)}(y+1)),m.push((d=y+1,Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,d)))),g.push((p=y+1,Function("promise","holder","                           \n            'use strict';                                                    \n            holder.pIndex = promise;                                         \n            ".replace(/Index/g,p))));o=function(e){this._reject(e)}}e.join=function(){var r,s=arguments.length-1;if(s>0&&"function"==typeof arguments[s]&&(r=arguments[s],s<=8&&u)){var c=new e(n);c._captureStackTrace();for(var h=new f[s-1](r),d=m,p=0;p<s;++p){var y=i(arguments[p],c);if(y instanceof e){var v=(y=y._target())._bitField;(0x3010000&v)==0?(y._then(d[p],o,void 0,c,h),g[p](y,h),h.asyncNeeded=!1):(0x2000000&v)!=0?d[p].call(c,y._value(),h):(0x1000000&v)!=0?c._reject(y._reason()):c._cancel()}else d[p].call(c,y,h)}if(!c._isFateSealed()){if(h.asyncNeeded){var b=a();null!==b&&(h.fn=l.domainBind(b,h.fn))}c._setAsyncGuaranteed(),c._setOnCancel(h)}return c}for(var w=arguments.length,x=Array(w),S=0;S<w;++S)x[S]=arguments[S];r&&x.pop();var c=new t(x).promise();return void 0!==r?c.spread(r):c}}},90811:(e,t,r)=>{"use strict";e.exports=function(e,t,i,n,s,a){var o=e._getDomain,l=r(50069),u=l.tryCatch,c=l.errorObj,h=e._async;function d(e,t,r,i){this.constructor$(e),this._promise._captureStackTrace();var n=o();this._callback=null===n?t:l.domainBind(n,t),this._preservedValues=i===s?Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=[],h.invoke(this._asyncInit,this,void 0)}function p(t,r,n,s){if("function"!=typeof r)return i("expecting a function but got "+l.classString(r));var a=0;if(void 0!==n){if("object"!=typeof n||null===n)return e.reject(TypeError("options argument must be an object but it is "+l.classString(n)));if("number"!=typeof n.concurrency)return e.reject(TypeError("'concurrency' must be a number but it is "+l.classString(n.concurrency)));a=n.concurrency}return new d(t,r,a="number"==typeof a&&isFinite(a)&&a>=1?a:0,s).promise()}l.inherits(d,t),d.prototype._asyncInit=function(){this._init$(void 0,-2)},d.prototype._init=function(){},d.prototype._promiseFulfilled=function(t,r){var i=this._values,s=this.length(),o=this._preservedValues,l=this._limit;if(r<0){if(i[r=-1*r-1]=t,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return i[r]=t,this._queue.push(r),!1;null!==o&&(o[r]=t);var h=this._promise,d=this._callback,p=h._boundValue();h._pushContext();var f=u(d).call(p,t,r,s),m=h._popContext();if(a.checkForgottenReturns(f,m,null!==o?"Promise.filter":"Promise.map",h),f===c)return this._reject(f.e),!0;var g=n(f,this._promise);if(g instanceof e){var y=(g=g._target())._bitField;if((0x3010000&y)==0)return l>=1&&this._inFlight++,i[r]=g,g._proxy(this,-((r+1)*1)),!1;if((0x2000000&y)!=0)f=g._value();else if((0x1000000&y)!=0)return this._reject(g._reason()),!0;else return this._cancel(),!0}i[r]=f}return++this._totalResolved>=s&&(null!==o?this._filter(i,o):this._resolve(i),!0)},d.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,r=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var i=e.pop();this._promiseFulfilled(r[i],i)}},d.prototype._filter=function(e,t){for(var r=t.length,i=Array(r),n=0,s=0;s<r;++s)e[s]&&(i[n++]=t[s]);i.length=n,this._resolve(i)},d.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(e,t){return p(this,e,t,null)},e.map=function(e,t,r,i){return p(e,t,r,i)}}},31792:(e,t,r)=>{"use strict";e.exports=function(e,t,i,n,s){var a=r(50069),o=a.tryCatch;e.method=function(r){if("function"!=typeof r)throw new e.TypeError("expecting a function but got "+a.classString(r));return function(){var i=new e(t);i._captureStackTrace(),i._pushContext();var n=o(r).apply(this,arguments),a=i._popContext();return s.checkForgottenReturns(n,a,"Promise.method",i),i._resolveFromSyncValue(n),i}},e.attempt=e.try=function(r){if("function"!=typeof r)return n("expecting a function but got "+a.classString(r));var i,l=new e(t);if(l._captureStackTrace(),l._pushContext(),arguments.length>1){s.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],c=arguments[2];i=a.isArray(u)?o(r).apply(c,u):o(r).call(c,u)}else i=o(r)();var h=l._popContext();return s.checkForgottenReturns(i,h,"Promise.try",l),l._resolveFromSyncValue(i),l},e.prototype._resolveFromSyncValue=function(e){e===a.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},28806:(e,t,r)=>{"use strict";var i=r(50069),n=i.maybeWrapAsError,s=r(82158).OperationalError,a=r(73070),o=/^(?:name|message|stack|cause)$/;e.exports=function(e,t){return function(r,l){if(null!==e){if(r){var u=function(e){if(e instanceof Error&&a.getPrototypeOf(e)===Error.prototype){(t=new s(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var t,r=a.keys(e),n=0;n<r.length;++n){var l=r[n];o.test(l)||(t[l]=e[l])}return t}return i.markAsOriginatingFromRejection(e),e}(n(r));e._attachExtraTrace(u),e._reject(u)}else if(t){for(var c=arguments.length,h=Array(Math.max(c-1,0)),d=1;d<c;++d)h[d-1]=arguments[d];e._fulfill(h)}else e._fulfill(l);e=null}}}},81855:(e,t,r)=>{"use strict";e.exports=function(e){var t=r(50069),i=e._async,n=t.tryCatch,s=t.errorObj;function a(e,r){if(!t.isArray(e))return o.call(this,e,r);var a=n(r).apply(this._boundValue(),[null].concat(e));a===s&&i.throwLater(a.e)}function o(e,t){var r=this._boundValue(),a=void 0===e?n(t).call(r,null):n(t).call(r,null,e);a===s&&i.throwLater(a.e)}function l(e,t){if(!e){var r=Error(e+"");r.cause=e,e=r}var a=n(t).call(this._boundValue(),e);a===s&&i.throwLater(a.e)}e.prototype.asCallback=e.prototype.nodeify=function(e,t){if("function"==typeof e){var r=o;void 0!==t&&Object(t).spread&&(r=a),this._then(r,l,void 0,this,e)}return this}}},22628:(e,t,r)=>{"use strict";e.exports=function(){var t,i=function(){return new p("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},n=function(){return new A.PromiseInspection(this._target())},s=function(e){return A.reject(new p(e))};function a(){}var o={},l=r(50069);t=l.isNode?function(){var e=process.domain;return void 0===e&&(e=null),e}:function(){return null},l.notEnumerableProp(A,"_getDomain",t);var u=r(73070),c=r(96661),h=new c;u.defineProperty(A,"_async",{value:h});var d=r(82158),p=A.TypeError=d.TypeError;A.RangeError=d.RangeError;var f=A.CancellationError=d.CancellationError;A.TimeoutError=d.TimeoutError,A.OperationalError=d.OperationalError,A.RejectionError=d.OperationalError,A.AggregateError=d.AggregateError;var m=function(){},g={},y={},v=r(80569)(A,m),b=r(23570)(A,m,v,s,a),w=r(64614)(A),x=w.create,S=r(54035)(A,w);S.CapturedTrace;var E=r(45238)(A,v),T=r(37703)(y),k=r(28806),O=l.errorObj,C=l.tryCatch;function A(e){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,e!==m&&(function(e,t){if("function"!=typeof t)throw new p("expecting a function but got "+l.classString(t));if(e.constructor!==A)throw new p("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n")}(this,e),this._resolveFromExecutor(e)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function N(e){this.promise._resolveCallback(e)}function R(e){this.promise._rejectCallback(e,!1)}function I(e){var t=new A(m);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return A.prototype.toString=function(){return"[object Promise]"},A.prototype.caught=A.prototype.catch=function(e){var t=arguments.length;if(t>1){var r,i=Array(t-1),n=0;for(r=0;r<t-1;++r){var a=arguments[r];if(!l.isObject(a))return s("expecting an object but got A catch statement predicate "+l.classString(a));i[n++]=a}return i.length=n,e=arguments[r],this.then(void 0,T(i,e,this))}return this.then(void 0,e)},A.prototype.reflect=function(){return this._then(n,n,void 0,this,void 0)},A.prototype.then=function(e,t){if(S.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var r=".then() only accepts functions but was passed: "+l.classString(e);arguments.length>1&&(r+=", "+l.classString(t)),this._warn(r)}return this._then(e,t,void 0,void 0,void 0)},A.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},A.prototype.spread=function(e){return"function"!=typeof e?s("expecting a function but got "+l.classString(e)):this.all()._then(e,void 0,void 0,g,void 0)},A.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},A.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new b(this).promise()},A.prototype.error=function(e){return this.caught(l.originatesFromRejection,e)},A.getNewLibraryCopy=e.exports,A.is=function(e){return e instanceof A},A.fromNode=A.fromCallback=function(e){var t=new A(m);t._captureStackTrace();var r=arguments.length>1&&!!Object(arguments[1]).multiArgs,i=C(e)(k(t,r));return i===O&&t._rejectCallback(i.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},A.all=function(e){return new b(e).promise()},A.cast=function(e){var t=v(e);return t instanceof A||((t=new A(m))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},A.resolve=A.fulfilled=A.cast,A.reject=A.rejected=function(e){var t=new A(m);return t._captureStackTrace(),t._rejectCallback(e,!0),t},A.setScheduler=function(e){if("function"!=typeof e)throw new p("expecting a function but got "+l.classString(e));return h.setScheduler(e)},A.prototype._then=function(e,r,i,n,s){var a=void 0!==s,o=a?s:new A(m),u=this._target(),c=u._bitField;a||(o._propagateFrom(this,3),o._captureStackTrace(),void 0===n&&(2097152&this._bitField)!=0&&(n=(0x3010000&c)!=0?this._boundValue():u===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,o));var d=t();if((0x3010000&c)!=0){var p,g,y=u._settlePromiseCtx;(0x2000000&c)!=0?(g=u._rejectionHandler0,p=e):(0x1000000&c)!=0?(g=u._fulfillmentHandler0,p=r,u._unsetRejectionIsUnhandled()):(y=u._settlePromiseLateCancellationObserver,g=new f("late cancellation observer"),u._attachExtraTrace(g),p=r),h.invoke(y,u,{handler:null===d?p:"function"==typeof p&&l.domainBind(d,p),promise:o,receiver:n,value:g})}else u._addCallbacks(e,r,o,n,d);return o},A.prototype._length=function(){return 65535&this._bitField},A.prototype._isFateSealed=function(){return(0x7010000&this._bitField)!=0},A.prototype._isFollowing=function(){return(0x4000000&this._bitField)==0x4000000},A.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},A.prototype._setFulfilled=function(){this._bitField=0x2000000|this._bitField,this._fireEvent("promiseFulfilled",this)},A.prototype._setRejected=function(){this._bitField=0x1000000|this._bitField,this._fireEvent("promiseRejected",this)},A.prototype._setFollowing=function(){this._bitField=0x4000000|this._bitField,this._fireEvent("promiseResolved",this)},A.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},A.prototype._isFinal=function(){return(4194304&this._bitField)>0},A.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},A.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},A.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},A.prototype._setAsyncGuaranteed=function(){h.hasCustomScheduler()||(this._bitField=0x8000000|this._bitField)},A.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];return t===o?void 0:void 0===t&&this._isBound()?this._boundValue():t},A.prototype._promiseAt=function(e){return this[4*e-4+2]},A.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},A.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},A.prototype._boundValue=function(){},A.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,r=e._rejectionHandler0,i=e._promise0,n=e._receiverAt(0);void 0===n&&(n=o),this._addCallbacks(t,r,i,n,null)},A.prototype._migrateCallbackAt=function(e,t){var r=e._fulfillmentHandlerAt(t),i=e._rejectionHandlerAt(t),n=e._promiseAt(t),s=e._receiverAt(t);void 0===s&&(s=o),this._addCallbacks(r,i,n,s,null)},A.prototype._addCallbacks=function(e,t,r,i,n){var s=this._length();if(s>=65531&&(s=0,this._setLength(0)),0===s)this._promise0=r,this._receiver0=i,"function"==typeof e&&(this._fulfillmentHandler0=null===n?e:l.domainBind(n,e)),"function"==typeof t&&(this._rejectionHandler0=null===n?t:l.domainBind(n,t));else{var a=4*s-4;this[a+2]=r,this[a+3]=i,"function"==typeof e&&(this[a+0]=null===n?e:l.domainBind(n,e)),"function"==typeof t&&(this[a+1]=null===n?t:l.domainBind(n,t))}return this._setLength(s+1),s},A.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},A.prototype._resolveCallback=function(e,t){if((0x7010000&this._bitField)==0){if(e===this)return this._rejectCallback(i(),!1);var r=v(e,this);if(!(r instanceof A))return this._fulfill(e);t&&this._propagateFrom(r,2);var n=r._target();if(n===this){this._reject(i());return}var s=n._bitField;if((0x3010000&s)==0){var a=this._length();a>0&&n._migrateCallback0(this);for(var o=1;o<a;++o)n._migrateCallbackAt(this,o);this._setFollowing(),this._setLength(0),this._setFollowee(n)}else if((0x2000000&s)!=0)this._fulfill(n._value());else if((0x1000000&s)!=0)this._reject(n._reason());else{var l=new f("late cancellation observer");n._attachExtraTrace(l),this._reject(l)}}},A.prototype._rejectCallback=function(e,t,r){var i=l.ensureErrorObject(e),n=i===e;if(!n&&!r&&S.warnings()){var s="a promise was rejected with a non-error: "+l.classString(e);this._warn(s,!0)}this._attachExtraTrace(i,!!t&&n),this._reject(e)},A.prototype._resolveFromExecutor=function(e){var t=this;this._captureStackTrace(),this._pushContext();var r=!0,i=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,r)});r=!1,this._popContext(),void 0!==i&&t._rejectCallback(i,!0)},A.prototype._settlePromiseFromHandler=function(e,t,r,i){var n,s=i._bitField;if((65536&s)==0){i._pushContext(),t===g?r&&"number"==typeof r.length?n=C(e).apply(this._boundValue(),r):(n=O).e=new p("cannot .spread() a non-array: "+l.classString(r)):n=C(e).call(t,r);var a=i._popContext();(65536&(s=i._bitField))==0&&(n===y?i._reject(r):n===O?i._rejectCallback(n.e,!1):(S.checkForgottenReturns(n,a,"",i,this),i._resolveCallback(n)))}},A.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},A.prototype._followee=function(){return this._rejectionHandler0},A.prototype._setFollowee=function(e){this._rejectionHandler0=e},A.prototype._settlePromise=function(e,t,r,i){var s=e instanceof A,o=this._bitField,l=(0x8000000&o)!=0;(65536&o)!=0?(s&&e._invokeInternalOnCancel(),r instanceof E&&r.isFinallyHandler()?(r.cancelPromise=e,C(t).call(r,i)===O&&e._reject(O.e)):t===n?e._fulfill(n.call(r)):r instanceof a?r._promiseCancelled(e):s||e instanceof b?e._cancel():r.cancel()):"function"==typeof t?s?(l&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,r,i,e)):t.call(r,i,e):r instanceof a?r._isResolved()||((0x2000000&o)!=0?r._promiseFulfilled(i,e):r._promiseRejected(i,e)):s&&(l&&e._setAsyncGuaranteed(),(0x2000000&o)!=0?e._fulfill(i):e._reject(i))},A.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,r=e.promise,i=e.receiver,n=e.value;"function"==typeof t?r instanceof A?this._settlePromiseFromHandler(t,i,n,r):t.call(i,n,r):r instanceof A&&r._reject(n)},A.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},A.prototype._settlePromise0=function(e,t,r){var i=this._promise0,n=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(i,e,n,t)},A.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},A.prototype._fulfill=function(e){var t=this._bitField;if(!((0x7010000&t)>>>16)){if(e===this){var r=i();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&((0x8000000&t)!=0?this._settlePromises():h.settlePromises(this))}},A.prototype._reject=function(e){var t=this._bitField;if(!((0x7010000&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return h.fatalError(e,l.isNode);(65535&t)>0?h.settlePromises(this):this._ensurePossibleRejectionHandled()}},A.prototype._fulfillPromises=function(e,t){for(var r=1;r<e;r++){var i=this._fulfillmentHandlerAt(r),n=this._promiseAt(r),s=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(n,i,s,t)}},A.prototype._rejectPromises=function(e,t){for(var r=1;r<e;r++){var i=this._rejectionHandlerAt(r),n=this._promiseAt(r),s=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(n,i,s,t)}},A.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if((0x1010000&e)!=0){var r=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,r,e),this._rejectPromises(t,r)}else{var i=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,i,e),this._fulfillPromises(t,i)}this._setLength(0)}this._clearCancellationData()},A.prototype._settledValue=function(){var e=this._bitField;return(0x2000000&e)!=0?this._rejectionHandler0:(0x1000000&e)!=0?this._fulfillmentHandler0:void 0},A.defer=A.pending=function(){return S.deprecated("Promise.defer","new Promise"),{promise:new A(m),resolve:N,reject:R}},l.notEnumerableProp(A,"_makeSelfResolutionError",i),r(31792)(A,m,v,s,S),r(15546)(A,m,v,S),r(39727)(A,b,s,S),r(5919)(A),r(58237)(A),r(45901)(A,b,v,m,h,t),A.Promise=A,A.version="3.4.7",r(90811)(A,b,s,v,m,S),r(89614)(A),r(59453)(A,s,v,x,m,S),r(66895)(A,m,S),r(23107)(A,s,m,v,a,S),r(81855)(A),r(67645)(A,m),r(89367)(A,b,v,s),r(20224)(A,m,v,s),r(2071)(A,b,s,v,m,S),r(17814)(A,b,S),r(35417)(A,b,s),r(64299)(A,m),r(63712)(A,m),r(44147)(A),l.toFastProperties(A),l.toFastProperties(A.prototype),I({a:1}),I({b:2}),I({c:3}),I(1),I(function(){}),I(void 0),I(!1),I(new A(m)),S.setBounds(c.firstLineError,l.lastLineError),A}},23570:(e,t,r)=>{"use strict";e.exports=function(e,t,i,n,s){var a=r(50069);function o(r){var i=this._promise=new e(t);r instanceof e&&i._propagateFrom(r,3),i._setOnCancel(this),this._values=r,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return a.isArray,a.inherits(o,s),o.prototype.length=function(){return this._length},o.prototype.promise=function(){return this._promise},o.prototype._init=function t(r,s){var o=i(this._values,this._promise);if(o instanceof e){var l=(o=o._target())._bitField;if(this._values=o,(0x3010000&l)==0)return this._promise._setAsyncGuaranteed(),o._then(t,this._reject,void 0,this,s);if((0x2000000&l)!=0)o=o._value();else if((0x1000000&l)!=0)return this._reject(o._reason());else return this._cancel()}if(null===(o=a.asArray(o))){var u=n("expecting an array or an iterable object but got "+a.classString(o)).reason();this._promise._rejectCallback(u,!1);return}if(0===o.length){-5===s?this._resolveEmptyArray():this._resolve(function(e){switch(e){case -2:return[];case -3:return{}}}(s));return}this._iterate(o)},o.prototype._iterate=function(t){var r=this.getActualLength(t.length);this._length=r,this._values=this.shouldCopyValues()?Array(r):this._values;for(var n=this._promise,s=!1,a=null,o=0;o<r;++o){var l=i(t[o],n);a=l instanceof e?(l=l._target())._bitField:null,s?null!==a&&l.suppressUnhandledRejections():null!==a?(0x3010000&a)==0?(l._proxy(this,o),this._values[o]=l):s=(0x2000000&a)!=0?this._promiseFulfilled(l._value(),o):(0x1000000&a)!=0?this._promiseRejected(l._reason(),o):this._promiseCancelled(o):s=this._promiseFulfilled(l,o)}s||n._setAsyncGuaranteed()},o.prototype._isResolved=function(){return null===this._values},o.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},o.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},o.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},o.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},o.prototype._promiseCancelled=function(){return this._cancel(),!0},o.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},o.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var r=0;r<t.length;++r)t[r]instanceof e&&t[r].cancel()}},o.prototype.shouldCopyValues=function(){return!0},o.prototype.getActualLength=function(e){return e},o}},67645:(e,t,r)=>{"use strict";e.exports=function(e,t){var i,n={},s=r(50069),a=r(28806),o=s.withAppended,l=s.maybeWrapAsError,u=s.canEvaluate,c=r(82158).TypeError,h={__isPromisified__:!0},d=RegExp("^(?:arity|length|name|arguments|caller|callee|prototype|__isPromisified__)$"),p=function(e){return s.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function f(e){return!d.test(e)}function m(e){try{return!0===e.__isPromisified__}catch(e){return!1}}var g=function(e){for(var t=[e],r=Math.max(0,e-1-3),i=e-1;i>=r;--i)t.push(i);for(var i=e+1;i<=3;++i)t.push(i);return t};i=function(r,i,u,c,h,d){var p=Math.max(0,("number"==typeof c.length?Math.max(Math.min(c.length,1024),0):0)-1),f=g(p),m="string"==typeof r||i===n,y="'use strict';                                                \n        var ret = function (Parameters) {                                    \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._captureStackTrace();                                    \n            var nodeback = nodebackForPromise(promise, "+d+");   \n            var ret;                                                         \n            var callback = tryCatch([GetFunctionCode]);                      \n            switch(len) {                                                    \n                [CodeForSwitchCase]                                          \n            }                                                                \n            if (ret === errorObj) {                                          \n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n            }                                                                \n            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \n            return promise;                                                  \n        };                                                                   \n        notEnumerableProp(ret, '__isPromisified__', true);                   \n        return ret;                                                          \n    ".replace("[CodeForSwitchCase]",function(){for(var e="",t=0;t<f.length;++t)e+="case "+f[t]+":"+function(e){var t=s.filledRange(e,"_arg","").join(", ");return(m?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===i?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n").replace("{{args}}",t).replace(", ",e>0?", ":"")}(f[t]);return e+"                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = nodeback;                                              \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",m?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}()).replace("[GetFunctionCode]","string"==typeof r?"this != null ? this['"+r+"'] : fn":"fn");return Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",y=y.replace("Parameters",s.filledRange(Math.max(p,3),"_arg","")))(e,c,i,o,l,a,s.tryCatch,s.errorObj,s.notEnumerableProp,t)};var y=u?i:function(r,i,u,c,h,d){var p=function(){return this}(),f=r;function m(){var s=i;i===n&&(s=this);var u=new e(t);u._captureStackTrace();var c="string"==typeof f&&this!==p?this[f]:r,h=a(u,d);try{c.apply(s,o(arguments,h))}catch(e){u._rejectCallback(l(e),!0,!0)}return u._isFateSealed()||u._setAsyncGuaranteed(),u}return"string"==typeof f&&(r=c),s.notEnumerableProp(m,"__isPromisified__",!0),m};function v(e,t,r,i,a){for(var o=RegExp(t.replace(/([$])/,"\\$")+"$"),l=function(e,t,r,i){for(var n=s.inheritedDataKeys(e),a=[],o=0;o<n.length;++o){var l=n[o],u=e[l],d=i===p||p(l,u,e);"function"==typeof u&&!m(u)&&!function(e,t,r){var i=s.getDataPropertyOrDefault(e,t+r,h);return!!i&&m(i)}(e,l,t)&&i(l,u,e,d)&&a.push(l,u)}return function(e,t,r){for(var i=0;i<e.length;i+=2){var n=e[i];if(r.test(n)){for(var s=n.replace(r,""),a=0;a<e.length;a+=2)if(e[a]===s)throw new c("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}}(a,t,r),a}(e,t,o,r),u=0,d=l.length;u<d;u+=2){var f=l[u],g=l[u+1],v=f+t;if(i===y)e[v]=y(f,n,f,g,t,a);else{var b=i(g,function(){return y(f,n,f,g,t,a)});s.notEnumerableProp(b,"__isPromisified__",!0),e[v]=b}}return s.toFastProperties(e),e}e.promisify=function(e,t){if("function"!=typeof e)throw new c("expecting a function but got "+s.classString(e));if(m(e))return e;var r=y(e,void 0===(t=Object(t)).context?n:t.context,void 0,e,null,!!t.multiArgs);return s.copyDescriptors(e,r,f),r},e.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new c("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var r=!!(t=Object(t)).multiArgs,i=t.suffix;"string"!=typeof i&&(i="Async");var n=t.filter;"function"!=typeof n&&(n=p);var a=t.promisifier;if("function"!=typeof a&&(a=y),!s.isIdentifier(i))throw RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var o=s.inheritedDataKeys(e),l=0;l<o.length;++l){var u=e[o[l]];"constructor"!==o[l]&&s.isClass(u)&&(v(u.prototype,i,n,a,r),v(u,i,n,a,r))}return v(e,i,n,a,r)}}},89367:(e,t,r)=>{"use strict";e.exports=function(e,t,i,n){var s,a=r(50069),o=a.isObject,l=r(73070);"function"==typeof Map&&(s=Map);var u=function(){var e=0,t=0;function r(r,i){this[e]=r,this[e+t]=i,e++}return function(i){t=i.size,e=0;var n=Array(2*i.size);return i.forEach(r,n),n}}(),c=function(e){for(var t=new s,r=e.length/2|0,i=0;i<r;++i){var n=e[r+i],a=e[i];t.set(n,a)}return t};function h(e){var t,r=!1;if(void 0!==s&&e instanceof s)t=u(e),r=!0;else{var i=l.keys(e),n=i.length;t=Array(2*n);for(var a=0;a<n;++a){var o=i[a];t[a]=e[o],t[a+n]=o}}this.constructor$(t),this._isMap=r,this._init$(void 0,-3)}function d(t){var r,s=i(t);return o(s)?(r=s instanceof e?s._then(e.props,void 0,void 0,void 0,void 0):new h(s).promise(),s instanceof e&&r._propagateFrom(s,2),r):n("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}a.inherits(h,t),h.prototype._init=function(){},h.prototype._promiseFulfilled=function(e,t){var r;if(this._values[t]=e,++this._totalResolved>=this._length){if(this._isMap)r=c(this._values);else{r={};for(var i=this.length(),n=0,s=this.length();n<s;++n)r[this._values[n+i]]=this._values[n]}return this._resolve(r),!0}return!1},h.prototype.shouldCopyValues=function(){return!1},h.prototype.getActualLength=function(e){return e>>1},e.prototype.props=function(){return d(this)},e.props=function(e){return d(e)}}},67198:e=>{"use strict";function t(e){this._capacity=e,this._length=0,this._front=0}t.prototype._willBeOverCapacity=function(e){return this._capacity<e},t.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},t.prototype.push=function(e,t,r){var i=this.length()+3;if(this._willBeOverCapacity(i)){this._pushOne(e),this._pushOne(t),this._pushOne(r);return}var n=this._front+i-3;this._checkCapacity(i);var s=this._capacity-1;this[n+0&s]=e,this[n+1&s]=t,this[n+2&s]=r,this._length=i},t.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},t.prototype.length=function(){return this._length},t.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},t.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,r,i,n){for(var s=0;s<n;++s)r[s+i]=e[s+0],e[s+0]=void 0}(this,0,this,t,this._front+this._length&t-1)},e.exports=t},20224:(e,t,r)=>{"use strict";e.exports=function(e,t,i,n){var s=r(50069);function a(r,o){var l=i(r);if(l instanceof e)return l.then(function(e){return a(e,l)});if(null===(r=s.asArray(r)))return n("expecting an array or an iterable object but got "+s.classString(r));var u=new e(t);void 0!==o&&u._propagateFrom(o,3);for(var c=u._fulfill,h=u._reject,d=0,p=r.length;d<p;++d){var f=r[d];(void 0!==f||d in r)&&e.cast(f)._then(c,h,void 0,u,null)}return u}e.race=function(e){return a(e,void 0)},e.prototype.race=function(){return a(this,void 0)}}},2071:(e,t,r)=>{"use strict";e.exports=function(e,t,i,n,s,a){var o=e._getDomain,l=r(50069),u=l.tryCatch;function c(t,r,i,n){this.constructor$(t);var a=o();this._fn=null===a?r:l.domainBind(a,r),void 0!==i&&(i=e.resolve(i))._attachCancellationCallback(this),this._initialValue=i,this._currentCancellable=null,n===s?this._eachValues=Array(this._length):0===n?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function h(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function d(e,t,r,n){return"function"!=typeof t?i("expecting a function but got "+l.classString(t)):new c(e,t,r,n).promise()}function p(t){this.accum=t,this.array._gotAccum(t);var r=n(this.value,this.array._promise);return r instanceof e?(this.array._currentCancellable=r,r._then(f,void 0,void 0,this,void 0)):f.call(this,r)}function f(t){var r,i=this.array,n=i._promise,s=u(i._fn);n._pushContext(),(r=void 0!==i._eachValues?s.call(n._boundValue(),t,this.index,this.length):s.call(n._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(i._currentCancellable=r);var o=n._popContext();return a.checkForgottenReturns(r,o,void 0!==i._eachValues?"Promise.each":"Promise.reduce",n),r}l.inherits(c,t),c.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==s&&this._eachValues.push(e)},c.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},c.prototype._init=function(){},c.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},c.prototype.shouldCopyValues=function(){return!1},c.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},c.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();!this._isResolved()&&(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},c.prototype._iterate=function(t){this._values=t;var r,i,n=t.length;if(void 0!==this._initialValue?(r=this._initialValue,i=0):(r=e.resolve(t[0]),i=1),this._currentCancellable=r,!r.isRejected())for(;i<n;++i){var s={accum:null,value:t[i],index:i,length:n,array:this};r=r._then(p,void 0,void 0,s,void 0)}void 0!==this._eachValues&&(r=r._then(this._eachComplete,void 0,void 0,this,void 0)),r._then(h,h,void 0,r,this)},e.prototype.reduce=function(e,t){return d(this,e,t,null)},e.reduce=function(e,t,r,i){return d(e,t,r,i)}}},9848:(e,t,r)=>{"use strict";var i,n=r(50069),s=n.getNativePromise();if(n.isNode&&"undefined"==typeof MutationObserver){var a=global.setImmediate,o=process.nextTick;i=n.isRecentNode?function(e){a.call(global,e)}:function(e){o.call(process,e)}}else if("function"==typeof s&&"function"==typeof s.resolve){var l=s.resolve();i=function(e){l.then(e)}}else"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?i="undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:i=function(){var e=document.createElement("div"),t={attributes:!0},r=!1,i=document.createElement("div");new MutationObserver(function(){e.classList.toggle("foo"),r=!1}).observe(i,t);var n=function(){r||(r=!0,i.classList.toggle("foo"))};return function(r){var i=new MutationObserver(function(){i.disconnect(),r()});i.observe(e,t),n()}}();e.exports=i},17814:(e,t,r)=>{"use strict";e.exports=function(e,t,i){var n=e.PromiseInspection;function s(e){this.constructor$(e)}r(50069).inherits(s,t),s.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseFulfilled=function(e,t){var r=new n;return r._bitField=0x2000000,r._settledValueField=e,this._promiseResolved(t,r)},s.prototype._promiseRejected=function(e,t){var r=new n;return r._bitField=0x1000000,r._settledValueField=e,this._promiseResolved(t,r)},e.settle=function(e){return i.deprecated(".settle()",".reflect()"),new s(e).promise()},e.prototype.settle=function(){return e.settle(this)}}},35417:(e,t,r)=>{"use strict";e.exports=function(e,t,i){var n=r(50069),s=r(82158).RangeError,a=r(82158).AggregateError,o=n.isArray,l={};function u(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function c(e,t){if((0|t)!==t||t<0)return i("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var r=new u(e),n=r.promise();return r.setHowMany(t),r.init(),n}n.inherits(u,t),u.prototype._init=function(){if(this._initialized){if(0===this._howMany){this._resolve([]);return}this._init$(void 0,-5);var e=o(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},u.prototype.init=function(){this._initialized=!0,this._init()},u.prototype.setUnwrap=function(){this._unwrap=!0},u.prototype.howMany=function(){return this._howMany},u.prototype.setHowMany=function(e){this._howMany=e},u.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},u.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},u.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(l),this._checkOutcome())},u.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new a,t=this.length();t<this._values.length;++t)this._values[t]!==l&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},u.prototype._fulfilled=function(){return this._totalResolved},u.prototype._rejected=function(){return this._values.length-this.length()},u.prototype._addRejected=function(e){this._values.push(e)},u.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},u.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},u.prototype._getRangeError=function(e){return new s("Input array must contain at least "+this._howMany+" items but contains only "+e+" items")},u.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(e,t){return c(e,t)},e.prototype.some=function(e){return c(this,e)},e._SomePromiseArray=u}},58237:e=>{"use strict";e.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var r=t.prototype.value=function(){if(!this.isFulfilled())throw TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},n=t.prototype.isFulfilled=function(){return(0x2000000&this._bitField)!=0},s=t.prototype.isRejected=function(){return(0x1000000&this._bitField)!=0},a=t.prototype.isPending=function(){return(0x3010000&this._bitField)==0},o=t.prototype.isResolved=function(){return(0x3000000&this._bitField)!=0};t.prototype.isCancelled=function(){return(8454144&this._bitField)!=0},e.prototype.__isCancelled=function(){return(65536&this._bitField)==65536},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return(8454144&this._target()._bitField)!=0},e.prototype.isPending=function(){return a.call(this._target())},e.prototype.isRejected=function(){return s.call(this._target())},e.prototype.isFulfilled=function(){return n.call(this._target())},e.prototype.isResolved=function(){return o.call(this._target())},e.prototype.value=function(){return r.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),i.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},80569:(e,t,r)=>{"use strict";e.exports=function(e,t){var i=r(50069),n=i.errorObj,s=i.isObject,a={}.hasOwnProperty;return function(r,o){if(s(r)){if(r instanceof e)return r;var l=function(e){try{return e.then}catch(e){return n.e=e,n}}(r);if(l===n){o&&o._pushContext();var u=e.reject(l.e);return o&&o._popContext(),u}if("function"==typeof l){if(function(e){try{return a.call(e,"_promise0")}catch(e){return!1}}(r)){var c,h,d,p,u=new e(t);return r._then(u._fulfill,u._reject,void 0,u,null),u}return h=c=new e(t),o&&o._pushContext(),c._captureStackTrace(),o&&o._popContext(),d=!0,p=i.tryCatch(l).call(r,function(e){c&&(c._resolveCallback(e),c=null)},function(e){c&&(c._rejectCallback(e,d,!0),c=null)}),d=!1,c&&p===n&&(c._rejectCallback(p.e,!0,!0),c=null),h}}return r}}},66895:(e,t,r)=>{"use strict";e.exports=function(e,t,i){var n=r(50069),s=e.TimeoutError;function a(e){this.handle=e}a.prototype._resultCancelled=function(){clearTimeout(this.handle)};var o=function(e){return l(+this).thenReturn(e)},l=e.delay=function(r,n){var s,l;return void 0!==n?(s=e.resolve(n)._then(o,null,null,r,void 0),i.cancellation()&&n instanceof e&&s._setOnCancel(n)):(s=new e(t),l=setTimeout(function(){s._fulfill()},+r),i.cancellation()&&s._setOnCancel(new a(l)),s._captureStackTrace()),s._setAsyncGuaranteed(),s};e.prototype.delay=function(e){return l(e,this)};var u=function(e,t,r){var i;i="string"!=typeof t?t instanceof Error?t:new s("operation timed out"):new s(t),n.markAsOriginatingFromRejection(i),e._attachExtraTrace(i),e._reject(i),null!=r&&r.cancel()};function c(e){return clearTimeout(this.handle),e}function h(e){throw clearTimeout(this.handle),e}e.prototype.timeout=function(e,t){var r,n,s=new a(setTimeout(function(){r.isPending()&&u(r,t,n)},e=+e));return i.cancellation()?(r=(n=this.then())._then(c,h,void 0,s,void 0))._setOnCancel(s):r=this._then(c,h,void 0,s,void 0),r}}},59453:(e,t,r)=>{"use strict";e.exports=function(e,t,i,n,s,a){var o=r(50069),l=r(82158).TypeError,u=r(50069).inherits,c=o.errorObj,h=o.tryCatch,d={};function p(e){setTimeout(function(){throw e},0)}function f(e,t,r){this._data=e,this._promise=t,this._context=r}function m(e,t,r){this.constructor$(e,t,r)}function g(e){return f.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function y(e){this.length=e,this.promise=null,this[e-1]=null}f.prototype.data=function(){return this._data},f.prototype.promise=function(){return this._promise},f.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():d},f.prototype.tryDispose=function(e){var t=this.resource(),r=this._context;void 0!==r&&r._pushContext();var i=t!==d?this.doDispose(t,e):null;return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,i},f.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},u(m,f),m.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},y.prototype._resultCancelled=function(){for(var t=this.length,r=0;r<t;++r){var i=this[r];i instanceof e&&i.cancel()}},e.using=function(){var r,n=arguments.length;if(n<2)return t("you must pass at least 2 arguments to Promise.using");var l=arguments[n-1];if("function"!=typeof l)return t("expecting a function but got "+o.classString(l));var u=!0;2===n&&Array.isArray(arguments[0])?(r=arguments[0],n=r.length,u=!1):(r=arguments,n--);for(var d=new y(n),m=0;m<n;++m){var v=r[m];if(f.isDisposer(v)){var b=v;(v=v.promise())._setDisposable(b)}else{var w=i(v);w instanceof e&&(v=w._then(g,null,null,{resources:d,index:m},void 0))}d[m]=v}for(var x=Array(d.length),m=0;m<x.length;++m)x[m]=e.resolve(d[m]).reflect();var S=e.all(x).then(function(e){for(var t=0;t<e.length;++t){var r=e[t];if(r.isRejected())return c.e=r.error(),c;if(!r.isFulfilled()){S.cancel();return}e[t]=r.value()}E._pushContext(),l=h(l);var i=u?l.apply(void 0,e):l(e),n=E._popContext();return a.checkForgottenReturns(i,n,"Promise.using",E),i}),E=S.lastly(function(){var t,r,n,a=new e.PromiseInspection(S);return t=0,r=d.length,n=new e(s),function s(){if(t>=r)return n._fulfill();var o,l,u=((l=i(o=d[t++]))!==o&&"function"==typeof o._isDisposable&&"function"==typeof o._getDisposer&&o._isDisposable()&&l._setDisposable(o._getDisposer()),l);if(u instanceof e&&u._isDisposable()){try{u=i(u._getDisposer().tryDispose(a),d.promise)}catch(e){return p(e)}if(u instanceof e)return u._then(s,p,null,null,null)}s()}(),n});return d.promise=E,E._setOnCancel(d),E},e.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(e){if("function"==typeof e)return new m(e,this,n());throw new l}}},50069:function(e,t,r){"use strict";var i,n,s=r(73070),a="undefined"==typeof navigator,o={e:{}},l="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null;function u(){try{var e=n;return n=null,e.apply(this,arguments)}catch(e){return o.e=e,o}}function c(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function h(e,t,r){return c(e)||s.defineProperty(e,t,{value:r,configurable:!0,enumerable:!1,writable:!0}),e}var d=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1};if(s.isES5){var r=Object.getOwnPropertyNames;return function(e){for(var i,n=[],a=Object.create(null);null!=e&&!t(e);){try{i=r(e)}catch(e){break}for(var o=0;o<i.length;++o){var l=i[o];if(!a[l]){a[l]=!0;var u=Object.getOwnPropertyDescriptor(e,l);null!=u&&null==u.get&&null==u.set&&n.push(l)}}e=s.getPrototypeOf(e)}return n}}var i={}.hasOwnProperty;return function(r){if(t(r))return[];var n=[];r:for(var s in r)if(i.call(r,s))n.push(s);else{for(var a=0;a<e.length;++a)if(i.call(e[a],s))continue r;n.push(s)}return n}}(),p=/this\s*\.\s*\S+\s*=/,f=/^[a-z$_][a-z$_0-9]*$/i;function m(e){try{return e+""}catch(e){return"[no string representation]"}}function g(e){return null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function y(e){return g(e)&&s.propertyIsWritable(e,"stack")}var v="stack"in Error()?function(e){return y(e)?e:Error(m(e))}:function(e){if(y(e))return e;try{throw Error(m(e))}catch(e){return e}};function b(e){return({}).toString.call(e)}var w=function(e){return s.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var x="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,r=[],i=e[Symbol.iterator]();!(t=i.next()).done;)r.push(t.value);return r};w=function(e){return s.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?x(e):null}}var S="undefined"!=typeof process&&"[object process]"===b(process).toLowerCase(),E="undefined"!=typeof process&&void 0!==process.env,T={isClass:function(e){try{if("function"==typeof e){var t=s.names(e.prototype),r=s.isES5&&t.length>1,i=t.length>0&&!(1===t.length&&"constructor"===t[0]),n=p.test(e+"")&&s.names(e).length>0;if(r||i||n)return!0}return!1}catch(e){return!1}},isIdentifier:function(e){return f.test(e)},inheritedDataKeys:d,getDataPropertyOrDefault:function(e,t,r){if(!s.isES5)return({}).hasOwnProperty.call(e,t)?e[t]:void 0;var i=Object.getOwnPropertyDescriptor(e,t);if(null!=i)return null==i.get&&null==i.set?i.value:r},thrower:function(e){throw e},isArray:s.isArray,asArray:w,notEnumerableProp:h,isPrimitive:c,isObject:function(e){return"function"==typeof e||"object"==typeof e&&null!==e},isError:g,canEvaluate:a,errorObj:o,tryCatch:function(e){return n=e,u},inherits:function(e,t){var r={}.hasOwnProperty;function i(){for(var i in this.constructor=e,this.constructor$=t,t.prototype)r.call(t.prototype,i)&&"$"!==i.charAt(i.length-1)&&(this[i+"$"]=t.prototype[i])}return i.prototype=t.prototype,e.prototype=new i,e.prototype},withAppended:function(e,t){var r,i=e.length,n=Array(i+1);for(r=0;r<i;++r)n[r]=e[r];return n[r]=t,n},maybeWrapAsError:function(e){return c(e)?Error(m(e)):e},toFastProperties:function(e){function t(){}t.prototype=e;for(var r=8;r--;)new t;return e},filledRange:function(e,t,r){for(var i=Array(e),n=0;n<e;++n)i[n]=t+n+r;return i},toString:m,canAttachTrace:y,ensureErrorObject:v,originatesFromRejection:function(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)},markAsOriginatingFromRejection:function(e){try{h(e,"isOperational",!0)}catch(e){}},classString:b,copyDescriptors:function(e,t,r){for(var i=s.names(e),n=0;n<i.length;++n){var a=i[n];if(r(a))try{s.defineProperty(t,a,s.getDescriptor(e,a))}catch(e){}}},hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:S,hasEnvVariables:E,env:function(e){return E?process.env[e]:void 0},global:l,getNativePromise:function(){if("function"==typeof Promise)try{var e=new Promise(function(){});if("[object Promise]"===({}).toString.call(e))return Promise}catch(e){}},domainBind:function(e,t){return e.bind(t)}};T.isRecentNode=T.isNode&&(0===(i=process.versions.node.split(".").map(Number))[0]&&i[1]>10||i[0]>0),T.isNode&&T.toFastProperties(process);try{throw Error()}catch(e){T.lastLineError=e}e.exports=T},29e3:(e,t,r)=>{var i=r(11092),n=r(61746);e.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),(function e(t,r){var s=[],a=n("{","}",t);if(!a||/\$$/.test(a.pre))return[t];var l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(a.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(a.body),h=l||u,g=a.body.indexOf(",")>=0;if(!h&&!g)return a.post.match(/,(?!,).*\}/)?e(t=a.pre+"{"+a.body+o+a.post):[t];if(h)b=a.body.split(/\.\./);else if(1===(b=function e(t){if(!t)return[""];var r=[],i=n("{","}",t);if(!i)return t.split(",");var s=i.pre,a=i.body,o=i.post,l=s.split(",");l[l.length-1]+="{"+a+"}";var u=e(o);return o.length&&(l[l.length-1]+=u.shift(),l.push.apply(l,u)),r.push.apply(r,l),r}(a.body)).length&&1===(b=e(b[0],!1).map(d)).length){var y=a.post.length?e(a.post,!1):[""];return y.map(function(e){return a.pre+b[0]+e})}var v=a.pre,y=a.post.length?e(a.post,!1):[""];if(h){var b,w,x,S=c(b[0]),E=c(b[1]),T=Math.max(b[0].length,b[1].length),k=3==b.length?Math.abs(c(b[2])):1,O=f;E<S&&(k*=-1,O=m);var C=b.some(p);w=[];for(var A=S;O(A,E);A+=k){if(u)"\\"===(x=String.fromCharCode(A))&&(x="");else if(x=String(A),C){var N=T-x.length;if(N>0){var R=Array(N+1).join("0");x=A<0?"-"+R+x.slice(1):R+x}}w.push(x)}}else w=i(b,function(t){return e(t,!1)});for(var I=0;I<w.length;I++)for(var P=0;P<y.length;P++){var j=v+w[I]+y[P];(!r||h||j)&&s.push(j)}return s})(e.split("\\\\").join(s).split("\\{").join(a).split("\\}").join(o).split("\\,").join(l).split("\\.").join(u),!0).map(h)):[]};var s="\0SLASH"+Math.random()+"\0",a="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",l="\0COMMA"+Math.random()+"\0",u="\0PERIOD"+Math.random()+"\0";function c(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function h(e){return e.split(s).join("\\").split(a).join("{").split(o).join("}").split(l).join(",").split(u).join(".")}function d(e){return"{"+e+"}"}function p(e){return/^-?0\d/.test(e)}function f(e,t){return e<=t}function m(e,t){return e>=t}},2561:(e,t,r)=>{var i=r(61746);e.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),(function e(t,r){var n=[],s=i("{","}",t);if(!s)return[t];var o=s.pre,l=s.post.length?e(s.post,!1):[""];if(/\$$/.test(s.pre))for(var c=0;c<l.length;c++){var m=o+"{"+s.body+"}"+l[c];n.push(m)}else{var g=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body),y=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body),v=g||y,b=s.body.indexOf(",")>=0;if(!v&&!b)return s.post.match(/,(?!,).*\}/)?e(t=s.pre+"{"+s.body+a+s.post):[t];if(v)w=s.body.split(/\.\./);else if(1===(w=function e(t){if(!t)return[""];var r=[],n=i("{","}",t);if(!n)return t.split(",");var s=n.pre,a=n.body,o=n.post,l=s.split(",");l[l.length-1]+="{"+a+"}";var u=e(o);return o.length&&(l[l.length-1]+=u.shift(),l.push.apply(l,u)),r.push.apply(r,l),r}(s.body)).length&&1===(w=e(w[0],!1).map(h)).length)return l.map(function(e){return s.pre+w[0]+e});if(v){var w,x,S,E=u(w[0]),T=u(w[1]),k=Math.max(w[0].length,w[1].length),O=3==w.length?Math.abs(u(w[2])):1,C=p;T<E&&(O*=-1,C=f);var A=w.some(d);x=[];for(var N=E;C(N,T);N+=O){if(y)"\\"===(S=String.fromCharCode(N))&&(S="");else if(S=String(N),A){var R=k-S.length;if(R>0){var I=Array(R+1).join("0");S=N<0?"-"+I+S.slice(1):I+S}}x.push(S)}}else{x=[];for(var P=0;P<w.length;P++)x.push.apply(x,e(w[P],!1))}for(var P=0;P<x.length;P++)for(var c=0;c<l.length;c++){var m=o+x[P]+l[c];(!r||v||m)&&n.push(m)}}return n})(e.split("\\\\").join(n).split("\\{").join(s).split("\\}").join(a).split("\\,").join(o).split("\\.").join(l),!0).map(c)):[]};var n="\0SLASH"+Math.random()+"\0",s="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",o="\0COMMA"+Math.random()+"\0",l="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function c(e){return e.split(n).join("\\").split(s).join("{").split(a).join("}").split(o).join(",").split(l).join(".")}function h(e){return"{"+e+"}"}function d(e){return/^-?0\d/.test(e)}function p(e,t){return e<=t}function f(e,t){return e>=t}},65971:(e,t,r)=>{var i=r(79428).Buffer,n=[0,0x77073096,0xee0e612c,0x990951ba,0x76dc419,0x706af48f,0xe963a535,0x9e6495a3,0xedb8832,0x79dcb8a4,0xe0d5e91e,0x97d2d988,0x9b64c2b,0x7eb17cbd,0xe7b82d07,0x90bf1d91,0x1db71064,0x6ab020f2,0xf3b97148,0x84be41de,0x1adad47d,0x6ddde4eb,0xf4d4b551,0x83d385c7,0x136c9856,0x646ba8c0,0xfd62f97a,0x8a65c9ec,0x14015c4f,0x63066cd9,0xfa0f3d63,0x8d080df5,0x3b6e20c8,0x4c69105e,0xd56041e4,0xa2677172,0x3c03e4d1,0x4b04d447,0xd20d85fd,0xa50ab56b,0x35b5a8fa,0x42b2986c,0xdbbbc9d6,0xacbcf940,0x32d86ce3,0x45df5c75,0xdcd60dcf,0xabd13d59,0x26d930ac,0x51de003a,0xc8d75180,0xbfd06116,0x21b4f4b5,0x56b3c423,0xcfba9599,0xb8bda50f,0x2802b89e,0x5f058808,0xc60cd9b2,0xb10be924,0x2f6f7c87,0x58684c11,0xc1611dab,0xb6662d3d,0x76dc4190,0x1db7106,0x98d220bc,0xefd5102a,0x71b18589,0x6b6b51f,0x9fbfe4a5,0xe8b8d433,0x7807c9a2,0xf00f934,0x9609a88e,0xe10e9818,0x7f6a0dbb,0x86d3d2d,0x91646c97,0xe6635c01,0x6b6b51f4,0x1c6c6162,0x856530d8,0xf262004e,0x6c0695ed,0x1b01a57b,0x8208f4c1,0xf50fc457,0x65b0d9c6,0x12b7e950,0x8bbeb8ea,0xfcb9887c,0x62dd1ddf,0x15da2d49,0x8cd37cf3,0xfbd44c65,0x4db26158,0x3ab551ce,0xa3bc0074,0xd4bb30e2,0x4adfa541,0x3dd895d7,0xa4d1c46d,0xd3d6f4fb,0x4369e96a,0x346ed9fc,0xad678846,0xda60b8d0,0x44042d73,0x33031de5,0xaa0a4c5f,0xdd0d7cc9,0x5005713c,0x270241aa,0xbe0b1010,0xc90c2086,0x5768b525,0x206f85b3,0xb966d409,0xce61e49f,0x5edef90e,0x29d9c998,0xb0d09822,0xc7d7a8b4,0x59b33d17,0x2eb40d81,0xb7bd5c3b,0xc0ba6cad,0xedb88320,0x9abfb3b6,0x3b6e20c,0x74b1d29a,0xead54739,0x9dd277af,0x4db2615,0x73dc1683,0xe3630b12,0x94643b84,0xd6d6a3e,0x7a6a5aa8,0xe40ecf0b,0x9309ff9d,0xa00ae27,0x7d079eb1,0xf00f9344,0x8708a3d2,0x1e01f268,0x6906c2fe,0xf762575d,0x806567cb,0x196c3671,0x6e6b06e7,0xfed41b76,0x89d32be0,0x10da7a5a,0x67dd4acc,0xf9b9df6f,0x8ebeeff9,0x17b7be43,0x60b08ed5,0xd6d6a3e8,0xa1d1937e,0x38d8c2c4,0x4fdff252,0xd1bb67f1,0xa6bc5767,0x3fb506dd,0x48b2364b,0xd80d2bda,0xaf0a1b4c,0x36034af6,0x41047a60,0xdf60efc3,0xa867df55,0x316e8eef,0x4669be79,0xcb61b38c,0xbc66831a,0x256fd2a0,0x5268e236,0xcc0c7795,0xbb0b4703,0x220216b9,0x5505262f,0xc5ba3bbe,0xb2bd0b28,0x2bb45a92,0x5cb36a04,0xc2d7ffa7,0xb5d0cf31,0x2cd99e8b,0x5bdeae1d,0x9b64c2b0,0xec63f226,0x756aa39c,0x26d930a,0x9c0906a9,0xeb0e363f,0x72076785,0x5005713,0x95bf4a82,0xe2b87a14,0x7bb12bae,0xcb61b38,0x92d28e9b,0xe5d5be0d,0x7cdcefb7,0xbdbdf21,0x86d3d2d4,0xf1d4e242,0x68ddb3f8,0x1fda836e,0x81be16cd,0xf6b9265b,0x6fb077e1,0x18b74777,0x88085ae6,0xff0f6a70,0x66063bca,0x11010b5c,0x8f659eff,0xf862ae69,0x616bffd3,0x166ccf45,0xa00ae278,0xd70dd2ee,0x4e048354,0x3903b3c2,0xa7672661,0xd06016f7,0x4969474d,0x3e6e77db,0xaed16a4a,0xd9d65adc,0x40df0b66,936918e3,0xa9bcae53,0xdebb9ec5,0x47b2cf7f,0x30b5ffe9,0xbdbdf21c,0xcabac28a,0x53b39330,0x24b4a3a6,0xbad03605,0xcdd70693,0x54de5729,0x23d967bf,0xb3667a2e,0xc4614ab8,0x5d681b02,0x2a6f2b94,0xb40bbe37,0xc30c8ea1,0x5a05df1b,0x2d02ef8d];function s(e){if(i.isBuffer(e))return e;var t="function"==typeof i.alloc&&"function"==typeof i.from;if("number"==typeof e)return t?i.alloc(e):new i(e);if("string"==typeof e)return t?i.from(e):new i(e);throw Error("input must be buffer, number, or string, received "+typeof e)}function a(e,t){e=s(e),i.isBuffer(t)&&(t=t.readUInt32BE(0));for(var r=-1^~~t,a=0;a<e.length;a++)r=n[(r^e[a])&255]^r>>>8;return -1^r}function o(){var e,t;return e=a.apply(null,arguments),(t=s(4)).writeInt32BE(e,0),t}"undefined"!=typeof Int32Array&&(n=new Int32Array(n)),o.signed=function(){return a.apply(null,arguments)},o.unsigned=function(){return a.apply(null,arguments)>>>0},e.exports=o},29444:(e,t,r)=>{"use strict";var i=r(21803);function n(e,t){"string"==typeof e||e instanceof String?e=i(e):("number"==typeof e||e instanceof Number)&&(e=i([e]));var r=e.length;t=t||this.length-r;for(var n=t;n>=0;n--){for(var s=!1,a=0;a<r;a++)if(this[n+a]!=e[a]){s=!0;break}if(!s)return n}return -1}Buffer.prototype.indexOf||(Buffer.prototype.indexOf=function(e,t){t=t||0,"string"==typeof e||e instanceof String?e=i(e):("number"==typeof e||e instanceof Number)&&(e=i([e]));for(var r=e.length,n=t;n<=this.length-r;n++){for(var s=!1,a=0;a<r;a++)if(this[n+a]!=e[a]){s=!0;break}if(!s)return n}return -1}),Buffer.prototype.lastIndexOf?-1===i("ABC").lastIndexOf("ABC")&&(Buffer.prototype.lastIndexOf=n):Buffer.prototype.lastIndexOf=n},21803:e=>{e.exports=function(e){return 6>(process&&process.version?process.version:"v5.0.0").split(".")[0].replace("v","")?new Buffer(e):Buffer.from(e)}},67653:e=>{function t(e){if(!(this instanceof t))return new t(e);this.buffers=e||[],this.length=this.buffers.reduce(function(e,t){return e+t.length},0)}e.exports=t,t.prototype.push=function(){for(var e=0;e<arguments.length;e++)if(!Buffer.isBuffer(arguments[e]))throw TypeError("Tried to push a non-buffer");for(var e=0;e<arguments.length;e++){var t=arguments[e];this.buffers.push(t),this.length+=t.length}return this.length},t.prototype.unshift=function(){for(var e=0;e<arguments.length;e++)if(!Buffer.isBuffer(arguments[e]))throw TypeError("Tried to unshift a non-buffer");for(var e=0;e<arguments.length;e++){var t=arguments[e];this.buffers.unshift(t),this.length+=t.length}return this.length},t.prototype.copy=function(e,t,r,i){return this.slice(r,i).copy(e,t,0,i-r)},t.prototype.splice=function(e,r){var i=this.buffers,n=e>=0?e:this.length-e,s=[].slice.call(arguments,2);void 0===r?r=this.length-n:r>this.length-n&&(r=this.length-n);for(var e=0;e<s.length;e++)this.length+=s[e].length;for(var a=new t,o=0,l=0;l<i.length&&o+i[l].length<n;l++)o+=i[l].length;if(n-o>0){var u=n-o;if(u+r<i[l].length){a.push(i[l].slice(u,u+r));for(var c=i[l],h=new Buffer(u),e=0;e<u;e++)h[e]=c[e];for(var d=new Buffer(c.length-u-r),e=u+r;e<c.length;e++)d[e-r-u]=c[e];if(s.length>0){var p=s.slice();p.unshift(h),p.push(d),i.splice.apply(i,[l,1].concat(p)),l+=p.length,s=[]}else i.splice(l,1,h,d),l+=2}else a.push(i[l].slice(u)),i[l]=i[l].slice(0,u),l++}for(s.length>0&&(i.splice.apply(i,[l,0].concat(s)),l+=s.length);a.length<r;){var f=i[l],m=f.length,g=Math.min(m,r-a.length);g===m?(a.push(f),i.splice(l,1)):(a.push(f.slice(0,g)),i[l]=i[l].slice(g))}return this.length-=a.length,a},t.prototype.slice=function(e,t){var r=this.buffers;void 0===t&&(t=this.length),void 0===e&&(e=0),t>this.length&&(t=this.length);for(var i=0,n=0;n<r.length&&i+r[n].length<=e;n++)i+=r[n].length;for(var s=new Buffer(t-e),a=0,o=n;a<t-e&&o<r.length;o++){var l=r[o].length,u=0===a?e-i:0,c=a+l>=t-e?Math.min(u+(t-e)-a,l):l;r[o].copy(s,a,u,c),a+=c-u}return s},t.prototype.pos=function(e){if(e<0||e>=this.length)throw Error("oob");for(var t=e,r=0,i=null;;){if(t<(i=this.buffers[r]).length)return{buf:r,offset:t};t-=i.length,r++}},t.prototype.get=function(e){var t=this.pos(e);return this.buffers[t.buf].get(t.offset)},t.prototype.set=function(e,t){var r=this.pos(e);return this.buffers[r.buf].set(r.offset,t)},t.prototype.indexOf=function(e,t){if("string"==typeof e)e=new Buffer(e);else if(e instanceof Buffer);else throw Error("Invalid type for a search string");if(!e.length)return 0;if(!this.length)return -1;var r,i=0,n=0,s=0,a=0;if(t){var o=this.pos(t);i=o.buf,n=o.offset,a=t}for(;;){for(;n>=this.buffers[i].length;)if(n=0,++i>=this.buffers.length)return -1;if(this.buffers[i][n]==e[s]){if(0==s&&(r={i:i,j:n,pos:a}),++s==e.length)return r.pos}else 0!=s&&(i=r.i,n=r.j,a=r.pos,s=0);n++,a++}},t.prototype.toBuffer=function(){return this.slice()},t.prototype.toString=function(e,t,r){return this.slice(t,r).toString(e)}},81172:(e,t,r)=>{var i=r(21033),n=r(94735).EventEmitter;function s(e){var t=s.saw(e,{}),r=e.call(t.handlers,t);return void 0!==r&&(t.handlers=r),t.record(),t.chain()}e.exports=s,s.light=function(e){var t=s.saw(e,{}),r=e.call(t.handlers,t);return void 0!==r&&(t.handlers=r),t.chain()},s.saw=function(e,t){var r=new n;return r.handlers=t,r.actions=[],r.chain=function(){var e=i(r.handlers).map(function(t){if(this.isRoot)return t;var i=this.path;"function"==typeof t&&this.update(function(){return r.actions.push({path:i,args:[].slice.call(arguments)}),e})});return process.nextTick(function(){r.emit("begin"),r.next()}),e},r.pop=function(){return r.actions.shift()},r.next=function(){var e=r.pop();if(e){if(!e.trap){var t=r.handlers;e.path.forEach(function(e){t=t[e]}),t.apply(r.handlers,e.args)}}else r.emit("end")},r.nest=function(t){var i=[].slice.call(arguments,1),n=!0;if("boolean"==typeof t){var n=t;t=i.shift()}var a=s.saw(e,{}),o=e.call(a.handlers,a);void 0!==o&&(a.handlers=o),void 0!==r.step&&a.record(),t.apply(a.chain(),i),!1!==n&&a.on("end",r.next)},r.record=function(){r.step=0,r.pop=function(){return r.actions[r.step++]},r.trap=function(e,t){var i=Array.isArray(e)?e:[e];r.actions.push({path:i,step:r.step,cb:t,trap:!0})},r.down=function(e){var t=(Array.isArray(e)?e:[e]).join("/"),i=r.actions.slice(r.step).map(function(e){return(!e.trap||!(e.step<=r.step))&&e.path.join("/")==t}).indexOf(!0);i>=0?r.step+=i:r.step=r.actions.length;var n=r.actions[r.step-1];n&&n.trap?(r.step=n.step,n.cb()):r.next()},r.jump=function(e){r.step=e,r.next()}},["trap","down","jump"].forEach(function(e){r[e]=function(){throw Error("To use the trap, down and jump features, please call record() first to start recording actions.")}}),r}},79035:e=>{var t=e.exports=function(){};t.prototype.getName=function(){},t.prototype.getSize=function(){},t.prototype.getLastModifiedDate=function(){},t.prototype.isDirectory=function(){}},12167:(e,t,r)=>{var i=r(28354).inherits,n=r(68280).Transform,s=r(79035),a=r(96819),o=e.exports=function(e){if(!(this instanceof o))return new o(e);n.call(this,e),this.offset=0,this._archive={finish:!1,finished:!1,processing:!1}};i(o,n),o.prototype._appendBuffer=function(e,t,r){},o.prototype._appendStream=function(e,t,r){},o.prototype._emitErrorCallback=function(e){e&&this.emit("error",e)},o.prototype._finish=function(e){},o.prototype._normalizeEntry=function(e){},o.prototype._transform=function(e,t,r){r(null,e)},o.prototype.entry=function(e,t,r){if(t=t||null,"function"!=typeof r&&(r=this._emitErrorCallback.bind(this)),!(e instanceof s)){r(Error("not a valid instance of ArchiveEntry"));return}if(this._archive.finish||this._archive.finished){r(Error("unacceptable entry after finish"));return}if(this._archive.processing){r(Error("already processing an entry"));return}if(this._archive.processing=!0,this._normalizeEntry(e),this._entry=e,t=a.normalizeInputSource(t),Buffer.isBuffer(t))this._appendBuffer(e,t,r);else if(a.isStream(t))this._appendStream(e,t,r);else{this._archive.processing=!1,r(Error("input source must be valid Stream or Buffer instance"));return}return this},o.prototype.finish=function(){if(this._archive.processing){this._archive.finish=!0;return}this._finish()},o.prototype.getBytesWritten=function(){return this.offset},o.prototype.write=function(e,t){return e&&(this.offset+=e.length),n.prototype.write.call(this,e,t)}},1277:e=>{e.exports={WORD:4,DWORD:8,EMPTY:Buffer.alloc(0),SHORT:2,SHORT_MASK:65535,SHORT_SHIFT:16,SHORT_ZERO:Buffer.from([,,]),LONG:4,LONG_ZERO:Buffer.from([,,,,]),MIN_VERSION_INITIAL:10,MIN_VERSION_DATA_DESCRIPTOR:20,MIN_VERSION_ZIP64:45,VERSION_MADEBY:45,METHOD_STORED:0,METHOD_DEFLATED:8,PLATFORM_UNIX:3,PLATFORM_FAT:0,SIG_LFH:0x4034b50,SIG_DD:0x8074b50,SIG_CFH:0x2014b50,SIG_EOCD:0x6054b50,SIG_ZIP64_EOCD:0x6064b50,SIG_ZIP64_EOCD_LOC:0x7064b50,ZIP64_MAGIC_SHORT:65535,ZIP64_MAGIC:0xffffffff,ZIP64_EXTRA_ID:1,ZLIB_NO_COMPRESSION:0,ZLIB_BEST_SPEED:1,ZLIB_BEST_COMPRESSION:9,ZLIB_DEFAULT_COMPRESSION:-1,MODE_MASK:4095,DEFAULT_FILE_MODE:33188,DEFAULT_DIR_MODE:16877,EXT_FILE_ATTR_DIR:0x41ed0010,EXT_FILE_ATTR_FILE:0x81a40020,S_IFMT:61440,S_IFIFO:4096,S_IFCHR:8192,S_IFDIR:16384,S_IFBLK:24576,S_IFREG:32768,S_IFLNK:40960,S_IFSOCK:49152,S_DOS_A:32,S_DOS_D:16,S_DOS_V:8,S_DOS_S:4,S_DOS_H:2,S_DOS_R:1}},59949:(e,t,r)=>{var i=r(88310),n=e.exports=function(){return this instanceof n?(this.descriptor=!1,this.encryption=!1,this.utf8=!1,this.numberOfShannonFanoTrees=0,this.strongEncryption=!1,this.slidingDictionarySize=0,this):new n};n.prototype.encode=function(){return i.getShortBytes((this.descriptor?8:0)|(this.utf8?2048:0)|(this.encryption?1:0)|(this.strongEncryption?64:0))},n.prototype.parse=function(e,t){var r=i.getShortBytesValue(e,t),s=new n;return s.useDataDescriptor((8&r)!=0),s.useUTF8ForNames((2048&r)!=0),s.useStrongEncryption((64&r)!=0),s.useEncryption((1&r)!=0),s.setSlidingDictionarySize((2&r)!=0?8192:4096),s.setNumberOfShannonFanoTrees((4&r)!=0?3:2),s},n.prototype.setNumberOfShannonFanoTrees=function(e){this.numberOfShannonFanoTrees=e},n.prototype.getNumberOfShannonFanoTrees=function(){return this.numberOfShannonFanoTrees},n.prototype.setSlidingDictionarySize=function(e){this.slidingDictionarySize=e},n.prototype.getSlidingDictionarySize=function(){return this.slidingDictionarySize},n.prototype.useDataDescriptor=function(e){this.descriptor=e},n.prototype.usesDataDescriptor=function(){return this.descriptor},n.prototype.useEncryption=function(e){this.encryption=e},n.prototype.usesEncryption=function(){return this.encryption},n.prototype.useStrongEncryption=function(e){this.strongEncryption=e},n.prototype.usesStrongEncryption=function(){return this.strongEncryption},n.prototype.useUTF8ForNames=function(e){this.utf8=e},n.prototype.usesUTF8ForNames=function(){return this.utf8}},62747:e=>{e.exports={PERM_MASK:4095,FILE_TYPE_FLAG:61440,LINK_FLAG:40960,FILE_FLAG:32768,DIR_FLAG:16384,DEFAULT_LINK_PERM:511,DEFAULT_DIR_PERM:493,DEFAULT_FILE_PERM:420}},88310:e=>{var t=e.exports={};t.dateToDos=function(e,t){var r=(t=t||!1)?e.getFullYear():e.getUTCFullYear();if(r<1980)return 2162688;if(r>=2044)return 0x7f9fbf7d;var i={year:r,month:t?e.getMonth():e.getUTCMonth(),date:t?e.getDate():e.getUTCDate(),hours:t?e.getHours():e.getUTCHours(),minutes:t?e.getMinutes():e.getUTCMinutes(),seconds:t?e.getSeconds():e.getUTCSeconds()};return i.year-1980<<25|i.month+1<<21|i.date<<16|i.hours<<11|i.minutes<<5|i.seconds/2},t.dosToDate=function(e){return new Date((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1)},t.fromDosTime=function(e){return t.dosToDate(e.readUInt32LE(0))},t.getEightBytes=function(e){var t=Buffer.alloc(8);return t.writeUInt32LE(e%0x100000000,0),t.writeUInt32LE(e/0x100000000|0,4),t},t.getShortBytes=function(e){var t=Buffer.alloc(2);return t.writeUInt16LE((65535&e)>>>0,0),t},t.getShortBytesValue=function(e,t){return e.readUInt16LE(t)},t.getLongBytes=function(e){var t=Buffer.alloc(4);return t.writeUInt32LE((0xffffffff&e)>>>0,0),t},t.getLongBytesValue=function(e,t){return e.readUInt32LE(t)},t.toDosTime=function(e){return t.getLongBytes(t.dateToDos(e))}},63357:(e,t,r)=>{var i=r(28354).inherits,n=r(13498),s=r(79035),a=r(59949),o=r(62747),l=r(1277),u=r(88310),c=e.exports=function(e){if(!(this instanceof c))return new c(e);s.call(this),this.platform=l.PLATFORM_FAT,this.method=-1,this.name=null,this.size=0,this.csize=0,this.gpb=new a,this.crc=0,this.time=-1,this.minver=l.MIN_VERSION_INITIAL,this.mode=-1,this.extra=null,this.exattr=0,this.inattr=0,this.comment=null,e&&this.setName(e)};i(c,s),c.prototype.getCentralDirectoryExtra=function(){return this.getExtra()},c.prototype.getComment=function(){return null!==this.comment?this.comment:""},c.prototype.getCompressedSize=function(){return this.csize},c.prototype.getCrc=function(){return this.crc},c.prototype.getExternalAttributes=function(){return this.exattr},c.prototype.getExtra=function(){return null!==this.extra?this.extra:l.EMPTY},c.prototype.getGeneralPurposeBit=function(){return this.gpb},c.prototype.getInternalAttributes=function(){return this.inattr},c.prototype.getLastModifiedDate=function(){return this.getTime()},c.prototype.getLocalFileDataExtra=function(){return this.getExtra()},c.prototype.getMethod=function(){return this.method},c.prototype.getName=function(){return this.name},c.prototype.getPlatform=function(){return this.platform},c.prototype.getSize=function(){return this.size},c.prototype.getTime=function(){return -1!==this.time?u.dosToDate(this.time):-1},c.prototype.getTimeDos=function(){return -1!==this.time?this.time:0},c.prototype.getUnixMode=function(){return this.platform!==l.PLATFORM_UNIX?0:this.getExternalAttributes()>>l.SHORT_SHIFT&l.SHORT_MASK},c.prototype.getVersionNeededToExtract=function(){return this.minver},c.prototype.setComment=function(e){Buffer.byteLength(e)!==e.length&&this.getGeneralPurposeBit().useUTF8ForNames(!0),this.comment=e},c.prototype.setCompressedSize=function(e){if(e<0)throw Error("invalid entry compressed size");this.csize=e},c.prototype.setCrc=function(e){if(e<0)throw Error("invalid entry crc32");this.crc=e},c.prototype.setExternalAttributes=function(e){this.exattr=e>>>0},c.prototype.setExtra=function(e){this.extra=e},c.prototype.setGeneralPurposeBit=function(e){if(!(e instanceof a))throw Error("invalid entry GeneralPurposeBit");this.gpb=e},c.prototype.setInternalAttributes=function(e){this.inattr=e},c.prototype.setMethod=function(e){if(e<0)throw Error("invalid entry compression method");this.method=e},c.prototype.setName=function(e,t=!1){e=n(e,!1).replace(/^\w+:/,"").replace(/^(\.\.\/|\/)+/,""),t&&(e=`/${e}`),Buffer.byteLength(e)!==e.length&&this.getGeneralPurposeBit().useUTF8ForNames(!0),this.name=e},c.prototype.setPlatform=function(e){this.platform=e},c.prototype.setSize=function(e){if(e<0)throw Error("invalid entry size");this.size=e},c.prototype.setTime=function(e,t){if(!(e instanceof Date))throw Error("invalid entry time");this.time=u.dateToDos(e,t)},c.prototype.setUnixMode=function(e){var t;e|=this.isDirectory()?l.S_IFDIR:l.S_IFREG,t=0|(e<<l.SHORT_SHIFT|(this.isDirectory()?l.S_DOS_D:l.S_DOS_A)),this.setExternalAttributes(t),this.mode=e&l.MODE_MASK,this.platform=l.PLATFORM_UNIX},c.prototype.setVersionNeededToExtract=function(e){this.minver=e},c.prototype.isDirectory=function(){return"/"===this.getName().slice(-1)},c.prototype.isUnixSymlink=function(){return(this.getUnixMode()&o.FILE_TYPE_FLAG)===o.LINK_FLAG},c.prototype.isZip64=function(){return this.csize>l.ZIP64_MAGIC||this.size>l.ZIP64_MAGIC}},82005:(e,t,r)=>{var i=r(28354).inherits,n=r(65971),{CRC32Stream:s}=r(40910),{DeflateCRC32Stream:a}=r(40910),o=r(12167);r(63357),r(59949);var l=r(1277);r(96819);var u=r(88310),c=e.exports=function(e){if(!(this instanceof c))return new c(e);e=this.options=this._defaults(e),o.call(this,e),this._entry=null,this._entries=[],this._archive={centralLength:0,centralOffset:0,comment:"",finish:!1,finished:!1,processing:!1,forceZip64:e.forceZip64,forceLocalTime:e.forceLocalTime}};i(c,o),c.prototype._afterAppend=function(e){this._entries.push(e),e.getGeneralPurposeBit().usesDataDescriptor()&&this._writeDataDescriptor(e),this._archive.processing=!1,this._entry=null,this._archive.finish&&!this._archive.finished&&this._finish()},c.prototype._appendBuffer=function(e,t,r){0===t.length&&e.setMethod(l.METHOD_STORED);var i=e.getMethod();if(i===l.METHOD_STORED&&(e.setSize(t.length),e.setCompressedSize(t.length),e.setCrc(n.unsigned(t))),this._writeLocalFileHeader(e),i===l.METHOD_STORED){this.write(t),this._afterAppend(e),r(null,e);return}if(i===l.METHOD_DEFLATED){this._smartStream(e,r).end(t);return}r(Error("compression method "+i+" not implemented"))},c.prototype._appendStream=function(e,t,r){e.getGeneralPurposeBit().useDataDescriptor(!0),e.setVersionNeededToExtract(l.MIN_VERSION_DATA_DESCRIPTOR),this._writeLocalFileHeader(e);var i=this._smartStream(e,r);t.once("error",function(e){i.emit("error",e),i.end()}),t.pipe(i)},c.prototype._defaults=function(e){return"object"!=typeof e&&(e={}),"object"!=typeof e.zlib&&(e.zlib={}),"number"!=typeof e.zlib.level&&(e.zlib.level=l.ZLIB_BEST_SPEED),e.forceZip64=!!e.forceZip64,e.forceLocalTime=!!e.forceLocalTime,e},c.prototype._finish=function(){this._archive.centralOffset=this.offset,this._entries.forEach((function(e){this._writeCentralFileHeader(e)}).bind(this)),this._archive.centralLength=this.offset-this._archive.centralOffset,this.isZip64()&&this._writeCentralDirectoryZip64(),this._writeCentralDirectoryEnd(),this._archive.processing=!1,this._archive.finish=!0,this._archive.finished=!0,this.end()},c.prototype._normalizeEntry=function(e){-1===e.getMethod()&&e.setMethod(l.METHOD_DEFLATED),e.getMethod()===l.METHOD_DEFLATED&&(e.getGeneralPurposeBit().useDataDescriptor(!0),e.setVersionNeededToExtract(l.MIN_VERSION_DATA_DESCRIPTOR)),-1===e.getTime()&&e.setTime(new Date,this._archive.forceLocalTime),e._offsets={file:0,data:0,contents:0}},c.prototype._smartStream=function(e,t){var r=e.getMethod()===l.METHOD_DEFLATED?new a(this.options.zlib):new s,i=null;return r.once("end",(function(){var n=r.digest().readUInt32BE(0);e.setCrc(n),e.setSize(r.size()),e.setCompressedSize(r.size(!0)),this._afterAppend(e),t(i,e)}).bind(this)),r.once("error",function(e){i=e}),r.pipe(this,{end:!1}),r},c.prototype._writeCentralDirectoryEnd=function(){var e=this._entries.length,t=this._archive.centralLength,r=this._archive.centralOffset;this.isZip64()&&(e=l.ZIP64_MAGIC_SHORT,t=l.ZIP64_MAGIC,r=l.ZIP64_MAGIC),this.write(u.getLongBytes(l.SIG_EOCD)),this.write(l.SHORT_ZERO),this.write(l.SHORT_ZERO),this.write(u.getShortBytes(e)),this.write(u.getShortBytes(e)),this.write(u.getLongBytes(t)),this.write(u.getLongBytes(r));var i=this.getComment(),n=Buffer.byteLength(i);this.write(u.getShortBytes(n)),this.write(i)},c.prototype._writeCentralDirectoryZip64=function(){this.write(u.getLongBytes(l.SIG_ZIP64_EOCD)),this.write(u.getEightBytes(44)),this.write(u.getShortBytes(l.MIN_VERSION_ZIP64)),this.write(u.getShortBytes(l.MIN_VERSION_ZIP64)),this.write(l.LONG_ZERO),this.write(l.LONG_ZERO),this.write(u.getEightBytes(this._entries.length)),this.write(u.getEightBytes(this._entries.length)),this.write(u.getEightBytes(this._archive.centralLength)),this.write(u.getEightBytes(this._archive.centralOffset)),this.write(u.getLongBytes(l.SIG_ZIP64_EOCD_LOC)),this.write(l.LONG_ZERO),this.write(u.getEightBytes(this._archive.centralOffset+this._archive.centralLength)),this.write(u.getLongBytes(1))},c.prototype._writeCentralFileHeader=function(e){var t=e.getGeneralPurposeBit(),r=e.getMethod(),i=e._offsets,n=e.getSize(),s=e.getCompressedSize();if(e.isZip64()||i.file>l.ZIP64_MAGIC){n=l.ZIP64_MAGIC,s=l.ZIP64_MAGIC,e.setVersionNeededToExtract(l.MIN_VERSION_ZIP64);var a=Buffer.concat([u.getShortBytes(l.ZIP64_EXTRA_ID),u.getShortBytes(24),u.getEightBytes(e.getSize()),u.getEightBytes(e.getCompressedSize()),u.getEightBytes(i.file)],28);e.setExtra(a)}this.write(u.getLongBytes(l.SIG_CFH)),this.write(u.getShortBytes(e.getPlatform()<<8|l.VERSION_MADEBY)),this.write(u.getShortBytes(e.getVersionNeededToExtract())),this.write(t.encode()),this.write(u.getShortBytes(r)),this.write(u.getLongBytes(e.getTimeDos())),this.write(u.getLongBytes(e.getCrc())),this.write(u.getLongBytes(s)),this.write(u.getLongBytes(n));var o=e.getName(),c=e.getComment(),h=e.getCentralDirectoryExtra();t.usesUTF8ForNames()&&(o=Buffer.from(o),c=Buffer.from(c)),this.write(u.getShortBytes(o.length)),this.write(u.getShortBytes(h.length)),this.write(u.getShortBytes(c.length)),this.write(l.SHORT_ZERO),this.write(u.getShortBytes(e.getInternalAttributes())),this.write(u.getLongBytes(e.getExternalAttributes())),i.file>l.ZIP64_MAGIC?this.write(u.getLongBytes(l.ZIP64_MAGIC)):this.write(u.getLongBytes(i.file)),this.write(o),this.write(h),this.write(c)},c.prototype._writeDataDescriptor=function(e){this.write(u.getLongBytes(l.SIG_DD)),this.write(u.getLongBytes(e.getCrc())),e.isZip64()?(this.write(u.getEightBytes(e.getCompressedSize())),this.write(u.getEightBytes(e.getSize()))):(this.write(u.getLongBytes(e.getCompressedSize())),this.write(u.getLongBytes(e.getSize())))},c.prototype._writeLocalFileHeader=function(e){var t=e.getGeneralPurposeBit(),r=e.getMethod(),i=e.getName(),n=e.getLocalFileDataExtra();e.isZip64()&&(t.useDataDescriptor(!0),e.setVersionNeededToExtract(l.MIN_VERSION_ZIP64)),t.usesUTF8ForNames()&&(i=Buffer.from(i)),e._offsets.file=this.offset,this.write(u.getLongBytes(l.SIG_LFH)),this.write(u.getShortBytes(e.getVersionNeededToExtract())),this.write(t.encode()),this.write(u.getShortBytes(r)),this.write(u.getLongBytes(e.getTimeDos())),e._offsets.data=this.offset,t.usesDataDescriptor()?(this.write(l.LONG_ZERO),this.write(l.LONG_ZERO),this.write(l.LONG_ZERO)):(this.write(u.getLongBytes(e.getCrc())),this.write(u.getLongBytes(e.getCompressedSize())),this.write(u.getLongBytes(e.getSize()))),this.write(u.getShortBytes(i.length)),this.write(u.getShortBytes(n.length)),this.write(i),this.write(n),e._offsets.contents=this.offset},c.prototype.getComment=function(e){return null!==this._archive.comment?this._archive.comment:""},c.prototype.isZip64=function(){return this._archive.forceZip64||this._entries.length>l.ZIP64_MAGIC_SHORT||this._archive.centralLength>l.ZIP64_MAGIC||this._archive.centralOffset>l.ZIP64_MAGIC},c.prototype.setComment=function(e){this._archive.comment=e}},63971:(e,t,r)=>{e.exports={ArchiveEntry:r(79035),ZipArchiveEntry:r(63357),ArchiveOutputStream:r(12167),ZipArchiveOutputStream:r(82005)}},96819:(e,t,r)=>{var i=r(27910).Stream,n=r(68280).PassThrough,s=e.exports={};s.isStream=function(e){return e instanceof i},s.normalizeInputSource=function(e){if(null===e)return Buffer.alloc(0);if("string"==typeof e)return Buffer.from(e);if(s.isStream(e)&&!e._readableState){var t=new n;return e.pipe(t),t}return e}},11092:e=>{e.exports=function(e,r){for(var i=[],n=0;n<e.length;n++){var s=r(e[n],n);t(s)?i.push.apply(i,s):i.push(s)}return i};var t=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},11225:(e,t,r)=>{function i(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===i(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===i(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===i(e)},t.isError=function(e){return"[object Error]"===i(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(79428).Buffer.isBuffer},30515:(e,t)=>{!function(e){"undefined"==typeof DO_NOT_EXPORT_CRC?e(t):e({})}(function(e){e.version="1.2.2";var t=function(){for(var e=0,t=Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1,t[r]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),r=function(e){var t=0,r=0,i=0,n="undefined"!=typeof Int32Array?new Int32Array(4096):Array(4096);for(i=0;256!=i;++i)n[i]=e[i];for(i=0;256!=i;++i)for(r=e[i],t=256+i;t<4096;t+=256)r=n[t]=r>>>8^e[255&r];var s=[];for(i=1;16!=i;++i)s[i-1]="undefined"!=typeof Int32Array?n.subarray(256*i,256*i+256):n.slice(256*i,256*i+256);return s}(t),i=r[0],n=r[1],s=r[2],a=r[3],o=r[4],l=r[5],u=r[6],c=r[7],h=r[8],d=r[9],p=r[10],f=r[11],m=r[12],g=r[13],y=r[14];e.table=t,e.bstr=function(e,r){for(var i=-1^r,n=0,s=e.length;n<s;)i=i>>>8^t[(i^e.charCodeAt(n++))&255];return~i},e.buf=function(e,r){for(var v=-1^r,b=e.length-15,w=0;w<b;)v=y[e[w++]^255&v]^g[e[w++]^v>>8&255]^m[e[w++]^v>>16&255]^f[e[w++]^v>>>24]^p[e[w++]]^d[e[w++]]^h[e[w++]]^c[e[w++]]^u[e[w++]]^l[e[w++]]^o[e[w++]]^a[e[w++]]^s[e[w++]]^n[e[w++]]^i[e[w++]]^t[e[w++]];for(b+=15;w<b;)v=v>>>8^t[(v^e[w++])&255];return~v},e.str=function(e,r){for(var i=-1^r,n=0,s=e.length,a=0,o=0;n<s;)(a=e.charCodeAt(n++))<128?i=i>>>8^t[(i^a)&255]:a<2048?i=(i=i>>>8^t[(i^(192|a>>6&31))&255])>>>8^t[(i^(128|63&a))&255]:a>=55296&&a<57344?(a=(1023&a)+64,o=1023&e.charCodeAt(n++),i=(i=(i=(i=i>>>8^t[(i^(240|a>>8&7))&255])>>>8^t[(i^(128|a>>2&63))&255])>>>8^t[(i^(128|o>>6&15|(3&a)<<4))&255])>>>8^t[(i^(128|63&o))&255]):i=(i=(i=i>>>8^t[(i^(224|a>>12&15))&255])>>>8^t[(i^(128|a>>6&63))&255])>>>8^t[(i^(128|63&a))&255];return~i}})},55922:(e,t,r)=>{"use strict";let{Transform:i}=r(68280),n=r(30515);class s extends i{constructor(e){super(e),this.checksum=Buffer.allocUnsafe(4),this.checksum.writeInt32BE(0,0),this.rawSize=0}_transform(e,t,r){e&&(this.checksum=n.buf(e,this.checksum)>>>0,this.rawSize+=e.length),r(null,e)}digest(e){let t=Buffer.allocUnsafe(4);return t.writeUInt32BE(this.checksum>>>0,0),e?t.toString(e):t}hex(){return this.digest("hex").toUpperCase()}size(){return this.rawSize}}e.exports=s},8396:(e,t,r)=>{"use strict";let{DeflateRaw:i}=r(74075),n=r(30515);class s extends i{constructor(e){super(e),this.checksum=Buffer.allocUnsafe(4),this.checksum.writeInt32BE(0,0),this.rawSize=0,this.compressedSize=0}push(e,t){return e&&(this.compressedSize+=e.length),super.push(e,t)}_transform(e,t,r){e&&(this.checksum=n.buf(e,this.checksum)>>>0,this.rawSize+=e.length),super._transform(e,t,r)}digest(e){let t=Buffer.allocUnsafe(4);return t.writeUInt32BE(this.checksum>>>0,0),e?t.toString(e):t}hex(){return this.digest("hex").toUpperCase()}size(e=!1){return e?this.compressedSize:this.rawSize}}e.exports=s},40910:(e,t,r)=>{"use strict";e.exports={CRC32Stream:r(55922),DeflateCRC32Stream:r(8396)}},11307:function(e){var t;t=function(){"use strict";var e="millisecond",t="second",r="minute",i="hour",n="week",s="month",a="quarter",o="year",l="date",u="Invalid Date",c=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(e,t,r){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(r)+e},p="en",f={};f[p]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||"th")+"]"}};var m="$isDayjsObject",g=function(e){return e instanceof w||!(!e||!e[m])},y=function e(t,r,i){var n;if(!t)return p;if("string"==typeof t){var s=t.toLowerCase();f[s]&&(n=s),r&&(f[s]=r,n=s);var a=t.split("-");if(!n&&a.length>1)return e(a[0])}else{var o=t.name;f[o]=t,n=o}return!i&&n&&(p=n),n||!i&&p},v=function(e,t){if(g(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new w(r)},b={s:d,z:function(e){var t=-e.utcOffset(),r=Math.abs(t);return(t<=0?"+":"-")+d(Math.floor(r/60),2,"0")+":"+d(r%60,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var i=12*(r.year()-t.year())+(r.month()-t.month()),n=t.clone().add(i,s),a=r-n<0,o=t.clone().add(i+(a?-1:1),s);return+(-(i+(r-n)/(a?n-o:o-n))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(u){return({M:s,y:o,w:n,d:"day",D:l,h:i,m:r,s:t,ms:e,Q:a})[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}};b.l=y,b.i=g,b.w=function(e,t){return v(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var w=function(){function d(e){this.$L=y(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[m]=!0}var p=d.prototype;return p.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(b.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(c);if(i){var n=i[2]-1||0,s=(i[7]||"0").substring(0,3);return r?new Date(Date.UTC(i[1],n,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)):new Date(i[1],n,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)}}return new Date(t)}(e),this.init()},p.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},p.$utils=function(){return b},p.isValid=function(){return this.$d.toString()!==u},p.isSame=function(e,t){var r=v(e);return this.startOf(t)<=r&&r<=this.endOf(t)},p.isAfter=function(e,t){return v(e)<this.startOf(t)},p.isBefore=function(e,t){return this.endOf(t)<v(e)},p.$g=function(e,t,r){return b.u(e)?this[t]:this.set(r,e)},p.unix=function(){return Math.floor(this.valueOf()/1e3)},p.valueOf=function(){return this.$d.getTime()},p.startOf=function(e,a){var u=this,c=!!b.u(a)||a,h=b.p(e),d=function(e,t){var r=b.w(u.$u?Date.UTC(u.$y,t,e):new Date(u.$y,t,e),u);return c?r:r.endOf("day")},p=function(e,t){return b.w(u.toDate()[e].apply(u.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),u)},f=this.$W,m=this.$M,g=this.$D,y="set"+(this.$u?"UTC":"");switch(h){case o:return c?d(1,0):d(31,11);case s:return c?d(1,m):d(0,m+1);case n:var v=this.$locale().weekStart||0,w=(f<v?f+7:f)-v;return d(c?g-w:g+(6-w),m);case"day":case l:return p(y+"Hours",0);case i:return p(y+"Minutes",1);case r:return p(y+"Seconds",2);case t:return p(y+"Milliseconds",3);default:return this.clone()}},p.endOf=function(e){return this.startOf(e,!1)},p.$set=function(n,a){var u,c=b.p(n),h="set"+(this.$u?"UTC":""),d=((u={}).day=h+"Date",u[l]=h+"Date",u[s]=h+"Month",u[o]=h+"FullYear",u[i]=h+"Hours",u[r]=h+"Minutes",u[t]=h+"Seconds",u[e]=h+"Milliseconds",u)[c],p="day"===c?this.$D+(a-this.$W):a;if(c===s||c===o){var f=this.clone().set(l,1);f.$d[d](p),f.init(),this.$d=f.set(l,Math.min(this.$D,f.daysInMonth())).$d}else d&&this.$d[d](p);return this.init(),this},p.set=function(e,t){return this.clone().$set(e,t)},p.get=function(e){return this[b.p(e)]()},p.add=function(e,a){var l,u=this;e=Number(e);var c=b.p(a),h=function(t){var r=v(u);return b.w(r.date(r.date()+Math.round(t*e)),u)};if(c===s)return this.set(s,this.$M+e);if(c===o)return this.set(o,this.$y+e);if("day"===c)return h(1);if(c===n)return h(7);var d=((l={})[r]=6e4,l[i]=36e5,l[t]=1e3,l)[c]||1,p=this.$d.getTime()+e*d;return b.w(p,this)},p.subtract=function(e,t){return this.add(-1*e,t)},p.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||u;var i=e||"YYYY-MM-DDTHH:mm:ssZ",n=b.z(this),s=this.$H,a=this.$m,o=this.$M,l=r.weekdays,c=r.months,d=r.meridiem,p=function(e,r,n,s){return e&&(e[r]||e(t,i))||n[r].slice(0,s)},f=function(e){return b.s(s%12||12,e,"0")},m=d||function(e,t,r){var i=e<12?"AM":"PM";return r?i.toLowerCase():i};return i.replace(h,function(e,i){return i||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return b.s(t.$y,4,"0");case"M":return o+1;case"MM":return b.s(o+1,2,"0");case"MMM":return p(r.monthsShort,o,c,3);case"MMMM":return p(c,o);case"D":return t.$D;case"DD":return b.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return p(r.weekdaysMin,t.$W,l,2);case"ddd":return p(r.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(s);case"HH":return b.s(s,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return m(s,a,!0);case"A":return m(s,a,!1);case"m":return String(a);case"mm":return b.s(a,2,"0");case"s":return String(t.$s);case"ss":return b.s(t.$s,2,"0");case"SSS":return b.s(t.$ms,3,"0");case"Z":return n}return null}(e)||n.replace(":","")})},p.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},p.diff=function(e,l,u){var c,h=this,d=b.p(l),p=v(e),f=(p.utcOffset()-this.utcOffset())*6e4,m=this-p,g=function(){return b.m(h,p)};switch(d){case o:c=g()/12;break;case s:c=g();break;case a:c=g()/3;break;case n:c=(m-f)/6048e5;break;case"day":c=(m-f)/864e5;break;case i:c=m/36e5;break;case r:c=m/6e4;break;case t:c=m/1e3;break;default:c=m}return u?c:b.a(c)},p.daysInMonth=function(){return this.endOf(s).$D},p.$locale=function(){return f[this.$L]},p.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),i=y(e,t,!0);return i&&(r.$L=i),r},p.clone=function(){return b.w(this.$d,this)},p.toDate=function(){return new Date(this.valueOf())},p.toJSON=function(){return this.isValid()?this.toISOString():null},p.toISOString=function(){return this.$d.toISOString()},p.toString=function(){return this.$d.toUTCString()},d}(),x=w.prototype;return v.prototype=x,[["$ms",e],["$s",t],["$m",r],["$H",i],["$W","day"],["$M",s],["$y",o],["$D",l]].forEach(function(e){x[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),v.extend=function(e,t){return e.$i||(e(t,w,v),e.$i=!0),v},v.locale=y,v.isDayjs=g,v.unix=function(e){return v(1e3*e)},v.en=f[p],v.Ls=f,v.p={},v},e.exports=t()},59023:function(e){var t;t=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d/,i=/\d\d/,n=/\d\d?/,s=/\d*[^-_:/,()\s\d]+/,a={},o=function(e){return(e=+e)+(e>68?1900:2e3)},l=function(e){return function(t){this[e]=+t}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e||"Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return 0===r?0:"+"===t[0]?-r:r}(e)}],c=function(e){var t=a[e];return t&&(t.indexOf?t:t.s.concat(t.f))},h=function(e,t){var r,i=a.meridiem;if(i){for(var n=1;n<=24;n+=1)if(e.indexOf(i(n,0,t))>-1){r=n>12;break}}else r=e===(t?"pm":"PM");return r},d={A:[s,function(e){this.afternoon=h(e,!1)}],a:[s,function(e){this.afternoon=h(e,!0)}],Q:[r,function(e){this.month=3*(e-1)+1}],S:[r,function(e){this.milliseconds=100*+e}],SS:[i,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[n,l("seconds")],ss:[n,l("seconds")],m:[n,l("minutes")],mm:[n,l("minutes")],H:[n,l("hours")],h:[n,l("hours")],HH:[n,l("hours")],hh:[n,l("hours")],D:[n,l("day")],DD:[i,l("day")],Do:[s,function(e){var t=a.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var i=1;i<=31;i+=1)t(i).replace(/\[|\]/g,"")===e&&(this.day=i)}],w:[n,l("week")],ww:[i,l("week")],M:[n,l("month")],MM:[i,l("month")],MMM:[s,function(e){var t=c("months"),r=(c("monthsShort")||t.map(function(e){return e.slice(0,3)})).indexOf(e)+1;if(r<1)throw Error();this.month=r%12||r}],MMMM:[s,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw Error();this.month=t%12||t}],Y:[/[+-]?\d+/,l("year")],YY:[i,function(e){this.year=o(e)}],YYYY:[/\d{4}/,l("year")],Z:u,ZZ:u};return function(r,i,n){n.p.customParseFormat=!0,r&&r.parseTwoDigitYear&&(o=r.parseTwoDigitYear);var s=i.prototype,l=s.parse;s.parse=function(r){var i=r.date,s=r.utc,o=r.args;this.$u=s;var u=o[1];if("string"==typeof u){var c=!0===o[2],h=!0===o[3],p=o[2];h&&(p=o[2]),a=this.$locale(),!c&&p&&(a=n.Ls[p]),this.$d=function(r,i,n,s){try{if(["x","X"].indexOf(i)>-1)return new Date(("X"===i?1e3:1)*r);var o=(function(r){var i,n;i=r,n=a&&a.formats;for(var s=(r=i.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(t,r,i){var s=i&&i.toUpperCase();return r||n[i]||e[i]||n[s].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(e,t,r){return t||r.slice(1)})})).match(t),o=s.length,l=0;l<o;l+=1){var u=s[l],c=d[u],h=c&&c[0],p=c&&c[1];s[l]=p?{regex:h,parser:p}:u.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,i=0;r<o;r+=1){var n=s[r];if("string"==typeof n)i+=n.length;else{var a=n.regex,l=n.parser,u=e.slice(i),c=a.exec(u)[0];l.call(t,c),e=e.replace(c,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var r=e.hours;t?r<12&&(e.hours+=12):12===r&&(e.hours=0),delete e.afternoon}}(t),t}})(i)(r),l=o.year,u=o.month,c=o.day,h=o.hours,p=o.minutes,f=o.seconds,m=o.milliseconds,g=o.zone,y=o.week,v=new Date,b=c||(l||u?1:v.getDate()),w=l||v.getFullYear(),x=0;l&&!u||(x=u>0?u-1:v.getMonth());var S,E=h||0,T=p||0,k=f||0,O=m||0;return g?new Date(Date.UTC(w,x,b,E,T,k,O+60*g.offset*1e3)):n?new Date(Date.UTC(w,x,b,E,T,k,O)):(S=new Date(w,x,b,E,T,k,O),y&&(S=s(S).week(y).toDate()),S)}catch(e){return new Date("")}}(i,u,s,n),this.init(),p&&!0!==p&&(this.$L=this.locale(p).$L),(c||h)&&i!=this.format(u)&&(this.$d=new Date("")),a={}}else if(u instanceof Array)for(var f=u.length,m=1;m<=f;m+=1){o[1]=u[m-1];var g=n.apply(this,o);if(g.isValid()){this.$d=g.$d,this.$L=g.$L,this.init();break}m===f&&(this.$d=new Date(""))}else l.call(this,r)}}},e.exports=t()},26732:function(e){var t;t=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(i,n,s){var a=n.prototype;s.utc=function(e){var t={date:e,utc:!0,args:arguments};return new n(t)},a.utc=function(t){var r=s(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},a.local=function(){return s(this.toDate(),{locale:this.$L,utc:!1})};var o=a.parse;a.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),o.call(this,e)};var l=a.init;a.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var u=a.utcOffset;a.utcOffset=function(i,n){var s=this.$utils().u;if(s(i))return this.$u?0:s(this.$offset)?u.call(this):this.$offset;if("string"==typeof i&&null===(i=function(e){void 0===e&&(e="");var i=e.match(t);if(!i)return null;var n=(""+i[0]).match(r)||["-",0,0],s=n[0],a=60*+n[1]+ +n[2];return 0===a?0:"+"===s?a:-a}(i)))return this;var a=16>=Math.abs(i)?60*i:i;if(0===a)return this.utc(n);var o=this.clone();if(n)return o.$offset=a,o.$u=!1,o;var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(o=this.local().add(a+l,e)).$offset=a,o.$x.$localOffset=l,o};var c=a.format;a.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return c.call(this,t)},a.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var h=a.toDate;a.toDate=function(e){return"s"===e&&this.$offset?s(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():h.call(this)};var d=a.diff;a.diff=function(e,t,r){if(e&&this.$u===e.$u)return d.call(this,e,t,r);var i=this.local(),n=s(e).local();return d.call(i,n,t,r)}}},e.exports=t()},67412:(e,t,r)=>{"use strict";var i=r(32662);function n(e,t,r){void 0===r&&(r=t,t=e,e=null),i.Duplex.call(this,e),"function"!=typeof r.read&&(r=new i.Readable(e).wrap(r)),this._writable=t,this._readable=r,this._waiting=!1;var n=this;t.once("finish",function(){n.end()}),this.once("finish",function(){t.end()}),r.on("readable",function(){n._waiting&&(n._waiting=!1,n._read())}),r.once("end",function(){n.push(null)}),(!e||void 0===e.bubbleErrors||e.bubbleErrors)&&(t.on("error",function(e){n.emit("error",e)}),r.on("error",function(e){n.emit("error",e)}))}n.prototype=Object.create(i.Duplex.prototype,{constructor:{value:n}}),n.prototype._write=function(e,t,r){this._writable.write(e,t,r)},n.prototype._read=function(){for(var e,t=0;null!==(e=this._readable.read());)this.push(e),t++;0===t&&(this._waiting=!0)},e.exports=function(e,t,r){return new n(e,t,r)},e.exports.DuplexWrapper=n},25879:(e,t,r)=>{var i=r(15075),n=function(){},s=global.Bare?queueMicrotask:process.nextTick.bind(process),a=function(e,t,r){if("function"==typeof t)return a(e,null,t);t||(t={}),r=i(r||n);var o=e._writableState,l=e._readableState,u=t.readable||!1!==t.readable&&e.readable,c=t.writable||!1!==t.writable&&e.writable,h=!1,d=function(){e.writable||p()},p=function(){c=!1,u||r.call(e)},f=function(){u=!1,c||r.call(e)},m=function(t){r.call(e,t?Error("exited with error code: "+t):null)},g=function(t){r.call(e,t)},y=function(){s(v)},v=function(){if(!h&&(u&&!(l&&l.ended&&!l.destroyed)||c&&!(o&&o.ended&&!o.destroyed)))return r.call(e,Error("premature close"))},b=function(){e.req.on("finish",p)};return e.setHeader&&"function"==typeof e.abort?(e.on("complete",p),e.on("abort",y),e.req?b():e.on("request",b)):c&&!o&&(e.on("end",d),e.on("close",d)),e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length&&e.on("exit",m),e.on("end",f),e.on("finish",p),!1!==t.error&&e.on("error",g),e.on("close",y),function(){h=!0,e.removeListener("complete",p),e.removeListener("abort",y),e.removeListener("request",b),e.req&&e.req.removeListener("finish",p),e.removeListener("end",d),e.removeListener("close",d),e.removeListener("finish",p),e.removeListener("exit",m),e.removeListener("end",f),e.removeListener("error",g),e.removeListener("close",y)}};e.exports=a},69872:(e,t,r)=>{if(10>parseInt(process.versions.node.split(".")[0],10))throw Error("For node versions older than 10, please use the ES5 Import: https://github.com/exceljs/exceljs#es5-imports");e.exports=r(90962)},98676:(e,t,r)=>{let i=r(29021),n=r(78154),s=r(59023),a=r(26732),o=r(11307).extend(s).extend(a),l=r(53881),{fs:{exists:u}}=r(86968),c={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};class h{constructor(e){this.workbook=e,this.worksheet=null}async readFile(e,t){if(t=t||{},!await u(e))throw Error(`File not found: ${e}`);let r=i.createReadStream(e),n=await this.read(r,t);return r.close(),n}read(e,t){return t=t||{},new Promise((r,i)=>{let s=this.workbook.addWorksheet(t.sheetName),a=t.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],l=t.map||function(e){if(""===e)return null;let t=Number(e);if(!Number.isNaN(t)&&t!==1/0)return t;let r=a.reduce((t,r)=>{if(t)return t;let i=o(e,r,!0);return i.isValid()?i:null},null);if(r)return new Date(r.valueOf());let i=c[e];return void 0!==i?i:e},u=n.parse(t.parserOptions).on("data",e=>{s.addRow(e.map(l))}).on("end",()=>{u.emit("worksheet",s)});u.on("worksheet",r).on("error",i),e.pipe(u)})}createInputStream(){throw Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(e,t){return new Promise((r,i)=>{t=t||{};let s=this.workbook.getWorksheet(t.sheetName||t.sheetId),a=n.format(t.formatterOptions);e.on("finish",()=>{r()}),a.on("error",i),a.pipe(e);let{dateFormat:l,dateUTC:u}=t,c=t.map||(e=>{if(e){if(e.text||e.hyperlink)return e.hyperlink||e.text||"";if(e.formula||e.result)return e.result||"";if(e instanceof Date)return l?u?o.utc(e).format(l):o(e).format(l):u?o.utc(e).format():o(e).format();if(e.error)return e.error;if("object"==typeof e)return JSON.stringify(e)}return e}),h=void 0===t.includeEmptyRows||t.includeEmptyRows,d=1;s&&s.eachRow((e,t)=>{if(h)for(;d++<t-1;)a.write([]);let{values:r}=e;r.shift(),a.write(r.map(c)),d=t}),a.end()})}writeFile(e,t){let r={encoding:(t=t||{}).encoding||"utf8"},n=i.createWriteStream(e,r);return this.write(n,t)}async writeBuffer(e){let t=new l;return await this.write(t,e),t.read()}}e.exports=h},70805:(e,t,r)=>{"use strict";let i=r(62844);class n{constructor(e,t,r=0){if(this.worksheet=e,t){if("string"==typeof t){let e=i.decodeAddress(t);this.nativeCol=e.col+r,this.nativeColOff=0,this.nativeRow=e.row+r,this.nativeRowOff=0}else void 0!==t.nativeCol?(this.nativeCol=t.nativeCol||0,this.nativeColOff=t.nativeColOff||0,this.nativeRow=t.nativeRow||0,this.nativeRowOff=t.nativeRowOff||0):void 0!==t.col?(this.col=t.col+r,this.row=t.row+r):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0)}else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(e){return e instanceof n||null==e?e:new n(e)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(e){this.nativeCol=Math.floor(e),this.nativeColOff=Math.floor((e-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(e){this.nativeRow=Math.floor(e),this.nativeRowOff=Math.floor((e-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(e){this.nativeCol=e.nativeCol,this.nativeColOff=e.nativeColOff,this.nativeRow=e.nativeRow,this.nativeRowOff=e.nativeRowOff}}e.exports=n},15060:(e,t,r)=>{let i=r(62844),n=r(29536),s=r(98672),{slideFormula:a}=r(83479),o=r(83200);class l{constructor(e,t,r){if(!e||!t)throw Error("A Cell needs a Row");this._row=e,this._column=t,i.validateAddress(r),this._address=r,this._value=x.create(l.Types.Null,this),this.style=this._mergeStyle(e.style,t.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(e){this.style.numFmt=e}get font(){return this.style.font}set font(e){this.style.font=e}get alignment(){return this.style.alignment}set alignment(e){this.style.alignment=e}get border(){return this.style.border}set border(e){this.style.border=e}get fill(){return this.style.fill}set fill(e){this.style.fill=e}get protection(){return this.style.protection}set protection(e){this.style.protection=e}_mergeStyle(e,t,r){let i=e&&e.numFmt||t&&t.numFmt;i&&(r.numFmt=i);let n=e&&e.font||t&&t.font;n&&(r.font=n);let s=e&&e.alignment||t&&t.alignment;s&&(r.alignment=s);let a=e&&e.border||t&&t.border;a&&(r.border=a);let o=e&&e.fill||t&&t.fill;o&&(r.fill=o);let l=e&&e.protection||t&&t.protection;return l&&(r.protection=l),r}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===l.Types.Merge}merge(e,t){this._value.release(),this._value=x.create(l.Types.Merge,this,e),t||(this.style=e.style)}unmerge(){this.type===l.Types.Merge&&(this._value.release(),this._value=x.create(l.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(e){return this._value.type===l.Types.Merge&&this._value.isMergedTo(e)}get master(){return this.type===l.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===l.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(e){if(this.type===l.Types.Merge){this._value.master.value=e;return}this._value.release(),this._value=x.create(x.getType(e),this,e)}get note(){return this._comment&&this._comment.note}set note(e){this._comment=new o(e)}get text(){return this._value.toString()}get html(){return n.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(e){this.type===l.Types.String&&(this._value=x.create(l.Types.Hyperlink,this,{text:this._value.value,hyperlink:e}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){let{worksheet:e}=this._row;return{sheetName:e.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(e){this.names=[e]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(e){let{definedNames:t}=this.workbook;t.removeAllNames(this.fullAddress),e.forEach(e=>{t.addEx(this.fullAddress,e)})}addName(e){this.workbook.definedNames.addEx(this.fullAddress,e)}removeName(e){this.workbook.definedNames.removeEx(this.fullAddress,e)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(e){this._dataValidations.add(this.address,e)}get model(){let{model:e}=this._value;return e.style=this.style,this._comment&&(e.comment=this._comment.model),e}set model(e){this._value.release(),this._value=x.create(e.type,this),this._value.model=e,e.comment&&"note"===e.comment.type&&(this._comment=o.fromModel(e.comment)),e.style?this.style=e.style:this.style={}}}l.Types=s.ValueType;class u{constructor(e){this.model={address:e.address,type:l.Types.Null}}get value(){return null}set value(e){}get type(){return l.Types.Null}get effectiveType(){return l.Types.Null}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return""}release(){}toString(){return""}}class c{constructor(e,t){this.model={address:e.address,type:l.Types.Number,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Number}get effectiveType(){return l.Types.Number}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}class h{constructor(e,t){this.model={address:e.address,type:l.Types.String,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.String}get effectiveType(){return l.Types.String}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}class d{constructor(e,t){this.model={address:e.address,type:l.Types.String,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}toString(){return this.model.value.richText.map(e=>e.text).join("")}get type(){return l.Types.RichText}get effectiveType(){return l.Types.RichText}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}class p{constructor(e,t){this.model={address:e.address,type:l.Types.Date,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Date}get effectiveType(){return l.Types.Date}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}class f{constructor(e,t){this.model={address:e.address,type:l.Types.Hyperlink,text:t?t.text:void 0,hyperlink:t?t.hyperlink:void 0},t&&t.tooltip&&(this.model.tooltip=t.tooltip)}get value(){let e={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(e.tooltip=this.model.tooltip),e}set value(e){this.model={text:e.text,hyperlink:e.hyperlink},e.tooltip&&(this.model.tooltip=e.tooltip)}get text(){return this.model.text}set text(e){this.model.text=e}get hyperlink(){return this.model.hyperlink}set hyperlink(e){this.model.hyperlink=e}get type(){return l.Types.Hyperlink}get effectiveType(){return l.Types.Hyperlink}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}class m{constructor(e,t){this.model={address:e.address,type:l.Types.Merge,master:t?t.address:void 0},this._master=t,t&&t.addMergeRef()}get value(){return this._master.value}set value(e){e instanceof l?(this._master&&this._master.releaseMergeRef(),e.addMergeRef(),this._master=e):this._master.value=e}isMergedTo(e){return e===this._master}get master(){return this._master}get type(){return l.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}class g{constructor(e,t){this.cell=e,this.model={address:e.address,type:l.Types.Formula,shareType:t?t.shareType:void 0,ref:t?t.ref:void 0,formula:t?t.formula:void 0,sharedFormula:t?t.sharedFormula:void 0,result:t?t.result:void 0}}_copyModel(e){let t={},r=r=>{let i=e[r];i&&(t[r]=i)};return r("formula"),r("result"),r("ref"),r("shareType"),r("sharedFormula"),t}get value(){return this._copyModel(this.model)}set value(e){this.model=this._copyModel(e)}validate(e){switch(x.getType(e)){case l.Types.Null:case l.Types.String:case l.Types.Number:case l.Types.Date:break;case l.Types.Hyperlink:case l.Types.Formula:default:throw Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(e){this.model.formula=e}get formulaType(){return this.model.formula?s.FormulaType.Master:this.model.sharedFormula?s.FormulaType.Shared:s.FormulaType.None}get result(){return this.model.result}set result(e){this.model.result=e}get type(){return l.Types.Formula}get effectiveType(){let e=this.model.result;return null==e?s.ValueType.Null:e instanceof String||"string"==typeof e?s.ValueType.String:"number"==typeof e?s.ValueType.Number:e instanceof Date?s.ValueType.Date:e.text&&e.hyperlink?s.ValueType.Hyperlink:e.formula?s.ValueType.Formula:s.ValueType.Null}get address(){return this.model.address}set address(e){this.model.address=e}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){let{worksheet:e}=this.cell,t=e.findCell(this.model.sharedFormula);this._translatedFormula=t&&a(t.formula,t.address,this.model.address)}return this._translatedFormula}toCsvString(){return`${this.model.result||""}`}release(){}toString(){return this.model.result?this.model.result.toString():""}}class y{constructor(e,t){this.model={address:e.address,type:l.Types.SharedString,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.SharedString}get effectiveType(){return l.Types.SharedString}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}class v{constructor(e,t){this.model={address:e.address,type:l.Types.Boolean,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Boolean}get effectiveType(){return l.Types.Boolean}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}class b{constructor(e,t){this.model={address:e.address,type:l.Types.Error,value:t}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return l.Types.Error}get effectiveType(){return l.Types.Error}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}class w{constructor(e,t){this.model={address:e.address,type:l.Types.String,value:JSON.stringify(t),rawValue:t}}get value(){return this.model.rawValue}set value(e){this.model.rawValue=e,this.model.value=JSON.stringify(e)}get type(){return l.Types.String}get effectiveType(){return l.Types.String}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}let x={getType:e=>null==e?l.Types.Null:e instanceof String||"string"==typeof e?l.Types.String:"number"==typeof e?l.Types.Number:"boolean"==typeof e?l.Types.Boolean:e instanceof Date?l.Types.Date:e.text&&e.hyperlink?l.Types.Hyperlink:e.formula||e.sharedFormula?l.Types.Formula:e.richText?l.Types.RichText:e.sharedString?l.Types.SharedString:e.error?l.Types.Error:l.Types.JSON,types:[{t:l.Types.Null,f:u},{t:l.Types.Number,f:c},{t:l.Types.String,f:h},{t:l.Types.Date,f:p},{t:l.Types.Hyperlink,f:f},{t:l.Types.Formula,f:g},{t:l.Types.Merge,f:m},{t:l.Types.JSON,f:w},{t:l.Types.SharedString,f:y},{t:l.Types.RichText,f:d},{t:l.Types.Boolean,f:v},{t:l.Types.Error,f:b}].reduce((e,t)=>(e[t.t]=t.f,e),[]),create(e,t,r){let i=this.types[e];if(!i)throw Error(`Could not create Value of type ${e}`);return new i(t,r)}};e.exports=l},48214:(e,t,r)=>{"use strict";let i=r(29536),n=r(98672),s=r(62844);class a{constructor(e,t,r){this._worksheet=e,this._number=t,!1!==r&&(this.defn=r)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return s.n2l(this._number)}get isCustomWidth(){return void 0!==this.width&&9!==this.width}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(e){e?(this.key=e.key,this.width=void 0!==e.width?e.width:9,this.outlineLevel=e.outlineLevel,e.style?this.style=e.style:this.style={},this.header=e.header,this._hidden=!!e.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(e){void 0!==e?(this._header=e,this.headers.forEach((e,t)=>{this._worksheet.getCell(t+1,this.number).value=e})):this._header=void 0}get key(){return this._key}set key(e){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=e,e&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(e){this._hidden=e}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(e){this._outlineLevel=e}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(e){return this.width===e.width&&this.hidden===e.hidden&&this.outlineLevel===e.outlineLevel&&i.isEqual(this.style,e.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;let e=this.style;return!e||!e.font&&!e.numFmt&&!e.alignment&&!e.border&&!e.fill&&!e.protection}get headerCount(){return this.headers.length}eachCell(e,t){let r=this.number;t||(t=e,e=null),this._worksheet.eachRow(e,(e,i)=>{t(e.getCell(r),i)})}get values(){let e=[];return this.eachCell((t,r)=>{t&&t.type!==n.ValueType.Null&&(e[r]=t.value)}),e}set values(e){if(!e)return;let t=this.number,r=0;e.hasOwnProperty("0")&&(r=1),e.forEach((e,i)=>{this._worksheet.getCell(i+r,t).value=e})}_applyStyle(e,t){return this.style[e]=t,this.eachCell(r=>{r[e]=t}),t}get numFmt(){return this.style.numFmt}set numFmt(e){this._applyStyle("numFmt",e)}get font(){return this.style.font}set font(e){this._applyStyle("font",e)}get alignment(){return this.style.alignment}set alignment(e){this._applyStyle("alignment",e)}get protection(){return this.style.protection}set protection(e){this._applyStyle("protection",e)}get border(){return this.style.border}set border(e){this._applyStyle("border",e)}get fill(){return this.style.fill}set fill(e){this._applyStyle("fill",e)}static toModel(e){let t=[],r=null;return e&&e.forEach((e,i)=>{e.isDefault?r&&(r=null):r&&e.equivalentTo(r)?r.max=i+1:(r={min:i+1,max:i+1,width:void 0!==e.width?e.width:9,style:e.style,isCustomWidth:e.isCustomWidth,hidden:e.hidden,outlineLevel:e.outlineLevel,collapsed:e.collapsed},t.push(r))}),t.length?t:void 0}static fromModel(e,t){let r=[],i=1,n=0;for(t=(t=t||[]).sort(function(e,t){return e.min-t.min});n<t.length;){let s=t[n++];for(;i<s.min;)r.push(new a(e,i++));for(;i<=s.max;)r.push(new a(e,i++,s))}return r.length?r:null}}e.exports=a},98025:e=>{class t{constructor(e){this.model=e||{}}add(e,t){return this.model[e]=t}find(e){return this.model[e]}remove(e){this.model[e]=void 0}}e.exports=t},87702:(e,t,r)=>{"use strict";let i=r(29536),n=r(62844),s=r(21227),a=r(73795),o=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;class l{constructor(){this.matrixMap={}}getMatrix(e){return this.matrixMap[e]||(this.matrixMap[e]=new s)}add(e,t){let r=n.decodeEx(e);this.addEx(r,t)}addEx(e,t){let r=this.getMatrix(t);if(e.top)for(let t=e.left;t<=e.right;t++)for(let i=e.top;i<=e.bottom;i++){let s={sheetName:e.sheetName,address:n.n2l(t)+i,row:i,col:t};r.addCellEx(s)}else r.addCellEx(e)}remove(e,t){let r=n.decodeEx(e);this.removeEx(r,t)}removeEx(e,t){this.getMatrix(t).removeCellEx(e)}removeAllNames(e){i.each(this.matrixMap,t=>{t.removeCellEx(e)})}forEach(e){i.each(this.matrixMap,(t,r)=>{t.forEach(t=>{e(r,t)})})}getNames(e){return this.getNamesEx(n.decodeEx(e))}getNamesEx(e){return i.map(this.matrixMap,(t,r)=>t.findCellEx(e)&&r).filter(Boolean)}_explore(e,t){let r,i;t.mark=!1;let{sheetName:n}=t,s=new a(t.row,t.col,t.row,t.col,n);function o(r,i){let a=e.findCellAt(n,r,t.col);return!!a&&!!a.mark&&(s[i]=r,a.mark=!1,!0)}for(i=t.row-1;o(i,"top");i--);for(i=t.row+1;o(i,"bottom");i++);function l(t,r){let a=[];for(i=s.top;i<=s.bottom;i++){let r=e.findCellAt(n,i,t);if(!r||!r.mark)return!1;a.push(r)}s[r]=t;for(let e=0;e<a.length;e++)a[e].mark=!1;return!0}for(r=t.col-1;l(r,"left");r--);for(r=t.col+1;l(r,"right");r++);return s}getRanges(e,t){return(t=t||this.matrixMap[e])?(t.forEach(e=>{e.mark=!0}),{name:e,ranges:t.map(e=>e.mark&&this._explore(t,e)).filter(Boolean).map(e=>e.$shortRange)}):{name:e,ranges:[]}}normaliseMatrix(e,t){e.forEachInSheet(t,(e,t,r)=>{e&&(e.row!==t||e.col!==r)&&(e.row=t,e.col=r,e.address=n.n2l(r)+t)})}spliceRows(e,t,r,n){i.each(this.matrixMap,i=>{i.spliceRows(e,t,r,n),this.normaliseMatrix(i,e)})}spliceColumns(e,t,r,n){i.each(this.matrixMap,i=>{i.spliceColumns(e,t,r,n),this.normaliseMatrix(i,e)})}get model(){return i.map(this.matrixMap,(e,t)=>this.getRanges(t,e)).filter(e=>e.ranges.length)}set model(e){let t=this.matrixMap={};e.forEach(e=>{let r=t[e.name]=new s;e.ranges.forEach(e=>{o.test(e.split("!").pop()||"")&&r.addCell(e)})})}}e.exports=l},98672:e=>{"use strict";e.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},24451:(e,t,r)=>{let i=r(62844),n=r(70805);class s{constructor(e,t){this.worksheet=e,this.model=t}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw Error("Invalid Image Type")}}set model({type:e,imageId:t,range:r,hyperlinks:s}){if(this.type=e,this.imageId=t,"image"===e){if("string"==typeof r){let e=i.decode(r);this.range={tl:new n(this.worksheet,{col:e.left,row:e.top},-1),br:new n(this.worksheet,{col:e.right,row:e.bottom},0),editAs:"oneCell"}}else this.range={tl:new n(this.worksheet,r.tl,0),br:r.br&&new n(this.worksheet,r.br,0),ext:r.ext,editAs:r.editAs,hyperlinks:s||r.hyperlinks}}}}e.exports=s},4468:(e,t,r)=>{"use strict";let i=r(21316);class n{constructor(e){this.model=e}get xlsx(){return this._xlsx||(this._xlsx=new i(this)),this._xlsx}}e.exports=n},83200:(e,t,r)=>{let i=r(29536);class n{constructor(e){this.note=e}get model(){let e=null;return e="string"==typeof this.note?{type:"note",note:{texts:[{text:this.note}]}}:{type:"note",note:this.note},i.deepMerge({},n.DEFAULT_CONFIGS,e)}set model(e){let{note:t}=e,{texts:r}=t;1===r.length&&1===Object.keys(r[0]).length?this.note=r[0].text:this.note=t}static fromModel(e){let t=new n;return t.model=e,t}}n.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},e.exports=n},73795:(e,t,r)=>{let i=r(62844);class n{constructor(){this.decode(arguments)}setTLBR(e,t,r,n,s){if(arguments.length<4){let n=i.decodeAddress(e),a=i.decodeAddress(t);this.model={top:Math.min(n.row,a.row),left:Math.min(n.col,a.col),bottom:Math.max(n.row,a.row),right:Math.max(n.col,a.col),sheetName:r},this.setTLBR(n.row,n.col,a.row,a.col,s)}else this.model={top:Math.min(e,r),left:Math.min(t,n),bottom:Math.max(e,r),right:Math.max(t,n),sheetName:s}}decode(e){switch(e.length){case 5:this.setTLBR(e[0],e[1],e[2],e[3],e[4]);break;case 4:this.setTLBR(e[0],e[1],e[2],e[3]);break;case 3:this.setTLBR(e[0],e[1],e[2]);break;case 2:this.setTLBR(e[0],e[1]);break;case 1:{let t=e[0];if(t instanceof n)this.model={top:t.model.top,left:t.model.left,bottom:t.model.bottom,right:t.model.right,sheetName:t.sheetName};else if(t instanceof Array)this.decode(t);else if(t.top&&t.left&&t.bottom&&t.right)this.model={top:t.top,left:t.left,bottom:t.bottom,right:t.right,sheetName:t.sheetName};else{let e=i.decodeEx(t);e.top?this.model={top:e.top,left:e.left,bottom:e.bottom,right:e.right,sheetName:e.sheetName}:this.model={top:e.row,left:e.col,bottom:e.row,right:e.col,sheetName:e.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw Error(`Invalid number of arguments to _getDimensions() - ${e.length}`)}}get top(){return this.model.top||1}set top(e){this.model.top=e}get left(){return this.model.left||1}set left(e){this.model.left=e}get bottom(){return this.model.bottom||1}set bottom(e){this.model.bottom=e}get right(){return this.model.right||1}set right(e){this.model.right=e}get sheetName(){return this.model.sheetName}set sheetName(e){this.model.sheetName=e}get _serialisedSheetName(){let{sheetName:e}=this.model;return e?/^[a-zA-Z0-9]*$/.test(e)?`${e}!`:`'${e}'!`:""}expand(e,t,r,i){(!this.model.top||e<this.top)&&(this.top=e),(!this.model.left||t<this.left)&&(this.left=t),(!this.model.bottom||r>this.bottom)&&(this.bottom=r),(!this.model.right||i>this.right)&&(this.right=i)}expandRow(e){if(e){let{dimensions:t,number:r}=e;t&&this.expand(r,t.min,r,t.max)}}expandToAddress(e){let t=i.decodeEx(e);this.expand(t.row,t.col,t.row,t.col)}get tl(){return i.n2l(this.left)+this.top}get $t$l(){return`$${i.n2l(this.left)}$${this.top}`}get br(){return i.n2l(this.right)+this.bottom}get $b$r(){return`$${i.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(e){return(!e.sheetName||!this.sheetName||e.sheetName===this.sheetName)&&!(e.bottom<this.top)&&!(e.top>this.bottom)&&!(e.right<this.left)&&!(e.left>this.right)}contains(e){let t=i.decodeEx(e);return this.containsEx(t)}containsEx(e){return(!e.sheetName||!this.sheetName||e.sheetName===this.sheetName)&&e.row>=this.top&&e.row<=this.bottom&&e.col>=this.left&&e.col<=this.right}forEachAddress(e){for(let t=this.left;t<=this.right;t++)for(let r=this.top;r<=this.bottom;r++)e(i.encodeAddress(r,t),r,t)}}e.exports=n},74230:(e,t,r)=>{"use strict";let i=r(29536),n=r(98672),s=r(62844),a=r(15060);class o{constructor(e,t){this._worksheet=e,this._number=t,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(e){return this._cells[e-1]}getCellEx(e){let t=this._cells[e.col-1];return t||(t=new a(this,this._worksheet.getColumn(e.col),e.address),this._cells[e.col-1]=t),t}getCell(e){if("string"==typeof e){let t=this._worksheet.getColumnKey(e);e=t?t.number:s.l2n(e)}return this._cells[e-1]||this.getCellEx({address:s.encodeAddress(this._number,e),row:this._number,col:e})}splice(e,t,...r){let i,n,s;let a=e+t,o=r.length-t,l=this._cells.length;if(o<0)for(i=e+r.length;i<=l;i++)s=this._cells[i-1],(n=this._cells[i-o-1])?((s=this.getCell(i)).value=n.value,s.style=n.style,s._comment=n._comment):s&&(s.value=null,s.style={},s._comment=void 0);else if(o>0)for(i=l;i>=a;i--)(n=this._cells[i-1])?((s=this.getCell(i+o)).value=n.value,s.style=n.style,s._comment=n._comment):this._cells[i+o-1]=void 0;for(i=0;i<r.length;i++)(s=this.getCell(e+i)).value=r[i],s.style={},s._comment=void 0}eachCell(e,t){if(t||(t=e,e=null),e&&e.includeEmpty){let e=this._cells.length;for(let r=1;r<=e;r++)t(this.getCell(r),r)}else this._cells.forEach((e,r)=>{e&&e.type!==n.ValueType.Null&&t(e,r+1)})}addPageBreak(e,t){let r=this._worksheet,i=Math.max(0,e-1)||0,n=Math.max(0,t-1)||16838,s={id:this._number,max:n,man:1};i&&(s.min=i),r.rowBreaks.push(s)}get values(){let e=[];return this._cells.forEach(t=>{t&&t.type!==n.ValueType.Null&&(e[t.col]=t.value)}),e}set values(e){if(this._cells=[],e){if(e instanceof Array){let t=0;e.hasOwnProperty("0")&&(t=1),e.forEach((e,r)=>{void 0!==e&&(this.getCellEx({address:s.encodeAddress(this._number,r+t),row:this._number,col:r+t}).value=e)})}else this._worksheet.eachColumnKey((t,r)=>{void 0!==e[r]&&(this.getCellEx({address:s.encodeAddress(this._number,t.number),row:this._number,col:t.number}).value=e[r])})}}get hasValues(){return i.some(this._cells,e=>e&&e.type!==n.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let e=0;return this.eachCell(()=>{e++}),e}get dimensions(){let e=0,t=0;return this._cells.forEach(r=>{r&&r.type!==n.ValueType.Null&&((!e||e>r.col)&&(e=r.col),t<r.col&&(t=r.col))}),e>0?{min:e,max:t}:null}_applyStyle(e,t){return this.style[e]=t,this._cells.forEach(r=>{r&&(r[e]=t)}),t}get numFmt(){return this.style.numFmt}set numFmt(e){this._applyStyle("numFmt",e)}get font(){return this.style.font}set font(e){this._applyStyle("font",e)}get alignment(){return this.style.alignment}set alignment(e){this._applyStyle("alignment",e)}get protection(){return this.style.protection}set protection(e){this._applyStyle("protection",e)}get border(){return this.style.border}set border(e){this._applyStyle("border",e)}get fill(){return this.style.fill}set fill(e){this._applyStyle("fill",e)}get hidden(){return!!this._hidden}set hidden(e){this._hidden=e}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(e){this._outlineLevel=e}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){let e=[],t=0,r=0;return this._cells.forEach(i=>{if(i){let n=i.model;n&&((!t||t>i.col)&&(t=i.col),r<i.col&&(r=i.col),e.push(n))}}),this.height||e.length?{cells:e,number:this.number,min:t,max:r,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(e){let t;if(e.number!==this._number)throw Error("Invalid row number in model");this._cells=[],e.cells.forEach(e=>{if(e.type===a.Types.Merge);else{let r;if(e.address)r=s.decodeAddress(e.address);else if(t){let{row:e}=t,i=t.col+1;r={row:e,col:i,address:s.encodeAddress(e,i),$col$row:`$${s.n2l(i)}$${e}`}}t=r,this.getCellEx(r).model=e}}),e.height?this.height=e.height:delete this.height,this.hidden=e.hidden,this.outlineLevel=e.outlineLevel||0,this.style=e.style&&JSON.parse(JSON.stringify(e.style))||{}}}e.exports=o},24602:(e,t,r)=>{let i=r(62844);class n{constructor(e,t,r){this.table=e,this.column=t,this.index=r}_set(e,t){this.table.cacheState(),this.column[e]=t}get name(){return this.column.name}set name(e){this._set("name",e)}get filterButton(){return this.column.filterButton}set filterButton(e){this.column.filterButton=e}get style(){return this.column.style}set style(e){this.column.style=e}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(e){this._set("totalsRowLabel",e)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(e){this._set("totalsRowFunction",e)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(e){this._set("totalsRowResult",e)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(e){this._set("totalsRowFormula",e)}}class s{constructor(e,t){this.worksheet=e,t&&(this.table=t,this.validate(),this.store())}getFormula(e){switch(e.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${e.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${e.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${e.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${e.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${e.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${e.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${e.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${e.name}])`;case"custom":return e.totalsRowFormula;default:throw Error(`Invalid Totals Row Function: ${e.totalsRowFunction}`)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){let{table:e}=this,t=(e,t,r)=>{void 0===e[t]&&(e[t]=r)};t(e,"headerRow",!0),t(e,"totalsRow",!1),t(e,"style",{}),t(e.style,"theme","TableStyleMedium2"),t(e.style,"showFirstColumn",!1),t(e.style,"showLastColumn",!1),t(e.style,"showRowStripes",!1),t(e.style,"showColumnStripes",!1);let r=(e,t)=>{if(!e)throw Error(t)};r(e.ref,"Table must have ref"),r(e.columns,"Table must have column definitions"),r(e.rows,"Table must have row definitions"),e.tl=i.decodeAddress(e.ref);let{row:n,col:s}=e.tl;r(n>0,"Table must be on valid row"),r(s>0,"Table must be on valid col");let{width:a,filterHeight:o,tableHeight:l}=this;e.autoFilterRef=i.encode(n,s,n+o-1,s+a-1),e.tableRef=i.encode(n,s,n+l-1,s+a-1),e.columns.forEach((e,i)=>{r(e.name,`Column ${i} must have a name`),0===i?t(e,"totalsRowLabel","Total"):(t(e,"totalsRowFunction","none"),e.totalsRowFormula=this.getFormula(e))})}store(){let e=(e,t)=>{t&&Object.keys(t).forEach(r=>{e[r]=t[r]})},{worksheet:t,table:r}=this,{row:i,col:n}=r.tl,s=0;if(r.headerRow){let a=t.getRow(i+s++);r.columns.forEach((t,r)=>{let{style:i,name:s}=t,o=a.getCell(n+r);o.value=s,e(o,i)})}if(r.rows.forEach(a=>{let o=t.getRow(i+s++);a.forEach((t,i)=>{let s=o.getCell(n+i);s.value=t,e(s,r.columns[i].style)})}),r.totalsRow){let a=t.getRow(i+s++);r.columns.forEach((t,r)=>{let i=a.getCell(n+r);0===r?i.value=t.totalsRowLabel:this.getFormula(t)?i.value={formula:t.totalsRowFormula,result:t.totalsRowResult}:i.value=null,e(i,t.style)})}}load(e){let{table:t}=this,{row:r,col:i}=t.tl,n=0;if(t.headerRow){let s=e.getRow(r+n++);t.columns.forEach((e,t)=>{s.getCell(i+t).value=e.name})}if(t.rows.forEach(t=>{let s=e.getRow(r+n++);t.forEach((e,t)=>{s.getCell(i+t).value=e})}),t.totalsRow){let s=e.getRow(r+n++);t.columns.forEach((e,t)=>{let r=s.getCell(i+t);0===t?r.value=e.totalsRowLabel:this.getFormula(e)&&(r.value={formula:e.totalsRowFormula,result:e.totalsRowResult})})}}get model(){return this.table}set model(e){this.table=e}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();let e=i.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let t=0;t<this._cache.tableHeight;t++){let r=this.worksheet.getRow(e.row+t);for(let t=0;t<this._cache.width;t++)r.getCell(e.col+t).value=null}else{for(let t=this.tableHeight;t<this._cache.tableHeight;t++){let r=this.worksheet.getRow(e.row+t);for(let t=0;t<this._cache.width;t++)r.getCell(e.col+t).value=null}for(let t=0;t<this.tableHeight;t++){let r=this.worksheet.getRow(e.row+t);for(let t=this.width;t<this._cache.width;t++)r.getCell(e.col+t).value=null}}this.store()}addRow(e,t){this.cacheState(),void 0===t?this.table.rows.push(e):this.table.rows.splice(t,0,e)}removeRows(e,t=1){this.cacheState(),this.table.rows.splice(e,t)}getColumn(e){return new n(this,this.table.columns[e],e)}addColumn(e,t,r){this.cacheState(),void 0===r?(this.table.columns.push(e),this.table.rows.forEach((e,r)=>{e.push(t[r])})):(this.table.columns.splice(r,0,e),this.table.rows.forEach((e,i)=>{e.splice(r,0,t[i])}))}removeColumns(e,t=1){this.cacheState(),this.table.columns.splice(e,t),this.table.rows.forEach(r=>{r.splice(e,t)})}_assign(e,t,r){this.cacheState(),e[t]=r}get ref(){return this.table.ref}set ref(e){this._assign(this.table,"ref",e)}get name(){return this.table.name}set name(e){this.table.name=e}get displayName(){return this.table.displyName||this.table.name}set displayNamename(e){this.table.displayName=e}get headerRow(){return this.table.headerRow}set headerRow(e){this._assign(this.table,"headerRow",e)}get totalsRow(){return this.table.totalsRow}set totalsRow(e){this._assign(this.table,"totalsRow",e)}get theme(){return this.table.style.name}set theme(e){this.table.style.name=e}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(e){this.table.style.showFirstColumn=e}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(e){this.table.style.showLastColumn=e}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(e){this.table.style.showRowStripes=e}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(e){this.table.style.showColumnStripes=e}}e.exports=s},20192:(e,t,r)=>{"use strict";let i=r(89246),n=r(87702),s=r(21316),a=r(98676);class o{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new n}get xlsx(){return this._xlsx||(this._xlsx=new s(this)),this._xlsx}get csv(){return this._csv||(this._csv=new a(this)),this._csv}get nextId(){for(let e=1;e<this._worksheets.length;e++)if(!this._worksheets[e])return e;return this._worksheets.length||1}addWorksheet(e,t){let r=this.nextId;t&&("string"==typeof t?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),t={properties:{tabColor:{argb:t}}}):(t.argb||t.theme||t.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),t={properties:{tabColor:t}}));let n=this._worksheets.reduce((e,t)=>(t&&t.orderNo)>e?t.orderNo:e,0),s=new i(Object.assign({},t,{id:r,name:e,orderNo:n+1,workbook:this}));return this._worksheets[r]=s,s}removeWorksheetEx(e){delete this._worksheets[e.id]}removeWorksheet(e){let t=this.getWorksheet(e);t&&t.destroy()}getWorksheet(e){return void 0===e?this._worksheets.find(Boolean):"number"==typeof e?this._worksheets[e]:"string"==typeof e?this._worksheets.find(t=>t&&t.name===e):void 0}get worksheets(){return this._worksheets.slice(1).sort((e,t)=>e.orderNo-t.orderNo).filter(Boolean)}eachSheet(e){this.worksheets.forEach(t=>{e(t,t.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(e){let t=this.media.length;return this.media.push(Object.assign({},e,{type:"image"})),t}getImage(e){return this.media[e]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(e=>e.model),sheets:this.worksheets.map(e=>e.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(e){this.creator=e.creator,this.lastModifiedBy=e.lastModifiedBy,this.lastPrinted=e.lastPrinted,this.created=e.created,this.modified=e.modified,this.company=e.company,this.manager=e.manager,this.title=e.title,this.subject=e.subject,this.keywords=e.keywords,this.category=e.category,this.description=e.description,this.language=e.language,this.revision=e.revision,this.contentStatus=e.contentStatus,this.properties=e.properties,this.calcProperties=e.calcProperties,this._worksheets=[],e.worksheets.forEach(t=>{let{id:r,name:n,state:s}=t,a=e.sheets&&e.sheets.findIndex(e=>e.id===r);(this._worksheets[r]=new i({id:r,name:n,orderNo:a,state:s,workbook:this})).model=t}),this._definedNames.model=e.definedNames,this.views=e.views,this._themes=e.themes,this.media=e.media||[]}}e.exports=o},89246:(e,t,r)=>{let i=r(29536),n=r(62844),s=r(73795),a=r(74230),o=r(48214),l=r(98672),u=r(24451),c=r(24602),h=r(98025),d=r(74113),{copyStyle:p}=r(24420);class f{constructor(e){e=e||{},this._workbook=e.workbook,this.id=e.id,this.orderNo=e.orderNo,this.name=e.name,this.state=e.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},e.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:0xffffffff,verticalDpi:0xffffffff,fitToPage:!!(e.pageSetup&&(e.pageSetup.fitToWidth||e.pageSetup.fitToHeight)&&!e.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},e.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},e.headerFooter),this.dataValidations=new h,this.views=e.views||[],this.autoFilter=e.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(e){if(void 0===e&&(e=`sheet${this.id}`),this._name!==e){if("string"!=typeof e)throw Error("The name has to be a string.");if(""===e)throw Error("The name can't be empty.");if("History"===e)throw Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(e))throw Error(`Worksheet name ${e} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(e))throw Error(`The first or last character of worksheet name cannot be a single quotation mark: ${e}`);if(e&&e.length>31&&(console.warn(`Worksheet name ${e} exceeds 31 chars. This will be truncated`),e=e.substring(0,31)),this._workbook._worksheets.find(t=>t&&t.name.toLowerCase()===e.toLowerCase()))throw Error(`Worksheet name already exists: ${e}`);this._name=e}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){let e=new s;return this._rows.forEach(t=>{if(t){let r=t.dimensions;r&&e.expand(t.number,r.min,t.number,r.max)}}),e}get columns(){return this._columns}set columns(e){this._headerRowCount=e.reduce((e,t)=>Math.max(e,t.header&&1||t.headers&&t.headers.length||0),0);let t=1,r=this._columns=[];e.forEach(e=>{let i=new o(this,t++,!1);r.push(i),i.defn=e})}getColumnKey(e){return this._keys[e]}setColumnKey(e,t){this._keys[e]=t}deleteColumnKey(e){delete this._keys[e]}eachColumnKey(e){i.each(this._keys,e)}getColumn(e){if("string"==typeof e){let t=this._keys[e];if(t)return t;e=n.l2n(e)}if(this._columns||(this._columns=[]),e>this._columns.length){let t=this._columns.length+1;for(;t<=e;)this._columns.push(new o(this,t++))}return this._columns[e-1]}spliceColumns(e,t,...r){let i=this._rows.length;if(r.length>0)for(let n=0;n<i;n++){let i=[e,t];r.forEach(e=>{i.push(e[n]||null)});let s=this.getRow(n+1);s.splice.apply(s,i)}else this._rows.forEach(r=>{r&&r.splice(e,t)});let n=r.length-t,s=e+t,a=this._columns.length;if(n<0)for(let t=e+r.length;t<=a;t++)this.getColumn(t).defn=this.getColumn(t-n).defn;else if(n>0)for(let e=a;e>=s;e--)this.getColumn(e+n).defn=this.getColumn(e).defn;for(let t=e;t<e+r.length;t++)this.getColumn(t).defn=null;this.workbook.definedNames.spliceColumns(this.name,e,t,r.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let e=0;return this.eachRow(t=>{e=Math.max(e,t.cellCount)}),e}get actualColumnCount(){let e=[],t=0;return this.eachRow(r=>{r.eachCell(({col:r})=>{!e[r]&&(e[r]=!0,t++)})}),t}_commitRow(){}get _lastRowNumber(){let e=this._rows,t=e.length;for(;t>0&&void 0===e[t-1];)t--;return t}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(e){return this._rows[e-1]}findRows(e,t){return this._rows.slice(e-1,e-1+t)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let e=0;return this.eachRow(()=>{e++}),e}getRow(e){let t=this._rows[e-1];return t||(t=this._rows[e-1]=new a(this,e)),t}getRows(e,t){if(t<1)return;let r=[];for(let i=e;i<e+t;i++)r.push(this.getRow(i));return r}addRow(e,t="n"){let r=this._nextRow,i=this.getRow(r);return i.values=e,this._setStyleOption(r,"i"===t[0]?t:"n"),i}addRows(e,t="n"){let r=[];return e.forEach(e=>{r.push(this.addRow(e,t))}),r}insertRow(e,t,r="n"){return this.spliceRows(e,0,t),this._setStyleOption(e,r),this.getRow(e)}insertRows(e,t,r="n"){if(this.spliceRows(e,0,...t),"n"!==r)for(let i=0;i<t.length;i++)"o"===r[0]&&void 0!==this.findRow(t.length+e+i)?this._copyStyle(t.length+e+i,e+i,"+"===r[1]):"i"===r[0]&&void 0!==this.findRow(e-1)&&this._copyStyle(e-1,e+i,"+"===r[1]);return this.getRows(e,t.length)}_setStyleOption(e,t="n"){"o"===t[0]&&void 0!==this.findRow(e+1)?this._copyStyle(e+1,e,"+"===t[1]):"i"===t[0]&&void 0!==this.findRow(e-1)&&this._copyStyle(e-1,e,"+"===t[1])}_copyStyle(e,t,r=!1){let i=this.getRow(e),n=this.getRow(t);n.style=p(i.style),i.eachCell({includeEmpty:r},(e,t)=>{n.getCell(t).style=p(e.style)}),n.height=i.height}duplicateRow(e,t,r=!1){let i=this._rows[e-1],n=Array(t).fill(i.values);this.spliceRows(e+1,r?0:t,...n);for(let r=0;r<t;r++){let t=this._rows[e+r];t.style=i.style,t.height=i.height,i.eachCell({includeEmpty:!0},(e,r)=>{t.getCell(r).style=e.style})}}spliceRows(e,t,...r){let i,n;let s=e+t,a=r.length,o=a-t,l=this._rows.length;if(o<0)for(e===l&&(this._rows[l-1]=void 0),i=s;i<=l;i++)if(n=this._rows[i-1]){let e=this.getRow(i+o);e.values=n.values,e.style=n.style,e.height=n.height,n.eachCell({includeEmpty:!0},(t,r)=>{e.getCell(r).style=t.style}),this._rows[i-1]=void 0}else this._rows[i+o-1]=void 0;else if(o>0)for(i=l;i>=s;i--)if(n=this._rows[i-1]){let e=this.getRow(i+o);e.values=n.values,e.style=n.style,e.height=n.height,n.eachCell({includeEmpty:!0},(t,r)=>{if(e.getCell(r).style=t.style,"MergeValue"===t._value.constructor.name){let e=this.getRow(t._row._number+a).getCell(r),i=t._value._master,n=this.getRow(i._row._number+a).getCell(i._column._number);e.merge(n)}})}else this._rows[i+o-1]=void 0;for(i=0;i<a;i++){let t=this.getRow(e+i);t.style={},t.values=r[i]}this.workbook.definedNames.spliceRows(this.name,e,t,a)}eachRow(e,t){if(t||(t=e,e=void 0),e&&e.includeEmpty){let e=this._rows.length;for(let r=1;r<=e;r++)t(this.getRow(r),r)}else this._rows.forEach(e=>{e&&e.hasValues&&t(e,e.number)})}getSheetValues(){let e=[];return this._rows.forEach(t=>{t&&(e[t.number]=t.values)}),e}findCell(e,t){let r=n.getAddress(e,t),i=this._rows[r.row-1];return i?i.findCell(r.col):void 0}getCell(e,t){let r=n.getAddress(e,t);return this.getRow(r.row).getCellEx(r)}mergeCells(...e){let t=new s(e);this._mergeCellsInternal(t)}mergeCellsWithoutStyle(...e){let t=new s(e);this._mergeCellsInternal(t,!0)}_mergeCellsInternal(e,t){i.each(this._merges,t=>{if(t.intersects(e))throw Error("Cannot merge already merged cells")});let r=this.getCell(e.top,e.left);for(let i=e.top;i<=e.bottom;i++)for(let n=e.left;n<=e.right;n++)(i>e.top||n>e.left)&&this.getCell(i,n).merge(r,t);this._merges[r.address]=e}_unMergeMaster(e){let t=this._merges[e.address];if(t){for(let e=t.top;e<=t.bottom;e++)for(let r=t.left;r<=t.right;r++)this.getCell(e,r).unmerge();delete this._merges[e.address]}}get hasMerges(){return i.some(this._merges,Boolean)}unMergeCells(...e){let t=new s(e);for(let e=t.top;e<=t.bottom;e++)for(let r=t.left;r<=t.right;r++){let t=this.findCell(e,r);t&&(t.type===l.ValueType.Merge?this._unMergeMaster(t.master):this._merges[t.address]&&this._unMergeMaster(t))}}fillFormula(e,t,r,i="shared"){let s;let{top:a,left:o,bottom:l,right:u}=n.decode(e),c=u-o+1,h=n.encodeAddress(a,o),d="shared"===i;s="function"==typeof r?r:Array.isArray(r)?Array.isArray(r[0])?(e,t)=>r[e-a][t-o]:(e,t)=>r[(e-a)*c+(t-o)]:()=>void 0;let p=!0;for(let r=a;r<=l;r++)for(let n=o;n<=u;n++)p?(this.getCell(r,n).value={shareType:i,formula:t,ref:e,result:s(r,n)},p=!1):this.getCell(r,n).value=d?{sharedFormula:h,result:s(r,n)}:s(r,n)}addImage(e,t){this._media.push(new u(this,{type:"image",imageId:e,range:t}))}getImages(){return this._media.filter(e=>"image"===e.type)}addBackgroundImage(e){this._media.push(new u(this,{type:"background",imageId:e}))}getBackgroundImageId(){let e=this._media.find(e=>"background"===e.type);return e&&e.imageId}protect(e,t){return new Promise(r=>{this.sheetProtection={sheet:!0},t&&"spinCount"in t&&(t.spinCount=Number.isFinite(t.spinCount)?Math.round(Math.max(0,t.spinCount)):1e5),e&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=d.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=t&&"spinCount"in t?t.spinCount:1e5,this.sheetProtection.hashValue=d.convertPasswordToHash(e,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),t&&(this.sheetProtection=Object.assign(this.sheetProtection,t),!e&&"spinCount"in t&&delete this.sheetProtection.spinCount),r()})}unprotect(){this.sheetProtection=null}addTable(e){let t=new c(this,e);return this.tables[e.name]=t,t}getTable(e){return this.tables[e]}removeTable(e){delete this.tables[e]}getTables(){return Object.values(this.tables)}addConditionalFormatting(e){this.conditionalFormattings.push(e)}removeConditionalFormatting(e){"number"==typeof e?this.conditionalFormattings.splice(e,1):e instanceof Function?this.conditionalFormattings=this.conditionalFormattings.filter(e):this.conditionalFormattings=[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(e){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=e}get model(){let e={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(e=>e.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(e=>e.model),conditionalFormattings:this.conditionalFormattings};e.cols=o.toModel(this.columns);let t=e.rows=[],r=e.dimensions=new s;return this._rows.forEach(e=>{let i=e&&e.model;i&&(r.expand(i.number,i.min,i.number,i.max),t.push(i))}),e.merges=[],i.each(this._merges,t=>{e.merges.push(t.range)}),e}_parseRows(e){this._rows=[],e.rows.forEach(e=>{let t=new a(this,e.number);this._rows[t.number-1]=t,t.model=e})}_parseMergeCells(e){i.each(e.mergeCells,e=>{this.mergeCellsWithoutStyle(e)})}set model(e){this.name=e.name,this._columns=o.fromModel(this,e.cols),this._parseRows(e),this._parseMergeCells(e),this.dataValidations=new h(e.dataValidations),this.properties=e.properties,this.pageSetup=e.pageSetup,this.headerFooter=e.headerFooter,this.views=e.views,this.autoFilter=e.autoFilter,this._media=e.media.map(e=>new u(this,e)),this.sheetProtection=e.sheetProtection,this.tables=e.tables.reduce((e,t)=>{let r=new c;return r.model=t,e[t.name]=r,e},{}),this.conditionalFormattings=e.conditionalFormattings}}e.exports=f},90962:(e,t,r)=>{let i={Workbook:r(20192),ModelContainer:r(4468),stream:{xlsx:{WorkbookWriter:r(9606),WorkbookReader:r(40806)}}};Object.assign(i,r(98672)),e.exports=i},34998:(e,t,r)=>{let{EventEmitter:i}=r(94735),n=r(79471),s=r(98672),a=r(37529);class o extends i{constructor({workbook:e,id:t,iterator:r,options:i}){super(),this.workbook=e,this.id=t,this.iterator=r,this.options=i}get count(){return this.hyperlinks&&this.hyperlinks.length||0}each(e){return this.hyperlinks.forEach(e)}async read(){let{iterator:e,options:t}=this,r=!1,i=null;switch(t.hyperlinks){case"emit":r=!0;break;case"cache":this.hyperlinks=i={}}if(!r&&!i){this.emit("finished");return}try{for await(let t of n(e))for(let{eventType:e,value:n}of t)if("opentag"===e&&"Relationship"===n.name){let e=n.attributes.Id;if(n.attributes.Type===a.Hyperlink){let t={type:s.RelationshipType.Styles,rId:e,target:n.attributes.Target,targetMode:n.attributes.TargetMode};r?this.emit("hyperlink",t):i[t.rId]=t}}this.emit("finished")}catch(e){this.emit("error",e)}}}e.exports=o},65606:(e,t,r)=>{let i=r(43213),n=r(37529),s=r(62844),a=r(69338),o=r(99792);class l{constructor(e,t,r){this.id=r.id,this.count=0,this._worksheet=e,this._workbook=r.workbook,this._sheetRelsWriter=t}get commentsStream(){return this._commentsStream||(this._commentsStream=this._workbook._openStream(`/xl/comments${this.id}.xml`)),this._commentsStream}get vmlStream(){return this._vmlStream||(this._vmlStream=this._workbook._openStream(`xl/drawings/vmlDrawing${this.id}.vml`)),this._vmlStream}_addRelationships(){let e={Type:n.Comments,Target:`../comments${this.id}.xml`};this._sheetRelsWriter.addRelationship(e);let t={Type:n.VmlDrawing,Target:`../drawings/vmlDrawing${this.id}.vml`};this.vmlRelId=this._sheetRelsWriter.addRelationship(t)}_addCommentRefs(){this._workbook.commentRefs.push({commentName:`comments${this.id}`,vmlDrawing:`vmlDrawing${this.id}`})}_writeOpen(){this.commentsStream.write('<?xml version="1.0" encoding="UTF-8" standalone="yes"?><comments xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><authors><author>Author</author></authors><commentList>'),this.vmlStream.write('<?xml version="1.0" encoding="UTF-8"?><xml xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:x="urn:schemas-microsoft-com:office:excel"><o:shapelayout v:ext="edit"><o:idmap v:ext="edit" data="1" /></o:shapelayout><v:shapetype id="_x0000_t202" coordsize="21600,21600" o:spt="202" path="m,l,21600r21600,l21600,xe"><v:stroke joinstyle="miter" /><v:path gradientshapeok="t" o:connecttype="rect" /></v:shapetype>')}_writeComment(e,t){let r=new a,n=new i;r.render(n,e),this.commentsStream.write(n.xml);let s=new o,l=new i;s.render(l,e,t),this.vmlStream.write(l.xml)}_writeClose(){this.commentsStream.write("</commentList></comments>"),this.vmlStream.write("</xml>")}addComments(e){e&&e.length&&(this.startedData||(this._worksheet.comments=[],this._writeOpen(),this._addRelationships(),this._addCommentRefs(),this.startedData=!0),e.forEach(e=>{e.refAddress=s.decodeAddress(e.ref)}),e.forEach(e=>{this._writeComment(e,this.count),this.count+=1}))}commit(){this.count&&(this._writeClose(),this.commentsStream.end(),this.vmlStream.end())}}e.exports=l},63036:(e,t,r)=>{let i=r(86968),n=r(37529);class s{constructor(e){this.writer=e}push(e){this.writer.addHyperlink(e)}}class a{constructor(e){this.id=e.id,this.count=0,this._hyperlinks=[],this._workbook=e.workbook}get stream(){return this._stream||(this._stream=this._workbook._openStream(`/xl/worksheets/_rels/sheet${this.id}.xml.rels`)),this._stream}get length(){return this._hyperlinks.length}each(e){return this._hyperlinks.forEach(e)}get hyperlinksProxy(){return this._hyperlinksProxy||(this._hyperlinksProxy=new s(this))}addHyperlink(e){let t={Target:e.target,Type:n.Hyperlink,TargetMode:"External"},r=this._writeRelationship(t);this._hyperlinks.push({rId:r,address:e.address})}addMedia(e){return this._writeRelationship(e)}addRelationship(e){return this._writeRelationship(e)}commit(){this.count&&(this._writeClose(),this.stream.end())}_writeOpen(){this.stream.write(`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
       <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">`)}_writeRelationship(e){this.count||this._writeOpen();let t=`rId${++this.count}`;return e.TargetMode?this.stream.write(`<Relationship Id="${t}" Type="${e.Type}" Target="${i.xmlEncode(e.Target)}" TargetMode="${e.TargetMode}"/>`):this.stream.write(`<Relationship Id="${t}" Type="${e.Type}" Target="${e.Target}"/>`),t}_writeClose(){this.stream.write("</Relationships>")}}e.exports=a},40806:(e,t,r)=>{let i=r(29021),{EventEmitter:n}=r(94735),{PassThrough:s,Readable:a}=r(68280),o=r(27910),l=r(82811),u=r(54319),c=r(97204),h=r(79471),d=r(89171),p=r(50827),f=r(60180),m=r(46960),g=r(34998);u.setGracefulCleanup();class y extends n{constructor(e,t={}){super(),this.input=e,this.options={worksheets:"emit",sharedStrings:"cache",hyperlinks:"ignore",styles:"ignore",entries:"ignore",...t},this.styles=new d,this.styles.init()}_getStream(e){if(e instanceof o.Readable||e instanceof a)return e;if("string"==typeof e)return i.createReadStream(e);throw Error(`Could not recognise input: ${e}`)}async read(e,t){try{for await(let{eventType:r,value:i}of this.parse(e,t))switch(r){case"shared-strings":case"hyperlinks":this.emit(r,i);break;case"worksheet":this.emit(r,i),await i.read()}this.emit("end"),this.emit("finished")}catch(e){this.emit("error",e)}}async *[Symbol.asyncIterator](){for await(let{eventType:e,value:t}of this.parse())"worksheet"===e&&(yield t)}async *parse(e,t){t&&(this.options=t);let r=this.stream=this._getStream(e||this.input),n=l.Parse({forceStream:!0});r.pipe(n);let a=[];for await(let e of c(n)){let t;switch(e.path){case"_rels/.rels":break;case"xl/_rels/workbook.xml.rels":await this._parseRels(e);break;case"xl/workbook.xml":await this._parseWorkbook(e);break;case"xl/sharedStrings.xml":yield*this._parseSharedStrings(e);break;case"xl/styles.xml":await this._parseStyles(e);break;default:e.path.match(/xl\/worksheets\/sheet\d+[.]xml/)?(t=e.path.match(/xl\/worksheets\/sheet(\d+)[.]xml/)[1],this.sharedStrings&&this.workbookRels?yield*this._parseWorksheet(c(e),t):await new Promise((r,n)=>{u.file((s,o,l,u)=>{if(s)return n(s);a.push({sheetNo:t,path:o,tempFileCleanupCallback:u});let c=i.createWriteStream(o);return c.on("error",n),e.pipe(c),c.on("finish",()=>r())})})):e.path.match(/xl\/worksheets\/_rels\/sheet\d+[.]xml.rels/)&&(t=e.path.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/)[1],yield*this._parseHyperlinks(c(e),t))}e.autodrain()}for(let{sheetNo:e,path:t,tempFileCleanupCallback:r}of a){let n=i.createReadStream(t);n[Symbol.asyncIterator]||(n=n.pipe(new s)),yield*this._parseWorksheet(n,e),r()}}_emitEntry(e){"emit"===this.options.entries&&this.emit("entry",e)}async _parseRels(e){let t=new f;this.workbookRels=await t.parseStream(c(e))}async _parseWorkbook(e){this._emitEntry({type:"workbook"});let t=new p;await t.parseStream(c(e)),this.properties=t.map.workbookPr,this.model=t.model}async *_parseSharedStrings(e){switch(this._emitEntry({type:"shared-strings"}),this.options.sharedStrings){case"cache":this.sharedStrings=[];break;case"emit":break;default:return}let t=null,r=[],i=0,n=null;for await(let s of h(c(e)))for(let{eventType:e,value:a}of s)if("opentag"===e)switch(a.name){case"b":(n=n||{}).bold=!0;break;case"charset":(n=n||{}).charset=parseInt(a.attributes.charset,10);break;case"color":(n=n||{}).color={},a.attributes.rgb&&(n.color.argb=a.attributes.argb),a.attributes.val&&(n.color.argb=a.attributes.val),a.attributes.theme&&(n.color.theme=a.attributes.theme);break;case"family":(n=n||{}).family=parseInt(a.attributes.val,10);break;case"i":(n=n||{}).italic=!0;break;case"outline":(n=n||{}).outline=!0;break;case"rFont":(n=n||{}).name=a.value;break;case"si":n=null,r=[],t=null;break;case"sz":(n=n||{}).size=parseInt(a.attributes.val,10);break;case"strike":break;case"t":t=null;break;case"u":(n=n||{}).underline=!0;break;case"vertAlign":(n=n||{}).vertAlign=a.attributes.val}else if("text"===e)t=t?t+a:a;else if("closetag"===e)switch(a.name){case"r":r.push({font:n,text:t}),n=null,t=null;break;case"si":"cache"===this.options.sharedStrings?this.sharedStrings.push(r.length?{richText:r}:t):"emit"===this.options.sharedStrings&&(yield{index:i++,text:r.length?{richText:r}:t}),r=[],n=null,t=null}}async _parseStyles(e){this._emitEntry({type:"styles"}),"cache"===this.options.styles&&(this.styles=new d,await this.styles.parseStream(c(e)))}*_parseWorksheet(e,t){this._emitEntry({type:"worksheet",id:t});let r=new m({workbook:this,id:t,iterator:e,options:this.options}),i=(this.workbookRels||[]).find(e=>e.Target===`worksheets/sheet${t}.xml`),n=i&&(this.model.sheets||[]).find(e=>e.rId===i.Id);n&&(r.id=n.id,r.name=n.name,r.state=n.state),"emit"===this.options.worksheets&&(yield{eventType:"worksheet",value:r})}*_parseHyperlinks(e,t){this._emitEntry({type:"hyperlinks",id:t});let r=new g({workbook:this,id:t,iterator:e,options:this.options});"emit"===this.options.hyperlinks&&(yield{eventType:"hyperlinks",value:r})}}y.Options={worksheets:["emit","ignore"],sharedStrings:["cache","emit","ignore"],hyperlinks:["cache","emit","ignore"],styles:["cache","ignore"],entries:["emit","ignore"]},e.exports=y},9606:(e,t,r)=>{let i=r(29021),n=r(14319),s=r(53881),a=r(37529),o=r(89171),l=r(10107),u=r(87702),c=r(43702),h=r(60180),d=r(11546),p=r(63936),f=r(50827),m=r(72502),g=r(52836),y=r(73641);class v{constructor(e){e=e||{},this.created=e.created||new Date,this.modified=e.modified||this.created,this.creator=e.creator||"ExcelJS",this.lastModifiedBy=e.lastModifiedBy||"ExcelJS",this.lastPrinted=e.lastPrinted,this.useSharedStrings=e.useSharedStrings||!1,this.sharedStrings=new l,this.styles=e.useStyles?new o(!0):new o.Mock(!0),this._definedNames=new u,this._worksheets=[],this.views=[],this.zipOptions=e.zip,this.media=[],this.commentRefs=[],this.zip=n("zip",this.zipOptions),e.stream?this.stream=e.stream:e.filename?this.stream=i.createWriteStream(e.filename):this.stream=new s,this.zip.pipe(this.stream),this.promise=Promise.all([this.addThemes(),this.addOfficeRels()])}get definedNames(){return this._definedNames}_openStream(e){let t=new s({bufSize:65536,batch:!0});return this.zip.append(t,{name:e}),t.on("finish",()=>{t.emit("zipped")}),t}_commitWorksheets(){let e=this._worksheets.map(function(e){return e.committed?Promise.resolve():new Promise(t=>{e.stream.on("zipped",()=>{t()}),e.commit()})});return e.length?Promise.all(e):Promise.resolve()}async commit(){return await this.promise,await this.addMedia(),await this._commitWorksheets(),await Promise.all([this.addContentTypes(),this.addApp(),this.addCore(),this.addSharedStrings(),this.addStyles(),this.addWorkbookRels()]),await this.addWorkbook(),this._finalize()}get nextId(){let e;for(e=1;e<this._worksheets.length;e++)if(!this._worksheets[e])return e;return this._worksheets.length||1}addImage(e){let t=this.media.length,r=Object.assign({},e,{type:"image",name:`image${t}.${e.extension}`});return this.media.push(r),t}getImage(e){return this.media[e]}addWorksheet(e,t){let r=void 0!==(t=t||{}).useSharedStrings?t.useSharedStrings:this.useSharedStrings;t.tabColor&&(console.trace("tabColor option has moved to { properties: tabColor: {...} }"),t.properties=Object.assign({tabColor:t.tabColor},t.properties));let i=this.nextId;e=e||`sheet${i}`;let n=new g({id:i,name:e,workbook:this,useSharedStrings:r,properties:t.properties,state:t.state,pageSetup:t.pageSetup,views:t.views,autoFilter:t.autoFilter,headerFooter:t.headerFooter});return this._worksheets[i]=n,n}getWorksheet(e){return void 0===e?this._worksheets.find(()=>!0):"number"==typeof e?this._worksheets[e]:"string"==typeof e?this._worksheets.find(t=>t&&t.name===e):void 0}addStyles(){return new Promise(e=>{this.zip.append(this.styles.xml,{name:"xl/styles.xml"}),e()})}addThemes(){return new Promise(e=>{this.zip.append(y,{name:"xl/theme/theme1.xml"}),e()})}addOfficeRels(){return new Promise(e=>{let t=new h().toXml([{Id:"rId1",Type:a.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:a.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:a.ExtenderProperties,Target:"docProps/app.xml"}]);this.zip.append(t,{name:"/_rels/.rels"}),e()})}addContentTypes(){return new Promise(e=>{let t={worksheets:this._worksheets.filter(Boolean),sharedStrings:this.sharedStrings,commentRefs:this.commentRefs,media:this.media},r=new d().toXml(t);this.zip.append(r,{name:"[Content_Types].xml"}),e()})}addMedia(){return Promise.all(this.media.map(e=>{if("image"===e.type){let t=`xl/media/${e.name}`;if(e.filename)return this.zip.file(e.filename,{name:t});if(e.buffer)return this.zip.append(e.buffer,{name:t});if(e.base64){let r=e.base64,i=r.substring(r.indexOf(",")+1);return this.zip.append(i,{name:t,base64:!0})}}throw Error("Unsupported media")}))}addApp(){return new Promise(e=>{let t={worksheets:this._worksheets.filter(Boolean)},r=new p().toXml(t);this.zip.append(r,{name:"docProps/app.xml"}),e()})}addCore(){return new Promise(e=>{let t=new c().toXml(this);this.zip.append(t,{name:"docProps/core.xml"}),e()})}addSharedStrings(){return this.sharedStrings.count?new Promise(e=>{let t=new m().toXml(this.sharedStrings);this.zip.append(t,{name:"/xl/sharedStrings.xml"}),e()}):Promise.resolve()}addWorkbookRels(){let e=1,t=[{Id:`rId${e++}`,Type:a.Styles,Target:"styles.xml"},{Id:`rId${e++}`,Type:a.Theme,Target:"theme/theme1.xml"}];return this.sharedStrings.count&&t.push({Id:`rId${e++}`,Type:a.SharedStrings,Target:"sharedStrings.xml"}),this._worksheets.forEach(r=>{r&&(r.rId=`rId${e++}`,t.push({Id:r.rId,Type:a.Worksheet,Target:`worksheets/sheet${r.id}.xml`}))}),new Promise(e=>{let r=new h().toXml(t);this.zip.append(r,{name:"/xl/_rels/workbook.xml.rels"}),e()})}addWorkbook(){let{zip:e}=this,t={worksheets:this._worksheets.filter(Boolean),definedNames:this._definedNames.model,views:this.views,properties:{},calcProperties:{}};return new Promise(r=>{let i=new f;i.prepare(t),e.append(i.toXml(t),{name:"/xl/workbook.xml"}),r()})}_finalize(){return new Promise((e,t)=>{this.stream.on("error",t),this.stream.on("finish",()=>{e(this)}),this.zip.on("error",t),this.zip.finalize()})}}e.exports=v},46960:(e,t,r)=>{let{EventEmitter:i}=r(94735),n=r(79471),s=r(29536),a=r(86968),o=r(62844),l=r(73795),u=r(74230),c=r(48214);class h extends i{constructor({workbook:e,id:t,iterator:r,options:i}){super(),this.workbook=e,this.id=t,this.iterator=r,this.options=i||{},this.name=`Sheet${this.id}`,this._columns=null,this._keys={},this._dimensions=new l}destroy(){throw Error("Invalid Operation: destroy")}get dimensions(){return this._dimensions}get columns(){return this._columns}getColumn(e){if("string"==typeof e){let t=this._keys[e];if(t)return t;e=o.l2n(e)}if(this._columns||(this._columns=[]),e>this._columns.length){let t=this._columns.length+1;for(;t<=e;)this._columns.push(new c(this,t++))}return this._columns[e-1]}getColumnKey(e){return this._keys[e]}setColumnKey(e,t){this._keys[e]=t}deleteColumnKey(e){delete this._keys[e]}eachColumnKey(e){s.each(this._keys,e)}async read(){try{for await(let e of this.parse())for(let{eventType:t,value:r}of e)this.emit(t,r);this.emit("finished")}catch(e){this.emit("error",e)}}async *[Symbol.asyncIterator](){for await(let e of this.parse())for(let{eventType:t,value:r}of e)"row"===t&&(yield r)}async *parse(){let{iterator:e,options:t}=this,r=!1,i=!1,s=null;switch("emit"===t.worksheets&&(r=!0),t.hyperlinks){case"emit":i=!0;break;case"cache":this.hyperlinks=s={}}if(!r&&!i&&!s)return;let{sharedStrings:l,styles:h,properties:d}=this.workbook,p=!1,f=!1,m=!1,g=null,y=null,v=null,b=null;for await(let t of n(e)){let e=[];for(let{eventType:n,value:w}of t)if("opentag"===n){if(r)switch(w.name){case"cols":p=!0,g=[];break;case"sheetData":f=!0;break;case"col":p&&g.push({min:parseInt(w.attributes.min,10),max:parseInt(w.attributes.max,10),width:parseFloat(w.attributes.width),styleId:parseInt(w.attributes.style||"0",10)});break;case"row":if(f&&(y=new u(this,parseInt(w.attributes.r,10)),w.attributes.ht&&(y.height=parseFloat(w.attributes.ht)),w.attributes.s)){let e=parseInt(w.attributes.s,10),t=h.getStyleModel(e);t&&(y.style=t)}break;case"c":y&&(v={ref:w.attributes.r,s:parseInt(w.attributes.s,10),t:w.attributes.t});break;case"f":v&&(b=v.f={text:""});break;case"v":case"is":case"t":v&&(b=v.v={text:""})}if(i||s)switch(w.name){case"hyperlinks":m=!0;break;case"hyperlink":if(m){let t={ref:w.attributes.ref,rId:w.attributes["r:id"]};i?e.push({eventType:"hyperlink",value:t}):s[t.ref]=t}}}else if("text"===n)r&&b&&(b.text+=w);else if("closetag"===n){if(r)switch(w.name){case"cols":p=!1,this._columns=c.fromModel(g);break;case"sheetData":f=!1;break;case"row":this._dimensions.expandRow(y),e.push({eventType:"row",value:y}),y=null;break;case"c":if(y&&v){let e=o.decodeAddress(v.ref),t=y.getCell(e.col);if(v.s){let e=h.getStyleModel(v.s);e&&(t.style=e)}if(v.f){let e={formula:v.f.text};v.v&&("str"===v.t?e.result=a.xmlDecode(v.v.text):e.result=parseFloat(v.v.text)),t.value=e}else if(v.v)switch(v.t){case"s":{let e=parseInt(v.v.text,10);l?t.value=l[e]:t.value={sharedString:e};break}case"inlineStr":case"str":t.value=a.xmlDecode(v.v.text);break;case"e":t.value={error:v.v.text};break;case"b":t.value=0!==parseInt(v.v.text,10);break;default:a.isDateFmt(t.numFmt)?t.value=a.excelToDate(parseFloat(v.v.text),d.model&&d.model.date1904):t.value=parseFloat(v.v.text)}if(s){let e=s[v.ref];e&&(t.text=t.value,t.value=void 0,t.hyperlink=e)}v=null}}(i||s)&&"hyperlinks"===w.name&&(m=!1)}e.length>0&&(yield e)}}}e.exports=h},52836:(e,t,r)=>{let i=r(29536),n=r(37529),s=r(62844),a=r(74113),o=r(73795),l=r(82660),u=r(74230),c=r(48214),h=r(63036),d=r(65606),p=r(98025),f=new l,m=r(1395),g=r(38398),y=r(93980),v=r(45140),b=r(65483),w=r(75013),x=r(4563),S=r(60440),E=r(66710),T=r(54526),k=r(62644),O=r(47093),C=r(78891),A=r(67860),N=r(33997),R=r(32876),I={dataValidations:new g,sheetProperties:new y,sheetFormatProperties:new v,columns:new m({tag:"cols",length:!1,childXform:new b}),row:new w,hyperlinks:new m({tag:"hyperlinks",length:!1,childXform:new x}),sheetViews:new m({tag:"sheetViews",length:!1,childXform:new S}),sheetProtection:new E,pageMargins:new T,pageSeteup:new k,autoFilter:new O,picture:new C,conditionalFormattings:new A,headerFooter:new N,rowBreaks:new R};class P{constructor(e){this.id=e.id,this.name=e.name||`Sheet${this.id}`,this.state=e.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges=[],this._merges.add=function(){},this._sheetRelsWriter=new h(e),this._sheetCommentsWriter=new d(this,this._sheetRelsWriter,e),this._dimensions=new o,this._rowZero=1,this.committed=!1,this.dataValidations=new p,this._formulae={},this._siFormulae=0,this.conditionalFormatting=[],this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},e.properties),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},e.headerFooter),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:0xffffffff,verticalDpi:0xffffffff,fitToPage:!!(e.pageSetup&&(e.pageSetup.fitToWidth||e.pageSetup.fitToHeight)&&!e.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},e.pageSetup),this.useSharedStrings=e.useSharedStrings||!1,this._workbook=e.workbook,this.hasComments=!1,this._views=e.views||[],this.autoFilter=e.autoFilter||null,this._media=[],this.sheetProtection=null,this._writeOpenWorksheet(),this.startedData=!1}get workbook(){return this._workbook}get stream(){return this._stream||(this._stream=this._workbook._openStream(`/xl/worksheets/sheet${this.id}.xml`),this._stream.pause()),this._stream}destroy(){throw Error("Invalid Operation: destroy")}commit(){this.committed||(this._rows.forEach(e=>{e&&this._writeRow(e)}),this._rows=null,this.startedData||this._writeOpenSheetData(),this._writeCloseSheetData(),this._writeAutoFilter(),this._writeMergeCells(),this._writeHyperlinks(),this._writeConditionalFormatting(),this._writeDataValidations(),this._writeSheetProtection(),this._writePageMargins(),this._writePageSetup(),this._writeBackground(),this._writeHeaderFooter(),this._writeRowBreaks(),this._writeLegacyData(),this._writeCloseWorksheet(),this.stream.end(),this._sheetCommentsWriter.commit(),this._sheetRelsWriter.commit(),this.committed=!0)}get dimensions(){return this._dimensions}get views(){return this._views}get columns(){return this._columns}set columns(e){this._headerRowCount=e.reduce((e,t)=>Math.max(e,t.header&&1||t.headers&&t.headers.length||0),0);let t=1,r=this._columns=[];e.forEach(e=>{let i=new c(this,t++,!1);r.push(i),i.defn=e})}getColumnKey(e){return this._keys[e]}setColumnKey(e,t){this._keys[e]=t}deleteColumnKey(e){delete this._keys[e]}eachColumnKey(e){i.each(this._keys,e)}getColumn(e){if("string"==typeof e){let t=this._keys[e];if(t)return t;e=s.l2n(e)}if(this._columns||(this._columns=[]),e>this._columns.length){let t=this._columns.length+1;for(;t<=e;)this._columns.push(new c(this,t++))}return this._columns[e-1]}get _nextRow(){return this._rowZero+this._rows.length}eachRow(e,t){if(t||(t=e,e=void 0),e&&e.includeEmpty){let e=this._nextRow;for(let r=this._rowZero;r<e;r++)t(this.getRow(r),r)}else this._rows.forEach(e=>{e.hasValues&&t(e,e.number)})}_commitRow(e){let t=!1;for(;this._rows.length&&!t;){let r=this._rows.shift();this._rowZero++,r&&(this._writeRow(r),t=r.number===e.number,this._rowZero=r.number+1)}}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(e){let t=e-this._rowZero;return this._rows[t]}getRow(e){let t=e-this._rowZero;if(t<0)throw Error("Out of bounds: this row has been committed");let r=this._rows[t];return r||(this._rows[t]=r=new u(this,e)),r}addRow(e){let t=new u(this,this._nextRow);return this._rows[t.number-this._rowZero]=t,t.values=e,t}findCell(e,t){let r=s.getAddress(e,t),i=this.findRow(r.row);return i?i.findCell(r.column):void 0}getCell(e,t){let r=s.getAddress(e,t);return this.getRow(r.row).getCellEx(r)}mergeCells(...e){let t=new o(e);this._merges.forEach(e=>{if(e.intersects(t))throw Error("Cannot merge already merged cells")});let r=this.getCell(t.top,t.left);for(let e=t.top;e<=t.bottom;e++)for(let i=t.left;i<=t.right;i++)(e>t.top||i>t.left)&&this.getCell(e,i).merge(r);this._merges.push(t)}addConditionalFormatting(e){this.conditionalFormatting.push(e)}removeConditionalFormatting(e){"number"==typeof e?this.conditionalFormatting.splice(e,1):e instanceof Function?this.conditionalFormatting=this.conditionalFormatting.filter(e):this.conditionalFormatting=[]}addBackgroundImage(e){this._background={imageId:e}}getBackgroundImageId(){return this._background&&this._background.imageId}protect(e,t){return new Promise(r=>{this.sheetProtection={sheet:!0},t&&"spinCount"in t&&(t.spinCount=Number.isFinite(t.spinCount)?Math.round(Math.max(0,t.spinCount)):1e5),e&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=a.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=t&&"spinCount"in t?t.spinCount:1e5,this.sheetProtection.hashValue=a.convertPasswordToHash(e,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),t&&(this.sheetProtection=Object.assign(this.sheetProtection,t),!e&&"spinCount"in t&&delete this.sheetProtection.spinCount),r()})}unprotect(){this.sheetProtection=null}_write(e){f.reset(),f.addText(e),this.stream.write(f)}_writeSheetProperties(e,t,r){let i={outlineProperties:t&&t.outlineProperties,tabColor:t&&t.tabColor,pageSetup:r&&r.fitToPage?{fitToPage:r.fitToPage}:void 0};e.addText(I.sheetProperties.toXml(i))}_writeSheetFormatProperties(e,t){let r=t?{defaultRowHeight:t.defaultRowHeight,dyDescent:t.dyDescent,outlineLevelCol:t.outlineLevelCol,outlineLevelRow:t.outlineLevelRow}:void 0;t.defaultColWidth&&(r.defaultColWidth=t.defaultColWidth),e.addText(I.sheetFormatProperties.toXml(r))}_writeOpenWorksheet(){f.reset(),f.addText('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'),f.addText('<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'),this._writeSheetProperties(f,this.properties,this.pageSetup),f.addText(I.sheetViews.toXml(this.views)),this._writeSheetFormatProperties(f,this.properties),this.stream.write(f)}_writeColumns(){let e=c.toModel(this.columns);e&&(I.columns.prepare(e,{styles:this._workbook.styles}),this.stream.write(I.columns.toXml(e)))}_writeOpenSheetData(){this._write("<sheetData>")}_writeRow(e){if(this.startedData||(this._writeColumns(),this._writeOpenSheetData(),this.startedData=!0),e.hasValues||e.height){let{model:t}=e,r={styles:this._workbook.styles,sharedStrings:this.useSharedStrings?this._workbook.sharedStrings:void 0,hyperlinks:this._sheetRelsWriter.hyperlinksProxy,merges:this._merges,formulae:this._formulae,siFormulae:this._siFormulae,comments:[]};I.row.prepare(t,r),this.stream.write(I.row.toXml(t)),r.comments.length&&(this.hasComments=!0,this._sheetCommentsWriter.addComments(r.comments))}}_writeCloseSheetData(){this._write("</sheetData>")}_writeMergeCells(){this._merges.length&&(f.reset(),f.addText(`<mergeCells count="${this._merges.length}">`),this._merges.forEach(e=>{f.addText(`<mergeCell ref="${e}"/>`)}),f.addText("</mergeCells>"),this.stream.write(f))}_writeHyperlinks(){this.stream.write(I.hyperlinks.toXml(this._sheetRelsWriter._hyperlinks))}_writeConditionalFormatting(){let e={styles:this._workbook.styles};I.conditionalFormattings.prepare(this.conditionalFormatting,e),this.stream.write(I.conditionalFormattings.toXml(this.conditionalFormatting))}_writeRowBreaks(){this.stream.write(I.rowBreaks.toXml(this.rowBreaks))}_writeDataValidations(){this.stream.write(I.dataValidations.toXml(this.dataValidations.model))}_writeSheetProtection(){this.stream.write(I.sheetProtection.toXml(this.sheetProtection))}_writePageMargins(){this.stream.write(I.pageMargins.toXml(this.pageSetup.margins))}_writePageSetup(){this.stream.write(I.pageSeteup.toXml(this.pageSetup))}_writeHeaderFooter(){this.stream.write(I.headerFooter.toXml(this.headerFooter))}_writeAutoFilter(){this.stream.write(I.autoFilter.toXml(this.autoFilter))}_writeBackground(){if(this._background){if(void 0!==this._background.imageId){let e=this._workbook.getImage(this._background.imageId),t=this._sheetRelsWriter.addMedia({Target:`../media/${e.name}`,Type:n.Image});this._background={...this._background,rId:t}}this.stream.write(I.picture.toXml({rId:this._background.rId}))}}_writeLegacyData(){this.hasComments&&(f.reset(),f.addText(`<legacyDrawing r:id="${this._sheetCommentsWriter.vmlRelId}"/>`),this.stream.write(f))}_writeDimensions(){}_writeCloseWorksheet(){this._write("</worksheet>")}}e.exports=P},2895:(e,t)=>{let r="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");t.bufferToString=function(e){return"string"==typeof e?e:r?r.decode(e):e.toString()}},51539:(e,t,r)=>{let i="undefined"==typeof TextEncoder?null:new TextEncoder("utf-8"),{Buffer:n}=r(79428);t.stringToBuffer=function(e){return"string"!=typeof e?e:i?n.from(i.encode(e).buffer):n.from(e)}},21227:(e,t,r)=>{let i=r(29536),n=r(62844);class s{constructor(e){this.template=e,this.sheets={}}addCell(e){this.addCellEx(n.decodeEx(e))}getCell(e){return this.findCellEx(n.decodeEx(e),!0)}findCell(e){return this.findCellEx(n.decodeEx(e),!1)}findCellAt(e,t,r){let i=this.sheets[e],n=i&&i[t];return n&&n[r]}addCellEx(e){if(e.top)for(let t=e.top;t<=e.bottom;t++)for(let r=e.left;r<=e.right;r++)this.getCellAt(e.sheetName,t,r);else this.findCellEx(e,!0)}getCellEx(e){return this.findCellEx(e,!0)}findCellEx(e,t){let r=this.findSheet(e,t),i=this.findSheetRow(r,e,t);return this.findRowCell(i,e,t)}getCellAt(e,t,r){let i=this.sheets[e]||(this.sheets[e]=[]),s=i[t]||(i[t]=[]);return s[r]||(s[r]={sheetName:e,address:n.n2l(r)+t,row:t,col:r})}removeCellEx(e){let t=this.findSheet(e);if(!t)return;let r=this.findSheetRow(t,e);r&&delete r[e.col]}forEachInSheet(e,t){let r=this.sheets[e];r&&r.forEach((e,r)=>{e&&e.forEach((e,i)=>{e&&t(e,r,i)})})}forEach(e){i.each(this.sheets,(t,r)=>{this.forEachInSheet(r,e)})}map(e){let t=[];return this.forEach(r=>{t.push(e(r))}),t}findSheet(e,t){let r=e.sheetName;return this.sheets[r]?this.sheets[r]:t?this.sheets[r]=[]:void 0}findSheetRow(e,t,r){let{row:i}=t;return e&&e[i]?e[i]:r?e[i]=[]:void 0}findRowCell(e,t,r){let{col:i}=t;return e&&e[i]?e[i]:r?e[i]=this.template?Object.assign(t,JSON.parse(JSON.stringify(this.template))):t:void 0}spliceRows(e,t,r,i){let n=this.sheets[e];if(n){let e=[];for(let t=0;t<i;t++)e.push([]);n.splice(t,r,...e)}}spliceColumns(e,t,r,n){let s=this.sheets[e];if(s){let e=[];for(let t=0;t<n;t++)e.push(null);i.each(s,i=>{i.splice(t,r,...e)})}}}e.exports=s},62844:e=>{let t=/^[A-Z]+\d+$/,r={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:e=>e<=26?1:e<=676?2:3,_fill(e){let t,r,i,n,s;let a=1;if(e>=4)throw Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&e>=1){for(;a<=26;)t=this._dictionary[a-1],this._n2l[a]=t,this._l2n[t]=a,a++;this._l2nFill=1}if(this._l2nFill<2&&e>=2){for(a=27;a<=702;)i=(r=a-27)%26,n=Math.floor(r/26),t=this._dictionary[n]+this._dictionary[i],this._n2l[a]=t,this._l2n[t]=a,a++;this._l2nFill=2}if(this._l2nFill<3&&e>=3){for(a=703;a<=16384;)i=(r=a-703)%26,n=Math.floor(r/26)%26,s=Math.floor(r/676),t=this._dictionary[s]+this._dictionary[n]+this._dictionary[i],this._n2l[a]=t,this._l2n[t]=a,a++;this._l2nFill=3}},l2n(e){if(this._l2n[e]||this._fill(e.length),!this._l2n[e])throw Error(`Out of bounds. Invalid column letter: ${e}`);return this._l2n[e]},n2l(e){if(e<1||e>16384)throw Error(`${e} is out of bounds. Excel supports columns from 1 to 16384`);return this._n2l[e]||this._fill(this._level(e)),this._n2l[e]},_hash:{},validateAddress(e){if(!t.test(e))throw Error(`Invalid Address: ${e}`);return!0},decodeAddress(e){let t=e.length<5&&this._hash[e];if(t)return t;let r=!1,i="",n=0,s=!1,a="",o=0;for(let t=0,l;t<e.length;t++)if(l=e.charCodeAt(t),!s&&l>=65&&l<=90)r=!0,i+=e[t],n=26*n+l-64;else if(l>=48&&l<=57)s=!0,a+=e[t],o=10*o+l-48;else if(s&&r&&36!==l)break;if(r){if(n>16384)throw Error(`Out of bounds. Invalid column letter: ${i}`)}else n=void 0;s||(o=void 0);let l={address:e=i+a,col:n,row:o,$col$row:`$${i}$${a}`};return n<=100&&o<=100&&(this._hash[e]=l,this._hash[l.$col$row]=l),l},getAddress(e,t){if(t){let r=this.n2l(t)+e;return this.decodeAddress(r)}return this.decodeAddress(e)},decode(e){let t=e.split(":");if(2===t.length){let e=this.decodeAddress(t[0]),r=this.decodeAddress(t[1]),i={top:Math.min(e.row,r.row),left:Math.min(e.col,r.col),bottom:Math.max(e.row,r.row),right:Math.max(e.col,r.col)};return i.tl=this.n2l(i.left)+i.top,i.br=this.n2l(i.right)+i.bottom,i.dimensions=`${i.tl}:${i.br}`,i}return this.decodeAddress(e)},decodeEx(e){let t=e.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),r=t[1]||t[2],i=t[3],n=i.split(":");if(n.length>1){let e=this.decodeAddress(n[0]),t=this.decodeAddress(n[1]),i=Math.min(e.row,t.row),s=Math.min(e.col,t.col),a=Math.max(e.row,t.row),o=Math.max(e.col,t.col);return e=this.n2l(s)+i,t=this.n2l(o)+a,{top:i,left:s,bottom:a,right:o,sheetName:r,tl:{address:e,col:s,row:i,$col$row:`$${this.n2l(s)}$${i}`,sheetName:r},br:{address:t,col:o,row:a,$col$row:`$${this.n2l(o)}$${a}`,sheetName:r},dimensions:`${e}:${t}`}}if(i.startsWith("#"))return r?{sheetName:r,error:i}:{error:i};let s=this.decodeAddress(i);return r?{sheetName:r,...s}:s},encodeAddress:(e,t)=>r.n2l(t)+e,encode(){switch(arguments.length){case 2:return r.encodeAddress(arguments[0],arguments[1]);case 4:return`${r.encodeAddress(arguments[0],arguments[1])}:${r.encodeAddress(arguments[2],arguments[3])}`;default:throw Error("Can only encode with 2 or 4 arguments")}},inRange(e,t){let[r,i,,n,s]=e,[a,o]=t;return a>=r&&a<=n&&o>=i&&o<=s}};e.exports=r},24420:(e,t)=>{let r=(e,t)=>({...e,...t.reduce((t,r)=>(e[r]&&(t[r]={...e[r]}),t),{})}),i=(e,t,i,n=[])=>{e[i]&&(t[i]=r(e[i],n))},n=e=>0===Object.keys(e).length;t.copyStyle=e=>{if(!e)return e;if(n(e))return{};let t={...e};return i(e,t,"font",["color"]),i(e,t,"alignment"),i(e,t,"protection"),e.border&&(i(e,t,"border"),i(e.border,t.border,"top",["color"]),i(e.border,t.border,"left",["color"]),i(e.border,t.border,"bottom",["color"]),i(e.border,t.border,"right",["color"]),i(e.border,t.border,"diagonal",["color"])),e.fill&&(i(e,t,"fill",["fgColor","bgColor","center"]),e.fill.stops&&(t.fill.stops=e.fill.stops.map(e=>r(e,["color"])))),t}},74113:(e,t,r)=>{"use strict";let i=r(55511);e.exports={hash(e,...t){let r=i.createHash(e);return r.update(Buffer.concat(t)),r.digest()},convertPasswordToHash(e,t,r,n){if(t=t.toLowerCase(),0>i.getHashes().indexOf(t))throw Error(`Hash algorithm '${t}' not supported!`);let s=Buffer.from(e,"utf16le"),a=this.hash(t,Buffer.from(r,"base64"),s);for(let e=0;e<n;e++){let r=Buffer.alloc(4);r.writeUInt32LE(e,0),a=this.hash(t,a,r)}return a.toString("base64")},randomBytes:e=>i.randomBytes(e)}},97204:e=>{e.exports=async function*(e){let t;let r=[];e.on("data",e=>r.push(e));let i=new Promise(e=>t=e),n=!1;e.on("end",()=>{n=!0,t()});let s=!1;for(e.on("error",e=>{s=e,t()});!n||r.length>0;){if(0===r.length)e.resume(),await Promise.race([function(e,t){return new Promise(r=>{let i=!1,n=()=>{i||(i=!0,e.removeListener(t,n),r())};e.addListener(t,n)})}(e,"data"),i]);else{e.pause();let t=r.shift();yield t}if(s)throw s}t()}},79471:(e,t,r)=>{let{SaxesParser:i}=r(15959),{PassThrough:n}=r(68280),{bufferToString:s}=r(2895);e.exports=async function*(e){let t;e.pipe&&!e[Symbol.asyncIterator]&&(e=e.pipe(new n));let r=new i;r.on("error",e=>{t=e});let a=[];for await(let i of(r.on("opentag",e=>a.push({eventType:"opentag",value:e})),r.on("text",e=>a.push({eventType:"text",value:e})),r.on("closetag",e=>a.push({eventType:"closetag",value:e})),e)){if(r.write(s(i)),t)throw t;yield a,a=[]}}},83479:(e,t,r)=>{let i=r(62844),n=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,s=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;e.exports={slideFormula:function(e,t,r){let a=i.decode(t),o=i.decode(r);return e.replace(n,(e,t,r,n,l)=>{if(l)return e;let u=s.exec(n);if(u){let r=u[1],n=u[2].toUpperCase(),s=u[3],l=u[4];if(n.length>3||3===n.length&&n>"XFD")return e;let c=i.l2n(n),h=parseInt(l,10);return r||(c+=o.col-a.col),s||(h+=o.row-a.row),(t||"")+(r||"")+i.n2l(c)+(s||"")+h}return e})}}},10107:e=>{class t{constructor(){this._values=[],this._totalRefs=0,this._hash=Object.create(null)}get count(){return this._values.length}get values(){return this._values}get totalRefs(){return this._totalRefs}getString(e){return this._values[e]}add(e){let t=this._hash[e];return void 0===t&&(t=this._hash[e]=this._values.length,this._values.push(e)),this._totalRefs++,t}}e.exports=t},53881:(e,t,r)=>{let i=r(68280),n=r(86968),s=r(82660);class a{constructor(e,t){this._data=e,this._encoding=t}get length(){return this.toBuffer().length}copy(e,t,r,i){return this.toBuffer().copy(e,t,r,i)}toBuffer(){return this._buffer||(this._buffer=Buffer.from(this._data,this._encoding)),this._buffer}}class o{constructor(e){this._data=e}get length(){return this._data.length}copy(e,t,r,i){return this._data._buf.copy(e,t,r,i)}toBuffer(){return this._data.toBuffer()}}class l{constructor(e){this._data=e}get length(){return this._data.length}copy(e,t,r,i){this._data.copy(e,t,r,i)}toBuffer(){return this._data}}class u{constructor(e){this.size=e,this.buffer=Buffer.alloc(e),this.iRead=0,this.iWrite=0}toBuffer(){if(0===this.iRead&&this.iWrite===this.size)return this.buffer;let e=Buffer.alloc(this.iWrite-this.iRead);return this.buffer.copy(e,0,this.iRead,this.iWrite),e}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(e){let t;return 0===e?null:(void 0===e||e>=this.length?(t=this.toBuffer(),this.iRead=this.iWrite):(t=Buffer.alloc(e),this.buffer.copy(t,0,this.iRead,e),this.iRead+=e),t)}write(e,t,r){let i=Math.min(r,this.size-this.iWrite);return e.copy(this.buffer,this.iWrite,t,t+i),this.iWrite+=i,i}}let c=function(e){e=e||{},this.bufSize=e.bufSize||1048576,this.buffers=[],this.batch=e.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};n.inherits(c,i.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return Buffer.concat(this.buffers.map(e=>e.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){let e=this.buffers[this.buffers.length-1];if(!e.full)return e}let e=new u(this.bufSize);return this.buffers.push(e),e},async _pipe(e){await Promise.all(this.pipes.map(function(t){return new Promise(r=>{t.write(e.toBuffer(),()=>{r()})})}))},_writeToBuffers(e){let t=0,r=e.length;for(;t<r;){let i=this._getWritableBuffer();t+=i.write(e,t,r-t)}},async write(e,t,r){let i;if(t instanceof Function&&(r=t,t="utf8"),r=r||n.nop,e instanceof s)i=new o(e);else if(e instanceof Buffer)i=new l(e);else if("string"==typeof e||e instanceof String||e instanceof ArrayBuffer)i=new a(e,t);else throw Error("Chunk must be one of type String, Buffer or StringBuf.");if(this.pipes.length){if(this.batch)for(this._writeToBuffers(i);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(i),process.nextTick(r)):(await this._pipe(i),r())}else this.paused||this.emit("data",i.toBuffer()),this._writeToBuffers(i),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(e,t,r){let i=e=>{e?r(e):(this._flush(),this.pipes.forEach(e=>{e.end()}),this.emit("finish"))};e?this.write(e,t,i):i()},read(e){let t;if(e){for(t=[];e&&this.buffers.length&&!this.buffers[0].eod;){let r=this.buffers[0],i=r.read(e);e-=i.length,t.push(i),r.eod&&r.full&&this.buffers.shift()}return Buffer.concat(t)}return t=this.buffers.map(e=>e.toBuffer()).filter(Boolean),this.buffers=[],Buffer.concat(t)},setEncoding(e){this.encoding=e},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(e){this.pipes.push(e),!this.paused&&this.buffers.length&&this.end()},unpipe(e){this.pipes=this.pipes.filter(t=>t!==e)},unshift(){throw Error("Not Implemented")},wrap(){throw Error("Not Implemented")}}),e.exports=c},82660:e=>{class t{constructor(e){this._buf=Buffer.alloc(e&&e.size||16384),this._encoding=e&&e.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=Buffer.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(e){e=e||0,this._buffer=void 0,this._inPos=e}_grow(e){let t=2*this._buf.length;for(;t<e;)t*=2;let r=Buffer.alloc(t);this._buf.copy(r,0),this._buf=r}addText(e){this._buffer=void 0;let t=this._inPos+this._buf.write(e,this._inPos,this._encoding);for(;t>=this._buf.length-4;)this._grow(this._inPos+e.length),t=this._inPos+this._buf.write(e,this._inPos,this._encoding);this._inPos=t}addStringBuf(e){e.length&&(this._buffer=void 0,this.length+e.length>this.capacity&&this._grow(this.length+e.length),e._buf.copy(this._buf,this._inPos,0,e.length),this._inPos+=e.length)}}e.exports=t},29536:e=>{let{toString:t}=Object.prototype,r=/["&<>]/,i={each:function(e,t){e&&(Array.isArray(e)?e.forEach(t):Object.keys(e).forEach(r=>{t(e[r],r)}))},some:function(e,t){return!!e&&(Array.isArray(e)?e.some(t):Object.keys(e).some(r=>t(e[r],r)))},every:function(e,t){return!e||(Array.isArray(e)?e.every(t):Object.keys(e).every(r=>t(e[r],r)))},map:function(e,t){return e?Array.isArray(e)?e.map(t):Object.keys(e).map(r=>t(e[r],r)):[]},keyBy:(e,t)=>e.reduce((e,r)=>(e[r[t]]=r,e),{}),isEqual:function(e,t){let r;let n=typeof e,s=typeof t,a=Array.isArray(e),o=Array.isArray(t);if(n!==s)return!1;if("object"==typeof e){if(a||o)return!!a&&!!o&&e.length===t.length&&e.every((e,r)=>{let n=t[r];return i.isEqual(e,n)});if(null===e||null===t)return e===t;if(r=Object.keys(e),Object.keys(t).length!==r.length)return!1;for(let e of r)if(!t.hasOwnProperty(e))return!1;return i.every(e,(e,r)=>{let n=t[r];return i.isEqual(e,n)})}return e===t},escapeHtml(e){let t=r.exec(e);if(!t)return e;let i="",n="",s=0,a=t.index;for(;a<e.length;a++){switch(e.charAt(a)){case'"':n="&quot;";break;case"&":n="&amp;";break;case"'":n="&apos;";break;case"<":n="&lt;";break;case">":n="&gt;";break;default:continue}s!==a&&(i+=e.substring(s,a)),s=a+1,i+=n}return s!==a?i+e.substring(s,a):i},strcmp:(e,t)=>e<t?-1:e>t?1:0,isUndefined:e=>"[object Undefined]"===t.call(e),isObject:e=>"[object Object]"===t.call(e),deepMerge(){let e,t,r;let n=arguments[0]||{},{length:s}=arguments;function a(s,a){e=n[a],r=Array.isArray(s),i.isObject(s)||r?(r?(r=!1,t=e&&Array.isArray(e)?e:[]):t=e&&i.isObject(e)?e:{},n[a]=i.deepMerge(t,s)):i.isUndefined(s)||(n[a]=s)}for(let e=0;e<s;e++)i.each(arguments[e],a);return n}};e.exports=i},86968:(e,t,r)=>{let i=r(29021),n=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,s={nop(){},promiseImmediate:e=>new Promise(t=>{global.setImmediate?setImmediate(()=>{t(e)}):setTimeout(()=>{t(e)},1)}),inherits:function(e,t,r,i){e.super_=t,i||(i=r,r=null),r&&Object.keys(r).forEach(t=>{Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))});let n={constructor:{value:e,enumerable:!1,writable:!1,configurable:!0}};i&&Object.keys(i).forEach(e=>{n[e]=Object.getOwnPropertyDescriptor(i,e)}),e.prototype=Object.create(t.prototype,n)},dateToExcel:(e,t)=>25569+e.getTime()/864e5-(t?1462:0),excelToDate:(e,t)=>new Date(Math.round((e-25569+(t?1462:0))*864e5)),parsePath(e){let t=e.lastIndexOf("/");return{path:e.substring(0,t),name:e.substring(t+1)}},getRelsPath(e){let t=s.parsePath(e);return`${t.path}/_rels/${t.name}.rels`},xmlEncode(e){let t=n.exec(e);if(!t)return e;let r="",i="",s=0,a=t.index;for(;a<e.length;a++){let t=e.charCodeAt(a);switch(t){case 34:i="&quot;";break;case 38:i="&amp;";break;case 39:i="&apos;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;case 127:i="";break;default:if(t<=31&&(t<=8||t>=11&&13!==t)){i="";break}continue}s!==a&&(r+=e.substring(s,a)),s=a+1,i&&(r+=i)}return s!==a?r+e.substring(s,a):r},xmlDecode:e=>e.replace(/&([a-z]*);/g,e=>{switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return e}}),validInt(e){let t=parseInt(e,10);return Number.isNaN(t)?0:t},isDateFmt:e=>!!e&&null!==(e=(e=e.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/),fs:{exists:e=>new Promise(t=>{i.access(e,i.constants.F_OK,e=>{t(!e)})})},toIsoDateString:e=>e.toIsoString().subsstr(0,10),parseBoolean:e=>!0===e||"true"===e||1===e||"1"===e};e.exports=s},43213:(e,t,r)=>{let i=r(29536),n=r(86968);function s(e,t,r){e.push(` ${t}="${n.xmlEncode(r.toString())}"`)}function a(e,t){if(t){let r=[];i.each(t,(e,t)=>{void 0!==e&&s(r,t,e)}),e.push(r.join(""))}}class o{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(e){let t=this._xml;t.push("<?xml"),a(t,e),t.push("?>\n")}openNode(e,t){let r=this.tos,i=this._xml;r&&this.open&&i.push(">"),this._stack.push(e),i.push("<"),i.push(e),a(i,t),this.leaf=!0,this.open=!0}addAttribute(e,t){if(!this.open)throw Error("Cannot write attributes to node if it is not open");void 0!==t&&s(this._xml,e,t)}addAttributes(e){if(!this.open)throw Error("Cannot write attributes to node if it is not open");a(this._xml,e)}writeText(e){let t=this._xml;this.open&&(t.push(">"),this.open=!1),this.leaf=!1,t.push(n.xmlEncode(e.toString()))}writeXml(e){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(e)}closeNode(){let e=this._stack.pop(),t=this._xml;this.leaf?t.push("/>"):(t.push("</"),t.push(e),t.push(">")),this.open=!1,this.leaf=!1}leafNode(e,t,r){this.openNode(e,t),void 0!==r&&this.writeText(r),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){let e=this._rollbacks.pop();this._xml.length>e.xml&&this._xml.splice(e.xml,this._xml.length-e.xml),this._stack.length>e.stack&&this._stack.splice(e.stack,this._stack.length-e.stack),this.leaf=e.leaf,this.open=e.open}get xml(){return this.closeAll(),this._xml.join("")}}o.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},e.exports=o},49803:(e,t,r)=>{let i=r(94735),n=r(65886),s=r(53881),{stringToBuffer:a}=r(51539);class o extends i.EventEmitter{constructor(e){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},e),this.zip=new n,this.stream=new s}append(e,t){t.hasOwnProperty("base64")&&t.base64?this.zip.file(t.name,e,{base64:!0}):this.zip.file(t.name,e)}async finalize(){let e=await this.zip.generateAsync(this.options);this.stream.end(e),this.emit("finish")}read(e){return this.stream.read(e)}setEncoding(e){return this.stream.setEncoding(e)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(e,t){return this.stream.pipe(e,t)}unpipe(e){return this.stream.unpipe(e)}unshift(e){return this.stream.unshift(e)}wrap(e){return this.stream.wrap(e)}}e.exports={ZipWriter:o}},33386:e=>{e.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},37529:e=>{"use strict";e.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},95774:(e,t,r)=>{let i=r(79471),n=r(43213);class s{prepare(){}render(){}parseOpen(e){}parseText(e){}parseClose(e){}reconcile(e,t){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(e=>{e instanceof s?e.reset():e.xform&&e.xform.reset()})}mergeModel(e){this.model=Object.assign(this.model||{},e)}async parse(e){for await(let t of e)for(let{eventType:e,value:r}of t)if("opentag"===e)this.parseOpen(r);else if("text"===e)this.parseText(r);else if("closetag"===e&&!this.parseClose(r.name))return this.model;return this.model}async parseStream(e){return this.parse(i(e))}get xml(){return this.toXml(this.model)}toXml(e){let t=new n;return this.render(t,e),t.xml}static toAttribute(e,t,r=!1){if(void 0===e){if(r)return t}else if(r||e!==t)return e.toString()}static toStringAttribute(e,t,r=!1){return s.toAttribute(e,t,r)}static toStringValue(e,t){return void 0===e?t:e}static toBoolAttribute(e,t,r=!1){if(void 0===e){if(r)return t}else if(r||e!==t)return e?"1":"0"}static toBoolValue(e,t){return void 0===e?t:"1"===e}static toIntAttribute(e,t,r=!1){return s.toAttribute(e,t,r)}static toIntValue(e,t){return void 0===e?t:parseInt(e,10)}static toFloatAttribute(e,t,r=!1){return s.toAttribute(e,t,r)}static toFloatValue(e,t){return void 0===e?t:parseFloat(e)}}e.exports=s},60460:(e,t,r)=>{let i=r(95774),n=r(62844);class s extends i{render(e,t){e.openNode("definedName",{name:t.name,localSheetId:t.localSheetId}),e.writeText(t.ranges.join(",")),e.closeNode()}parseOpen(e){return"definedName"===e.name&&(this._parsedName=e.attributes.name,this._parsedLocalSheetId=e.attributes.localSheetId,this._parsedText=[],!0)}parseText(e){this._parsedText.push(e)}parseClose(){return this.model={name:this._parsedName,ranges:function(e){let t=[],r=!1,i="";return e.split(",").forEach(e=>{if(!e)return;let n=(e.match(/'/g)||[]).length;if(!n){r?i+=`${e},`:a(e)&&t.push(e);return}let s=n%2==0;!r&&s&&a(e)?t.push(e):r&&!s?(r=!1,a(i+e)&&t.push(i+e),i=""):(r=!0,i+=`${e},`)}),t}(this._parsedText.join(""))},void 0!==this._parsedLocalSheetId&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}function a(e){try{return n.decodeEx(e),!0}catch(e){return!1}}e.exports=s},87358:(e,t,r)=>{let i=r(86968),n=r(95774);class s extends n{render(e,t){e.leafNode("sheet",{sheetId:t.id,name:t.name,state:t.state,"r:id":t.rId})}parseOpen(e){return"sheet"===e.name&&(this.model={name:i.xmlDecode(e.attributes.name),id:parseInt(e.attributes.sheetId,10),state:e.attributes.state,rId:e.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}e.exports=s},27779:(e,t,r)=>{let i=r(95774);class n extends i{render(e,t){e.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:t.fullCalcOnLoad?1:void 0})}parseOpen(e){return"calcPr"===e.name&&(this.model={},!0)}parseText(){}parseClose(){return!1}}e.exports=n},30271:(e,t,r)=>{let i=r(95774);class n extends i{render(e,t){e.leafNode("workbookPr",{date1904:t.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(e){return"workbookPr"===e.name&&(this.model={date1904:"1"===e.attributes.date1904},!0)}parseText(){}parseClose(){return!1}}e.exports=n},45779:(e,t,r)=>{let i=r(95774);class n extends i{render(e,t){let r={xWindow:t.x||0,yWindow:t.y||0,windowWidth:t.width||12e3,windowHeight:t.height||24e3,firstSheet:t.firstSheet,activeTab:t.activeTab};t.visibility&&"visible"!==t.visibility&&(r.visibility=t.visibility),e.leafNode("workbookView",r)}parseOpen(e){if("workbookView"===e.name){let t=this.model={},r=function(e,r,i){let n=void 0!==r?t[e]=parseInt(r,10):i;void 0!==n&&(t[e]=n)};return r("x",e.attributes.xWindow,0),r("y",e.attributes.yWindow,0),r("width",e.attributes.windowWidth,25e3),r("height",e.attributes.windowHeight,1e4),function(e,r,i){let n=void 0!==r?t[e]=r:i;void 0!==n&&(t[e]=n)}("visibility",e.attributes.visibility,"visible"),r("activeTab",e.attributes.activeTab,void 0),r("firstSheet",e.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}e.exports=n},50827:(e,t,r)=>{let i=r(29536),n=r(62844),s=r(43213),a=r(95774),o=r(70341),l=r(1395),u=r(60460),c=r(87358),h=r(45779),d=r(30271),p=r(27779);class f extends a{constructor(){super(),this.map={fileVersion:f.STATIC_XFORMS.fileVersion,workbookPr:new d,bookViews:new l({tag:"bookViews",count:!1,childXform:new h}),sheets:new l({tag:"sheets",count:!1,childXform:new c}),definedNames:new l({tag:"definedNames",count:!1,childXform:new u}),calcPr:new p}}prepare(e){e.sheets=e.worksheets;let t=[],r=0;e.sheets.forEach(e=>{if(e.pageSetup&&e.pageSetup.printArea&&e.pageSetup.printArea.split("&&").forEach(i=>{let n=i.split(":"),s={name:"_xlnm.Print_Area",ranges:[`'${e.name}'!$${n[0]}:$${n[1]}`],localSheetId:r};t.push(s)}),e.pageSetup&&(e.pageSetup.printTitlesRow||e.pageSetup.printTitlesColumn)){let i=[];if(e.pageSetup.printTitlesColumn){let t=e.pageSetup.printTitlesColumn.split(":");i.push(`'${e.name}'!$${t[0]}:$${t[1]}`)}if(e.pageSetup.printTitlesRow){let t=e.pageSetup.printTitlesRow.split(":");i.push(`'${e.name}'!$${t[0]}:$${t[1]}`)}let n={name:"_xlnm.Print_Titles",ranges:i,localSheetId:r};t.push(n)}r++}),t.length&&(e.definedNames=e.definedNames.concat(t)),(e.media||[]).forEach((e,t)=>{e.name=e.type+(t+1)})}render(e,t){e.openXml(s.StdDocAttributes),e.openNode("workbook",f.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(e),this.map.workbookPr.render(e,t.properties),this.map.bookViews.render(e,t.views),this.map.sheets.render(e,t.sheets),this.map.definedNames.render(e,t.definedNames),this.map.calcPr.render(e,t.calcProperties),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"workbook"===e.name||(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):"workbook"!==e||(this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1)}reconcile(e){let t;let r=(e.workbookRels||[]).reduce((e,t)=>(e[t.Id]=t,e),{}),s=[],a=0;(e.sheets||[]).forEach(i=>{let n=r[i.rId];n&&(t=e.worksheetHash[`xl/${n.Target.replace(/^(\s|\/xl\/)+/,"")}`])&&(t.name=i.name,t.id=i.id,t.state=i.state,s[a++]=t)});let o=[];i.each(e.definedNames,e=>{if("_xlnm.Print_Area"===e.name){if(t=s[e.localSheetId]){t.pageSetup||(t.pageSetup={});let r=n.decodeEx(e.ranges[0]);t.pageSetup.printArea=t.pageSetup.printArea?`${t.pageSetup.printArea}&&${r.dimensions}`:r.dimensions}}else if("_xlnm.Print_Titles"===e.name){if(t=s[e.localSheetId]){t.pageSetup||(t.pageSetup={});let r=e.ranges.join(","),i=/\$/g,n=r.match(/\$\d+:\$\d+/);if(n&&n.length){let e=n[0];t.pageSetup.printTitlesRow=e.replace(i,"")}let s=r.match(/\$[A-Z]+:\$[A-Z]+/);if(s&&s.length){let e=s[0];t.pageSetup.printTitlesColumn=e.replace(i,"")}}}else o.push(e)}),e.definedNames=o,e.media.forEach((e,t)=>{e.index=t})}}f.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},f.STATIC_XFORMS={fileVersion:new o({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},e.exports=f},69338:(e,t,r)=>{let i=r(7426),n=r(86968),s=r(95774),a=e.exports=function(e){this.model=e};n.inherits(a,s,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new i),this._richTextXform},render(e,t){t=t||this.model,e.openNode("comment",{ref:t.ref,authorId:0}),e.openNode("text"),t&&t.note&&t.note.texts&&t.note.texts.forEach(t=>{this.richTextXform.render(e,t)}),e.closeNode(),e.closeNode()},parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"comment":return this.model={type:"note",note:{texts:[]},...e.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(e),!0;default:return!1}},parseText(e){this.parser&&this.parser.parseText(e)},parseClose(e){switch(e){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(e),!0}}})},21491:(e,t,r)=>{let i=r(43213),n=r(86968),s=r(95774),a=r(69338),o=e.exports=function(){this.map={comment:new a}};n.inherits(o,s,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(e,t){t=t||this.model,e.openXml(i.StdDocAttributes),e.openNode("comments",o.COMMENTS_ATTRIBUTES),e.openNode("authors"),e.leafNode("author",null,"Author"),e.closeNode(),e.openNode("commentList"),t.comments.forEach(t=>{this.map.comment.render(e,t)}),e.closeNode(),e.closeNode()},parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(e),!0;default:return!1}},parseText(e){this.parser&&this.parser.parseText(e)},parseClose(e){switch(e){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(e),!0}}})},37570:(e,t,r)=>{let i=r(95774);class n extends i{constructor(e){super(),this._model=e}get tag(){return this._model&&this._model.tag}render(e,t,r){t===r[2]?e.leafNode(this.tag):"x:SizeWithCells"===this.tag&&t===r[1]&&e.leafNode(this.tag)}parseOpen(e){return e.name===this.tag&&(this.model={},this.model[this.tag]=!0,!0)}parseText(){}parseClose(){return!1}}e.exports=n},47394:(e,t,r)=>{let i=r(95774);class n extends i{constructor(e){super(),this._model=e}get tag(){return this._model&&this._model.tag}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(e){return e.name===this.tag&&(this.text="",!0)}parseText(e){this.text=e}parseClose(){return!1}}e.exports=n},91898:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"x:Anchor"}getAnchorRect(e){let t=Math.floor(e.left),r=Math.floor((e.left-t)*68),i=Math.floor(e.top),n=Math.floor((e.top-i)*18),s=Math.floor(e.right),a=Math.floor((e.right-s)*68),o=Math.floor(e.bottom),l=Math.floor((e.bottom-o)*18);return[t,r,i,n,s,a,o,l]}getDefaultRect(e){let t=e.col,r=Math.max(e.row-2,0);return[t,6,r,14,t+2,2,r+4,16]}render(e,t){let r=t.anchor?this.getAnchorRect(t.anchor):this.getDefaultRect(t.refAddress);e.leafNode("x:Anchor",null,r.join(", "))}parseOpen(e){return e.name===this.tag&&(this.text="",!0)}parseText(e){this.text=e}parseClose(){return!1}}e.exports=n},19187:(e,t,r)=>{let i=r(95774),n=r(91898),s=r(47394),a=r(37570),o=["twoCells","oneCells","absolute"];class l extends i{constructor(){super(),this.map={"x:Anchor":new n,"x:Locked":new s({tag:"x:Locked"}),"x:LockText":new s({tag:"x:LockText"}),"x:SizeWithCells":new a({tag:"x:SizeWithCells"}),"x:MoveWithCells":new a({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(e,t){let{protection:r,editAs:i}=t.note;e.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(e,i,o),this.map["x:SizeWithCells"].render(e,i,o),this.map["x:Anchor"].render(e,t),this.map["x:Locked"].render(e,r.locked),e.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(e,r.lockText),e.leafNode("x:Row",null,t.refAddress.row-1),e.leafNode("x:Column",null,t.refAddress.col-1),e.closeNode()}parseOpen(e){return e.name===this.tag?(this.reset(),this.model={anchor:[],protection:{},editAs:""}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.normalizeModel(),!1)}normalizeModel(){let e=Object.keys(Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model)).length;this.model.editAs=o[e],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}e.exports=l},7740:(e,t,r)=>{let i=r(43213),n=r(95774),s=r(99792);class a extends n{constructor(){super(),this.map={"v:shape":new s}}get tag(){return"xml"}render(e,t){e.openXml(i.StdDocAttributes),e.openNode(this.tag,a.DRAWING_ATTRIBUTES),e.openNode("o:shapelayout",{"v:ext":"edit"}),e.leafNode("o:idmap",{"v:ext":"edit",data:1}),e.closeNode(),e.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),e.leafNode("v:stroke",{joinstyle:"miter"}),e.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),e.closeNode(),t.comments.forEach((t,r)=>{this.map["v:shape"].render(e,t,r)}),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):e.name===this.tag?(this.reset(),this.model={comments:[]}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0):e!==this.tag}reconcile(e,t){e.anchors.forEach(e=>{e.br?this.map["xdr:twoCellAnchor"].reconcile(e,t):this.map["xdr:oneCellAnchor"].reconcile(e,t)})}}a.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},e.exports=a},99792:(e,t,r)=>{let i=r(95774),n=r(88041),s=r(19187);class a extends i{constructor(){super(),this.map={"v:textbox":new n,"x:ClientData":new s}}get tag(){return"v:shape"}render(e,t,r){e.openNode("v:shape",a.V_SHAPE_ATTRIBUTES(t,r)),e.leafNode("v:fill",{color2:"infoBackground [80]"}),e.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),e.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(e,t),this.map["x:ClientData"].render(e,t),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):e.name===this.tag?(this.reset(),this.model={margins:{insetmode:e.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1)}}a.V_SHAPE_ATTRIBUTES=(e,t)=>({id:`_x0000_s${1025+t}`,type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":e.note.margins&&e.note.margins.insetmode}),e.exports=a},88041:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"v:textbox"}conversionUnit(e,t,r){return`${parseFloat(e)*t.toFixed(2)}${r}`}reverseConversionUnit(e){return(e||"").split(",").map(e=>Number(parseFloat(this.conversionUnit(parseFloat(e),.1,"")).toFixed(2)))}render(e,t){let r={style:"mso-direction-alt:auto"};if(t&&t.note){let{inset:e}=t.note&&t.note.margins;Array.isArray(e)&&(e=e.map(e=>this.conversionUnit(e,10,"mm")).join(",")),e&&(r.inset=e)}e.openNode("v:textbox",r),e.leafNode("div",{style:"text-align:left"}),e.closeNode()}parseOpen(e){return e.name!==this.tag||(this.model={inset:this.reverseConversionUnit(e.attributes.inset)},!0)}parseText(){}parseClose(e){return e!==this.tag}}e.exports=n},58430:(e,t,r)=>{let i=r(95774);class n extends i{createNewModel(e){return{}}parseOpen(e){return(this.parser=this.parser||this.map[e.name],this.parser)?(this.parser.parseOpen(e),!0):e.name===this.tag&&(this.model=this.createNewModel(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}onParserClose(e,t){this.model[e]=t.model}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.onParserClose(e,this.parser),this.parser=void 0),!0):e!==this.tag}}e.exports=n},37911:(e,t,r)=>{let i=r(95774);class n extends i{render(e,t){e.openNode("HeadingPairs"),e.openNode("vt:vector",{size:2,baseType:"variant"}),e.openNode("vt:variant"),e.leafNode("vt:lpstr",void 0,"Worksheets"),e.closeNode(),e.openNode("vt:variant"),e.leafNode("vt:i4",void 0,t.length),e.closeNode(),e.closeNode(),e.closeNode()}parseOpen(e){return"HeadingPairs"===e.name}parseText(){}parseClose(e){return"HeadingPairs"!==e}}e.exports=n},34153:(e,t,r)=>{let i=r(95774);class n extends i{render(e,t){e.openNode("TitlesOfParts"),e.openNode("vt:vector",{size:t.length,baseType:"lpstr"}),t.forEach(t=>{e.leafNode("vt:lpstr",void 0,t.name)}),e.closeNode(),e.closeNode()}parseOpen(e){return"TitlesOfParts"===e.name}parseText(){}parseClose(e){return"TitlesOfParts"!==e}}e.exports=n},63936:(e,t,r)=>{let i=r(43213),n=r(95774),s=r(98395),a=r(37911),o=r(34153);class l extends n{constructor(){super(),this.map={Company:new s({tag:"Company"}),Manager:new s({tag:"Manager"}),HeadingPairs:new a,TitleOfParts:new o}}render(e,t){e.openXml(i.StdDocAttributes),e.openNode("Properties",l.PROPERTY_ATTRIBUTES),e.leafNode("Application",void 0,"Microsoft Excel"),e.leafNode("DocSecurity",void 0,"0"),e.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(e,t.worksheets),this.map.TitleOfParts.render(e,t.worksheets),this.map.Company.render(e,t.company||""),this.map.Manager.render(e,t.manager),e.leafNode("LinksUpToDate",void 0,"false"),e.leafNode("SharedDoc",void 0,"false"),e.leafNode("HyperlinksChanged",void 0,"false"),e.leafNode("AppVersion",void 0,"16.0300"),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"Properties"===e.name||(this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):"Properties"!==e||(this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1)}}l.DateFormat=function(e){return e.toISOString().replace(/[.]\d{3,6}/,"")},l.DateAttrs={"xsi:type":"dcterms:W3CDTF"},l.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},e.exports=l},11546:(e,t,r)=>{let i=r(43213),n=r(95774);class s extends n{render(e,t){e.openXml(i.StdDocAttributes),e.openNode("Types",s.PROPERTY_ATTRIBUTES);let r={};(t.media||[]).forEach(t=>{if("image"===t.type){let i=t.extension;r[i]||(r[i]=!0,e.leafNode("Default",{Extension:i,ContentType:`image/${i}`}))}}),e.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),e.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),e.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),t.worksheets.forEach(t=>{let r=`/xl/worksheets/sheet${t.id}.xml`;e.leafNode("Override",{PartName:r,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),e.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),e.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),t.sharedStrings&&t.sharedStrings.count&&e.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),t.tables&&t.tables.forEach(t=>{e.leafNode("Override",{PartName:`/xl/tables/${t.target}`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),t.drawings&&t.drawings.forEach(t=>{e.leafNode("Override",{PartName:`/xl/drawings/${t.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),t.commentRefs&&(e.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),t.commentRefs.forEach(({commentName:t})=>{e.leafNode("Override",{PartName:`/xl/${t}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),e.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),e.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),e.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}s.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},e.exports=s},43702:(e,t,r)=>{let i=r(43213),n=r(95774),s=r(44966),a=r(98395),o=r(17944);class l extends n{constructor(){super(),this.map={"dc:creator":new a({tag:"dc:creator"}),"dc:title":new a({tag:"dc:title"}),"dc:subject":new a({tag:"dc:subject"}),"dc:description":new a({tag:"dc:description"}),"dc:identifier":new a({tag:"dc:identifier"}),"dc:language":new a({tag:"dc:language"}),"cp:keywords":new a({tag:"cp:keywords"}),"cp:category":new a({tag:"cp:category"}),"cp:lastModifiedBy":new a({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new s({tag:"cp:lastPrinted",format:l.DateFormat}),"cp:revision":new o({tag:"cp:revision"}),"cp:version":new a({tag:"cp:version"}),"cp:contentStatus":new a({tag:"cp:contentStatus"}),"cp:contentType":new a({tag:"cp:contentType"}),"dcterms:created":new s({tag:"dcterms:created",attrs:l.DateAttrs,format:l.DateFormat}),"dcterms:modified":new s({tag:"dcterms:modified",attrs:l.DateAttrs,format:l.DateFormat})}}render(e,t){e.openXml(i.StdDocAttributes),e.openNode("cp:coreProperties",l.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(e,t.creator),this.map["dc:title"].render(e,t.title),this.map["dc:subject"].render(e,t.subject),this.map["dc:description"].render(e,t.description),this.map["dc:identifier"].render(e,t.identifier),this.map["dc:language"].render(e,t.language),this.map["cp:keywords"].render(e,t.keywords),this.map["cp:category"].render(e,t.category),this.map["cp:lastModifiedBy"].render(e,t.lastModifiedBy),this.map["cp:lastPrinted"].render(e,t.lastPrinted),this.map["cp:revision"].render(e,t.revision),this.map["cp:version"].render(e,t.version),this.map["cp:contentStatus"].render(e,t.contentStatus),this.map["cp:contentType"].render(e,t.contentType),this.map["dcterms:created"].render(e,t.created),this.map["dcterms:modified"].render(e,t.modified),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[e.name],this.parser)return this.parser.parseOpen(e),!0;throw Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw Error(`Unexpected xml node in parseClose: ${e}`)}}}l.DateFormat=function(e){return e.toISOString().replace(/[.]\d{3}/,"")},l.DateAttrs={"xsi:type":"dcterms:W3CDTF"},l.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},e.exports=l},571:(e,t,r)=>{let i=r(95774);class n extends i{render(e,t){e.leafNode("Relationship",t)}parseOpen(e){return"Relationship"===e.name&&(this.model=e.attributes,!0)}parseText(){}parseClose(){return!1}}e.exports=n},60180:(e,t,r)=>{let i=r(43213),n=r(95774),s=r(571);class a extends n{constructor(){super(),this.map={Relationship:new s}}render(e,t){t=t||this._values,e.openXml(i.StdDocAttributes),e.openNode("Relationships",a.RELATIONSHIPS_ATTRIBUTES),t.forEach(t=>{this.map.Relationship.render(e,t)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("Relationships"===e.name)return this.model=[],!0;if(this.parser=this.map[e.name],this.parser)return this.parser.parseOpen(e),!0;throw Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.push(this.parser.model),this.parser=void 0),!0;if("Relationships"===e)return!1;throw Error(`Unexpected xml node in parseClose: ${e}`)}}a.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},e.exports=a},88306:(e,t,r)=>{let i=r(95774);class n extends i{parseOpen(e){return this.parser?this.parser.parseOpen(e):e.name===this.tag?(this.reset(),this.model={range:{editAs:e.attributes.editAs||"oneCell"}}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}reconcilePicture(e,t){if(e&&e.rId){let r=t.rels[e.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(r){let e=r[1],i=t.mediaIndex[e];return t.media[i]}}}}e.exports=n},30907:(e,t,r)=>{let i=r(95774),n=r(81767);class s extends i{constructor(){super(),this.map={"a:blip":new n}}get tag(){return"xdr:blipFill"}render(e,t){e.openNode(this.tag),this.map["a:blip"].render(e,t),e.openNode("a:stretch"),e.leafNode("a:fillRect"),e.closeNode(),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):e.name===this.tag?this.reset():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model=this.map["a:blip"].model,!1)}}e.exports=s},81767:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"a:blip"}render(e,t){e.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":t.rId,cstate:"print"})}parseOpen(e){return e.name!==this.tag||(this.model={rId:e.attributes["r:embed"]},!0)}parseText(){}parseClose(e){return e!==this.tag}}e.exports=n},69262:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"xdr:cNvPicPr"}render(e){e.openNode(this.tag),e.leafNode("a:picLocks",{noChangeAspect:"1"}),e.closeNode()}parseOpen(e){return e.name,this.tag,!0}parseText(){}parseClose(e){return e!==this.tag}}e.exports=n},43601:(e,t,r)=>{let i=r(95774),n=r(84461),s=r(17609);class a extends i{constructor(){super(),this.map={"a:hlinkClick":new n,"a:extLst":new s}}get tag(){return"xdr:cNvPr"}render(e,t){e.openNode(this.tag,{id:t.index,name:`Picture ${t.index}`}),this.map["a:hlinkClick"].render(e,t),this.map["a:extLst"].render(e,t),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):e.name===this.tag?this.reset():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model=this.map["a:hlinkClick"].model,!1)}}e.exports=a},21916:(e,t,r)=>{let i=r(95774),n=r(17944);class s extends i{constructor(e){super(),this.tag=e.tag,this.map={"xdr:col":new n({tag:"xdr:col",zero:!0}),"xdr:colOff":new n({tag:"xdr:colOff",zero:!0}),"xdr:row":new n({tag:"xdr:row",zero:!0}),"xdr:rowOff":new n({tag:"xdr:rowOff",zero:!0})}}render(e,t){e.openNode(this.tag),this.map["xdr:col"].render(e,t.nativeCol),this.map["xdr:colOff"].render(e,t.nativeColOff),this.map["xdr:row"].render(e,t.nativeRow),this.map["xdr:rowOff"].render(e,t.nativeRowOff),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):e.name===this.tag?this.reset():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1)}}e.exports=s},72534:(e,t,r)=>{let i=r(62844),n=r(43213),s=r(95774),a=r(14405),o=r(18199);class l extends s{constructor(){super(),this.map={"xdr:twoCellAnchor":new a,"xdr:oneCellAnchor":new o}}prepare(e){e.anchors.forEach((e,t)=>{e.anchorType=("string"==typeof e.range?i.decode(e.range):e.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor",this.map[e.anchorType].prepare(e,{index:t})})}get tag(){return"xdr:wsDr"}render(e,t){e.openXml(n.StdDocAttributes),e.openNode(this.tag,l.DRAWING_ATTRIBUTES),t.anchors.forEach(t=>{this.map[t.anchorType].render(e,t)}),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):e.name===this.tag?(this.reset(),this.model={anchors:[]}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0):e!==this.tag}reconcile(e,t){e.anchors.forEach(e=>{e.br?this.map["xdr:twoCellAnchor"].reconcile(e,t):this.map["xdr:oneCellAnchor"].reconcile(e,t)})}}l.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},e.exports=l},17609:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"a:extLst"}render(e){e.openNode(this.tag),e.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),e.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),e.closeNode(),e.closeNode()}parseOpen(e){return e.name,this.tag,!0}parseText(){}parseClose(e){return e!==this.tag}}e.exports=n},26091:(e,t,r)=>{let i=r(95774);class n extends i{constructor(e){super(),this.tag=e.tag,this.map={}}render(e,t){e.openNode(this.tag);let r=Math.floor(9525*t.width),i=Math.floor(9525*t.height);e.addAttribute("cx",r),e.addAttribute("cy",i),e.closeNode()}parseOpen(e){return e.name===this.tag&&(this.model={width:parseInt(e.attributes.cx||"0",10)/9525,height:parseInt(e.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}e.exports=n},84461:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"a:hlinkClick"}render(e,t){t.hyperlinks&&t.hyperlinks.rId&&e.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":t.hyperlinks.rId,tooltip:t.hyperlinks.tooltip})}parseOpen(e){return e.name!==this.tag||(this.model={hyperlinks:{rId:e.attributes["r:id"],tooltip:e.attributes.tooltip}},!0)}parseText(){}parseClose(){return!1}}e.exports=n},67298:(e,t,r)=>{let i=r(95774),n=r(43601),s=r(69262);class a extends i{constructor(){super(),this.map={"xdr:cNvPr":new n,"xdr:cNvPicPr":new s}}get tag(){return"xdr:nvPicPr"}render(e,t){e.openNode(this.tag),this.map["xdr:cNvPr"].render(e,t),this.map["xdr:cNvPicPr"].render(e,t),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):e.name===this.tag?this.reset():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model=this.map["xdr:cNvPr"].model,!1)}}e.exports=a},18199:(e,t,r)=>{let i=r(88306),n=r(70341),s=r(21916),a=r(26091),o=r(11828);class l extends i{constructor(){super(),this.map={"xdr:from":new s({tag:"xdr:from"}),"xdr:ext":new a({tag:"xdr:ext"}),"xdr:pic":new o,"xdr:clientData":new n({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(e,t){this.map["xdr:pic"].prepare(e.picture,t)}render(e,t){e.openNode(this.tag,{editAs:t.range.editAs||"oneCell"}),this.map["xdr:from"].render(e,t.range.tl),this.map["xdr:ext"].render(e,t.range.ext),this.map["xdr:pic"].render(e,t.picture),this.map["xdr:clientData"].render(e,{}),e.closeNode()}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1)}reconcile(e,t){e.medium=this.reconcilePicture(e.picture,t)}}e.exports=l},11828:(e,t,r)=>{let i=r(95774),n=r(70341),s=r(30907),a=r(67298),o=r(99999);class l extends i{constructor(){super(),this.map={"xdr:nvPicPr":new a,"xdr:blipFill":new s,"xdr:spPr":new n(o)}}get tag(){return"xdr:pic"}prepare(e,t){e.index=t.index+1}render(e,t){e.openNode(this.tag),this.map["xdr:nvPicPr"].render(e,t),this.map["xdr:blipFill"].render(e,t),this.map["xdr:spPr"].render(e,t),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):e.name===this.tag?this.reset():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.mergeModel(this.parser.model),this.parser=void 0),!0):e!==this.tag}}e.exports=l},99999:e=>{e.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},14405:(e,t,r)=>{let i=r(88306),n=r(70341),s=r(21916),a=r(11828);class o extends i{constructor(){super(),this.map={"xdr:from":new s({tag:"xdr:from"}),"xdr:to":new s({tag:"xdr:to"}),"xdr:pic":new a,"xdr:clientData":new n({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(e,t){this.map["xdr:pic"].prepare(e.picture,t)}render(e,t){e.openNode(this.tag,{editAs:t.range.editAs||"oneCell"}),this.map["xdr:from"].render(e,t.range.tl),this.map["xdr:to"].render(e,t.range.br),this.map["xdr:pic"].render(e,t.picture),this.map["xdr:clientData"].render(e,{}),e.closeNode()}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1)}reconcile(e,t){e.medium=this.reconcilePicture(e.picture,t)}}e.exports=o},1395:(e,t,r)=>{let i=r(95774);class n extends i{constructor(e){super(),this.tag=e.tag,this.always=!!e.always,this.count=e.count,this.empty=e.empty,this.$count=e.$count||"count",this.$=e.$,this.childXform=e.childXform,this.maxItems=e.maxItems}prepare(e,t){let{childXform:r}=this;e&&e.forEach((e,i)=>{t.index=i,r.prepare(e,t)})}render(e,t){if(this.always||t&&t.length){e.openNode(this.tag,this.$),this.count&&e.addAttribute(this.$count,t&&t.length||0);let{childXform:r}=this;(t||[]).forEach((t,i)=>{r.render(e,t,i)}),e.closeNode()}else this.empty&&e.leafNode(this.tag)}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag?(this.model=[],!0):!!this.childXform.parseOpen(e)&&(this.parser=this.childXform,!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(e,t){if(e){let{childXform:r}=this;e.forEach(e=>{r.reconcile(e,t)})}}}e.exports=n},47093:(e,t,r)=>{let i=r(62844),n=r(95774);class s extends n{get tag(){return"autoFilter"}render(e,t){if(t){if("string"==typeof t)e.leafNode("autoFilter",{ref:t});else{let r=function(e){return"string"==typeof e?e:i.getAddress(e.row,e.column).address},n=r(t.from),s=r(t.to);n&&s&&e.leafNode("autoFilter",{ref:`${n}:${s}`})}}}parseOpen(e){"autoFilter"===e.name&&(this.model=e.attributes.ref)}}e.exports=s},43831:(e,t,r)=>{let i=r(86968),n=r(95774),s=r(73795),a=r(98672),o=r(7426);function l(e){if(null==e)return a.ValueType.Null;if(e instanceof String||"string"==typeof e)return a.ValueType.String;if("number"==typeof e)return a.ValueType.Number;if("boolean"==typeof e)return a.ValueType.Boolean;if(e instanceof Date)return a.ValueType.Date;if(e.text&&e.hyperlink)return a.ValueType.Hyperlink;if(e.formula)return a.ValueType.Formula;if(e.error)return a.ValueType.Error;throw Error("I could not understand type of value")}class u extends n{constructor(){super(),this.richTextXForm=new o}get tag(){return"c"}prepare(e,t){let r=t.styles.addStyleModel(e.style||{},e.type===a.ValueType.Formula?l(e.result):e.type);switch(r&&(e.styleId=r),e.comment&&t.comments.push({...e.comment,ref:e.address}),e.type){case a.ValueType.String:case a.ValueType.RichText:t.sharedStrings&&(e.ssId=t.sharedStrings.add(e.value));break;case a.ValueType.Date:t.date1904&&(e.date1904=!0);break;case a.ValueType.Hyperlink:t.sharedStrings&&void 0!==e.text&&null!==e.text&&(e.ssId=t.sharedStrings.add(e.text)),t.hyperlinks.push({address:e.address,target:e.hyperlink,tooltip:e.tooltip});break;case a.ValueType.Merge:t.merges.add(e);break;case a.ValueType.Formula:if(t.date1904&&(e.date1904=!0),"shared"===e.shareType&&(e.si=t.siFormulae++),e.formula)t.formulae[e.address]=e;else if(e.sharedFormula){let r=t.formulae[e.sharedFormula];if(!r)throw Error(`Shared Formula master must exist above and or left of clone for cell ${e.address}`);void 0===r.si?(r.shareType="shared",r.si=t.siFormulae++,r.range=new s(r.address,e.address)):r.range&&r.range.expandToAddress(e.address),e.si=r.si}}}renderFormula(e,t){let r=null;switch(t.shareType){case"shared":r={t:"shared",ref:t.ref||t.range.range,si:t.si};break;case"array":r={t:"array",ref:t.ref};break;default:void 0!==t.si&&(r={t:"shared",si:t.si})}switch(l(t.result)){case a.ValueType.Null:e.leafNode("f",r,t.formula);break;case a.ValueType.String:e.addAttribute("t","str"),e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result);break;case a.ValueType.Number:e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result);break;case a.ValueType.Boolean:e.addAttribute("t","b"),e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result?1:0);break;case a.ValueType.Error:e.addAttribute("t","e"),e.leafNode("f",r,t.formula),e.leafNode("v",null,t.result.error);break;case a.ValueType.Date:e.leafNode("f",r,t.formula),e.leafNode("v",null,i.dateToExcel(t.result,t.date1904));break;default:throw Error("I could not understand type of value")}}render(e,t){if(t.type!==a.ValueType.Null||t.styleId){switch(e.openNode("c"),e.addAttribute("r",t.address),t.styleId&&e.addAttribute("s",t.styleId),t.type){case a.ValueType.Null:break;case a.ValueType.Number:e.leafNode("v",null,t.value);break;case a.ValueType.Boolean:e.addAttribute("t","b"),e.leafNode("v",null,t.value?"1":"0");break;case a.ValueType.Error:e.addAttribute("t","e"),e.leafNode("v",null,t.value.error);break;case a.ValueType.String:case a.ValueType.RichText:void 0!==t.ssId?(e.addAttribute("t","s"),e.leafNode("v",null,t.ssId)):t.value&&t.value.richText?(e.addAttribute("t","inlineStr"),e.openNode("is"),t.value.richText.forEach(t=>{this.richTextXForm.render(e,t)}),e.closeNode("is")):(e.addAttribute("t","str"),e.leafNode("v",null,t.value));break;case a.ValueType.Date:e.leafNode("v",null,i.dateToExcel(t.value,t.date1904));break;case a.ValueType.Hyperlink:void 0!==t.ssId?(e.addAttribute("t","s"),e.leafNode("v",null,t.ssId)):(e.addAttribute("t","str"),e.leafNode("v",null,t.text));break;case a.ValueType.Formula:this.renderFormula(e,t);case a.ValueType.Merge:}e.closeNode()}}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"c":return this.model={address:e.attributes.r},this.t=e.attributes.t,e.attributes.s&&(this.model.styleId=parseInt(e.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=e.attributes.si,this.model.shareType=e.attributes.t,this.model.ref=e.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){if(this.parser){this.parser.parseText(e);return}switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+e:e;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+e:e:this.model.value=this.model.value?this.model.value+e:e}}parseClose(e){switch(e){case"c":{let{model:e}=this;if(e.formula||e.shareType)e.type=a.ValueType.Formula,e.value&&("str"===this.t?e.result=i.xmlDecode(e.value):"b"===this.t?e.result=0!==parseInt(e.value,10):"e"===this.t?e.result={error:e.value}:e.result=parseFloat(e.value),e.value=void 0);else if(void 0!==e.value)switch(this.t){case"s":e.type=a.ValueType.String,e.value=parseInt(e.value,10);break;case"str":e.type=a.ValueType.String,e.value=i.xmlDecode(e.value);break;case"inlineStr":e.type=a.ValueType.String;break;case"b":e.type=a.ValueType.Boolean,e.value=0!==parseInt(e.value,10);break;case"e":e.type=a.ValueType.Error,e.value={error:e.value};break;default:e.type=a.ValueType.Number,e.value=parseFloat(e.value)}else e.styleId?e.type=a.ValueType.Null:e.type=a.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":if(this.parser)return this.parser.parseClose(e),!0;return this.currentNode=void 0,!0;case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:if(this.parser)return this.parser.parseClose(e),!0;return!1}}reconcile(e,t){let r=e.styleId&&t.styles&&t.styles.getStyleModel(e.styleId);switch(r&&(e.style=r),void 0!==e.styleId&&(e.styleId=void 0),e.type){case a.ValueType.String:"number"==typeof e.value&&t.sharedStrings&&(e.value=t.sharedStrings.getString(e.value)),e.value.richText&&(e.type=a.ValueType.RichText);break;case a.ValueType.Number:r&&i.isDateFmt(r.numFmt)&&(e.type=a.ValueType.Date,e.value=i.excelToDate(e.value,t.date1904));break;case a.ValueType.Formula:void 0!==e.result&&r&&i.isDateFmt(r.numFmt)&&(e.result=i.excelToDate(e.result,t.date1904)),"shared"===e.shareType&&(e.ref?t.formulae[e.si]=e.address:(e.sharedFormula=t.formulae[e.si],delete e.shareType),delete e.si)}let n=t.hyperlinkMap[e.address];n&&(e.type===a.ValueType.Formula?(e.text=e.result,e.result=void 0):(e.text=e.value,e.value=void 0),e.type=a.ValueType.Hyperlink,e.hyperlink=n);let s=t.commentsMap&&t.commentsMap[e.address];s&&(e.comment=s)}}e.exports=u},76180:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"x14:cfIcon"}render(e,t){e.leafNode(this.tag,{iconSet:t.iconSet,iconId:t.iconId})}parseOpen({attributes:e}){this.model={iconSet:e.iconSet,iconId:i.toIntValue(e.iconId)}}parseClose(e){return e!==this.tag}}e.exports=n},51511:(e,t,r)=>{let{v4:i}=r(1607),n=r(95774),s=r(58430),a=r(58460),o=r(55735),l={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class u extends s{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new a,"x14:iconSet":this.iconSetXform=new o}}get tag(){return"x14:cfRule"}static isExt(e){return"dataBar"===e.type?a.isExt(e):"iconSet"===e.type&&(!!e.custom||!!l[e.iconSet])}prepare(e){u.isExt(e)&&(e.x14Id=`{${i()}}`.toUpperCase())}render(e,t){if(u.isExt(t))switch(t.type){case"dataBar":this.renderDataBar(e,t);break;case"iconSet":this.renderIconSet(e,t)}}renderDataBar(e,t){e.openNode(this.tag,{type:"dataBar",id:t.x14Id}),this.databarXform.render(e,t),e.closeNode()}renderIconSet(e,t){e.openNode(this.tag,{type:"iconSet",priority:t.priority,id:t.x14Id||`{${i()}}`}),this.iconSetXform.render(e,t),e.closeNode()}createNewModel({attributes:e}){return{type:e.type,x14Id:e.id,priority:n.toIntValue(e.priority)}}onParserClose(e,t){Object.assign(this.model,t.model)}}e.exports=u},26409:(e,t,r)=>{let i=r(58430),n=r(37179);class s extends i{constructor(){super(),this.map={"xm:f":this.fExtXform=new n}}get tag(){return"x14:cfvo"}render(e,t){e.openNode(this.tag,{type:t.type}),void 0!==t.value&&this.fExtXform.render(e,t.value),e.closeNode()}createNewModel(e){return{type:e.attributes.type}}onParserClose(e,t){"xm:f"===e&&(this.model.value=t.model?parseFloat(t.model):0)}}e.exports=s},69843:(e,t,r)=>{let i=r(58430),n=r(64168),s=r(51511);class a extends i{constructor(){super(),this.map={"xm:sqref":this.sqRef=new n,"x14:cfRule":this.cfRule=new s}}get tag(){return"x14:conditionalFormatting"}prepare(e,t){e.rules.forEach(e=>{this.cfRule.prepare(e,t)})}render(e,t){t.rules.some(s.isExt)&&(e.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),t.rules.filter(s.isExt).forEach(t=>this.cfRule.render(e,t)),this.sqRef.render(e,t.ref),e.closeNode())}createNewModel(){return{rules:[]}}onParserClose(e,t){switch(e){case"xm:sqref":this.model.ref=t.model;break;case"x14:cfRule":this.model.rules.push(t.model)}}}e.exports=a},44208:(e,t,r)=>{let i=r(58430),n=r(51511),s=r(69843);class a extends i{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new s}}get tag(){return"x14:conditionalFormattings"}hasContent(e){return void 0===e.hasExtContent&&(e.hasExtContent=e.some(e=>e.rules.some(n.isExt))),e.hasExtContent}prepare(e,t){e.forEach(e=>{this.cfXform.prepare(e,t)})}render(e,t){this.hasContent(t)&&(e.openNode(this.tag),t.forEach(t=>this.cfXform.render(e,t)),e.closeNode())}createNewModel(){return[]}onParserClose(e,t){this.model.push(t.model)}}e.exports=a},58460:(e,t,r)=>{let i=r(95774),n=r(58430),s=r(14480),a=r(26409);class o extends n{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new a,"x14:borderColor":this.borderColorXform=new s("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new s("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new s("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new s("x14:axisColor")}}static isExt(e){return!e.gradient}get tag(){return"x14:dataBar"}render(e,t){e.openNode(this.tag,{minLength:i.toIntAttribute(t.minLength,0,!0),maxLength:i.toIntAttribute(t.maxLength,100,!0),border:i.toBoolAttribute(t.border,!1),gradient:i.toBoolAttribute(t.gradient,!0),negativeBarColorSameAsPositive:i.toBoolAttribute(t.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolAttribute(t.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toAttribute(t.axisPosition,"auto"),direction:i.toAttribute(t.direction,"leftToRight")}),t.cfvo.forEach(t=>{this.cfvoXform.render(e,t)}),this.borderColorXform.render(e,t.borderColor),this.negativeBorderColorXform.render(e,t.negativeBorderColor),this.negativeFillColorXform.render(e,t.negativeFillColor),this.axisColorXform.render(e,t.axisColor),e.closeNode()}createNewModel({attributes:e}){return{cfvo:[],minLength:i.toIntValue(e.minLength,0),maxLength:i.toIntValue(e.maxLength,100),border:i.toBoolValue(e.border,!1),gradient:i.toBoolValue(e.gradient,!0),negativeBarColorSameAsPositive:i.toBoolValue(e.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolValue(e.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toStringValue(e.axisPosition,"auto"),direction:i.toStringValue(e.direction,"leftToRight")}}onParserClose(e,t){let[,r]=e.split(":");"cfvo"===r?this.model.cfvo.push(t.model):this.model[r]=t.model}}e.exports=o},37179:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"xm:f"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}e.exports=n},55735:(e,t,r)=>{let i=r(95774),n=r(58430),s=r(26409),a=r(76180);class o extends n{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new s,"x14:cfIcon":this.cfIconXform=new a}}get tag(){return"x14:iconSet"}render(e,t){e.openNode(this.tag,{iconSet:i.toStringAttribute(t.iconSet),reverse:i.toBoolAttribute(t.reverse,!1),showValue:i.toBoolAttribute(t.showValue,!0),custom:i.toBoolAttribute(t.icons,!1)}),t.cfvo.forEach(t=>{this.cfvoXform.render(e,t)}),t.icons&&t.icons.forEach((t,r)=>{t.iconId=r,this.cfIconXform.render(e,t)}),e.closeNode()}createNewModel({attributes:e}){return{cfvo:[],iconSet:i.toStringValue(e.iconSet,"3TrafficLights"),reverse:i.toBoolValue(e.reverse,!1),showValue:i.toBoolValue(e.showValue,!0)}}onParserClose(e,t){let[,r]=e.split(":");switch(r){case"cfvo":this.model.cfvo.push(t.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(t.model);break;default:this.model[r]=t.model}}}e.exports=o},64168:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"xm:sqref"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}e.exports=n},16231:(e,t,r)=>{let i=r(95774),n=r(58430),s=r(73795),a=r(16164),o=r(17512),l=r(47087),u=r(6729),c=r(61911),h={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},d=e=>{if(e.formulae&&e.formulae[0])return e.formulae[0];let{tl:t}=new s(e.ref);switch(e.operator){case"containsText":return`NOT(ISERROR(SEARCH("${e.text}",${t})))`;case"containsBlanks":return`LEN(TRIM(${t}))=0`;case"notContainsBlanks":return`LEN(TRIM(${t}))>0`;case"containsErrors":return`ISERROR(${t})`;case"notContainsErrors":return`NOT(ISERROR(${t}))`;default:return}},p=e=>{if(e.formulae&&e.formulae[0])return e.formulae[0];let{tl:t}=new s(e.ref);switch(e.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${t},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${t},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${t},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${t},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${t},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${t},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${t},1)=TODAY()-1`;case"today":return`FLOOR(${t},1)=TODAY()`;case"tomorrow":return`FLOOR(${t},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${t},1)<=6,FLOOR(${t},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${t})=MONTH(EDATE(TODAY(),0-1)),YEAR(${t})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${t})=MONTH(TODAY()),YEAR(${t})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${t})=MONTH(EDATE(TODAY(),0+1)),YEAR(${t})=YEAR(EDATE(TODAY(),0+1)))`;default:return}},f=e=>{let{type:t,operator:r}=e;switch(t){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:t};default:return{type:t,operator:r}}};class m extends n{constructor(){super(),this.map={dataBar:this.databarXform=new a,extLst:this.extLstRefXform=new o,formula:this.formulaXform=new l,colorScale:this.colorScaleXform=new u,iconSet:this.iconSetXform=new c}}get tag(){return"cfRule"}static isPrimitive(e){return"iconSet"!==e.type||!e.custom&&!h[e.iconSet]}render(e,t){switch(t.type){case"expression":this.renderExpression(e,t);break;case"cellIs":this.renderCellIs(e,t);break;case"top10":this.renderTop10(e,t);break;case"aboveAverage":this.renderAboveAverage(e,t);break;case"dataBar":this.renderDataBar(e,t);break;case"colorScale":this.renderColorScale(e,t);break;case"iconSet":this.renderIconSet(e,t);break;case"containsText":this.renderText(e,t);break;case"timePeriod":this.renderTimePeriod(e,t)}}renderExpression(e,t){e.openNode(this.tag,{type:"expression",dxfId:t.dxfId,priority:t.priority}),this.formulaXform.render(e,t.formulae[0]),e.closeNode()}renderCellIs(e,t){e.openNode(this.tag,{type:"cellIs",dxfId:t.dxfId,priority:t.priority,operator:t.operator}),t.formulae.forEach(t=>{this.formulaXform.render(e,t)}),e.closeNode()}renderTop10(e,t){e.leafNode(this.tag,{type:"top10",dxfId:t.dxfId,priority:t.priority,percent:i.toBoolAttribute(t.percent,!1),bottom:i.toBoolAttribute(t.bottom,!1),rank:i.toIntValue(t.rank,10,!0)})}renderAboveAverage(e,t){e.leafNode(this.tag,{type:"aboveAverage",dxfId:t.dxfId,priority:t.priority,aboveAverage:i.toBoolAttribute(t.aboveAverage,!0)})}renderDataBar(e,t){e.openNode(this.tag,{type:"dataBar",priority:t.priority}),this.databarXform.render(e,t),this.extLstRefXform.render(e,t),e.closeNode()}renderColorScale(e,t){e.openNode(this.tag,{type:"colorScale",priority:t.priority}),this.colorScaleXform.render(e,t),e.closeNode()}renderIconSet(e,t){m.isPrimitive(t)&&(e.openNode(this.tag,{type:"iconSet",priority:t.priority}),this.iconSetXform.render(e,t),e.closeNode())}renderText(e,t){e.openNode(this.tag,{type:t.operator,dxfId:t.dxfId,priority:t.priority,operator:i.toStringAttribute(t.operator,"containsText")});let r=d(t);r&&this.formulaXform.render(e,r),e.closeNode()}renderTimePeriod(e,t){e.openNode(this.tag,{type:"timePeriod",dxfId:t.dxfId,priority:t.priority,timePeriod:t.timePeriod});let r=p(t);r&&this.formulaXform.render(e,r),e.closeNode()}createNewModel({attributes:e}){return{...f(e),dxfId:i.toIntValue(e.dxfId),priority:i.toIntValue(e.priority),timePeriod:e.timePeriod,percent:i.toBoolValue(e.percent),bottom:i.toBoolValue(e.bottom),rank:i.toIntValue(e.rank),aboveAverage:i.toBoolValue(e.aboveAverage)}}onParserClose(e,t){switch(e){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,t.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(t.model)}}}e.exports=m},64201:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"cfvo"}render(e,t){e.leafNode(this.tag,{type:t.type,val:t.value})}parseOpen(e){this.model={type:e.attributes.type,value:i.toFloatValue(e.attributes.val)}}parseClose(e){return e!==this.tag}}e.exports=n},6729:(e,t,r)=>{let i=r(58430),n=r(14480),s=r(64201);class a extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new s,color:this.colorXform=new n}}get tag(){return"colorScale"}render(e,t){e.openNode(this.tag),t.cfvo.forEach(t=>{this.cfvoXform.render(e,t)}),t.color.forEach(t=>{this.colorXform.render(e,t)}),e.closeNode()}createNewModel(e){return{cfvo:[],color:[]}}onParserClose(e,t){this.model[e].push(t.model)}}e.exports=a},78811:(e,t,r)=>{let i=r(58430),n=r(16231);class s extends i{constructor(){super(),this.map={cfRule:new n}}get tag(){return"conditionalFormatting"}render(e,t){t.rules.some(n.isPrimitive)&&(e.openNode(this.tag,{sqref:t.ref}),t.rules.forEach(r=>{n.isPrimitive(r)&&(r.ref=t.ref,this.map.cfRule.render(e,r))}),e.closeNode())}createNewModel({attributes:e}){return{ref:e.sqref,rules:[]}}onParserClose(e,t){this.model.rules.push(t.model)}}e.exports=s},67860:(e,t,r)=>{let i=r(95774),n=r(78811);class s extends i{constructor(){super(),this.cfXform=new n}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(e,t){let r=e.reduce((e,t)=>Math.max(e,...t.rules.map(e=>e.priority||0)),1);e.forEach(e=>{e.rules.forEach(e=>{e.priority||(e.priority=r++),e.style&&(e.dxfId=t.styles.addDxfStyle(e.style))})})}render(e,t){t.forEach(t=>{this.cfXform.render(e,t)})}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"conditionalFormatting"===e.name&&(this.parser=this.cfXform,this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(!!this.parser.parseClose(e)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(e,t){e.forEach(e=>{e.rules.forEach(e=>{void 0!==e.dxfId&&(e.style=t.styles.getDxfStyle(e.dxfId),delete e.dxfId)})})}}e.exports=s},16164:(e,t,r)=>{let i=r(58430),n=r(14480),s=r(64201);class a extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new s,color:this.colorXform=new n}}get tag(){return"dataBar"}render(e,t){e.openNode(this.tag),t.cfvo.forEach(t=>{this.cfvoXform.render(e,t)}),this.colorXform.render(e,t.color),e.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(e,t){switch(e){case"cfvo":this.model.cfvo.push(t.model);break;case"color":this.model.color=t.model}}}e.exports=a},17512:(e,t,r)=>{let i=r(95774),n=r(58430);class s extends i{get tag(){return"x14:id"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}class a extends n{constructor(){super(),this.map={"x14:id":this.idXform=new s}}get tag(){return"ext"}render(e,t){e.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(e,t.x14Id),e.closeNode()}createNewModel(){return{}}onParserClose(e,t){this.model.x14Id=t.model}}class o extends n{constructor(){super(),this.map={ext:new a}}get tag(){return"extLst"}render(e,t){e.openNode(this.tag),this.map.ext.render(e,t),e.closeNode()}createNewModel(){return{}}onParserClose(e,t){Object.assign(this.model,t.model)}}e.exports=o},47087:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"formula"}render(e,t){e.leafNode(this.tag,null,t)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}}e.exports=n},61911:(e,t,r)=>{let i=r(95774),n=r(58430),s=r(64201);class a extends n{constructor(){super(),this.map={cfvo:this.cfvoXform=new s}}get tag(){return"iconSet"}render(e,t){e.openNode(this.tag,{iconSet:i.toStringAttribute(t.iconSet,"3TrafficLights"),reverse:i.toBoolAttribute(t.reverse,!1),showValue:i.toBoolAttribute(t.showValue,!0)}),t.cfvo.forEach(t=>{this.cfvoXform.render(e,t)}),e.closeNode()}createNewModel({attributes:e}){return{iconSet:i.toStringValue(e.iconSet,"3TrafficLights"),reverse:i.toBoolValue(e.reverse),showValue:i.toBoolValue(e.showValue),cfvo:[]}}onParserClose(e,t){this.model[e].push(t.model)}}e.exports=a},65483:(e,t,r)=>{let i=r(86968),n=r(95774);class s extends n{get tag(){return"col"}prepare(e,t){let r=t.styles.addStyleModel(e.style||{});r&&(e.styleId=r)}render(e,t){e.openNode("col"),e.addAttribute("min",t.min),e.addAttribute("max",t.max),t.width&&e.addAttribute("width",t.width),t.styleId&&e.addAttribute("style",t.styleId),t.hidden&&e.addAttribute("hidden","1"),t.bestFit&&e.addAttribute("bestFit","1"),t.outlineLevel&&e.addAttribute("outlineLevel",t.outlineLevel),t.collapsed&&e.addAttribute("collapsed","1"),e.addAttribute("customWidth","1"),e.closeNode()}parseOpen(e){if("col"===e.name){let t=this.model={min:parseInt(e.attributes.min||"0",10),max:parseInt(e.attributes.max||"0",10),width:void 0===e.attributes.width?void 0:parseFloat(e.attributes.width||"0")};return e.attributes.style&&(t.styleId=parseInt(e.attributes.style,10)),i.parseBoolean(e.attributes.hidden)&&(t.hidden=!0),i.parseBoolean(e.attributes.bestFit)&&(t.bestFit=!0),e.attributes.outlineLevel&&(t.outlineLevel=parseInt(e.attributes.outlineLevel,10)),i.parseBoolean(e.attributes.collapsed)&&(t.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(e,t){e.styleId&&(e.style=t.styles.getStyleModel(e.styleId))}}e.exports=s},38398:(e,t,r)=>{let i=r(29536),n=r(86968),s=r(62844),a=r(95774),o=r(73795);function l(e,t,r,i){let n=t[r];void 0!==n?e[r]=n:void 0!==i&&(e[r]=i)}function u(e,t,r,i){let s=t[r];void 0!==s?e[r]=n.parseBoolean(s):void 0!==i&&(e[r]=i)}class c extends a{get tag(){return"dataValidations"}render(e,t){let r=function(e){let t=i.map(e,(e,t)=>({address:t,dataValidation:e,marked:!1})).sort((e,t)=>i.strcmp(e.address,t.address)),r=i.keyBy(t,"address"),n=(t,r,n)=>{for(let a=0;a<r;a++){let r=s.encodeAddress(t.row+a,n);if(!e[r]||!i.isEqual(e[t.address],e[r]))return!1}return!0};return t.map(t=>{if(!t.marked){let a=s.decodeEx(t.address);if(a.dimensions)return r[a.dimensions].marked=!0,{...t.dataValidation,sqref:t.address};let o=1,l=s.encodeAddress(a.row+o,a.col);for(;e[l]&&i.isEqual(t.dataValidation,e[l]);)o++,l=s.encodeAddress(a.row+o,a.col);let u=1;for(;n(a,o,a.col+u);)u++;for(let e=0;e<o;e++)for(let t=0;t<u;t++)r[l=s.encodeAddress(a.row+e,a.col+t)].marked=!0;if(o>1||u>1){let e=a.row+(o-1),r=a.col+(u-1);return{...t.dataValidation,sqref:`${t.address}:${s.encodeAddress(e,r)}`}}return{...t.dataValidation,sqref:t.address}}return null}).filter(Boolean)}(t);r.length&&(e.openNode("dataValidations",{count:r.length}),r.forEach(t=>{e.openNode("dataValidation"),"any"!==t.type&&(e.addAttribute("type",t.type),t.operator&&"list"!==t.type&&"between"!==t.operator&&e.addAttribute("operator",t.operator),t.allowBlank&&e.addAttribute("allowBlank","1")),t.showInputMessage&&e.addAttribute("showInputMessage","1"),t.promptTitle&&e.addAttribute("promptTitle",t.promptTitle),t.prompt&&e.addAttribute("prompt",t.prompt),t.showErrorMessage&&e.addAttribute("showErrorMessage","1"),t.errorStyle&&e.addAttribute("errorStyle",t.errorStyle),t.errorTitle&&e.addAttribute("errorTitle",t.errorTitle),t.error&&e.addAttribute("error",t.error),e.addAttribute("sqref",t.sqref),(t.formulae||[]).forEach((r,i)=>{e.openNode(`formula${i+1}`),"date"===t.type?e.writeText(n.dateToExcel(new Date(r))):e.writeText(r),e.closeNode()}),e.closeNode()}),e.closeNode())}parseOpen(e){switch(e.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=e.attributes.sqref;let t={type:e.attributes.type||"any",formulae:[]};switch(e.attributes.type&&u(t,e.attributes,"allowBlank"),u(t,e.attributes,"showInputMessage"),u(t,e.attributes,"showErrorMessage"),t.type){case"any":case"list":case"custom":break;default:l(t,e.attributes,"operator","between")}return l(t,e.attributes,"promptTitle"),l(t,e.attributes,"prompt"),l(t,e.attributes,"errorStyle"),l(t,e.attributes,"errorTitle"),l(t,e.attributes,"error"),this._dataValidation=t,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(e){this._formula&&this._formula.push(e)}parseClose(e){switch(e){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(e=>{e.includes(":")?new o(e).forEachAddress(e=>{this.model[e]=this._dataValidation}):this.model[e]=this._dataValidation}),!0;case"formula1":case"formula2":{let e=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":e=parseInt(e,10);break;case"decimal":e=parseFloat(e);break;case"date":e=n.excelToDate(parseFloat(e))}return this._dataValidation.formulae.push(e),this._formula=void 0,!0}default:return!0}}}e.exports=c},65297:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"dimension"}render(e,t){t&&e.leafNode("dimension",{ref:t})}parseOpen(e){return"dimension"===e.name&&(this.model=e.attributes.ref,!0)}parseText(){}parseClose(){return!1}}e.exports=n},8503:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"drawing"}render(e,t){t&&e.leafNode(this.tag,{"r:id":t.rId})}parseOpen(e){return e.name===this.tag&&(this.model={rId:e.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}e.exports=n},50820:(e,t,r)=>{let i=r(58430),n=r(44208);class s extends i{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new n}}get tag(){return"ext"}hasContent(e){return this.conditionalFormattings.hasContent(e.conditionalFormattings)}prepare(e,t){this.conditionalFormattings.prepare(e.conditionalFormattings,t)}render(e,t){e.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(e,t.conditionalFormattings),e.closeNode()}createNewModel(){return{}}onParserClose(e,t){this.model[e]=t.model}}class a extends i{constructor(){super(),this.map={ext:this.ext=new s}}get tag(){return"extLst"}prepare(e,t){this.ext.prepare(e,t)}hasContent(e){return this.ext.hasContent(e)}render(e,t){this.hasContent(t)&&(e.openNode("extLst"),this.ext.render(e,t),e.closeNode())}createNewModel(){return{}}onParserClose(e,t){Object.assign(this.model,t.model)}}e.exports=a},33997:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"headerFooter"}render(e,t){if(t){e.addRollback();let r=!1;e.openNode("headerFooter"),t.differentFirst&&(e.addAttribute("differentFirst","1"),r=!0),t.differentOddEven&&(e.addAttribute("differentOddEven","1"),r=!0),t.oddHeader&&"string"==typeof t.oddHeader&&(e.leafNode("oddHeader",null,t.oddHeader),r=!0),t.oddFooter&&"string"==typeof t.oddFooter&&(e.leafNode("oddFooter",null,t.oddFooter),r=!0),t.evenHeader&&"string"==typeof t.evenHeader&&(e.leafNode("evenHeader",null,t.evenHeader),r=!0),t.evenFooter&&"string"==typeof t.evenFooter&&(e.leafNode("evenFooter",null,t.evenFooter),r=!0),t.firstHeader&&"string"==typeof t.firstHeader&&(e.leafNode("firstHeader",null,t.firstHeader),r=!0),t.firstFooter&&"string"==typeof t.firstFooter&&(e.leafNode("firstFooter",null,t.firstFooter),r=!0),r?(e.closeNode(),e.commit()):e.rollback()}}parseOpen(e){switch(e.name){case"headerFooter":return this.model={},e.attributes.differentFirst&&(this.model.differentFirst=1===parseInt(e.attributes.differentFirst,0)),e.attributes.differentOddEven&&(this.model.differentOddEven=1===parseInt(e.attributes.differentOddEven,0)),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(e){switch(this.currentNode){case"oddHeader":this.model.oddHeader=e;break;case"oddFooter":this.model.oddFooter=e;break;case"evenHeader":this.model.evenHeader=e;break;case"evenFooter":this.model.evenFooter=e;break;case"firstHeader":this.model.firstHeader=e;break;case"firstFooter":this.model.firstFooter=e}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}e.exports=n},4563:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"hyperlink"}render(e,t){this.isInternalLink(t)?e.leafNode("hyperlink",{ref:t.address,"r:id":t.rId,tooltip:t.tooltip,location:t.target}):e.leafNode("hyperlink",{ref:t.address,"r:id":t.rId,tooltip:t.tooltip})}parseOpen(e){return"hyperlink"===e.name&&(this.model={address:e.attributes.ref,rId:e.attributes["r:id"],tooltip:e.attributes.tooltip},e.attributes.location&&(this.model.target=e.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(e){return e.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(e.target)}}e.exports=n},52892:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"mergeCell"}render(e,t){e.leafNode("mergeCell",{ref:t})}parseOpen(e){return"mergeCell"===e.name&&(this.model=e.attributes.ref,!0)}parseText(){}parseClose(){return!1}}e.exports=n},72521:(e,t,r)=>{let i=r(29536),n=r(73795),s=r(62844),a=r(98672);class o{constructor(){this.merges={}}add(e){if(this.merges[e.master])this.merges[e.master].expandToAddress(e.address);else{let t=`${e.master}:${e.address}`;this.merges[e.master]=new n(t)}}get mergeCells(){return i.map(this.merges,e=>e.range)}reconcile(e,t){i.each(e,e=>{let r=s.decode(e);for(let e=r.top;e<=r.bottom;e++){let i=t[e-1];for(let t=r.left;t<=r.right;t++){let n=i.cells[t-1];n?n.type===a.ValueType.Merge&&(n.master=r.tl):i.cells[t]={type:a.ValueType.Null,address:s.encodeAddress(e,t)}}}})}getMasterAddress(e){let t=this.hash[e];return t&&t.tl}}e.exports=o},28675:(e,t,r)=>{let i=r(95774),n=e=>void 0!==e;class s extends i{get tag(){return"outlinePr"}render(e,t){return!!(t&&(n(t.summaryBelow)||n(t.summaryRight)))&&(e.leafNode(this.tag,{summaryBelow:n(t.summaryBelow)?Number(t.summaryBelow):void 0,summaryRight:n(t.summaryRight)?Number(t.summaryRight):void 0}),!0)}parseOpen(e){return e.name===this.tag&&(this.model={summaryBelow:n(e.attributes.summaryBelow)?!!Number(e.attributes.summaryBelow):void 0,summaryRight:n(e.attributes.summaryRight)?!!Number(e.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}e.exports=s},1451:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"brk"}render(e,t){e.leafNode("brk",t)}parseOpen(e){return"brk"===e.name&&(this.model=e.attributes.ref,!0)}parseText(){}parseClose(){return!1}}e.exports=n},54526:(e,t,r)=>{let i=r(29536),n=r(95774);class s extends n{get tag(){return"pageMargins"}render(e,t){if(t){let r={left:t.left,right:t.right,top:t.top,bottom:t.bottom,header:t.header,footer:t.footer};i.some(r,e=>void 0!==e)&&e.leafNode(this.tag,r)}}parseOpen(e){return e.name===this.tag&&(this.model={left:parseFloat(e.attributes.left||.7),right:parseFloat(e.attributes.right||.7),top:parseFloat(e.attributes.top||.75),bottom:parseFloat(e.attributes.bottom||.75),header:parseFloat(e.attributes.header||.3),footer:parseFloat(e.attributes.footer||.3)},!0)}parseText(){}parseClose(){return!1}}e.exports=s},78382:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"pageSetUpPr"}render(e,t){return!!t&&!!t.fitToPage&&(e.leafNode(this.tag,{fitToPage:t.fitToPage?"1":void 0}),!0)}parseOpen(e){return e.name===this.tag&&(this.model={fitToPage:"1"===e.attributes.fitToPage},!0)}parseText(){}parseClose(){return!1}}e.exports=n},62644:(e,t,r)=>{let i=r(29536),n=r(95774);function s(e){return e?"1":void 0}class a extends n{get tag(){return"pageSetup"}render(e,t){if(t){let r={paperSize:t.paperSize,orientation:t.orientation,horizontalDpi:t.horizontalDpi,verticalDpi:t.verticalDpi,pageOrder:function(e){if("overThenDown"===e)return e}(t.pageOrder),blackAndWhite:s(t.blackAndWhite),draft:s(t.draft),cellComments:function(e){switch(e){case"atEnd":case"asDisplyed":return e;default:return}}(t.cellComments),errors:function(e){switch(e){case"dash":case"blank":case"NA":return e;default:return}}(t.errors),scale:t.scale,fitToWidth:t.fitToWidth,fitToHeight:t.fitToHeight,firstPageNumber:t.firstPageNumber,useFirstPageNumber:s(t.firstPageNumber),usePrinterDefaults:s(t.usePrinterDefaults),copies:t.copies};i.some(r,e=>void 0!==e)&&e.leafNode(this.tag,r)}}parseOpen(e){if(e.name===this.tag){var t;return this.model={paperSize:void 0!==(t=e.attributes.paperSize)?parseInt(t,10):void 0,orientation:e.attributes.orientation||"portrait",horizontalDpi:parseInt(e.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(e.attributes.verticalDpi||"4294967295",10),pageOrder:e.attributes.pageOrder||"downThenOver",blackAndWhite:"1"===e.attributes.blackAndWhite,draft:"1"===e.attributes.draft,cellComments:e.attributes.cellComments||"None",errors:e.attributes.errors||"displayed",scale:parseInt(e.attributes.scale||"100",10),fitToWidth:parseInt(e.attributes.fitToWidth||"1",10),fitToHeight:parseInt(e.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(e.attributes.firstPageNumber||"1",10),useFirstPageNumber:"1"===e.attributes.useFirstPageNumber,usePrinterDefaults:"1"===e.attributes.usePrinterDefaults,copies:parseInt(e.attributes.copies||"1",10)},!0}return!1}parseText(){}parseClose(){return!1}}e.exports=a},78891:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"picture"}render(e,t){t&&e.leafNode(this.tag,{"r:id":t.rId})}parseOpen(e){return e.name===this.tag&&(this.model={rId:e.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}e.exports=n},79489:(e,t,r)=>{let i=r(29536),n=r(95774);function s(e){return e?"1":void 0}class a extends n{get tag(){return"printOptions"}render(e,t){if(t){let r={headings:s(t.showRowColHeaders),gridLines:s(t.showGridLines),horizontalCentered:s(t.horizontalCentered),verticalCentered:s(t.verticalCentered)};i.some(r,e=>void 0!==e)&&e.leafNode(this.tag,r)}}parseOpen(e){return e.name===this.tag&&(this.model={showRowColHeaders:"1"===e.attributes.headings,showGridLines:"1"===e.attributes.gridLines,horizontalCentered:"1"===e.attributes.horizontalCentered,verticalCentered:"1"===e.attributes.verticalCentered},!0)}parseText(){}parseClose(){return!1}}e.exports=a},32876:(e,t,r)=>{"use strict";let i=r(1451),n=r(1395);class s extends n{constructor(){super({tag:"rowBreaks",count:!0,childXform:new i})}render(e,t){if(t&&t.length){e.openNode(this.tag,this.$),this.count&&(e.addAttribute(this.$count,t.length),e.addAttribute("manualBreakCount",t.length));let{childXform:r}=this;t.forEach(t=>{r.render(e,t)}),e.closeNode()}else this.empty&&e.leafNode(this.tag)}}e.exports=s},75013:(e,t,r)=>{let i=r(95774),n=r(86968),s=r(43831);class a extends i{constructor(e){super(),this.maxItems=e&&e.maxItems,this.map={c:new s}}get tag(){return"row"}prepare(e,t){let r=t.styles.addStyleModel(e.style);r&&(e.styleId=r);let i=this.map.c;e.cells.forEach(e=>{i.prepare(e,t)})}render(e,t,r){e.openNode("row"),e.addAttribute("r",t.number),t.height&&(e.addAttribute("ht",t.height),e.addAttribute("customHeight","1")),t.hidden&&e.addAttribute("hidden","1"),t.min>0&&t.max>0&&t.min<=t.max&&e.addAttribute("spans",`${t.min}:${t.max}`),t.styleId&&(e.addAttribute("s",t.styleId),e.addAttribute("customFormat","1")),e.addAttribute("x14ac:dyDescent","0.25"),t.outlineLevel&&e.addAttribute("outlineLevel",t.outlineLevel),t.collapsed&&e.addAttribute("collapsed","1");let i=this.map.c;t.cells.forEach(t=>{i.render(e,t,r)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if("row"===e.name){this.numRowsSeen+=1;let t=e.attributes.spans?e.attributes.spans.split(":").map(e=>parseInt(e,10)):[void 0,void 0],r=this.model={number:parseInt(e.attributes.r,10),min:t[0],max:t[1],cells:[]};return e.attributes.s&&(r.styleId=parseInt(e.attributes.s,10)),n.parseBoolean(e.attributes.hidden)&&(r.hidden=!0),n.parseBoolean(e.attributes.bestFit)&&(r.bestFit=!0),e.attributes.ht&&(r.height=parseFloat(e.attributes.ht)),e.attributes.outlineLevel&&(r.outlineLevel=parseInt(e.attributes.outlineLevel,10)),n.parseBoolean(e.attributes.collapsed)&&(r.collapsed=!0),!0}return this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(e,t){e.style=e.styleId?t.styles.getStyleModel(e.styleId):{},void 0!==e.styleId&&(e.styleId=void 0);let r=this.map.c;e.cells.forEach(e=>{r.reconcile(e,t)})}}e.exports=a},45140:(e,t,r)=>{let i=r(29536),n=r(95774);class s extends n{get tag(){return"sheetFormatPr"}render(e,t){if(t){let r={defaultRowHeight:t.defaultRowHeight,outlineLevelRow:t.outlineLevelRow,outlineLevelCol:t.outlineLevelCol,"x14ac:dyDescent":t.dyDescent};t.defaultColWidth&&(r.defaultColWidth=t.defaultColWidth),t.defaultRowHeight&&15===t.defaultRowHeight||(r.customHeight="1"),i.some(r,e=>void 0!==e)&&e.leafNode("sheetFormatPr",r)}}parseOpen(e){return"sheetFormatPr"===e.name&&(this.model={defaultRowHeight:parseFloat(e.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(e.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(e.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(e.attributes.outlineLevelCol||"0",10)},e.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(e.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}e.exports=s},93980:(e,t,r)=>{let i=r(95774),n=r(14480),s=r(78382),a=r(28675);class o extends i{constructor(){super(),this.map={tabColor:new n("tabColor"),pageSetUpPr:new s,outlinePr:new a}}get tag(){return"sheetPr"}render(e,t){if(t){e.addRollback(),e.openNode("sheetPr");let r=!1;r=this.map.tabColor.render(e,t.tabColor)||r,r=this.map.pageSetUpPr.render(e,t.pageSetup)||r,(r=this.map.outlinePr.render(e,t.outlineProperties)||r)?(e.closeNode(),e.commit()):e.rollback()}}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag?(this.reset(),!0):!!this.map[e.name]&&(this.parser=this.map[e.name],this.parser.parseOpen(e),!0)}parseText(e){return!!this.parser&&(this.parser.parseText(e),!0)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}e.exports=o},66710:(e,t,r)=>{let i=r(29536),n=r(95774);function s(e,t){return e?t:void 0}function a(e,t){return e===t||void 0}class o extends n{get tag(){return"sheetProtection"}render(e,t){if(t){let r={sheet:s(t.sheet,"1"),selectLockedCells:!1===t.selectLockedCells?"1":void 0,selectUnlockedCells:!1===t.selectUnlockedCells?"1":void 0,formatCells:s(t.formatCells,"0"),formatColumns:s(t.formatColumns,"0"),formatRows:s(t.formatRows,"0"),insertColumns:s(t.insertColumns,"0"),insertRows:s(t.insertRows,"0"),insertHyperlinks:s(t.insertHyperlinks,"0"),deleteColumns:s(t.deleteColumns,"0"),deleteRows:s(t.deleteRows,"0"),sort:s(t.sort,"0"),autoFilter:s(t.autoFilter,"0"),pivotTables:s(t.pivotTables,"0")};t.sheet&&(r.algorithmName=t.algorithmName,r.hashValue=t.hashValue,r.saltValue=t.saltValue,r.spinCount=t.spinCount,r.objects=s(!1===t.objects,"1"),r.scenarios=s(!1===t.scenarios,"1")),i.some(r,e=>void 0!==e)&&e.leafNode(this.tag,r)}}parseOpen(e){return e.name===this.tag&&(this.model={sheet:a(e.attributes.sheet,"1"),objects:"1"!==e.attributes.objects&&void 0,scenarios:"1"!==e.attributes.scenarios&&void 0,selectLockedCells:"1"!==e.attributes.selectLockedCells&&void 0,selectUnlockedCells:"1"!==e.attributes.selectUnlockedCells&&void 0,formatCells:a(e.attributes.formatCells,"0"),formatColumns:a(e.attributes.formatColumns,"0"),formatRows:a(e.attributes.formatRows,"0"),insertColumns:a(e.attributes.insertColumns,"0"),insertRows:a(e.attributes.insertRows,"0"),insertHyperlinks:a(e.attributes.insertHyperlinks,"0"),deleteColumns:a(e.attributes.deleteColumns,"0"),deleteRows:a(e.attributes.deleteRows,"0"),sort:a(e.attributes.sort,"0"),autoFilter:a(e.attributes.autoFilter,"0"),pivotTables:a(e.attributes.pivotTables,"0")},e.attributes.algorithmName&&(this.model.algorithmName=e.attributes.algorithmName,this.model.hashValue=e.attributes.hashValue,this.model.saltValue=e.attributes.saltValue,this.model.spinCount=parseInt(e.attributes.spinCount,10)),!0)}parseText(){}parseClose(){return!1}}e.exports=o},60440:(e,t,r)=>{let i=r(62844),n=r(95774),s={frozen:"frozen",frozenSplit:"frozen",split:"split"};class a extends n{get tag(){return"sheetView"}prepare(e){switch(e.state){case"frozen":case"split":break;default:e.state="normal"}}render(e,t){let r,n,s,a;e.openNode("sheetView",{workbookViewId:t.workbookViewId||0});let o=function(t,r,i){i&&e.addAttribute(t,r)};switch(o("rightToLeft","1",!0===t.rightToLeft),o("tabSelected","1",t.tabSelected),o("showRuler","0",!1===t.showRuler),o("showRowColHeaders","0",!1===t.showRowColHeaders),o("showGridLines","0",!1===t.showGridLines),o("zoomScale",t.zoomScale,t.zoomScale),o("zoomScaleNormal",t.zoomScaleNormal,t.zoomScaleNormal),o("view",t.style,t.style),t.state){case"frozen":n=t.xSplit||0,s=t.ySplit||0,r=t.topLeftCell||i.getAddress(s+1,n+1).address,a=t.xSplit&&t.ySplit&&"bottomRight"||t.xSplit&&"topRight"||"bottomLeft",e.leafNode("pane",{xSplit:t.xSplit||void 0,ySplit:t.ySplit||void 0,topLeftCell:r,activePane:a,state:"frozen"}),e.leafNode("selection",{pane:a,activeCell:t.activeCell,sqref:t.activeCell});break;case"split":"topLeft"===t.activePane&&(t.activePane=void 0),e.leafNode("pane",{xSplit:t.xSplit||void 0,ySplit:t.ySplit||void 0,topLeftCell:t.topLeftCell,activePane:t.activePane}),e.leafNode("selection",{pane:t.activePane,activeCell:t.activeCell,sqref:t.activeCell});break;case"normal":t.activeCell&&e.leafNode("selection",{activeCell:t.activeCell,sqref:t.activeCell})}e.closeNode()}parseOpen(e){switch(e.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(e.attributes.workbookViewId,10),rightToLeft:"1"===e.attributes.rightToLeft,tabSelected:"1"===e.attributes.tabSelected,showRuler:"0"!==e.attributes.showRuler,showRowColHeaders:"0"!==e.attributes.showRowColHeaders,showGridLines:"0"!==e.attributes.showGridLines,zoomScale:parseInt(e.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(e.attributes.zoomScaleNormal||"100",10),style:e.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(e.attributes.xSplit||"0",10),ySplit:parseInt(e.attributes.ySplit||"0",10),topLeftCell:e.attributes.topLeftCell,activePane:e.attributes.activePane||"topLeft",state:e.attributes.state},!0;case"selection":{let t=e.attributes.pane||"topLeft";return this.selections[t]={pane:t,activeCell:e.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(e){let t,r;return"sheetView"!==e||(this.sheetView&&this.pane?(t=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:s[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},"split"===this.model.state&&(t.activePane=this.pane.activePane),(r=this.selections[this.pane.activePane])&&r.activeCell&&(t.activeCell=r.activeCell)):(t=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},(r=this.selections.topLeft)&&r.activeCell&&(t.activeCell=r.activeCell)),this.sheetView.style&&(t.style=this.sheetView.style),!1)}reconcile(){}}e.exports=a},42297:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"tablePart"}render(e,t){t&&e.leafNode(this.tag,{"r:id":t.rId})}parseOpen(e){return e.name===this.tag&&(this.model={rId:e.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}e.exports=n},42701:(e,t,r)=>{let i=r(29536),n=r(62844),s=r(43213),a=r(37529),o=r(72521),l=r(95774),u=r(1395),c=r(75013),h=r(65483),d=r(65297),p=r(4563),f=r(52892),m=r(38398),g=r(93980),y=r(45140),v=r(60440),b=r(66710),w=r(54526),x=r(62644),S=r(79489),E=r(47093),T=r(78891),k=r(8503),O=r(42297),C=r(32876),A=r(33997),N=r(67860),R=r(50820),I=(e,t)=>{Object.keys(t).forEach(r=>{let i=e[r],n=t[r];void 0===i&&void 0!==n&&(e[r]=n)})},P=(e,t)=>{if(!t||!t.length)return e;if(!e||!e.length)return t;let r={},i={};return e.forEach(e=>{r[e.ref]=e,e.rules.forEach(e=>{let{x14Id:t}=e;t&&(i[t]=e)})}),t.forEach(t=>{t.rules.forEach(n=>{let s=i[n.x14Id];s?I(s,n):r[t.ref]?r[t.ref].rules.push(n):e.push({ref:t.ref,rules:[n]})})}),e};class j extends l{constructor(e){super();let{maxRows:t,maxCols:r,ignoreNodes:i}=e||{};this.ignoreNodes=i||[],this.map={sheetPr:new g,dimension:new d,sheetViews:new u({tag:"sheetViews",count:!1,childXform:new v}),sheetFormatPr:new y,cols:new u({tag:"cols",count:!1,childXform:new h}),sheetData:new u({tag:"sheetData",count:!1,empty:!0,childXform:new c({maxItems:r}),maxItems:t}),autoFilter:new E,mergeCells:new u({tag:"mergeCells",count:!0,childXform:new f}),rowBreaks:new C,hyperlinks:new u({tag:"hyperlinks",count:!1,childXform:new p}),pageMargins:new w,dataValidations:new m,pageSetup:new x,headerFooter:new A,printOptions:new S,picture:new T,drawing:new k,sheetProtection:new b,tableParts:new u({tag:"tableParts",count:!0,childXform:new O}),conditionalFormatting:new N,extLst:new R}}prepare(e,t){let r;t.merges=new o,e.hyperlinks=t.hyperlinks=[],e.comments=t.comments=[],t.formulae={},t.siFormulae=0,this.map.cols.prepare(e.cols,t),this.map.sheetData.prepare(e.rows,t),this.map.conditionalFormatting.prepare(e.conditionalFormattings,t),e.mergeCells=t.merges.mergeCells;let i=e.rels=[];function s(e){return`rId${e.length+1}`}if(e.hyperlinks.forEach(e=>{let t=s(i);e.rId=t,i.push({Id:t,Type:a.Hyperlink,Target:e.target,TargetMode:"External"})}),e.comments.length>0){let r={Id:s(i),Type:a.Comments,Target:`../comments${e.id}.xml`};i.push(r);let o={Id:s(i),Type:a.VmlDrawing,Target:`../drawings/vmlDrawing${e.id}.vml`};i.push(o),e.comments.forEach(e=>{e.refAddress=n.decodeAddress(e.ref)}),t.commentRefs.push({commentName:`comments${e.id}`,vmlDrawing:`vmlDrawing${e.id}`})}let l=[];e.media.forEach(n=>{if("background"===n.type){let o=s(i);r=t.media[n.imageId],i.push({Id:o,Type:a.Image,Target:`../media/${r.name}.${r.extension}`}),e.background={rId:o},e.image=t.media[n.imageId]}else if("image"===n.type){let{drawing:o}=e;r=t.media[n.imageId],o||(o=e.drawing={rId:s(i),name:`drawing${++t.drawingsCount}`,anchors:[],rels:[]},t.drawings.push(o),i.push({Id:o.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${o.name}.xml`}));let u=this.preImageId===n.imageId?l[n.imageId]:l[o.rels.length];u||(u=s(o.rels),l[o.rels.length]=u,o.rels.push({Id:u,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${r.name}.${r.extension}`}));let c={picture:{rId:u},range:n.range};if(n.hyperlinks&&n.hyperlinks.hyperlink){let e=s(o.rels);l[o.rels.length]=e,c.picture.hyperlinks={tooltip:n.hyperlinks.tooltip,rId:e},o.rels.push({Id:e,Type:a.Hyperlink,Target:n.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=n.imageId,o.anchors.push(c)}}),e.tables.forEach(e=>{let r=s(i);e.rId=r,i.push({Id:r,Type:a.Table,Target:`../tables/${e.target}`}),e.columns.forEach(e=>{let{style:r}=e;r&&(e.dxfId=t.styles.addDxfStyle(r))})}),this.map.extLst.prepare(e,t)}render(e,t){e.openXml(s.StdDocAttributes),e.openNode("worksheet",j.WORKSHEET_ATTRIBUTES);let r=t.properties?{defaultRowHeight:t.properties.defaultRowHeight,dyDescent:t.properties.dyDescent,outlineLevelCol:t.properties.outlineLevelCol,outlineLevelRow:t.properties.outlineLevelRow}:void 0;t.properties&&t.properties.defaultColWidth&&(r.defaultColWidth=t.properties.defaultColWidth);let i={outlineProperties:t.properties&&t.properties.outlineProperties,tabColor:t.properties&&t.properties.tabColor,pageSetup:t.pageSetup&&t.pageSetup.fitToPage?{fitToPage:t.pageSetup.fitToPage}:void 0},n=t.pageSetup&&t.pageSetup.margins,o={showRowColHeaders:t.pageSetup&&t.pageSetup.showRowColHeaders,showGridLines:t.pageSetup&&t.pageSetup.showGridLines,horizontalCentered:t.pageSetup&&t.pageSetup.horizontalCentered,verticalCentered:t.pageSetup&&t.pageSetup.verticalCentered},l=t.sheetProtection;this.map.sheetPr.render(e,i),this.map.dimension.render(e,t.dimensions),this.map.sheetViews.render(e,t.views),this.map.sheetFormatPr.render(e,r),this.map.cols.render(e,t.cols),this.map.sheetData.render(e,t.rows),this.map.sheetProtection.render(e,l),this.map.autoFilter.render(e,t.autoFilter),this.map.mergeCells.render(e,t.mergeCells),this.map.conditionalFormatting.render(e,t.conditionalFormattings),this.map.dataValidations.render(e,t.dataValidations),this.map.hyperlinks.render(e,t.hyperlinks),this.map.printOptions.render(e,o),this.map.pageMargins.render(e,n),this.map.pageSetup.render(e,t.pageSetup),this.map.headerFooter.render(e,t.headerFooter),this.map.rowBreaks.render(e,t.rowBreaks),this.map.drawing.render(e,t.drawing),this.map.picture.render(e,t.background),this.map.tableParts.render(e,t.tables),this.map.extLst.render(e,t),t.rels&&t.rels.forEach(t=>{t.Type===a.VmlDrawing&&e.leafNode("legacyDrawing",{"r:id":t.Id})}),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):"worksheet"===e.name?i.each(this.map,e=>{e.reset()}):this.map[e.name]&&!this.ignoreNodes.includes(e.name)&&(this.parser=this.map[e.name],this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if("worksheet"===e){let e=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(e.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(e.outlineProperties=this.map.sheetPr.model.outlineProperties);let t=Object.assign({fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},this.map.pageSetup.model,this.map.printOptions.model),r=P(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:e,views:this.map.sheetViews.model,pageSetup:t,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:r},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}return!0}reconcile(e,t){let r=(e.relationships||[]).reduce((r,i)=>{if(r[i.Id]=i,i.Type===a.Comments&&(e.comments=t.comments[i.Target].comments),i.Type===a.VmlDrawing&&e.comments&&e.comments.length){let r=t.vmlDrawings[i.Target].comments;e.comments.forEach((e,t)=>{e.note=Object.assign({},e.note,r[t])})}return r},{});if(t.commentsMap=(e.comments||[]).reduce((e,t)=>(t.ref&&(e[t.ref]=t),e),{}),t.hyperlinkMap=(e.hyperlinks||[]).reduce((e,t)=>(t.rId&&(e[t.address]=r[t.rId].Target),e),{}),t.formulae={},e.rows=e.rows&&e.rows.filter(Boolean)||[],e.rows.forEach(e=>{e.cells=e.cells&&e.cells.filter(Boolean)||[]}),this.map.cols.reconcile(e.cols,t),this.map.sheetData.reconcile(e.rows,t),this.map.conditionalFormatting.reconcile(e.conditionalFormattings,t),e.media=[],e.drawing){let i=r[e.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(i){let r=i[1];t.drawings[r].anchors.forEach(t=>{if(t.medium){let r={type:"image",imageId:t.medium.index,range:t.range,hyperlinks:t.picture.hyperlinks};e.media.push(r)}})}}let i=e.background&&r[e.background.rId];if(i){let r=i.Target.split("/media/")[1],n=t.mediaIndex&&t.mediaIndex[r];void 0!==n&&e.media.push({type:"background",imageId:n})}e.tables=(e.tables||[]).map(e=>{let i=r[e.rId];return t.tables[i.Target]}),delete e.relationships,delete e.hyperlinks,delete e.comments}}j.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},e.exports=j},50658:(e,t,r)=>{let i=r(95774);class n extends i{constructor(e){super(),this.tag=e.tag,this.attr=e.attr}render(e,t){t&&(e.openNode(this.tag),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}e.exports=n},44966:(e,t,r)=>{let i=r(95774);class n extends i{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs,this._format=e.format||function(e){try{if(Number.isNaN(e.getTime()))return"";return e.toISOString()}catch(e){return""}},this._parse=e.parse||function(e){return new Date(e)}}render(e,t){t&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,this._format(t)):e.writeText(this._format(t)),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.attr?this.model=this._parse(e.attributes[this.attr]):this.text=[])}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}e.exports=n},17944:(e,t,r)=>{let i=r(95774);class n extends i{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs,this.zero=e.zero}render(e,t){(t||this.zero)&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,t):e.writeText(t),e.closeNode())}parseOpen(e){return e.name===this.tag&&(this.attr?this.model=parseInt(e.attributes[this.attr],10):this.text=[],!0)}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}e.exports=n},98395:(e,t,r)=>{let i=r(95774);class n extends i{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs}render(e,t){void 0!==t&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,t):e.writeText(t),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.attr?this.model=e.attributes[this.attr]:this.text=[])}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}e.exports=n},70341:(e,t,r)=>{let i=r(95774),n=r(43213);class s extends i{constructor(e){super(),this._model=e}render(e){if(!this._xml){let e=new n;(function e(t,r){t.openNode(r.tag,r.$),r.c&&r.c.forEach(r=>{e(t,r)}),r.t&&t.writeText(r.t),t.closeNode()})(e,this._model),this._xml=e.xml}e.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(e){return e!==this._model.tag}}e.exports=s},16004:(e,t,r)=>{let i=r(80279),n=r(7426),s=r(95774);class a extends s{constructor(){super(),this.map={r:new n,t:new i}}get tag(){return"rPh"}render(e,t){if(e.openNode(this.tag,{sb:t.sb||0,eb:t.eb||0}),t&&t.hasOwnProperty("richText")&&t.richText){let{r}=this.map;t.richText.forEach(t=>{r.render(e,t)})}else t&&this.map.t.render(e,t.text);e.closeNode()}parseOpen(e){let{name:t}=e;return this.parser?(this.parser.parseOpen(e),!0):t===this.tag?(this.model={sb:parseInt(e.attributes.sb,10),eb:parseInt(e.attributes.eb,10)},!0):(this.parser=this.map[t],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){switch(e){case"r":{let e=this.model.richText;e||(e=this.model.richText=[]),e.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}return e!==this.tag}}e.exports=a},7426:(e,t,r)=>{let i=r(80279),n=r(59e3),s=r(95774);class a extends s{constructor(e){super(),this.model=e}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new i)}get fontXform(){return this._fontXform||(this._fontXform=new n(a.FONT_OPTIONS))}render(e,t){t=t||this.model,e.openNode("r"),t.font&&this.fontXform.render(e,t.font),this.textXform.render(e,t.text),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(e),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){switch(e){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(e),!0}}}a.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},e.exports=a},31517:(e,t,r)=>{let i=r(80279),n=r(7426),s=r(16004),a=r(95774);class o extends a{constructor(e){super(),this.model=e,this.map={r:new n,t:new i,rPh:new s}}get tag(){return"si"}render(e,t){e.openNode(this.tag),t&&t.hasOwnProperty("richText")&&t.richText?t.richText.length?t.richText.forEach(t=>{this.map.r.render(e,t)}):this.map.t.render(e,""):null!=t&&this.map.t.render(e,t),e.closeNode()}parseOpen(e){let{name:t}=e;return this.parser?(this.parser.parseOpen(e),!0):t===this.tag?(this.model={},!0):(this.parser=this.map[t],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){switch(e){case"r":{let e=this.model.richText;e||(e=this.model.richText=[]),e.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}return e!==this.tag}}e.exports=o},72502:(e,t,r)=>{let i=r(43213),n=r(95774),s=r(31517);class a extends n{constructor(e){super(),this.model=e||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new s)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(e){return this.model.values[e]}add(e){return e.richText?this.addRichText(e):this.addText(e)}addText(e){let t=this.hash[e];return void 0===t&&(t=this.hash[e]=this.model.values.length,this.model.values.push(e)),this.model.count++,t}addRichText(e){let t=this.sharedStringXform.toXml(e),r=this.rich[t];return void 0===r&&(r=this.rich[t]=this.model.values.length,this.model.values.push(e)),this.model.count++,r}render(e,t){t=t||this._values,e.openXml(i.StdDocAttributes),e.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:t.count,uniqueCount:t.values.length});let r=this.sharedStringXform;t.values.forEach(t=>{r.render(e,t)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(e),!0;default:throw Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;if("sst"===e)return!1;throw Error(`Unexpected xml node in parseClose: ${e}`)}}e.exports=a},80279:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"t"}render(e,t){e.openNode("t"),/^\s|\n|\s$/.test(t)&&e.addAttribute("xml:space","preserve"),e.writeText(t),e.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(e,t)=>String.fromCharCode(parseInt(t,16)))}parseOpen(e){return"t"===e.name&&(this._text=[],!0)}parseText(e){this._text.push(e)}parseClose(){return!1}}e.exports=n},74258:(e,t,r)=>{let i=r(98672),n=r(86968),s=r(95774),a={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((e,t)=>(e[t]=!0,e),{}),horizontal(e){return this.horizontalValues[e]?e:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((e,t)=>(e[t]=!0,e),{}),vertical(e){return"middle"===e?"center":this.verticalValues[e]?e:void 0},wrapText:e=>!!e||void 0,shrinkToFit:e=>!!e||void 0,textRotation:e=>"vertical"===e?e:(e=n.validInt(e))>=-90&&e<=90?e:void 0,indent:e=>Math.max(0,e=n.validInt(e)),readingOrder(e){switch(e){case"ltr":return i.ReadingOrder.LeftToRight;case"rtl":return i.ReadingOrder.RightToLeft;default:return}}},o={toXml(e){if(e=a.textRotation(e)){if("vertical"===e)return 255;let t=Math.round(e);if(t>=0&&t<=90)return t;if(t<0&&t>=-90)return 90-t}},toModel(e){let t=n.validInt(e);if(void 0!==t){if(255===t)return"vertical";if(t>=0&&t<=90)return t;if(t>90&&t<=180)return 90-t}}};class l extends s{get tag(){return"alignment"}render(e,t){e.addRollback(),e.openNode("alignment");let r=!1;function i(t,i){i&&(e.addAttribute(t,i),r=!0)}i("horizontal",a.horizontal(t.horizontal)),i("vertical",a.vertical(t.vertical)),i("wrapText",!!a.wrapText(t.wrapText)&&"1"),i("shrinkToFit",!!a.shrinkToFit(t.shrinkToFit)&&"1"),i("indent",a.indent(t.indent)),i("textRotation",o.toXml(t.textRotation)),i("readingOrder",a.readingOrder(t.readingOrder)),e.closeNode(),r?e.commit():e.rollback()}parseOpen(e){let t={},r=!1;function i(e,i,n){e&&(t[i]=n,r=!0)}i(e.attributes.horizontal,"horizontal",e.attributes.horizontal),i(e.attributes.vertical,"vertical","center"===e.attributes.vertical?"middle":e.attributes.vertical),i(e.attributes.wrapText,"wrapText",n.parseBoolean(e.attributes.wrapText)),i(e.attributes.shrinkToFit,"shrinkToFit",n.parseBoolean(e.attributes.shrinkToFit)),i(e.attributes.indent,"indent",parseInt(e.attributes.indent,10)),i(e.attributes.textRotation,"textRotation",o.toModel(e.attributes.textRotation)),i(e.attributes.readingOrder,"readingOrder","2"===e.attributes.readingOrder?"rtl":"ltr"),this.model=r?t:null}parseText(){}parseClose(){return!1}}e.exports=l},60443:(e,t,r)=>{let i=r(95774),n=r(86968),s=r(14480);class a extends i{constructor(e){super(),this.name=e,this.map={color:new s}}get tag(){return this.name}render(e,t,r){let i=t&&t.color||r||this.defaultColor;e.openNode(this.name),t&&t.style&&(e.addAttribute("style",t.style),i&&this.map.color.render(e,i)),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.name:{let{style:t}=e.attributes;return t?this.model={style:t}:this.model=void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):(e===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(e){return a.validStyleValues[e]}}a.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((e,t)=>(e[t]=!0,e),{});class o extends i{constructor(){super(),this.map={top:new a("top"),left:new a("left"),bottom:new a("bottom"),right:new a("right"),diagonal:new a("diagonal")}}render(e,t){let{color:r}=t;function i(i,n){i&&!i.color&&t.color&&(i={...i,color:t.color}),n.render(e,i,r)}e.openNode("border"),t.diagonal&&t.diagonal.style&&(t.diagonal.up&&e.addAttribute("diagonalUp","1"),t.diagonal.down&&e.addAttribute("diagonalDown","1")),i(t.left,this.map.left),i(t.right,this.map.right),i(t.top,this.map.top),i(t.bottom,this.map.bottom),i(t.diagonal,this.map.diagonal),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"border"===e.name?(this.reset(),this.diagonalUp=n.parseBoolean(e.attributes.diagonalUp),this.diagonalDown=n.parseBoolean(e.attributes.diagonalDown),!0):(this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if("border"===e){let e=this.model={},t=function(t,r,i){r&&(i&&Object.assign(r,i),e[t]=r)};t("left",this.map.left.model),t("right",this.map.right.model),t("top",this.map.top.model),t("bottom",this.map.bottom.model),t("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}e.exports=o},14480:(e,t,r)=>{let i=r(95774);class n extends i{constructor(e){super(),this.name=e||"color"}get tag(){return this.name}render(e,t){return!!t&&(e.openNode(this.name),t.argb?e.addAttribute("rgb",t.argb):void 0!==t.theme?(e.addAttribute("theme",t.theme),void 0!==t.tint&&e.addAttribute("tint",t.tint)):void 0!==t.indexed?e.addAttribute("indexed",t.indexed):e.addAttribute("auto","1"),e.closeNode(),!0)}parseOpen(e){return e.name===this.name&&(e.attributes.rgb?this.model={argb:e.attributes.rgb}:e.attributes.theme?(this.model={theme:parseInt(e.attributes.theme,10)},e.attributes.tint&&(this.model.tint=parseFloat(e.attributes.tint))):e.attributes.indexed?this.model={indexed:parseInt(e.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}e.exports=n},70637:(e,t,r)=>{let i=r(95774),n=r(74258),s=r(60443),a=r(76224),o=r(59e3),l=r(68378),u=r(77790);class c extends i{constructor(){super(),this.map={alignment:new n,border:new s,fill:new a,font:new o,numFmt:new l,protection:new u}}get tag(){return"dxf"}render(e,t){if(e.openNode(this.tag),t.font&&this.map.font.render(e,t.font),t.numFmt&&t.numFmtId){let r={id:t.numFmtId,formatCode:t.numFmt};this.map.numFmt.render(e,r)}t.fill&&this.map.fill.render(e,t.fill),t.alignment&&this.map.alignment.render(e,t.alignment),t.border&&this.map.border.render(e,t.border),t.protection&&this.map.protection.render(e,t.protection),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):e.name===this.tag?this.reset():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}e.exports=c},76224:(e,t,r)=>{let i=r(95774),n=r(14480);class s extends i{constructor(){super(),this.map={color:new n}}get tag(){return"stop"}render(e,t){e.openNode("stop"),e.addAttribute("position",t.position),this.map.color.render(e,t.color),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"stop":return this.model={position:parseFloat(e.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(e),!0;default:return!1}}parseText(){}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class a extends i{constructor(){super(),this.map={fgColor:new n("fgColor"),bgColor:new n("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(e,t){e.openNode("patternFill"),e.addAttribute("patternType",t.pattern),t.fgColor&&this.map.fgColor.render(e,t.fgColor),t.bgColor&&this.map.bgColor.render(e,t.bgColor),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"patternFill"===e.name?(this.model={type:"pattern",pattern:e.attributes.patternType},!0):(this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.parser.model&&(this.model[e]=this.parser.model),this.parser=void 0),!0)}}class o extends i{constructor(){super(),this.map={stop:new s}}get name(){return"gradient"}get tag(){return"gradientFill"}render(e,t){switch(e.openNode("gradientFill"),t.gradient){case"angle":e.addAttribute("degree",t.degree);break;case"path":e.addAttribute("type","path"),t.center.left&&(e.addAttribute("left",t.center.left),void 0===t.center.right&&e.addAttribute("right",t.center.left)),t.center.right&&e.addAttribute("right",t.center.right),t.center.top&&(e.addAttribute("top",t.center.top),void 0===t.center.bottom&&e.addAttribute("bottom",t.center.top)),t.center.bottom&&e.addAttribute("bottom",t.center.bottom)}let r=this.map.stop;t.stops.forEach(t=>{r.render(e,t)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"gradientFill":{let t=this.model={stops:[]};return e.attributes.degree?(t.gradient="angle",t.degree=parseInt(e.attributes.degree,10)):"path"===e.attributes.type&&(t.gradient="path",t.center={left:e.attributes.left?parseFloat(e.attributes.left):0,top:e.attributes.top?parseFloat(e.attributes.top):0},e.attributes.right!==e.attributes.left&&(t.center.right=e.attributes.right?parseFloat(e.attributes.right):0),e.attributes.bottom!==e.attributes.top&&(t.center.bottom=e.attributes.bottom?parseFloat(e.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class l extends i{constructor(){super(),this.map={patternFill:new a,gradientFill:new o}}get tag(){return"fill"}render(e,t){switch(e.addRollback(),e.openNode("fill"),t.type){case"pattern":this.map.patternFill.render(e,t);break;case"gradient":this.map.gradientFill.render(e,t);break;default:e.rollback();return}e.closeNode(),e.commit()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):"fill"===e.name?(this.model={},!0):(this.parser=this.map[e.name],!!this.parser&&(this.parser.parseOpen(e),!0))}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return!!this.parser&&(this.parser.parseClose(e)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(e){return l.validPatternValues[e]}}l.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((e,t)=>(e[t]=!0,e),{}),l.StopXform=s,l.PatternFillXform=a,l.GradientFillXform=o,e.exports=l},59e3:(e,t,r)=>{"use strict";let i=r(14480),n=r(50658),s=r(17944),a=r(98395),o=r(26547),l=r(29536),u=r(95774);class c extends u{constructor(e){super(),this.options=e||c.OPTIONS,this.map={b:{prop:"bold",xform:new n({tag:"b",attr:"val"})},i:{prop:"italic",xform:new n({tag:"i",attr:"val"})},u:{prop:"underline",xform:new o},charset:{prop:"charset",xform:new s({tag:"charset",attr:"val"})},color:{prop:"color",xform:new i},condense:{prop:"condense",xform:new n({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new n({tag:"extend",attr:"val"})},family:{prop:"family",xform:new s({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new n({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new a({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new a({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new n({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new n({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new s({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new a({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(e,t){let{map:r}=this;e.openNode(this.options.tagName),l.each(this.map,(i,n)=>{r[n].xform.render(e,t[i.prop])}),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):this.map[e.name]?(this.parser=this.map[e.name].xform,this.parser.parseOpen(e)):e.name===this.options.tagName&&(this.model={},!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser&&!this.parser.parseClose(e)){let t=this.map[e];return this.parser.model&&(this.model[t.prop]=this.parser.model),this.parser=void 0,!0}return e!==this.options.tagName}}c.OPTIONS={tagName:"font",fontNameTag:"name"},e.exports=c},68378:(e,t,r)=>{let i=r(29536),n=r(33386),s=r(95774),a=function(){let e={};return i.each(n,(t,r)=>{t.f&&(e[t.f]=parseInt(r,10))}),e}();class o extends s{constructor(e,t){super(),this.id=e,this.formatCode=t}get tag(){return"numFmt"}render(e,t){e.leafNode("numFmt",{numFmtId:t.id,formatCode:t.formatCode})}parseOpen(e){return"numFmt"===e.name&&(this.model={id:parseInt(e.attributes.numFmtId,10),formatCode:e.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0)}parseText(){}parseClose(){return!1}}o.getDefaultFmtId=function(e){return a[e]},o.getDefaultFmtCode=function(e){return n[e]&&n[e].f},e.exports=o},77790:(e,t,r)=>{let i=r(95774),n={boolean:(e,t)=>void 0===e?t:e};class s extends i{get tag(){return"protection"}render(e,t){e.addRollback(),e.openNode("protection");let r=!1;function i(t,i){void 0!==i&&(e.addAttribute(t,i),r=!0)}i("locked",n.boolean(t.locked,!0)?void 0:"0"),i("hidden",n.boolean(t.hidden,!1)?"1":void 0),e.closeNode(),r?e.commit():e.rollback()}parseOpen(e){let t={locked:"0"!==e.attributes.locked,hidden:"1"===e.attributes.hidden},r=!t.locked||t.hidden;this.model=r?t:null}parseText(){}parseClose(){return!1}}e.exports=s},27898:(e,t,r)=>{let i=r(95774),n=r(74258),s=r(77790);class a extends i{constructor(e){super(),this.xfId=!!(e&&e.xfId),this.map={alignment:new n,protection:new s}}get tag(){return"xf"}render(e,t){e.openNode("xf",{numFmtId:t.numFmtId||0,fontId:t.fontId||0,fillId:t.fillId||0,borderId:t.borderId||0}),this.xfId&&e.addAttribute("xfId",t.xfId||0),t.numFmtId&&e.addAttribute("applyNumberFormat","1"),t.fontId&&e.addAttribute("applyFont","1"),t.fillId&&e.addAttribute("applyFill","1"),t.borderId&&e.addAttribute("applyBorder","1"),t.alignment&&e.addAttribute("applyAlignment","1"),t.protection&&e.addAttribute("applyProtection","1"),t.alignment&&this.map.alignment.render(e,t.alignment),t.protection&&this.map.protection.render(e,t.protection),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"xf":return this.model={numFmtId:parseInt(e.attributes.numFmtId,10),fontId:parseInt(e.attributes.fontId,10),fillId:parseInt(e.attributes.fillId,10),borderId:parseInt(e.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(e.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(e),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):"xf"!==e}}e.exports=a},89171:(e,t,r)=>{let i=r(98672),n=r(43213),s=r(95774),a=r(70341),o=r(1395),l=r(59e3),u=r(76224),c=r(60443),h=r(68378),d=r(27898),p=r(70637);class f extends s{constructor(e){super(),this.map={numFmts:new o({tag:"numFmts",count:!0,childXform:new h}),fonts:new o({tag:"fonts",count:!0,childXform:new l,$:{"x14ac:knownFonts":1}}),fills:new o({tag:"fills",count:!0,childXform:new u}),borders:new o({tag:"borders",count:!0,childXform:new c}),cellStyleXfs:new o({tag:"cellStyleXfs",count:!0,childXform:new d}),cellXfs:new o({tag:"cellXfs",count:!0,childXform:new d({xfId:!0})}),dxfs:new o({tag:"dxfs",always:!0,count:!0,childXform:new p}),numFmt:new h,font:new l,fill:new u,border:new c,style:new d({xfId:!0}),cellStyles:f.STATIC_XFORMS.cellStyles,tableStyles:f.STATIC_XFORMS.tableStyles,extLst:f.STATIC_XFORMS.extLst},e&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(e,t){t=t||this.model,e.openXml(n.StdDocAttributes),e.openNode("styleSheet",f.STYLESHEET_ATTRIBUTES),this.index?(t.numFmts&&t.numFmts.length&&(e.openNode("numFmts",{count:t.numFmts.length}),t.numFmts.forEach(t=>{e.writeXml(t)}),e.closeNode()),t.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),e.openNode("fonts",{count:t.fonts.length,"x14ac:knownFonts":1}),t.fonts.forEach(t=>{e.writeXml(t)}),e.closeNode(),e.openNode("fills",{count:t.fills.length}),t.fills.forEach(t=>{e.writeXml(t)}),e.closeNode(),e.openNode("borders",{count:t.borders.length}),t.borders.forEach(t=>{e.writeXml(t)}),e.closeNode(),this.map.cellStyleXfs.render(e,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),e.openNode("cellXfs",{count:t.styles.length}),t.styles.forEach(t=>{e.writeXml(t)}),e.closeNode()):(this.map.numFmts.render(e,t.numFmts),this.map.fonts.render(e,t.fonts),this.map.fills.render(e,t.fills),this.map.borders.render(e,t.borders),this.map.cellStyleXfs.render(e,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(e,t.styles)),f.STATIC_XFORMS.cellStyles.render(e),this.map.dxfs.render(e,t.dxfs),f.STATIC_XFORMS.tableStyles.render(e),f.STATIC_XFORMS.extLst.render(e),e.closeNode()}parseOpen(e){return this.parser?this.parser.parseOpen(e):"styleSheet"===e.name?this.initIndex():(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if("styleSheet"===e){this.model={};let e=(e,t)=>{t.model&&t.model.length&&(this.model[e]=t.model)};if(e("numFmts",this.map.numFmts),e("fonts",this.map.fonts),e("fills",this.map.fills),e("borders",this.map.borders),e("styles",this.map.cellXfs),e("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){let e=this.index.numFmt;this.model.numFmts.forEach(t=>{e[t.id]=t.formatCode})}return!1}return!0}addStyleModel(e,t){if(!e)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(e))return this.weakMap.get(e);let r={};if(t=t||i.ValueType.Number,e.numFmt)r.numFmtId=this._addNumFmtStr(e.numFmt);else switch(t){case i.ValueType.Number:r.numFmtId=this._addNumFmtStr("General");break;case i.ValueType.Date:r.numFmtId=this._addNumFmtStr("mm-dd-yy")}e.font&&(r.fontId=this._addFont(e.font)),e.border&&(r.borderId=this._addBorder(e.border)),e.fill&&(r.fillId=this._addFill(e.fill)),e.alignment&&(r.alignment=e.alignment),e.protection&&(r.protection=e.protection);let n=this._addStyle(r);return this.weakMap&&this.weakMap.set(e,n),n}getStyleModel(e){let t=this.model.styles[e];if(!t)return null;let r=this.index.model[e];if(r)return r;if(r=this.index.model[e]={},t.numFmtId){let e=this.index.numFmt[t.numFmtId]||h.getDefaultFmtCode(t.numFmtId);e&&(r.numFmt=e)}function i(e,t,i){if(i||0===i){let n=t[i];n&&(r[e]=n)}}return i("font",this.model.fonts,t.fontId),i("border",this.model.borders,t.borderId),i("fill",this.model.fills,t.fillId),t.alignment&&(r.alignment=t.alignment),t.protection&&(r.protection=t.protection),r}addDxfStyle(e){return e.numFmt&&(e.numFmtId=this._addNumFmtStr(e.numFmt)),this.model.dxfs.push(e),this.model.dxfs.length-1}getDxfStyle(e){return this.model.dxfs[e]}_addStyle(e){let t=this.map.style.toXml(e),r=this.index.style[t];return void 0===r&&(r=this.index.style[t]=this.model.styles.length,this.model.styles.push(t)),r}_addNumFmtStr(e){let t=h.getDefaultFmtId(e);if(void 0!==t||void 0!==(t=this.index.numFmt[e]))return t;t=this.index.numFmt[e]=164+this.model.numFmts.length;let r=this.map.numFmt.toXml({id:t,formatCode:e});return this.model.numFmts.push(r),t}_addFont(e){let t=this.map.font.toXml(e),r=this.index.font[t];return void 0===r&&(r=this.index.font[t]=this.model.fonts.length,this.model.fonts.push(t)),r}_addBorder(e){let t=this.map.border.toXml(e),r=this.index.border[t];return void 0===r&&(r=this.index.border[t]=this.model.borders.length,this.model.borders.push(t)),r}_addFill(e){let t=this.map.fill.toXml(e),r=this.index.fill[t];return void 0===r&&(r=this.index.fill[t]=this.model.fills.length,this.model.fills.push(t)),r}}f.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},f.STATIC_XFORMS={cellStyles:new a({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new a({tag:"dxfs",$:{count:0}}),tableStyles:new a({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new a({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})};class m extends f{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(e){return e.autodrain(),Promise.resolve()}addStyleModel(e,t){return t===i.ValueType.Date?this.dateStyleId:0}get dateStyleId(){if(!this._dateStyleId){let e={numFmtId:h.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(e)}return this._dateStyleId}getStyleModel(){return{}}}f.Mock=m,e.exports=f},26547:(e,t,r)=>{let i=r(95774);class n extends i{constructor(e){super(),this.model=e}get tag(){return"u"}render(e,t){if(!0===(t=t||this.model))e.leafNode("u");else{let r=n.Attributes[t];r&&e.leafNode("u",r)}}parseOpen(e){"u"===e.name&&(this.model=e.attributes.val||!0)}parseText(){}parseClose(){return!1}}n.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},e.exports=n},30742:(e,t,r)=>{let i=r(95774),n=r(58497);class s extends i{constructor(){super(),this.map={filterColumn:new n}}get tag(){return"autoFilter"}prepare(e){e.columns.forEach((e,t)=>{this.map.filterColumn.prepare(e,{index:t})})}render(e,t){return e.openNode(this.tag,{ref:t.autoFilterRef}),t.columns.forEach(t=>{this.map.filterColumn.render(e,t)}),e.closeNode(),!0}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name===this.tag)return this.model={autoFilterRef:e.attributes.ref,columns:[]},!0;if(this.parser=this.map[e.name],this.parser)return this.parseOpen(e),!0;throw Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;if(e===this.tag)return!1;throw Error(`Unexpected xml node in parseClose: ${e}`)}}e.exports=s},7538:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"customFilter"}render(e,t){e.leafNode(this.tag,{val:t.val,operator:t.operator})}parseOpen(e){return e.name===this.tag&&(this.model={val:e.attributes.val,operator:e.attributes.operator},!0)}parseText(){}parseClose(){return!1}}e.exports=n},58497:(e,t,r)=>{let i=r(95774),n=r(1395),s=r(7538),a=r(50868);class o extends i{constructor(){super(),this.map={customFilters:new n({tag:"customFilters",count:!1,empty:!0,childXform:new s}),filters:new n({tag:"filters",count:!1,empty:!0,childXform:new a})}}get tag(){return"filterColumn"}prepare(e,t){e.colId=t.index.toString()}render(e,t){return t.customFilters?(e.openNode(this.tag,{colId:t.colId,hiddenButton:t.filterButton?"0":"1"}),this.map.customFilters.render(e,t.customFilters),e.closeNode()):e.leafNode(this.tag,{colId:t.colId,hiddenButton:t.filterButton?"0":"1"}),!0}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;let{attributes:t}=e;if(e.name===this.tag)return this.model={filterButton:"0"===t.hiddenButton},!0;if(this.parser=this.map[e.name],this.parser)return this.parseOpen(e),!0;throw Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model.customFilters=this.map.customFilters.model,!1)}}e.exports=o},50868:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"filter"}render(e,t){e.leafNode(this.tag,{val:t.val})}parseOpen(e){return e.name===this.tag&&(this.model={val:e.attributes.val},!0)}parseText(){}parseClose(){return!1}}e.exports=n},20591:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"tableColumn"}prepare(e,t){e.id=t.index+1}render(e,t){return e.leafNode(this.tag,{id:t.id.toString(),name:t.name,totalsRowLabel:t.totalsRowLabel,totalsRowFunction:t.totalsRowFunction,dxfId:t.dxfId}),!0}parseOpen(e){if(e.name===this.tag){let{attributes:t}=e;return this.model={name:t.name,totalsRowLabel:t.totalsRowLabel,totalsRowFunction:t.totalsRowFunction,dxfId:t.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}e.exports=n},36293:(e,t,r)=>{let i=r(95774);class n extends i{get tag(){return"tableStyleInfo"}render(e,t){return e.leafNode(this.tag,{name:t.theme?t.theme:void 0,showFirstColumn:t.showFirstColumn?"1":"0",showLastColumn:t.showLastColumn?"1":"0",showRowStripes:t.showRowStripes?"1":"0",showColumnStripes:t.showColumnStripes?"1":"0"}),!0}parseOpen(e){if(e.name===this.tag){let{attributes:t}=e;return this.model={theme:t.name?t.name:null,showFirstColumn:"1"===t.showFirstColumn,showLastColumn:"1"===t.showLastColumn,showRowStripes:"1"===t.showRowStripes,showColumnStripes:"1"===t.showColumnStripes},!0}return!1}parseText(){}parseClose(){return!1}}e.exports=n},12522:(e,t,r)=>{let i=r(43213),n=r(95774),s=r(1395),a=r(30742),o=r(20591),l=r(36293);class u extends n{constructor(){super(),this.map={autoFilter:new a,tableColumns:new s({tag:"tableColumns",count:!0,empty:!0,childXform:new o}),tableStyleInfo:new l}}prepare(e,t){this.map.autoFilter.prepare(e),this.map.tableColumns.prepare(e.columns,t)}get tag(){return"table"}render(e,t){e.openXml(i.StdDocAttributes),e.openNode(this.tag,{...u.TABLE_ATTRIBUTES,id:t.id,name:t.name,displayName:t.displayName||t.name,ref:t.tableRef,totalsRowCount:t.totalsRow?"1":void 0,totalsRowShown:t.totalsRow?void 0:"1",headerRowCount:t.headerRow?"1":"0"}),this.map.autoFilter.render(e,t),this.map.tableColumns.render(e,t.columns),this.map.tableStyleInfo.render(e,t.style),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;let{name:t,attributes:r}=e;return t===this.tag?(this.reset(),this.model={name:r.name,displayName:r.displayName||r.name,tableRef:r.ref,totalsRow:"1"===r.totalsRowCount,headerRow:"1"===r.headerRowCount}):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e)),!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e!==this.tag||(this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((e,t)=>{this.model.columns[t].filterButton=e.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1)}reconcile(e,t){e.columns.forEach(e=>{void 0!==e.dxfId&&(e.style=t.styles.getDxfStyle(e.dxfId))})}}u.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},e.exports=u},21316:(e,t,r)=>{let i=r(29021),n=r(65886),{PassThrough:s}=r(68280),a=r(49803),o=r(53881),l=r(86968),u=r(43213),{bufferToString:c}=r(2895),h=r(89171),d=r(43702),p=r(72502),f=r(60180),m=r(11546),g=r(63936),y=r(50827),v=r(42701),b=r(72534),w=r(12522),x=r(21491),S=r(7740),E=r(73641);class T{constructor(e){this.workbook=e}async readFile(e,t){if(!await l.fs.exists(e))throw Error(`File not found: ${e}`);let r=i.createReadStream(e);try{let e=await this.read(r,t);return r.close(),e}catch(e){throw r.close(),e}}parseRels(e){return new f().parseStream(e)}parseWorkbook(e){return new y().parseStream(e)}parseSharedStrings(e){return new p().parseStream(e)}reconcile(e,t){let r=new y,i=new v(t),n=new b,s=new w;r.reconcile(e);let a={media:e.media,mediaIndex:e.mediaIndex};Object.keys(e.drawings).forEach(t=>{let r=e.drawings[t],i=e.drawingRels[t];i&&(a.rels=i.reduce((e,t)=>(e[t.Id]=t,e),{}),(r.anchors||[]).forEach(e=>{let t=e.picture&&e.picture.hyperlinks;t&&a.rels[t.rId]&&(t.hyperlink=a.rels[t.rId].Target,delete t.rId)}),n.reconcile(r,a))});let o={styles:e.styles};Object.values(e.tables).forEach(e=>{s.reconcile(e,o)});let l={styles:e.styles,sharedStrings:e.sharedStrings,media:e.media,mediaIndex:e.mediaIndex,date1904:e.properties&&e.properties.date1904,drawings:e.drawings,comments:e.comments,tables:e.tables,vmlDrawings:e.vmlDrawings};e.worksheets.forEach(t=>{t.relationships=e.worksheetRels[t.sheetNo],i.reconcile(t,l)}),delete e.worksheetHash,delete e.worksheetRels,delete e.globalRels,delete e.sharedStrings,delete e.workbookRels,delete e.sheetDefs,delete e.styles,delete e.mediaIndex,delete e.drawings,delete e.drawingRels,delete e.vmlDrawings}async _processWorksheetEntry(e,t,r,i,n){let s=new v(i),a=await s.parseStream(e);a.sheetNo=r,t.worksheetHash[n]=a,t.worksheets.push(a)}async _processCommentEntry(e,t,r){let i=new x,n=await i.parseStream(e);t.comments[`../${r}.xml`]=n}async _processTableEntry(e,t,r){let i=new w,n=await i.parseStream(e);t.tables[`../tables/${r}.xml`]=n}async _processWorksheetRelsEntry(e,t,r){let i=new f,n=await i.parseStream(e);t.worksheetRels[r]=n}async _processMediaEntry(e,t,r){let i=r.lastIndexOf(".");if(i>=1){let n=r.substr(i+1),s=r.substr(0,i);await new Promise((i,a)=>{let l=new o;l.on("finish",()=>{t.mediaIndex[r]=t.media.length,t.mediaIndex[s]=t.media.length;let e={type:"image",name:s,extension:n,buffer:l.toBuffer()};t.media.push(e),i()}),e.on("error",e=>{a(e)}),e.pipe(l)})}}async _processDrawingEntry(e,t,r){let i=new b,n=await i.parseStream(e);t.drawings[r]=n}async _processDrawingRelsEntry(e,t,r){let i=new f,n=await i.parseStream(e);t.drawingRels[r]=n}async _processVmlDrawingEntry(e,t,r){let i=new S,n=await i.parseStream(e);t.vmlDrawings[`../drawings/${r}.vml`]=n}async _processThemeEntry(e,t,r){await new Promise((i,n)=>{let s=new o;e.on("error",n),s.on("error",n),s.on("finish",()=>{t.themes[r]=s.read().toString(),i()}),e.pipe(s)})}createInputStream(){throw Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(e,t){!e[Symbol.asyncIterator]&&e.pipe&&(e=e.pipe(new s));let r=[];for await(let t of e)r.push(t);return this.load(Buffer.concat(r),t)}async load(e,t){let r;r=t&&t.base64?Buffer.from(e.toString(),"base64"):e;let i={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}};for(let e of Object.values((await n.loadAsync(r)).files))if(!e.dir){let r,n=e.name;if("/"===n[0]&&(n=n.substr(1)),n.match(/xl\/media\//)||n.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))(r=new s).write(await e.async("nodebuffer"));else{let t;r=new s({writableObjectMode:!0,readableObjectMode:!0}),t=await e.async("string");for(let e=0;e<t.length;e+=16384)r.write(t.substring(e,e+16384))}switch(r.end(),n){case"_rels/.rels":i.globalRels=await this.parseRels(r);break;case"xl/workbook.xml":{let e=await this.parseWorkbook(r);i.sheets=e.sheets,i.definedNames=e.definedNames,i.views=e.views,i.properties=e.properties,i.calcProperties=e.calcProperties;break}case"xl/_rels/workbook.xml.rels":i.workbookRels=await this.parseRels(r);break;case"xl/sharedStrings.xml":i.sharedStrings=new p,await i.sharedStrings.parseStream(r);break;case"xl/styles.xml":i.styles=new h,await i.styles.parseStream(r);break;case"docProps/app.xml":{let e=new g,t=await e.parseStream(r);i.company=t.company,i.manager=t.manager;break}case"docProps/core.xml":{let e=new d;Object.assign(i,await e.parseStream(r));break}default:{let e=n.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(e){await this._processWorksheetEntry(r,i,e[1],t,n);break}if(e=n.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/)){await this._processWorksheetRelsEntry(r,i,e[1]);break}if(e=n.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/)){await this._processThemeEntry(r,i,e[1]);break}if(e=n.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/)){await this._processMediaEntry(r,i,e[1]);break}if(e=n.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/)){await this._processDrawingEntry(r,i,e[1]);break}if(e=n.match(/xl\/(comments\d+)[.]xml/)){await this._processCommentEntry(r,i,e[1]);break}if(e=n.match(/xl\/tables\/(table\d+)[.]xml/)){await this._processTableEntry(r,i,e[1]);break}if(e=n.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/)){await this._processDrawingRelsEntry(r,i,e[1]);break}(e=n.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/))&&await this._processVmlDrawingEntry(r,i,e[1])}}}return this.reconcile(i,t),this.workbook.model=i,this.workbook}async addMedia(e,t){await Promise.all(t.media.map(async t=>{if("image"===t.type){let n=`xl/media/${t.name}.${t.extension}`;if(t.filename){var r;let s=await (r=t.filename,new Promise((e,t)=>{i.readFile(r,void 0,(r,i)=>{r?t(r):e(i)})}));return e.append(s,{name:n})}if(t.buffer)return e.append(t.buffer,{name:n});if(t.base64){let r=t.base64,i=r.substring(r.indexOf(",")+1);return e.append(i,{name:n,base64:!0})}}throw Error("Unsupported media")}))}addDrawings(e,t){let r=new b,i=new f;t.worksheets.forEach(t=>{let{drawing:n}=t;if(n){r.prepare(n,{});let t=r.toXml(n);e.append(t,{name:`xl/drawings/${n.name}.xml`}),t=i.toXml(n.rels),e.append(t,{name:`xl/drawings/_rels/${n.name}.xml.rels`})}})}addTables(e,t){let r=new w;t.worksheets.forEach(t=>{let{tables:i}=t;i.forEach(t=>{r.prepare(t,{});let i=r.toXml(t);e.append(i,{name:`xl/tables/${t.target}`})})})}async addContentTypes(e,t){let r=new m().toXml(t);e.append(r,{name:"[Content_Types].xml"})}async addApp(e,t){let r=new g().toXml(t);e.append(r,{name:"docProps/app.xml"})}async addCore(e,t){let r=new d;e.append(r.toXml(t),{name:"docProps/core.xml"})}async addThemes(e,t){let r=t.themes||{theme1:E};Object.keys(r).forEach(t=>{let i=r[t],n=`xl/theme/${t}.xml`;e.append(i,{name:n})})}async addOfficeRels(e){let t=new f().toXml([{Id:"rId1",Type:T.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:T.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:T.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);e.append(t,{name:"_rels/.rels"})}async addWorkbookRels(e,t){let r=1,i=[{Id:`rId${r++}`,Type:T.RelType.Styles,Target:"styles.xml"},{Id:`rId${r++}`,Type:T.RelType.Theme,Target:"theme/theme1.xml"}];t.sharedStrings.count&&i.push({Id:`rId${r++}`,Type:T.RelType.SharedStrings,Target:"sharedStrings.xml"}),t.worksheets.forEach(e=>{e.rId=`rId${r++}`,i.push({Id:e.rId,Type:T.RelType.Worksheet,Target:`worksheets/sheet${e.id}.xml`})});let n=new f().toXml(i);e.append(n,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(e,t){t.sharedStrings&&t.sharedStrings.count&&e.append(t.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(e,t){let{xml:r}=t.styles;r&&e.append(r,{name:"xl/styles.xml"})}async addWorkbook(e,t){let r=new y;e.append(r.toXml(t),{name:"xl/workbook.xml"})}async addWorksheets(e,t){let r=new v,i=new f,n=new x,s=new S;t.worksheets.forEach(t=>{let a=new u;r.render(a,t),e.append(a.xml,{name:`xl/worksheets/sheet${t.id}.xml`}),t.rels&&t.rels.length&&(a=new u,i.render(a,t.rels),e.append(a.xml,{name:`xl/worksheets/_rels/sheet${t.id}.xml.rels`})),t.comments.length>0&&(a=new u,n.render(a,t),e.append(a.xml,{name:`xl/comments${t.id}.xml`}),a=new u,s.render(a,t),e.append(a.xml,{name:`xl/drawings/vmlDrawing${t.id}.vml`}))})}_finalize(e){return new Promise((t,r)=>{e.on("finish",()=>{t(this)}),e.on("error",r),e.finalize()})}prepareModel(e,t){e.creator=e.creator||"ExcelJS",e.lastModifiedBy=e.lastModifiedBy||"ExcelJS",e.created=e.created||new Date,e.modified=e.modified||new Date,e.useSharedStrings=void 0===t.useSharedStrings||t.useSharedStrings,e.useStyles=void 0===t.useStyles||t.useStyles,e.sharedStrings=new p,e.styles=e.useStyles?new h(!0):new h.Mock;let r=new y,i=new v;r.prepare(e);let n={sharedStrings:e.sharedStrings,styles:e.styles,date1904:e.properties.date1904,drawingsCount:0,media:e.media};n.drawings=e.drawings=[],n.commentRefs=e.commentRefs=[];let s=0;e.tables=[],e.worksheets.forEach(t=>{t.tables.forEach(t=>{s++,t.target=`table${s}.xml`,t.id=s,e.tables.push(t)}),i.prepare(t,n)})}async write(e,t){t=t||{};let{model:r}=this.workbook,i=new a.ZipWriter(t.zip);return i.pipe(e),this.prepareModel(r,t),await this.addContentTypes(i,r),await this.addOfficeRels(i,r),await this.addWorkbookRels(i,r),await this.addWorksheets(i,r),await this.addSharedStrings(i,r),await this.addDrawings(i,r),await this.addTables(i,r),await Promise.all([this.addThemes(i,r),this.addStyles(i,r)]),await this.addMedia(i,r),await Promise.all([this.addApp(i,r),this.addCore(i,r)]),await this.addWorkbook(i,r),this._finalize(i)}writeFile(e,t){let r=i.createWriteStream(e);return new Promise((e,i)=>{r.on("finish",()=>{e()}),r.on("error",e=>{i(e)}),this.write(r,t).then(()=>{r.end()}).catch(e=>{i(e)})})}async writeBuffer(e){let t=new o;return await this.write(t,e),t.read()}}T.RelType=r(37529),e.exports=T},73641:e=>{e.exports='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>'},78154:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CsvParserStream=t.ParserOptions=t.parseFile=t.parseStream=t.parseString=t.parse=t.FormatterOptions=t.CsvFormatterStream=t.writeToPath=t.writeToString=t.writeToBuffer=t.writeToStream=t.write=t.format=void 0;var i=r(95539);Object.defineProperty(t,"format",{enumerable:!0,get:function(){return i.format}}),Object.defineProperty(t,"write",{enumerable:!0,get:function(){return i.write}}),Object.defineProperty(t,"writeToStream",{enumerable:!0,get:function(){return i.writeToStream}}),Object.defineProperty(t,"writeToBuffer",{enumerable:!0,get:function(){return i.writeToBuffer}}),Object.defineProperty(t,"writeToString",{enumerable:!0,get:function(){return i.writeToString}}),Object.defineProperty(t,"writeToPath",{enumerable:!0,get:function(){return i.writeToPath}}),Object.defineProperty(t,"CsvFormatterStream",{enumerable:!0,get:function(){return i.CsvFormatterStream}}),Object.defineProperty(t,"FormatterOptions",{enumerable:!0,get:function(){return i.FormatterOptions}});var n=r(43810);Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return n.parse}}),Object.defineProperty(t,"parseString",{enumerable:!0,get:function(){return n.parseString}}),Object.defineProperty(t,"parseStream",{enumerable:!0,get:function(){return n.parseStream}}),Object.defineProperty(t,"parseFile",{enumerable:!0,get:function(){return n.parseFile}}),Object.defineProperty(t,"ParserOptions",{enumerable:!0,get:function(){return n.ParserOptions}}),Object.defineProperty(t,"CsvParserStream",{enumerable:!0,get:function(){return n.CsvParserStream}})},73252:(e,t,r)=>{e.exports=r(29021).constants||r(81115)},55874:(e,t,r)=>{e.exports=c,c.realpath=c,c.sync=h,c.realpathSync=h,c.monkeypatch=function(){i.realpath=c,i.realpathSync=h},c.unmonkeypatch=function(){i.realpath=n,i.realpathSync=s};var i=r(29021),n=i.realpath,s=i.realpathSync,a=process.version,o=/^v[0-5]\./.test(a),l=r(89987);function u(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function c(e,t,r){if(o)return n(e,t,r);"function"==typeof t&&(r=t,t=null),n(e,t,function(i,n){u(i)?l.realpath(e,t,r):r(i,n)})}function h(e,t){if(o)return s(e,t);try{return s(e,t)}catch(r){if(u(r))return l.realpathSync(e,t);throw r}}},89987:(e,t,r)=>{var i=r(33873),n="win32"===process.platform,s=r(29021),a=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);if(i.normalize,n)var o=/(.*?)(?:[\/\\]+|$)/g;else var o=/(.*?)(?:[\/]+|$)/g;if(n)var l=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else var l=/^[\/]*/;t.realpathSync=function(e,t){if(e=i.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var r=e,a={},u={};function c(){var t=l.exec(e);h=t[0].length,d=t[0],p=t[0],f="",n&&!u[p]&&(s.lstatSync(p),u[p]=!0)}for(c();h<e.length;){o.lastIndex=h;var h,d,p,f,m,g=o.exec(e);if(f=d,d+=g[0],p=f+g[1],h=o.lastIndex,!u[p]&&(!t||t[p]!==p)){if(t&&Object.prototype.hasOwnProperty.call(t,p))m=t[p];else{var y=s.lstatSync(p);if(!y.isSymbolicLink()){u[p]=!0,t&&(t[p]=p);continue}var v=null;if(!n){var b=y.dev.toString(32)+":"+y.ino.toString(32);a.hasOwnProperty(b)&&(v=a[b])}null===v&&(s.statSync(p),v=s.readlinkSync(p)),m=i.resolve(f,v),t&&(t[p]=m),n||(a[b]=v)}e=i.resolve(m,e.slice(h)),c()}}return t&&(t[r]=e),e},t.realpath=function(e,t,r){if("function"!=typeof r){var u;r="function"==typeof(u=t)?u:function(){var e;if(a){var t=Error();e=function(e){e&&(t.message=e.message,r(e=t))}}else e=r;return e;function r(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}}(),t=null}if(e=i.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(r.bind(null,null,t[e]));var c,h,d,p,f=e,m={},g={};function y(){var t=l.exec(e);c=t[0].length,h=t[0],d=t[0],p="",n&&!g[d]?s.lstat(d,function(e){if(e)return r(e);g[d]=!0,v()}):process.nextTick(v)}function v(){if(c>=e.length)return t&&(t[f]=e),r(null,e);o.lastIndex=c;var i=o.exec(e);return(p=h,h+=i[0],d=p+i[1],c=o.lastIndex,g[d]||t&&t[d]===d)?process.nextTick(v):t&&Object.prototype.hasOwnProperty.call(t,d)?x(t[d]):s.lstat(d,b)}function b(e,i){if(e)return r(e);if(!i.isSymbolicLink())return g[d]=!0,t&&(t[d]=d),process.nextTick(v);if(!n){var a=i.dev.toString(32)+":"+i.ino.toString(32);if(m.hasOwnProperty(a))return w(null,m[a],d)}s.stat(d,function(e){if(e)return r(e);s.readlink(d,function(e,t){n||(m[a]=t),w(e,t)})})}function w(e,n,s){if(e)return r(e);var a=i.resolve(p,n);t&&(t[s]=a),x(a)}function x(t){e=i.resolve(t,e.slice(c)),y()}y()}},81469:(e,t,r)=>{r(31921),r(96184),t.Writer=r(99644),t.ZH={Reader:r(13381),Writer:r(87753)},t.ig={Reader:r(62558),Writer:r(30894)},t.N_={Reader:r(38859),Writer:r(50267)},t.by={Reader:r(5931),Writer:r(95931)},t.ig.Reader,t.ZH.Reader,t.N_.Reader,t.by.Reader,t.Writer.Dir=t.ig.Writer,t.Writer.File=t.ZH.Writer,t.Writer.Link=t.N_.Writer,t.Writer.Proxy=t.by.Writer,r(95325)},31921:(e,t,r)=>{e.exports=n;var i=r(27910).Stream;function n(){i.call(this)}function s(e,t,r){return e instanceof Error||(e=Error(e)),e.code=e.code||t,e.path=e.path||r.path,e.fstream_type=e.fstream_type||r.type,e.fstream_path=e.fstream_path||r.path,r._path!==r.path&&(e.fstream_unc_path=e.fstream_unc_path||r._path),r.linkpath&&(e.fstream_linkpath=e.fstream_linkpath||r.linkpath),e.fstream_class=e.fstream_class||r.constructor.name,e.fstream_stack=e.fstream_stack||Error().stack.split(/\n/).slice(3).map(function(e){return e.replace(/^ {4}at /,"")}),e}r(76225)(n,i),n.prototype.on=function(e,t){return"ready"===e&&this.ready?process.nextTick(t.bind(this)):i.prototype.on.call(this,e,t),this},n.prototype.abort=function(){this._aborted=!0,this.emit("abort")},n.prototype.destroy=function(){},n.prototype.warn=function(e,t){var r=s(e,t,this);this.listeners("warn")?this.emit("warn",r):console.error("%s %s\npath = %s\nsyscall = %s\nfstream_type = %s\nfstream_path = %s\nfstream_unc_path = %s\nfstream_class = %s\nfstream_stack =\n%s\n",t||"UNKNOWN",r.stack,r.path,r.syscall,r.fstream_type,r.fstream_path,r.fstream_unc_path,r.fstream_class,r.fstream_stack.join("\n"))},n.prototype.info=function(e,t){this.emit("info",e,t)},n.prototype.error=function(e,t,r){var i=s(e,t,this);if(r)throw i;this.emit("error",i)}},95325:e=>{e.exports=function e(t){if(!t._collected){if(t._paused)return t.on("resume",e.bind(null,t));t._collected=!0,t.pause(),t.on("data",s),t.on("end",s);var r,i=[];t.on("entry",a);var n=[];t.on("proxy",function(e){e.pause()}),t.pipe=(r=t.pipe,function(e){var o=0;return function l(){var u=n[o++];if(!u)return void(t.removeListener("entry",a),t.removeListener("data",s),t.removeListener("end",s),t.pipe=r,e&&t.pipe(e),i.forEach(function(e){e?t.emit("data",e):t.emit("end")}),t.resume());u.on("end",l),e?e.add(u):t.emit("entry",u)}(),e})}function s(e){"string"==typeof e&&(e=new Buffer(e)),(!Buffer.isBuffer(e)||e.length)&&i.push(e)}function a(t){e(t),n.push(t)}}},62558:(e,t,r)=>{e.exports=l;var i=r(2720),n=r(76225),s=r(33873),a=r(96184),o=r(12412).ok;function l(e){if(!(this instanceof l))throw Error("DirReader must be called as constructor.");if("Directory"!==e.type||!e.Directory)throw Error("Non-directory type "+e.type);this.entries=null,this._index=-1,this._paused=!1,this._length=-1,e.sort&&(this.sort=e.sort),a.call(this,e)}n(l,a),l.prototype._getEntries=function(){var e=this;e._gotEntries||(e._gotEntries=!0,i.readdir(e._path,function(t,r){if(t)return e.error(t);function i(){e._length=e.entries.length,"function"==typeof e.sort&&(e.entries=e.entries.sort(e.sort.bind(e))),e._read()}e.entries=r,e.emit("entries",r),e._paused?e.once("resume",i):i()}))},l.prototype._read=function(){var e=this;if(!e.entries)return e._getEntries();if(!e._paused&&!e._currentEntry&&!e._aborted){if(e._index++,e._index>=e.entries.length){e._ended||(e._ended=!0,e.emit("end"),e.emit("close"));return}var t=s.resolve(e._path,e.entries[e._index]);o(t!==e._path),o(e.entries[e._index]),e._currentEntry=t,i[e.props.follow?"stat":"lstat"](t,function(r,i){if(r)return e.error(r);var n=e._proxy||e;i.path=t,i.basename=s.basename(t),i.dirname=s.dirname(t);var o=e.getChildProps.call(n,i);o.path=t,o.basename=s.basename(t),o.dirname=s.dirname(t);var l=a(o,i);e._currentEntry=l,l.on("pause",function(t){e._paused||l._disowned||e.pause(t)}),l.on("resume",function(t){e._paused&&!l._disowned&&e.resume(t)}),l.on("stat",function(t){e.emit("_entryStat",l,t),l._aborted||(l._paused?l.once("resume",function(){e.emit("entryStat",l,t)}):e.emit("entryStat",l,t))}),l.on("ready",function t(){if(e._paused)return l.pause(e),e.once("resume",t);"Socket"===l.type?e.emit("socket",l):e.emitEntry(l)});var u=!1;function c(){u||(u=!0,e.emit("childEnd",l),e.emit("entryEnd",l),e._currentEntry=null,e._paused||e._read())}l.on("close",c),l.on("disown",c),l.on("error",function(t){l._swallowErrors?(e.warn(t),l.emit("end"),l.emit("close")):e.emit("error",t)}),["child","childEnd","warn"].forEach(function(t){l.on(t,e.emit.bind(e,t))})})}},l.prototype.disown=function(e){e.emit("beforeDisown"),e._disowned=!0,e.parent=e.root=null,e===this._currentEntry&&(this._currentEntry=null),e.emit("disown")},l.prototype.getChildProps=function(){return{depth:this.depth+1,root:this.root||this,parent:this,follow:this.follow,filter:this.filter,sort:this.props.sort,hardlinks:this.props.hardlinks}},l.prototype.pause=function(e){this._paused||(e=e||this,this._paused=!0,this._currentEntry&&this._currentEntry.pause&&this._currentEntry.pause(e),this.emit("pause",e))},l.prototype.resume=function(e){this._paused&&(e=e||this,this._paused=!1,this.emit("resume",e),!this._paused&&(this._currentEntry?this._currentEntry.resume&&this._currentEntry.resume(e):this._read()))},l.prototype.emitEntry=function(e){this.emit("entry",e),this.emit("child",e)}},30894:(e,t,r)=>{e.exports=l;var i=r(99644),n=r(76225),s=r(47734),a=r(33873),o=r(95325);function l(e){this instanceof l||this.error("DirWriter must be called as constructor.",null,!0),"Directory"===e.type&&e.Directory||this.error("Non-directory type "+e.type+" "+JSON.stringify(e),null,!0),i.call(this,e)}n(l,i),l.prototype._create=function(){var e=this;s(e._path,i.dirmode,function(t){if(t)return e.error(t);e.ready=!0,e.emit("ready"),e._process()})},l.prototype.write=function(){return!0},l.prototype.end=function(){this._ended=!0,this._process()},l.prototype.add=function(e){return(o(e),!this.ready||this._currentEntry)?(this._buffer.push(e),!1):this._ended?this.error("add after end"):(this._buffer.push(e),this._process(),0===this._buffer.length)},l.prototype._process=function(){var e,t=this;if(!t._processing){var r=t._buffer.shift();if(!r){t.emit("drain"),t._ended&&t._finish();return}t._processing=!0,t.emit("entry",r);var n=r;do{if((e=n._path||n.path)===t.root._path||e===t._path||e&&0===e.indexOf(t._path))return t._processing=!1,r._collected&&r.pipe(),t._process();n=n.parent}while(n);var s={parent:t,root:t.root||t,type:r.type,depth:t.depth+1};e=r._path||r.path||r.props.path,r.parent&&(e=e.substr(r.parent._path.length+1)),s.path=a.join(t.path,a.join("/",e)),s.filter=t.filter,Object.keys(r.props).forEach(function(e){s.hasOwnProperty(e)||(s[e]=r.props[e])});var o=t._currentChild=new i(s);o.on("ready",function(){r.pipe(o),r.resume()}),o.on("error",function(e){o._swallowErrors?(t.warn(e),o.emit("end"),o.emit("close")):t.emit("error",e)}),o.on("close",function(){l||(l=!0,t._currentChild=null,t._processing=!1,t._process())});var l=!1}}},13381:(e,t,r)=>{e.exports=l;var i=r(2720),n=r(76225),s=r(96184),a={EOF:!0},o={CLOSE:!0};function l(e){if(!(this instanceof l))throw Error("FileReader must be called as constructor.");if(!("Link"===e.type&&e.Link||"File"===e.type&&e.File))throw Error("Non-file type "+e.type);this._buffer=[],this._bytesEmitted=0,s.call(this,e)}n(l,s),l.prototype._getStream=function(){var e=this,t=e._stream=i.createReadStream(e._path,e.props);e.props.blksize&&(t.bufferSize=e.props.blksize),t.on("open",e.emit.bind(e,"open")),t.on("data",function(t){e._bytesEmitted+=t.length,t.length&&(e._paused||e._buffer.length?(e._buffer.push(t),e._read()):e.emit("data",t))}),t.on("end",function(){e._paused||e._buffer.length?(e._buffer.push(a),e._read()):e.emit("end"),e._bytesEmitted!==e.props.size&&e.error("Didn't get expected byte count\nexpect: "+e.props.size+"\nactual: "+e._bytesEmitted)}),t.on("close",function(){e._paused||e._buffer.length?(e._buffer.push(o),e._read()):e.emit("close")}),t.on("error",function(t){e.emit("error",t)}),e._read()},l.prototype._read=function(){if(!this._paused){if(!this._stream)return this._getStream();if(this._buffer.length){for(var e=this._buffer,t=0,r=e.length;t<r;t++){var i=e[t];if(i===a?this.emit("end"):i===o?this.emit("close"):this.emit("data",i),this._paused){this._buffer=e.slice(t);return}}this._buffer.length=0}}},l.prototype.pause=function(e){this._paused||(e=e||this,this._paused=!0,this._stream&&this._stream.pause(),this.emit("pause",e))},l.prototype.resume=function(e){this._paused&&(e=e||this,this.emit("resume",e),this._paused=!1,this._stream&&this._stream.resume(),this._read())}},87753:(e,t,r)=>{e.exports=o;var i=r(2720),n=r(99644),s=r(76225),a={};function o(e){if(!(this instanceof o))throw Error("FileWriter must be called as constructor.");if("File"!==e.type||!e.File)throw Error("Non-file type "+e.type);this._buffer=[],this._bytesWritten=0,n.call(this,e)}s(o,n),o.prototype._create=function(){var e=this;if(!e._stream){var t={};e.props.flags&&(t.flags=e.props.flags),t.mode=n.filemode,e._old&&e._old.blksize&&(t.bufferSize=e._old.blksize),e._stream=i.createWriteStream(e._path,t),e._stream.on("open",function(){e.ready=!0,e._buffer.forEach(function(t){t===a?e._stream.end():e._stream.write(t)}),e.emit("ready"),e.emit("drain")}),e._stream.on("error",function(t){e.emit("error",t)}),e._stream.on("drain",function(){e.emit("drain")}),e._stream.on("close",function(){e._finish()})}},o.prototype.write=function(e){if(this._bytesWritten+=e.length,!this.ready){if(!Buffer.isBuffer(e)&&"string"!=typeof e)throw Error("invalid write data");return this._buffer.push(e),!1}var t=this._stream.write(e);return!1===t&&this._stream._queue?this._stream._queue.length<=2:t},o.prototype.end=function(e){return(e&&this.write(e),this.ready)?this._stream.end():(this._buffer.push(a),!1)},o.prototype._finish=function(){"number"==typeof this.size&&this._bytesWritten!==this.size&&this.error("Did not get expected byte count.\nexpect: "+this.size+"\nactual: "+this._bytesWritten),n.prototype._finish.call(this)}},17240:e=>{e.exports=function(e){var t,r=["Directory","File","SymbolicLink","Link","BlockDevice","CharacterDevice","FIFO","Socket"];if(e.type&&-1!==r.indexOf(e.type))return e[e.type]=!0,e.type;for(var i=0,n=r.length;i<n;i++){var s=e[t=r[i]]||e["is"+t];if("function"==typeof s&&(s=s.call(e)),s)return e[t]=!0,e.type=t,t}return null}},38859:(e,t,r)=>{e.exports=a;var i=r(2720),n=r(76225),s=r(96184);function a(e){if(!(this instanceof a))throw Error("LinkReader must be called as constructor.");if(!("Link"===e.type&&e.Link||"SymbolicLink"===e.type&&e.SymbolicLink))throw Error("Non-link type "+e.type);s.call(this,e)}n(a,s),a.prototype._stat=function(e){var t=this;i.readlink(t._path,function(r,i){if(r)return t.error(r);t.linkpath=t.props.linkpath=i,t.emit("linkpath",i),s.prototype._stat.call(t,e)})},a.prototype._read=function(){this._paused||this._ended||(this.emit("end"),this.emit("close"),this._ended=!0)}},50267:(e,t,r)=>{e.exports=l;var i=r(2720),n=r(99644),s=r(76225),a=r(33873),o=r(44849);function l(e){if(!(this instanceof l))throw Error("LinkWriter must be called as constructor.");if(!("Link"===e.type&&e.Link||"SymbolicLink"===e.type&&e.SymbolicLink))throw Error("Non-link type "+e.type);""===e.linkpath&&(e.linkpath="."),e.linkpath||this.error("Need linkpath property to create "+e.type),n.call(this,e)}function u(e,t,r){o(e._path,function(n){if(n)return e.error(n);(function(e,t,r){i[r](t,e._path,function(t){if(t){if("ENOENT"!==t.code&&"EACCES"!==t.code&&"EPERM"!==t.code||"win32"!==process.platform)return e.error(t);e.ready=!0,e.emit("ready"),e.emit("end"),e.emit("close"),e.end=e._finish=function(){}}c(e)})})(e,t,r)})}function c(e){e.ready=!0,e.emit("ready"),e._ended&&!e._finished&&e._finish()}s(l,n),l.prototype._create=function(){var e=this,t="Link"===e.type||"win32"===process.platform,r=t?"link":"symlink",n=t?a.resolve(e.dirname,e.linkpath):e.linkpath;if(t)return u(e,n,r);i.readlink(e._path,function(t,i){if(i&&i===n)return c(e);u(e,n,r)})},l.prototype.end=function(){this._ended=!0,this.ready&&(this._finished=!0,this._finish())}},5931:(e,t,r)=>{e.exports=o;var i=r(96184),n=r(17240),s=r(76225),a=r(2720);function o(e){if(!(this instanceof o))throw Error("ProxyReader must be called as constructor.");this.props=e,this._buffer=[],this.ready=!1,i.call(this,e)}s(o,i),o.prototype._stat=function(){var e=this,t=e.props;a[t.follow?"stat":"lstat"](t.path,function(r,s){var a;t[a=r||!s?"File":n(s)]=!0,t.type=e.type=a,e._old=s,e._addProxy(i(t,s))})},o.prototype._addProxy=function(e){var t=this;if(t._proxyTarget)return t.error("proxy already set");t._proxyTarget=e,e._proxy=t,["error","data","end","close","linkpath","entry","entryEnd","child","childEnd","warn","stat"].forEach(function(r){e.on(r,t.emit.bind(t,r))}),t.emit("proxy",e),e.on("ready",function(){t.ready=!0,t.emit("ready")});var r=t._buffer;t._buffer.length=0,r.forEach(function(t){e[t[0]].apply(e,t[1])})},o.prototype.pause=function(){return!!this._proxyTarget&&this._proxyTarget.pause()},o.prototype.resume=function(){return!!this._proxyTarget&&this._proxyTarget.resume()}},95931:(e,t,r)=>{e.exports=l;var i=r(99644),n=r(17240),s=r(76225),a=r(95325),o=r(29021);function l(e){if(!(this instanceof l))throw Error("ProxyWriter must be called as constructor.");this.props=e,this._needDrain=!1,i.call(this,e)}s(l,i),l.prototype._stat=function(){var e=this,t=e.props;o[t.follow?"stat":"lstat"](t.path,function(r,s){var a;t[a=r||!s?"File":n(s)]=!0,t.type=e.type=a,e._old=s,e._addProxy(i(t,s))})},l.prototype._addProxy=function(e){var t=this;if(t._proxy)return t.error("proxy already set");t._proxy=e,["ready","error","close","pipe","drain","warn"].forEach(function(r){e.on(r,t.emit.bind(t,r))}),t.emit("proxy",e),t._buffer.forEach(function(t){e[t[0]].apply(e,t[1])}),t._buffer.length=0,t._needsDrain&&t.emit("drain")},l.prototype.add=function(e){return(a(e),this._proxy)?this._proxy.add(e):(this._buffer.push(["add",[e]]),this._needDrain=!0,!1)},l.prototype.write=function(e){return this._proxy?this._proxy.write(e):(this._buffer.push(["write",[e]]),this._needDrain=!0,!1)},l.prototype.end=function(e){return this._proxy?this._proxy.end(e):(this._buffer.push(["end",[e]]),!1)}},96184:(e,t,r)=>{e.exports=h;var i=r(2720),n=r(27910).Stream,s=r(76225),a=r(33873),o=r(17240),l=h.hardLinks={},u=r(31921);s(h,u);var c=r(38859);function h(e,t){var i,n;if(!(this instanceof h))return new h(e,t);switch("string"==typeof e&&(e={path:e}),e.type&&"function"==typeof e.type?n=i=e.type:(i=o(e),n=h),t&&!i&&(e[i=o(t)]=!0,e.type=i),i){case"Directory":n=r(62558);break;case"Link":case"File":n=r(13381);break;case"SymbolicLink":n=c;break;case"Socket":n=r(79300);break;case null:n=r(5931)}if(!(this instanceof n))return new n(e);u.call(this),e.path||this.error("Must provide a path",null,!0),this.readable=!0,this.writable=!1,this.type=i,this.props=e,this.depth=e.depth=e.depth||0,this.parent=e.parent||null,this.root=e.root||e.parent&&e.parent.root||this,this._path=this.path=a.resolve(e.path),"win32"===process.platform&&(this.path=this._path=this.path.replace(/\?/g,"_"),this._path.length>=260&&(this._swallowErrors=!0,this._path="\\\\?\\"+this.path.replace(/\//g,"\\"))),this.basename=e.basename=a.basename(this.path),this.dirname=e.dirname=a.dirname(this.path),e.parent=e.root=null,this.size=e.size,this.filter="function"==typeof e.filter?e.filter:null,"alpha"===e.sort&&(e.sort=d),this._stat(t)}function d(e,t){return e===t?0:e.toLowerCase()>t.toLowerCase()?1:e.toLowerCase()<t.toLowerCase()?-1:e>t?1:-1}h.prototype._stat=function(e){var t=this,r=t.props,n=r.follow?"stat":"lstat";function s(e,i){if(e)return t.error(e);if(Object.keys(i).forEach(function(e){r[e]=i[e]}),void 0!==t.size&&r.size!==t.size)return t.error("incorrect size");t.size=r.size;var n=o(r);if(!1!==r.hardlinks&&"Directory"!==n&&r.nlink&&r.nlink>1){var s=r.dev+":"+r.ino;l[s]!==t._path&&l[s]?(n=t.type=t.props.type="Link",t.Link=t.props.Link=!0,t.linkpath=t.props.linkpath=l[s],t._stat=t._read=c.prototype._read):l[s]=t._path}if(t.type&&t.type!==n&&t.error("Unexpected type: "+n),t.filter){var a=t._proxy||t;if(!t.filter.call(a,a,r)){t._disowned||(t.abort(),t.emit("end"),t.emit("close"));return}}var u=["_stat","stat","ready"],h=0;!function e(){if(t._aborted){t.emit("end"),t.emit("close");return}if(t._paused&&"Directory"!==t.type){t.once("resume",e);return}var i=u[h++];if(!i)return t._read();t.emit(i,r),e()}()}e?process.nextTick(s.bind(null,null,e)):i[n](t._path,s)},h.prototype.pipe=function(e){var t=this;return"function"==typeof e.add&&t.on("entry",function(r){!1===e.add(r)&&t.pause()}),n.prototype.pipe.apply(this,arguments)},h.prototype.pause=function(e){this._paused=!0,e=e||this,this.emit("pause",e),this._stream&&this._stream.pause(e)},h.prototype.resume=function(e){this._paused=!1,e=e||this,this.emit("resume",e),this._stream&&this._stream.resume(e),this._read()},h.prototype._read=function(){this.error("Cannot read unknown type: "+this.type)}},79300:(e,t,r)=>{e.exports=s;var i=r(76225),n=r(96184);function s(e){if(!(this instanceof s))throw Error("SocketReader must be called as constructor.");if(!("Socket"===e.type&&e.Socket))throw Error("Non-socket type "+e.type);n.call(this,e)}i(s,n),s.prototype._read=function(){this._paused||this._ended||(this.emit("end"),this.emit("close"),this._ended=!0)}},99644:(e,t,r)=>{e.exports=m;var i=r(2720),n=r(76225),s=r(44849),a=r(47734),o=r(33873),l="win32"===process.platform?0:process.umask(),u=r(17240),c=r(31921);n(m,c),m.dirmode=parseInt("0777",8)&~l,m.filemode=parseInt("0666",8)&~l;var h=r(30894),d=r(50267),p=r(87753),f=r(95931);function m(e,t){"string"==typeof e&&(e={path:e});var r=u(e),i=m;switch(r){case"Directory":i=h;break;case"File":i=p;break;case"Link":case"SymbolicLink":i=d;break;default:i=f}if(!(this instanceof i))return new i(e);c.call(this),e.path||this.error("Must provide a path",null,!0),this.type=e.type,this.props=e,this.depth=e.depth||0,this.clobber=!1!==e.clobber||e.clobber,this.parent=e.parent||null,this.root=e.root||e.parent&&e.parent.root||this,this._path=this.path=o.resolve(e.path),"win32"===process.platform&&(this.path=this._path=this.path.replace(/\?/g,"_"),this._path.length>=260&&(this._swallowErrors=!0,this._path="\\\\?\\"+this.path.replace(/\//g,"\\"))),this.basename=o.basename(e.path),this.dirname=o.dirname(e.path),this.linkpath=e.linkpath||null,e.parent=e.root=null,this.size=e.size,"string"==typeof e.mode&&(e.mode=parseInt(e.mode,8)),this.readable=!1,this.writable=!0,this._buffer=[],this.ready=!1,this.filter="function"==typeof e.filter?e.filter:null,this._stat(t)}function g(e){a(o.dirname(e._path),m.dirmode,function(t,r){return t?e.error(t):(e._madeDir=r,e._create())})}function y(e,t,r,n,s){var a=t.mode,o=t.follow||"SymbolicLink"!==e.type?"chmod":"lchmod";if(!i[o]||"number"!=typeof a)return s();var l=r.mode&parseInt("0777",8);if((a&=parseInt("0777",8))===l)return s();i[o](n,a,s)}function v(e,t,r,n,s){if("win32"===process.platform||!process.getuid||0!==process.getuid()||"number"!=typeof t.uid&&"number"!=typeof t.gid||r.uid===t.uid&&r.gid===t.gid)return s();var a=e.props.follow||"SymbolicLink"!==e.type?"chown":"lchown";if(!i[a])return s();"number"!=typeof t.uid&&(t.uid=r.uid),"number"!=typeof t.gid&&(t.gid=r.gid),i[a](n,t.uid,t.gid,s)}function b(e,t,r,n,s){if(!i.utimes||"win32"===process.platform)return s();var a=t.follow||"SymbolicLink"!==e.type?"utimes":"lutimes";if("lutimes"!==a||i[a]||(a="utimes"),!i[a])return s();var o=r.atime,l=r.mtime,u=t.atime,c=t.mtime;if(void 0===u&&(u=o),void 0===c&&(c=l),w(u)||(u=new Date(u)),w(c)||(u=new Date(c)),u.getTime()===o.getTime()&&c.getTime()===l.getTime())return s();i[a](n,u,c,s)}function w(e){return"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)}m.prototype._create=function(){var e=this;i[e.props.follow?"stat":"lstat"](e._path,function(t){if(t)return e.warn("Cannot create "+e._path+"\nUnsupported type: "+e.type,"ENOTSUP");e._finish()})},m.prototype._stat=function(e){var t=this,r=t.props.follow?"stat":"lstat",n=t._proxy||t;function a(e,r){if(t.filter&&!t.filter.call(n,n,r)){t._aborted=!0,t.emit("end"),t.emit("close");return}return e||!r?g(t):(t._old=r,u(r)!==t.type||"File"===t.type&&r.nlink>1)?s(t._path,function(e){if(e)return t.error(e);t._old=null,g(t)}):void g(t)}e?a(null,e):i[r](t._path,a)},m.prototype._finish=function(){var e=this;if(!e._finishing){e._finishing=!0;var t=0,r=null,n=!1;e._old?(e._old.atime=new Date(0),e._old.mtime=new Date(0),s(e._old)):i[e.props.follow?"stat":"lstat"](e._path,function(t,r){if(t)return"ENOENT"!==t.code||"Link"!==e.type&&"SymbolicLink"!==e.type||"win32"!==process.platform?e.error(t):(e.ready=!0,e.emit("ready"),e.emit("end"),e.emit("close"),void(e.end=e._finish=function(){}));s(e._old=r)})}function s(r){t+=3,y(e,e.props,r,e._path,a("chmod")),v(e,e.props,r,e._path,a("chown")),b(e,e.props,r,e._path,a("utimes"))}function a(s){return function(a){if(!r){if(a)return a.fstream_finish_call=s,e.error(r=a);if(!(--t>0)&&!n){if(n=!0,!e._madeDir)return l();(function e(t,r,n){var s=t._madeDir,a=o.dirname(r);(function(e,t,r){var n={};Object.keys(e.props).forEach(function(t){n[t]=e.props[t],"mode"===t&&"Directory"!==e.type&&(n[t]=n[t]|parseInt("0111",8))});var s=3,a=null;function o(e){if(!a){if(e)return r(a=e);if(0==--s)return r()}}i.stat(t,function(i,s){if(i)return r(a=i);y(e,n,s,t,o),v(e,n,s,t,o),b(e,n,s,t,o)})})(t,a,function(r){return r?n(r):a===s?n():void e(t,a,n)})})(e,e._path,l)}}function l(t){if(t)return t.fstream_finish_call="setupMadeDir",e.error(t);e.emit("end"),e.emit("close")}}}},m.prototype.pipe=function(){this.error("Can't pipe from writable stream")},m.prototype.add=function(){this.error("Can't add to non-Directory type")},m.prototype.write=function(){return!0}},968:(e,t,r)=>{function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.setopts=function(e,t,r){if(r||(r={}),r.matchBase&&-1===t.indexOf("/")){if(r.noglobstar)throw Error("base matching requires globstar");t="**/"+t}e.silent=!!r.silent,e.pattern=t,e.strict=!1!==r.strict,e.realpath=!!r.realpath,e.realpathCache=r.realpathCache||Object.create(null),e.follow=!!r.follow,e.dot=!!r.dot,e.mark=!!r.mark,e.nodir=!!r.nodir,e.nodir&&(e.mark=!0),e.sync=!!r.sync,e.nounique=!!r.nounique,e.nonull=!!r.nonull,e.nosort=!!r.nosort,e.nocase=!!r.nocase,e.stat=!!r.stat,e.noprocess=!!r.noprocess,e.absolute=!!r.absolute,e.fs=r.fs||n,e.maxLength=r.maxLength||1/0,e.cache=r.cache||Object.create(null),e.statCache=r.statCache||Object.create(null),e.symlinks=r.symlinks||Object.create(null),a=r,e.ignore=a.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]),e.ignore.length&&(e.ignore=e.ignore.map(c)),e.changedCwd=!1;var a,u=process.cwd();i(r,"cwd")?(e.cwd=s.resolve(r.cwd),e.changedCwd=e.cwd!==u):e.cwd=u,e.root=r.root||s.resolve(e.cwd,"/"),e.root=s.resolve(e.root),"win32"===process.platform&&(e.root=e.root.replace(/\\/g,"/")),e.cwdAbs=o(e.cwd)?e.cwd:h(e,e.cwd),"win32"===process.platform&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/")),e.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,r.allowWindowsEscape=!1,e.minimatch=new l(t,r),e.options=e.minimatch.options},t.ownProp=i,t.makeAbs=h,t.finish=function(e){for(var t=e.nounique,r=t?[]:Object.create(null),i=0,n=e.matches.length;i<n;i++){var s=e.matches[i];if(s&&0!==Object.keys(s).length){var a=Object.keys(s);t?r.push.apply(r,a):a.forEach(function(e){r[e]=!0})}else if(e.nonull){var o=e.minimatch.globSet[i];t?r.push(o):r[o]=!0}}if(t||(r=Object.keys(r)),e.nosort||(r=r.sort(u)),e.mark){for(var i=0;i<r.length;i++)r[i]=e._mark(r[i]);e.nodir&&(r=r.filter(function(t){var r=!/\/$/.test(t),i=e.cache[t]||e.cache[h(e,t)];return r&&i&&(r="DIR"!==i&&!Array.isArray(i)),r}))}e.ignore.length&&(r=r.filter(function(t){return!d(e,t)})),e.found=r},t.mark=function(e,t){var r=h(e,t),i=e.cache[r],n=t;if(i){var s="DIR"===i||Array.isArray(i),a="/"===t.slice(-1);if(s&&!a?n+="/":!s&&a&&(n=n.slice(0,-1)),n!==t){var o=h(e,n);e.statCache[o]=e.statCache[r],e.cache[o]=e.cache[r]}}return n},t.isIgnored=d,t.childrenIgnored=function(e,t){return!!e.ignore.length&&e.ignore.some(function(e){return!!(e.gmatcher&&e.gmatcher.match(t))})};var n=r(29021),s=r(33873),a=r(80747),o=r(89671),l=a.Minimatch;function u(e,t){return e.localeCompare(t,"en")}function c(e){var t=null;return"/**"===e.slice(-3)&&(t=new l(e.replace(/(\/\*\*)+$/,""),{dot:!0})),{matcher:new l(e,{dot:!0}),gmatcher:t}}function h(e,t){var r=t;return r="/"===t.charAt(0)?s.join(e.root,t):o(t)||""===t?t:e.changedCwd?s.resolve(e.cwd,t):s.resolve(t),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function d(e,t){return!!e.ignore.length&&e.ignore.some(function(e){return e.matcher.match(t)||!!(e.gmatcher&&e.gmatcher.match(t))})}},88939:(e,t,r)=>{e.exports=v;var i=r(55874),n=r(80747);n.Minimatch;var s=r(76225),a=r(94735).EventEmitter,o=r(33873),l=r(12412),u=r(89671),c=r(43582),h=r(968),d=h.setopts,p=h.ownProp,f=r(9473);r(28354);var m=h.childrenIgnored,g=h.isIgnored,y=r(15075);function v(e,t,r){if("function"==typeof t&&(r=t,t={}),t||(t={}),t.sync){if(r)throw TypeError("callback provided to sync glob");return c(e,t)}return new w(e,t,r)}v.sync=c;var b=v.GlobSync=c.GlobSync;function w(e,t,r){if("function"==typeof t&&(r=t,t=null),t&&t.sync){if(r)throw TypeError("callback provided to sync glob");return new b(e,t)}if(!(this instanceof w))return new w(e,t,r);d(this,e,t),this._didRealPath=!1;var i=this.minimatch.set.length;this.matches=Array(i),"function"==typeof r&&(r=y(r),this.on("error",r),this.on("end",function(e){r(null,e)}));var n=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===i)return o();for(var s=!0,a=0;a<i;a++)this._process(this.minimatch.set[a],a,!1,o);function o(){--n._processing,n._processing<=0&&(s?process.nextTick(function(){n._finish()}):n._finish())}s=!1}v.glob=v,v.hasMagic=function(e,t){var r=function(e,t){if(null===t||"object"!=typeof t)return e;for(var r=Object.keys(t),i=r.length;i--;)e[r[i]]=t[r[i]];return e}({},t);r.noprocess=!0;var i=new w(e,r).minimatch.set;if(!e)return!1;if(i.length>1)return!0;for(var n=0;n<i[0].length;n++)if("string"!=typeof i[0][n])return!0;return!1},v.Glob=w,s(w,a),w.prototype._finish=function(){if(l(this instanceof w),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();h.finish(this),this.emit("end",this.found)}},w.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,r=0;r<this.matches.length;r++)this._realpathSet(r,i)}function i(){0==--e&&t._finish()}},w.prototype._realpathSet=function(e,t){var r=this.matches[e];if(!r)return t();var n=Object.keys(r),s=this,a=n.length;if(0===a)return t();var o=this.matches[e]=Object.create(null);n.forEach(function(r,n){r=s._makeAbs(r),i.realpath(r,s.realpathCache,function(i,n){i?"stat"===i.syscall?o[r]=!0:s.emit("error",i):o[n]=!0,0==--a&&(s.matches[e]=o,t())})})},w.prototype._mark=function(e){return h.mark(this,e)},w.prototype._makeAbs=function(e){return h.makeAbs(this,e)},w.prototype.abort=function(){this.aborted=!0,this.emit("abort")},w.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},w.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var r=e[t];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var i=this._processQueue.slice(0);this._processQueue.length=0;for(var t=0;t<i.length;t++){var n=i[t];this._processing--,this._process(n[0],n[1],n[2],n[3])}}}},w.prototype._process=function(e,t,r,i){if(l(this instanceof w),l("function"==typeof i),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([e,t,r,i]);return}for(var s,a,o=0;"string"==typeof e[o];)o++;switch(o){case e.length:this._processSimple(e.join("/"),t,i);return;case 0:s=null;break;default:s=e.slice(0,o).join("/")}var c=e.slice(o);null===s?a=".":((u(s)||u(e.map(function(e){return"string"==typeof e?e:"[*]"}).join("/")))&&(!s||!u(s))&&(s="/"+s),a=s);var h=this._makeAbs(a);if(m(this,a))return i();c[0]===n.GLOBSTAR?this._processGlobStar(s,a,h,c,t,r,i):this._processReaddir(s,a,h,c,t,r,i)}},w.prototype._processReaddir=function(e,t,r,i,n,s,a){var o=this;this._readdir(r,s,function(l,u){return o._processReaddir2(e,t,r,i,n,s,u,a)})},w.prototype._processReaddir2=function(e,t,r,i,n,s,a,l){if(!a)return l();for(var u=i[0],c=!!this.minimatch.negate,h=u._glob,d=this.dot||"."===h.charAt(0),p=[],f=0;f<a.length;f++){var m=a[f];("."!==m.charAt(0)||d)&&(c&&!e?!m.match(u):m.match(u))&&p.push(m)}var g=p.length;if(0===g)return l();if(1===i.length&&!this.mark&&!this.stat){this.matches[n]||(this.matches[n]=Object.create(null));for(var f=0;f<g;f++){var m=p[f];e&&(m="/"!==e?e+"/"+m:e+m),"/"!==m.charAt(0)||this.nomount||(m=o.join(this.root,m)),this._emitMatch(n,m)}return l()}i.shift();for(var f=0;f<g;f++){var m=p[f];e&&(m="/"!==e?e+"/"+m:e+m),this._process([m].concat(i),n,s,l)}l()},w.prototype._emitMatch=function(e,t){if(!(this.aborted||g(this,t))){if(this.paused){this._emitQueue.push([e,t]);return}var r=u(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var i=this.cache[r];if("DIR"===i||Array.isArray(i))return}this.matches[e][t]=!0;var n=this.statCache[r];n&&this.emit("stat",t,n),this.emit("match",t)}}},w.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var r=this,i=f("lstat\0"+e,function(i,n){if(i&&"ENOENT"===i.code)return t();var s=n&&n.isSymbolicLink();r.symlinks[e]=s,s||!n||n.isDirectory()?r._readdir(e,!1,t):(r.cache[e]="FILE",t())});i&&r.fs.lstat(e,i)}},w.prototype._readdir=function(e,t,r){if(!this.aborted&&(r=f("readdir\0"+e+"\0"+t,r))){if(t&&!p(this.symlinks,e))return this._readdirInGlobStar(e,r);if(p(this.cache,e)){var i,n,s=this.cache[e];if(!s||"FILE"===s)return r();if(Array.isArray(s))return r(null,s)}this.fs.readdir(e,(i=this,n=r,function(t,r){t?i._readdirError(e,t,n):i._readdirEntries(e,r,n)}))}},w.prototype._readdirEntries=function(e,t,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var i=0;i<t.length;i++){var n=t[i];n="/"===e?e+n:e+"/"+n,this.cache[n]=!0}return this.cache[e]=t,r(null,t)}},w.prototype._readdirError=function(e,t,r){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var i=this._makeAbs(e);if(this.cache[i]="FILE",i===this.cwdAbs){var n=Error(t.code+" invalid cwd "+this.cwd);n.path=this.cwd,n.code=t.code,this.emit("error",n),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return r()}},w.prototype._processGlobStar=function(e,t,r,i,n,s,a){var o=this;this._readdir(r,s,function(l,u){o._processGlobStar2(e,t,r,i,n,s,u,a)})},w.prototype._processGlobStar2=function(e,t,r,i,n,s,a,o){if(!a)return o();var l=i.slice(1),u=e?[e]:[],c=u.concat(l);this._process(c,n,!1,o);var h=this.symlinks[r],d=a.length;if(h&&s)return o();for(var p=0;p<d;p++)if("."!==a[p].charAt(0)||this.dot){var f=u.concat(a[p],l);this._process(f,n,!0,o);var m=u.concat(a[p],i);this._process(m,n,!0,o)}o()},w.prototype._processSimple=function(e,t,r){var i=this;this._stat(e,function(n,s){i._processSimple2(e,t,n,s,r)})},w.prototype._processSimple2=function(e,t,r,i,n){if(this.matches[t]||(this.matches[t]=Object.create(null)),!i)return n();if(e&&u(e)&&!this.nomount){var s=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=o.join(this.root,e):(e=o.resolve(this.root,e),s&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),n()},w.prototype._stat=function(e,t){var r=this._makeAbs(e),i="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&p(this.cache,r)){var n=this.cache[r];if(Array.isArray(n)&&(n="DIR"),!i||"DIR"===n)return t(null,n);if(i&&"FILE"===n)return t()}var s=this.statCache[r];if(void 0!==s){if(!1===s)return t(null,s);var a=s.isDirectory()?"DIR":"FILE";return i&&"FILE"===a?t():t(null,a,s)}var o=this,l=f("stat\0"+r,function(i,n){if(n&&n.isSymbolicLink())return o.fs.stat(r,function(i,s){i?o._stat2(e,r,null,n,t):o._stat2(e,r,i,s,t)});o._stat2(e,r,i,n,t)});l&&o.fs.lstat(r,l)},w.prototype._stat2=function(e,t,r,i,n){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[t]=!1,n();var s="/"===e.slice(-1);if(this.statCache[t]=i,"/"===t.slice(-1)&&i&&!i.isDirectory())return n(null,!1,i);var a=!0;return(i&&(a=i.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||a,s&&"FILE"===a)?n():n(null,a,i)}},43582:(e,t,r)=>{e.exports=p,p.GlobSync=f;var i=r(55874),n=r(80747);n.Minimatch,r(88939).Glob,r(28354);var s=r(33873),a=r(12412),o=r(89671),l=r(968),u=l.setopts,c=l.ownProp,h=l.childrenIgnored,d=l.isIgnored;function p(e,t){if("function"==typeof t||3==arguments.length)throw TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new f(e,t).found}function f(e,t){if(!e)throw Error("must provide pattern");if("function"==typeof t||3==arguments.length)throw TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof f))return new f(e,t);if(u(this,e,t),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=Array(r);for(var i=0;i<r;i++)this._process(this.minimatch.set[i],i,!1);this._finish()}f.prototype._finish=function(){if(a.ok(this instanceof f),this.realpath){var e=this;this.matches.forEach(function(t,r){var n=e.matches[r]=Object.create(null);for(var s in t)try{s=e._makeAbs(s),n[i.realpathSync(s,e.realpathCache)]=!0}catch(t){if("stat"===t.syscall)n[e._makeAbs(s)]=!0;else throw t}})}l.finish(this)},f.prototype._process=function(e,t,r){a.ok(this instanceof f);for(var i,s,l=0;"string"==typeof e[l];)l++;switch(l){case e.length:this._processSimple(e.join("/"),t);return;case 0:i=null;break;default:i=e.slice(0,l).join("/")}var u=e.slice(l);null===i?s=".":((o(i)||o(e.map(function(e){return"string"==typeof e?e:"[*]"}).join("/")))&&(!i||!o(i))&&(i="/"+i),s=i);var c=this._makeAbs(s);h(this,s)||(u[0]===n.GLOBSTAR?this._processGlobStar(i,s,c,u,t,r):this._processReaddir(i,s,c,u,t,r))},f.prototype._processReaddir=function(e,t,r,i,n,a){var o=this._readdir(r,a);if(o){for(var l=i[0],u=!!this.minimatch.negate,c=l._glob,h=this.dot||"."===c.charAt(0),d=[],p=0;p<o.length;p++){var f=o[p];("."!==f.charAt(0)||h)&&(u&&!e?!f.match(l):f.match(l))&&d.push(f)}var m=d.length;if(0!==m){if(1===i.length&&!this.mark&&!this.stat){this.matches[n]||(this.matches[n]=Object.create(null));for(var p=0;p<m;p++){var f=d[p];e&&(f="/"!==e.slice(-1)?e+"/"+f:e+f),"/"!==f.charAt(0)||this.nomount||(f=s.join(this.root,f)),this._emitMatch(n,f)}return}i.shift();for(var p=0;p<m;p++){var g,f=d[p];g=e?[e,f]:[f],this._process(g.concat(i),n,a)}}}},f.prototype._emitMatch=function(e,t){if(!d(this,t)){var r=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var i=this.cache[r];if("DIR"===i||Array.isArray(i))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},f.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);try{r=this.fs.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var t,r,i=r&&r.isSymbolicLink();return this.symlinks[e]=i,i||!r||r.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},f.prototype._readdir=function(e,t){if(t&&!c(this.symlinks,e))return this._readdirInGlobStar(e);if(c(this.cache,e)){var r=this.cache[e];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(e,this.fs.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},f.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var i=t[r];i="/"===e?e+i:e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,t},f.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var i=Error(t.code+" invalid cwd "+this.cwd);throw i.path=this.cwd,i.code=t.code,i}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},f.prototype._processGlobStar=function(e,t,r,i,n,s){var a=this._readdir(r,s);if(a){var o=i.slice(1),l=e?[e]:[],u=l.concat(o);this._process(u,n,!1);var c=a.length;if(!this.symlinks[r]||!s){for(var h=0;h<c;h++)if("."!==a[h].charAt(0)||this.dot){var d=l.concat(a[h],o);this._process(d,n,!0);var p=l.concat(a[h],i);this._process(p,n,!0)}}}},f.prototype._processSimple=function(e,t){var r=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),r){if(e&&o(e)&&!this.nomount){var i=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=s.join(this.root,e):(e=s.resolve(this.root,e),i&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},f.prototype._stat=function(e){var t,r=this._makeAbs(e),i="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&c(this.cache,r)){var n=this.cache[r];if(Array.isArray(n)&&(n="DIR"),!i||"DIR"===n)return n;if(i&&"FILE"===n)return!1}var s=this.statCache[r];if(!s){try{t=this.fs.lstatSync(r)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[r]=!1,!1}if(t&&t.isSymbolicLink())try{s=this.fs.statSync(r)}catch(e){s=t}else s=t}this.statCache[r]=s;var n=!0;return s&&(n=s.isDirectory()?"DIR":"FILE"),this.cache[r]=this.cache[r]||n,(!i||"FILE"!==n)&&n},f.prototype._mark=function(e){return l.mark(this,e)},f.prototype._makeAbs=function(e){return l.makeAbs(this,e)}},84532:e=>{"use strict";e.exports=function(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Object)var r={__proto__:t(e)};else var r=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}),r};var t=Object.getPrototypeOf||function(e){return e.__proto__}},2720:(e,t,r)=>{var i,n,s,a=r(29021),o=r(22250),l=r(66410),u=r(84532),c=r(28354);function h(e,t){Object.defineProperty(e,i,{get:function(){return t}})}"function"==typeof Symbol&&"function"==typeof Symbol.for?(i=Symbol.for("graceful-fs.queue"),n=Symbol.for("graceful-fs.previous")):(i="___graceful-fs.queue",n="___graceful-fs.previous");var d=function(){};function p(e){o(e),e.gracefulify=p,e.createReadStream=function(t,r){return new e.ReadStream(t,r)},e.createWriteStream=function(t,r){return new e.WriteStream(t,r)};var t=e.readFile;e.readFile=function(e,r,i){return"function"==typeof r&&(i=r,r=null),function e(r,i,n,s){return t(r,i,function(t){t&&("EMFILE"===t.code||"ENFILE"===t.code)?f([e,[r,i,n],t,s||Date.now(),Date.now()]):"function"==typeof n&&n.apply(this,arguments)})}(e,r,i)};var r=e.writeFile;e.writeFile=function(e,t,i,n){return"function"==typeof i&&(n=i,i=null),function e(t,i,n,s,a){return r(t,i,n,function(r){r&&("EMFILE"===r.code||"ENFILE"===r.code)?f([e,[t,i,n,s],r,a||Date.now(),Date.now()]):"function"==typeof s&&s.apply(this,arguments)})}(e,t,i,n)};var i=e.appendFile;i&&(e.appendFile=function(e,t,r,n){return"function"==typeof r&&(n=r,r=null),function e(t,r,n,s,a){return i(t,r,n,function(i){i&&("EMFILE"===i.code||"ENFILE"===i.code)?f([e,[t,r,n,s],i,a||Date.now(),Date.now()]):"function"==typeof s&&s.apply(this,arguments)})}(e,t,r,n)});var n=e.copyFile;n&&(e.copyFile=function(e,t,r,i){return"function"==typeof r&&(i=r,r=0),function e(t,r,i,s,a){return n(t,r,i,function(n){n&&("EMFILE"===n.code||"ENFILE"===n.code)?f([e,[t,r,i,s],n,a||Date.now(),Date.now()]):"function"==typeof s&&s.apply(this,arguments)})}(e,t,r,i)});var s=e.readdir;e.readdir=function(e,t,r){"function"==typeof t&&(r=t,t=null);var i=a.test(process.version)?function(e,t,r,i){return s(e,n(e,t,r,i))}:function(e,t,r,i){return s(e,t,n(e,t,r,i))};return i(e,t,r);function n(e,t,r,n){return function(s,a){s&&("EMFILE"===s.code||"ENFILE"===s.code)?f([i,[e,t,r],s,n||Date.now(),Date.now()]):(a&&a.sort&&a.sort(),"function"==typeof r&&r.call(this,s,a))}}};var a=/^v[0-5]\./;if("v0.8"===process.version.substr(0,4)){var u=l(e);g=u.ReadStream,y=u.WriteStream}var c=e.ReadStream;c&&(g.prototype=Object.create(c.prototype),g.prototype.open=function(){var e=this;b(e.path,e.flags,e.mode,function(t,r){t?(e.autoClose&&e.destroy(),e.emit("error",t)):(e.fd=r,e.emit("open",r),e.read())})});var h=e.WriteStream;h&&(y.prototype=Object.create(h.prototype),y.prototype.open=function(){var e=this;b(e.path,e.flags,e.mode,function(t,r){t?(e.destroy(),e.emit("error",t)):(e.fd=r,e.emit("open",r))})}),Object.defineProperty(e,"ReadStream",{get:function(){return g},set:function(e){g=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return y},set:function(e){y=e},enumerable:!0,configurable:!0});var d=g;Object.defineProperty(e,"FileReadStream",{get:function(){return d},set:function(e){d=e},enumerable:!0,configurable:!0});var m=y;function g(e,t){return this instanceof g?(c.apply(this,arguments),this):g.apply(Object.create(g.prototype),arguments)}function y(e,t){return this instanceof y?(h.apply(this,arguments),this):y.apply(Object.create(y.prototype),arguments)}Object.defineProperty(e,"FileWriteStream",{get:function(){return m},set:function(e){m=e},enumerable:!0,configurable:!0});var v=e.open;function b(e,t,r,i){return"function"==typeof r&&(i=r,r=null),function e(t,r,i,n,s){return v(t,r,i,function(a,o){a&&("EMFILE"===a.code||"ENFILE"===a.code)?f([e,[t,r,i,n],a,s||Date.now(),Date.now()]):"function"==typeof n&&n.apply(this,arguments)})}(e,t,r,i)}return e.open=b,e}function f(e){d("ENQUEUE",e[0].name,e[1]),a[i].push(e),g()}function m(){for(var e=Date.now(),t=0;t<a[i].length;++t)a[i][t].length>2&&(a[i][t][3]=e,a[i][t][4]=e);g()}function g(){if(clearTimeout(s),s=void 0,0!==a[i].length){var e=a[i].shift(),t=e[0],r=e[1],n=e[2],o=e[3],l=e[4];if(void 0===o)d("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-o>=6e4){d("TIMEOUT",t.name,r);var u=r.pop();"function"==typeof u&&u.call(null,n)}else Date.now()-l>=Math.min(1.2*Math.max(l-o,1),100)?(d("RETRY",t.name,r),t.apply(null,r.concat([o]))):a[i].push(e);void 0===s&&(s=setTimeout(g,0))}}c.debuglog?d=c.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(d=function(){var e=c.format.apply(c,arguments);console.error(e="GFS4: "+e.split(/\n/).join("\nGFS4: "))}),!a[i]&&(h(a,global[i]||[]),a.close=function(e){function t(t,r){return e.call(a,t,function(e){e||m(),"function"==typeof r&&r.apply(this,arguments)})}return Object.defineProperty(t,n,{value:e}),t}(a.close),a.closeSync=function(e){function t(t){e.apply(a,arguments),m()}return Object.defineProperty(t,n,{value:e}),t}(a.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){d(a[i]),r(12412).equal(a[i].length,0)})),global[i]||h(global,a[i]),e.exports=p(u(a)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!a.__patched&&(e.exports=p(a),a.__patched=!0)},66410:(e,t,r)=>{var i=r(27910).Stream;e.exports=function(e){return{ReadStream:function t(r,n){if(!(this instanceof t))return new t(r,n);i.call(this);var s=this;this.path=r,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536;for(var a=Object.keys(n=n||{}),o=0,l=a.length;o<l;o++){var u=a[o];this[u]=n[u]}if(this.encoding&&this.setEncoding(this.encoding),void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw Error("start must be <= end");this.pos=this.start}if(null!==this.fd){process.nextTick(function(){s._read()});return}e.open(this.path,this.flags,this.mode,function(e,t){if(e){s.emit("error",e),s.readable=!1;return}s.fd=t,s.emit("open",t),s._read()})},WriteStream:function t(r,n){if(!(this instanceof t))return new t(r,n);i.call(this),this.path=r,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0;for(var s=Object.keys(n=n||{}),a=0,o=s.length;a<o;a++){var l=s[a];this[l]=n[l]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}}},22250:(e,t,r)=>{var i=r(81115),n=process.cwd,s=null,a=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return s||(s=n.call(process)),s};try{process.cwd()}catch(e){}if("function"==typeof process.chdir){var o=process.chdir;process.chdir=function(e){s=null,o.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,o)}e.exports=function(e){var t;function r(t){return t?function(r,i,n){return t.call(e,r,i,function(e){c(e)&&(e=null),n&&n.apply(this,arguments)})}:t}function n(t){return t?function(r,i){try{return t.call(e,r,i)}catch(e){if(!c(e))throw e}}:t}function s(t){return t?function(r,i,n,s){return t.call(e,r,i,n,function(e){c(e)&&(e=null),s&&s.apply(this,arguments)})}:t}function o(t){return t?function(r,i,n){try{return t.call(e,r,i,n)}catch(e){if(!c(e))throw e}}:t}function l(t){return t?function(r,i,n){function s(e,t){t&&(t.uid<0&&(t.uid+=0x100000000),t.gid<0&&(t.gid+=0x100000000)),n&&n.apply(this,arguments)}return"function"==typeof i&&(n=i,i=null),i?t.call(e,r,i,s):t.call(e,r,s)}:t}function u(t){return t?function(r,i){var n=i?t.call(e,r,i):t.call(e,r);return n&&(n.uid<0&&(n.uid+=0x100000000),n.gid<0&&(n.gid+=0x100000000)),n}:t}function c(e){return!e||"ENOSYS"===e.code||(!process.getuid||0!==process.getuid())&&("EINVAL"===e.code||"EPERM"===e.code)}i.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&(e.lchmod=function(t,r,n){e.open(t,i.O_WRONLY|i.O_SYMLINK,r,function(t,i){if(t){n&&n(t);return}e.fchmod(i,r,function(t){e.close(i,function(e){n&&n(t||e)})})})},e.lchmodSync=function(t,r){var n,s=e.openSync(t,i.O_WRONLY|i.O_SYMLINK,r),a=!0;try{n=e.fchmodSync(s,r),a=!1}finally{if(a)try{e.closeSync(s)}catch(e){}else e.closeSync(s)}return n}),e.lutimes||(i.hasOwnProperty("O_SYMLINK")&&e.futimes?(e.lutimes=function(t,r,n,s){e.open(t,i.O_SYMLINK,function(t,i){if(t){s&&s(t);return}e.futimes(i,r,n,function(t){e.close(i,function(e){s&&s(t||e)})})})},e.lutimesSync=function(t,r,n){var s,a=e.openSync(t,i.O_SYMLINK),o=!0;try{s=e.futimesSync(a,r,n),o=!1}finally{if(o)try{e.closeSync(a)}catch(e){}else e.closeSync(a)}return s}):e.futimes&&(e.lutimes=function(e,t,r,i){i&&process.nextTick(i)},e.lutimesSync=function(){})),e.chown=s(e.chown),e.fchown=s(e.fchown),e.lchown=s(e.lchown),e.chmod=r(e.chmod),e.fchmod=r(e.fchmod),e.lchmod=r(e.lchmod),e.chownSync=o(e.chownSync),e.fchownSync=o(e.fchownSync),e.lchownSync=o(e.lchownSync),e.chmodSync=n(e.chmodSync),e.fchmodSync=n(e.fchmodSync),e.lchmodSync=n(e.lchmodSync),e.stat=l(e.stat),e.fstat=l(e.fstat),e.lstat=l(e.lstat),e.statSync=u(e.statSync),e.fstatSync=u(e.fstatSync),e.lstatSync=u(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(e,t,r){r&&process.nextTick(r)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(e,t,r,i){i&&process.nextTick(i)},e.lchownSync=function(){}),"win32"===a&&(e.rename="function"!=typeof e.rename?e.rename:function(t){function r(r,i,n){var s=Date.now(),a=0;t(r,i,function o(l){if(l&&("EACCES"===l.code||"EPERM"===l.code||"EBUSY"===l.code)&&Date.now()-s<6e4){setTimeout(function(){e.stat(i,function(e,s){e&&"ENOENT"===e.code?t(r,i,o):n(l)})},a),a<100&&(a+=10);return}n&&n(l)})}return Object.setPrototypeOf&&Object.setPrototypeOf(r,t),r}(e.rename)),e.read="function"!=typeof e.read?e.read:function(t){function r(r,i,n,s,a,o){var l;if(o&&"function"==typeof o){var u=0;l=function(c,h,d){if(c&&"EAGAIN"===c.code&&u<10)return u++,t.call(e,r,i,n,s,a,l);o.apply(this,arguments)}}return t.call(e,r,i,n,s,a,l)}return Object.setPrototypeOf&&Object.setPrototypeOf(r,t),r}(e.read),e.readSync="function"!=typeof e.readSync?e.readSync:(t=e.readSync,function(r,i,n,s,a){for(var o=0;;)try{return t.call(e,r,i,n,s,a)}catch(e){if("EAGAIN"===e.code&&o<10){o++;continue}throw e}})}},42756:e=>{"use strict";global.MutationObserver||global.WebKitMutationObserver,t=function(){process.nextTick(n)};var t,r,i=[];function n(){r=!0;for(var e,t,n=i.length;n;){for(t=i,i=[],e=-1;++e<n;)t[e]();n=i.length}r=!1}e.exports=function(e){1!==i.push(e)||r||t()}},9473:(e,t,r)=>{var i=r(57083),n=Object.create(null),s=r(15075);e.exports=i(function(e,t){return n[e]?(n[e].push(t),null):(n[e]=[t],s(function t(){var r=n[e],i=r.length,s=function(e){for(var t=e.length,r=[],i=0;i<t;i++)r[i]=e[i];return r}(arguments);try{for(var a=0;a<i;a++)r[a].apply(null,s)}finally{r.length>i?(r.splice(0,i),process.nextTick(function(){t.apply(null,s)})):delete n[e]}}))})},76225:(e,t,r)=>{try{var i=r(28354);if("function"!=typeof i.inherits)throw"";e.exports=i.inherits}catch(t){e.exports=r(6182)}},6182:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},7268:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},72279:(e,t,r)=>{"use strict";var i=r(76807),n=r(68441),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(e){for(var t,r,n,a,o,l,u,c=[],h=0,d=e.length,p=d,f="string"!==i.getTypeOf(e);h<e.length;)p=d-h,f?(t=e[h++],r=h<d?e[h++]:0,n=h<d?e[h++]:0):(t=e.charCodeAt(h++),r=h<d?e.charCodeAt(h++):0,n=h<d?e.charCodeAt(h++):0),a=t>>2,o=(3&t)<<4|r>>4,l=p>1?(15&r)<<2|n>>6:64,u=p>2?63&n:64,c.push(s.charAt(a)+s.charAt(o)+s.charAt(l)+s.charAt(u));return c.join("")},t.decode=function(e){var t,r,i,a,o,l,u,c,h=0,d=0,p="data:";if(e.substr(0,p.length)===p)throw Error("Invalid base64 input, it looks like a data url.");var f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===s.charAt(64)&&f--,e.charAt(e.length-2)===s.charAt(64)&&f--,f%1!=0)throw Error("Invalid base64 input, bad content length.");for(c=n.uint8array?new Uint8Array(0|f):Array(0|f);h<e.length;)a=s.indexOf(e.charAt(h++)),o=s.indexOf(e.charAt(h++)),l=s.indexOf(e.charAt(h++)),u=s.indexOf(e.charAt(h++)),t=a<<2|o>>4,r=(15&o)<<4|l>>2,i=(3&l)<<6|u,c[d++]=t,64!==l&&(c[d++]=r),64!==u&&(c[d++]=i);return c}},56378:(e,t,r)=>{"use strict";var i=r(47907),n=r(17765),s=r(74100),a=r(43685);function o(e,t,r,i,n){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=i,this.compressedContent=n}o.prototype={getContentWorker:function(){var e=new n(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new n(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,r){return e.pipe(new s).pipe(new a("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},e.exports=o},24051:(e,t,r)=>{"use strict";var i=r(50656);t.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},t.DEFLATE=r(92232)},80821:(e,t,r)=>{"use strict";var i=r(76807),n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?0xedb88320^e>>>1:e>>>1;t[r]=e}return t}();e.exports=function(e,t){return void 0!==e&&e.length?"string"!==i.getTypeOf(e)?function(e,t,r,i){var s=0+r;e^=-1;for(var a=0;a<s;a++)e=e>>>8^n[(e^t[a])&255];return -1^e}(0|t,e,e.length,0):function(e,t,r,i){var s=0+r;e^=-1;for(var a=0;a<s;a++)e=e>>>8^n[(e^t.charCodeAt(a))&255];return -1^e}(0|t,e,e.length,0):0}},34906:(e,t)=>{"use strict";t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!0,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},47907:(e,t,r)=>{"use strict";var i=null;i="undefined"!=typeof Promise?Promise:r(78275),e.exports={Promise:i}},92232:(e,t,r)=>{"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=r(74848),s=r(76807),a=r(50656),o=i?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}t.magic="\b\0",s.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(o,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},t.compressWorker=function(e){return new l("Deflate",e)},t.uncompressWorker=function(){return new l("Inflate",{})}},65819:(e,t,r)=>{"use strict";var i=r(76807),n=r(50656),s=r(79983),a=r(80821),o=r(56964),l=function(e,t){var r,i="";for(r=0;r<t;r++)i+=String.fromCharCode(255&e),e>>>=8;return i},u=function(e,t){var r=e;return e||(r=t?16893:33204),(65535&r)<<16},c=function(e,t,r,n,c,h){var d,p,f=e.file,m=e.compression,g=h!==s.utf8encode,y=i.transformTo("string",h(f.name)),v=i.transformTo("string",s.utf8encode(f.name)),b=f.comment,w=i.transformTo("string",h(b)),x=i.transformTo("string",s.utf8encode(b)),S=v.length!==f.name.length,E=x.length!==b.length,T="",k="",O="",C=f.dir,A=f.date,N={crc32:0,compressedSize:0,uncompressedSize:0};(!t||r)&&(N.crc32=e.crc32,N.compressedSize=e.compressedSize,N.uncompressedSize=e.uncompressedSize);var R=0;t&&(R|=8),!g&&(S||E)&&(R|=2048);var I=0,P=0;(C&&(I|=16),"UNIX"===c)?(P=798,I|=u(f.unixPermissions,C)):(P=20,I|=63&(f.dosPermissions||0)),d=(A.getUTCHours()<<6|A.getUTCMinutes())<<5|A.getUTCSeconds()/2,p=(A.getUTCFullYear()-1980<<4|A.getUTCMonth()+1)<<5|A.getUTCDate(),S&&(k=l(1,1)+l(a(y),4)+v,T+="up"+l(k.length,2)+k),E&&(O=l(1,1)+l(a(w),4)+x,T+="uc"+l(O.length,2)+O);var j="";return j+="\n\0",j+=l(R,2),j+=m.magic,j+=l(d,2),j+=l(p,2),j+=l(N.crc32,4),j+=l(N.compressedSize,4),j+=l(N.uncompressedSize,4),j+=l(y.length,2),j+=l(T.length,2),{fileRecord:o.LOCAL_FILE_HEADER+j+y+T,dirRecord:o.CENTRAL_FILE_HEADER+l(P,2)+j+l(w.length,2)+"\0\0\0\0"+l(I,4)+l(n,4)+y+T+w}},h=function(e,t,r,n,s){var a=i.transformTo("string",s(n));return o.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(e,2)+l(e,2)+l(t,4)+l(r,4)+l(a.length,2)+a};function d(e,t,r,i){n.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(d,n),d.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,n.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-i-1))/r:100}}))},d.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=c(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(e){this.accumulate=!1;var t,r=this.streamFiles&&!e.file.dir,i=c(e,r,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(i.dirRecord),r){this.push({data:(t=e,o.DATA_DESCRIPTOR+l(t.crc32,4)+l(t.compressedSize,4)+l(t.uncompressedSize,4)),meta:{percent:100}})}else for(this.push({data:i.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,i=h(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},d.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(e){var t=this._sources;if(!n.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},d.prototype.lock=function(){n.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},e.exports=d},91356:(e,t,r)=>{"use strict";var i=r(24051),n=r(65819),s=function(e,t){var r=e||t,n=i[r];if(!n)throw Error(r+" is not a valid compression method !");return n};t.generateWorker=function(e,t,r){var i=new n(t.streamFiles,r,t.platform,t.encodeFileName),a=0;try{e.forEach(function(e,r){a++;var n=s(r.options.compression,t.compression),o=r.options.compressionOptions||t.compressionOptions||{},l=r.dir,u=r.date;r._compressWorker(n,o).withStreamInfo("file",{name:e,dir:l,date:u,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(i)}),i.entriesCount=a}catch(e){i.error(e)}return i}},65886:(e,t,r)=>{"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}i.prototype=r(25691),i.prototype.loadAsync=r(44088),i.support=r(68441),i.defaults=r(34906),i.version="3.10.1",i.loadAsync=function(e,t){return new i().loadAsync(e,t)},i.external=r(47907),e.exports=i},44088:(e,t,r)=>{"use strict";var i=r(76807),n=r(47907),s=r(79983),a=r(66197),o=r(74100),l=r(59322);e.exports=function(e,t){var r=this;return(t=i.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),l.isNode&&l.isStream(e))?n.Promise.reject(Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var r=new a(t);return r.load(e),r}).then(function(e){var r=[n.Promise.resolve(e)],i=e.files;if(t.checkCRC32)for(var s=0;s<i.length;s++)r.push(function(e){return new n.Promise(function(t,r){var i=e.decompressed.getContentWorker().pipe(new o);i.on("error",function(e){r(e)}).on("end",function(){i.streamInfo.crc32!==e.decompressed.crc32?r(Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}(i[s]));return n.Promise.all(r)}).then(function(e){for(var n=e.shift(),s=n.files,a=0;a<s.length;a++){var o=s[a],l=o.fileNameStr,u=i.resolve(o.fileNameStr);r.file(u,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders}),o.dir||(r.file(u).unsafeOriginalName=l)}return n.zipComment.length&&(r.comment=n.zipComment),r})}},62682:(e,t,r)=>{"use strict";var i=r(76807),n=r(50656);function s(e,t){n.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}i.inherits(s,n),s.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=s},49261:(e,t,r)=>{"use strict";var i=r(32662).Readable;function n(e,t,r){i.call(this,t),this._helper=e;var n=this;e.on("data",function(e,t){n.push(e)||n._helper.pause(),r&&r(t)}).on("error",function(e){n.emit("error",e)}).on("end",function(){n.push(null)})}r(76807).inherits(n,i),n.prototype._read=function(){this._helper.resume()},e.exports=n},59322:e=>{"use strict";e.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},25691:(e,t,r)=>{"use strict";var i=r(79983),n=r(76807),s=r(50656),a=r(44079),o=r(34906),l=r(56378),u=r(28382),c=r(91356),h=r(59322),d=r(62682),p=function(e,t,r){var i,a=n.getTypeOf(t),c=n.extend(r||{},o);c.date=c.date||new Date,null!==c.compression&&(c.compression=c.compression.toUpperCase()),"string"==typeof c.unixPermissions&&(c.unixPermissions=parseInt(c.unixPermissions,8)),c.unixPermissions&&16384&c.unixPermissions&&(c.dir=!0),c.dosPermissions&&16&c.dosPermissions&&(c.dir=!0),c.dir&&(e=m(e)),c.createFolders&&(i=f(e))&&g.call(this,i,!0);var p="string"===a&&!1===c.binary&&!1===c.base64;r&&void 0!==r.binary||(c.binary=!p),(t instanceof l&&0===t.uncompressedSize||c.dir||!t||0===t.length)&&(c.base64=!1,c.binary=!0,t="",c.compression="STORE",a="string");var y=null;y=t instanceof l||t instanceof s?t:h.isNode&&h.isStream(t)?new d(e,t):n.prepareContent(e,t,c.binary,c.optimizedBinaryString,c.base64);var v=new u(e,y,c);this.files[e]=v},f=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:o.createFolders,e=m(e),this.files[e]||p.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function y(e){return"[object RegExp]"===Object.prototype.toString.call(e)}e.exports={load:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,i;for(t in this.files)i=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,i)},filter:function(e){var t=[];return this.forEach(function(r,i){e(r,i)&&t.push(i)}),t},file:function(e,t,r){if(1==arguments.length){if(y(e)){var i=e;return this.filter(function(e,t){return!t.dir&&i.test(e)})}var n=this.files[this.root+e];return n&&!n.dir?n:null}return e=this.root+e,p.call(this,e,t,r),this},folder:function(e){if(!e)return this;if(y(e))return this.filter(function(t,r){return r.dir&&e.test(t)});var t=this.root+e,r=g.call(this,t),i=this.clone();return i.root=r.name,i},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter(function(t,r){return r.name.slice(0,e.length)===e}),i=0;i<r.length;i++)delete this.files[r[i].name];return this},generate:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=n.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw Error("No output type specified.");n.checkSupport(r.type),("darwin"===r.platform||"freebsd"===r.platform||"linux"===r.platform||"sunos"===r.platform)&&(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var o=r.comment||this.comment||"";t=c.generateWorker(this,r,o)}catch(e){(t=new s("error")).error(e)}return new a(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}}},44746:(e,t,r)=>{"use strict";var i=r(30333);function n(e){i.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}r(76807).inherits(n,i),n.prototype.byteAt=function(e){return this.data[this.zero+e]},n.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),i=e.charCodeAt(2),n=e.charCodeAt(3),s=this.length-4;s>=0;--s)if(this.data[s]===t&&this.data[s+1]===r&&this.data[s+2]===i&&this.data[s+3]===n)return s-this.zero;return -1},n.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),i=e.charCodeAt(2),n=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&r===s[1]&&i===s[2]&&n===s[3]},n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=n},30333:(e,t,r)=>{"use strict";var i=r(76807);function n(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return i.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},e.exports=n},97651:(e,t,r)=>{"use strict";var i=r(11980);function n(e){i.call(this,e)}r(76807).inherits(n,i),n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=n},27172:(e,t,r)=>{"use strict";var i=r(30333);function n(e){i.call(this,e)}r(76807).inherits(n,i),n.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},n.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},n.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=n},11980:(e,t,r)=>{"use strict";var i=r(44746);function n(e){i.call(this,e)}r(76807).inherits(n,i),n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=n},7166:(e,t,r)=>{"use strict";var i=r(76807),n=r(68441),s=r(44746),a=r(27172),o=r(97651),l=r(11980);e.exports=function(e){var t=i.getTypeOf(e);return(i.checkSupport(t),"string"!==t||n.uint8array)?"nodebuffer"===t?new o(e):n.uint8array?new l(i.transformTo("uint8array",e)):new s(i.transformTo("array",e)):new a(e)}},56964:(e,t)=>{"use strict";t.LOCAL_FILE_HEADER="PK\x03\x04",t.CENTRAL_FILE_HEADER="PK\x01\x02",t.CENTRAL_DIRECTORY_END="PK\x05\x06",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",t.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",t.DATA_DESCRIPTOR="PK\x07\b"},89158:(e,t,r)=>{"use strict";var i=r(50656),n=r(76807);function s(e){i.call(this,"ConvertWorker to "+e),this.destType=e}n.inherits(s,i),s.prototype.processChunk=function(e){this.push({data:n.transformTo(this.destType,e.data),meta:e.meta})},e.exports=s},74100:(e,t,r)=>{"use strict";var i=r(50656),n=r(80821);function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r(76807).inherits(s,i),s.prototype.processChunk=function(e){this.streamInfo.crc32=n(e.data,this.streamInfo.crc32||0),this.push(e)},e.exports=s},43685:(e,t,r)=>{"use strict";var i=r(76807),n=r(50656);function s(e){n.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}i.inherits(s,n),s.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}n.prototype.processChunk.call(this,e)},e.exports=s},17765:(e,t,r)=>{"use strict";var i=r(76807),n=r(50656);function s(e){n.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=i.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}i.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=s},50656:e=>{"use strict";function t(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}t.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},e.exports=t},44079:(e,t,r)=>{"use strict";var i=r(76807),n=r(89158),s=r(50656),a=r(72279),o=r(68441),l=r(47907),u=null;if(o.nodestream)try{u=r(49261)}catch(e){}function c(e,t,r){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=r,i.checkSupport(a),this._worker=e.pipe(new n(a)),e.lock()}catch(e){this._worker=new s("error"),this._worker.error(e)}}c.prototype={accumulate:function(e){var t;return t=this,new l.Promise(function(r,n){var s=[],o=t._internalType,l=t._outputType,u=t._mimeType;t.on("data",function(t,r){s.push(t),e&&e(r)}).on("error",function(e){s=[],n(e)}).on("end",function(){try{var e=function(e,t,r){switch(e){case"blob":return i.newBlob(i.transformTo("arraybuffer",t),r);case"base64":return a.encode(t);default:return i.transformTo(e,t)}}(l,function(e,t){var r,i=0,n=null,s=0;for(r=0;r<t.length;r++)s+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(r=0,n=new Uint8Array(s);r<t.length;r++)n.set(t[r],i),i+=t[r].length;return n;case"nodebuffer":return Buffer.concat(t);default:throw Error("concat : unsupported type '"+e+"'")}}(o,s),u);r(e)}catch(e){n(e)}s=[]}).resume()})},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,function(e){t.call(r,e.data,e.meta)}):this._worker.on(e,function(){i.delay(t,arguments,r)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},e.exports=c},68441:(e,t,r)=>{"use strict";if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,t.nodebuffer="undefined"!=typeof Buffer,t.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)t.blob=!1;else{var i=new ArrayBuffer(0);try{t.blob=0===new Blob([i],{type:"application/zip"}).size}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(i),t.blob=0===n.getBlob("application/zip").size}catch(e){t.blob=!1}}}try{t.nodestream=!!r(32662).Readable}catch(e){t.nodestream=!1}},79983:(e,t,r)=>{"use strict";for(var i=r(76807),n=r(68441),s=r(59322),a=r(50656),o=Array(256),l=0;l<256;l++)o[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;o[254]=o[254]=1;var u=function(e){var t,r,i,s,a,o=e.length,l=0;for(s=0;s<o;s++)(64512&(r=e.charCodeAt(s)))==55296&&s+1<o&&(64512&(i=e.charCodeAt(s+1)))==56320&&(r=65536+(r-55296<<10)+(i-56320),s++),l+=r<128?1:r<2048?2:r<65536?3:4;for(a=0,t=n.uint8array?new Uint8Array(l):Array(l),s=0;a<l;s++)(64512&(r=e.charCodeAt(s)))==55296&&s+1<o&&(64512&(i=e.charCodeAt(s+1)))==56320&&(r=65536+(r-55296<<10)+(i-56320),s++),r<128?t[a++]=r:(r<2048?t[a++]=192|r>>>6:(r<65536?t[a++]=224|r>>>12:(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63),t[a++]=128|r>>>6&63),t[a++]=128|63&r);return t},c=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&(192&e[r])==128;)r--;return r<0||0===r?t:r+o[e[r]]>t?r:t},h=function(e){var t,r,n,s,a=e.length,l=Array(2*a);for(r=0,t=0;t<a;){if((n=e[t++])<128){l[r++]=n;continue}if((s=o[n])>4){l[r++]=65533,t+=s-1;continue}for(n&=2===s?31:3===s?15:7;s>1&&t<a;)n=n<<6|63&e[t++],s--;if(s>1){l[r++]=65533;continue}n<65536?l[r++]=n:(n-=65536,l[r++]=55296|n>>10&1023,l[r++]=56320|1023&n)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),i.applyFromCharCode(l)};function d(){a.call(this,"utf-8 decode"),this.leftOver=null}function p(){a.call(this,"utf-8 encode")}t.utf8encode=function(e){return n.nodebuffer?s.newBufferFrom(e,"utf-8"):u(e)},t.utf8decode=function(e){return n.nodebuffer?i.transformTo("nodebuffer",e).toString("utf-8"):h(e=i.transformTo(n.uint8array?"uint8array":"array",e))},i.inherits(d,a),d.prototype.processChunk=function(e){var r=i.transformTo(n.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var s=r;(r=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),r.set(s,this.leftOver.length)}else r=this.leftOver.concat(r);this.leftOver=null}var a=c(r),o=r;a!==r.length&&(n.uint8array?(o=r.subarray(0,a),this.leftOver=r.subarray(a,r.length)):(o=r.slice(0,a),this.leftOver=r.slice(a,r.length))),this.push({data:t.utf8decode(o),meta:e.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=d,i.inherits(p,a),p.prototype.processChunk=function(e){this.push({data:t.utf8encode(e.data),meta:e.meta})},t.Utf8EncodeWorker=p},76807:(e,t,r)=>{"use strict";var i=r(68441),n=r(72279),s=r(59322),a=r(47907);function o(e){return e}function l(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}r(82971),t.newBlob=function(e,r){t.checkSupport("blob");try{return new Blob([e],{type:r})}catch(t){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(e),i.getBlob(r)}catch(e){throw Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(e,t,r){var i=[],n=0,s=e.length;if(s<=r)return String.fromCharCode.apply(null,e);for(;n<s;)"array"===t||"nodebuffer"===t?i.push(String.fromCharCode.apply(null,e.slice(n,Math.min(n+r,s)))):i.push(String.fromCharCode.apply(null,e.subarray(n,Math.min(n+r,s)))),n+=r;return i.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,s.allocBuffer(1)).length}catch(e){return!1}}()}};function c(e){var r=65536,i=t.getTypeOf(e),n=!0;if("uint8array"===i?n=u.applyCanBeUsed.uint8array:"nodebuffer"===i&&(n=u.applyCanBeUsed.nodebuffer),n)for(;r>1;)try{return u.stringifyByChunk(e,i,r)}catch(e){r=Math.floor(r/2)}return u.stringifyByChar(e)}function h(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}t.applyFromCharCode=c;var d={};d.string={string:o,array:function(e){return l(e,Array(e.length))},arraybuffer:function(e){return d.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,s.allocBuffer(e.length))}},d.array={string:c,array:o,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(e)}},d.arraybuffer={string:function(e){return c(new Uint8Array(e))},array:function(e){return h(new Uint8Array(e),Array(e.byteLength))},arraybuffer:o,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(new Uint8Array(e))}},d.uint8array={string:c,array:function(e){return h(e,Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:o,nodebuffer:function(e){return s.newBufferFrom(e)}},d.nodebuffer={string:c,array:function(e){return h(e,Array(e.length))},arraybuffer:function(e){return d.nodebuffer.uint8array(e).buffer},uint8array:function(e){return h(e,new Uint8Array(e.length))},nodebuffer:o},t.transformTo=function(e,r){return(r||(r=""),e)?(t.checkSupport(e),d[t.getTypeOf(r)][e](r)):r},t.resolve=function(e){for(var t=e.split("/"),r=[],i=0;i<t.length;i++){var n=t[i];"."!==n&&(""!==n||0===i||i===t.length-1)&&(".."===n?r.pop():r.push(n))}return r.join("/")},t.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":i.nodebuffer&&s.isBuffer(e)?"nodebuffer":i.uint8array&&e instanceof Uint8Array?"uint8array":i.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},t.checkSupport=function(e){if(!i[e.toLowerCase()])throw Error(e+" is not supported by this platform")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(e){var t,r,i="";for(r=0;r<(e||"").length;r++)i+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return i},t.delay=function(e,t,r){setImmediate(function(){e.apply(r||null,t||[])})},t.inherits=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r},t.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},t.prepareContent=function(e,r,s,o,u){return a.Promise.resolve(r).then(function(e){return i.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise(function(t,r){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=function(e){r(e.target.error)},i.readAsArrayBuffer(e)}):e}).then(function(r){var c,h,d=t.getTypeOf(r);return d?("arraybuffer"===d?r=t.transformTo("uint8array",r):"string"===d&&(u?r=n.decode(r):s&&!0!==o&&(c=r,h=null,h=i.uint8array?new Uint8Array(c.length):Array(c.length),r=l(c,h))),r):a.Promise.reject(Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},66197:(e,t,r)=>{"use strict";var i=r(7166),n=r(76807),s=r(56964),a=r(24445),o=r(68441);function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw Error("Corrupted zip or bug: unexpected signature ("+n.pretty(t)+", expected "+n.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4);return this.reader.setIndex(r),i===t},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",r=n.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e<0){if(!this.isSignature(0,s.LOCAL_FILE_HEADER))throw Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");throw Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(e);var t=e;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var i=t-r;if(i>0)this.isSignature(t,s.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=i(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=l},24445:(e,t,r)=>{"use strict";var i=r(7166),n=r(76807),s=r(56378),a=r(80821),o=r(79983),l=r(24051),u=r(68441),c=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null};function h(e,t){this.options=e,this.loadOptions=t}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=c(this.compressionMethod)))throw Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=i(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,i,n=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<n;)t=e.readInt(2),r=e.readInt(2),i=e.readData(r),this.extraFields[t]={id:t,length:r,value:i};e.setIndex(n)},handleUTF8:function(){var e=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=n.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var s=n.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=i(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=i(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},e.exports=h},28382:(e,t,r)=>{"use strict";var i=r(44079),n=r(17765),s=r(79983),a=r(56378),o=r(50656),l=function(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};l.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw Error("No output type specified.");r=e.toLowerCase();var n="string"===r||"text"===r;("binarystring"===r||"text"===r)&&(r="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!n&&(t=t.pipe(new s.Utf8EncodeWorker)),!a&&n&&(t=t.pipe(new s.Utf8DecodeWorker))}catch(e){(t=new o("error")).error(e)}return new i(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new s.Utf8EncodeWorker)),a.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof o?this._data:new n(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<u.length;h++)l.prototype[u[h]]=c;e.exports=l},98417:(e,t,r)=>{var i=r(28354),n=r(82610);function s(e,t,r){e[t]=function(){return delete e[t],r.apply(this,arguments),this[t].apply(this,arguments)}}function a(e,t){if(!(this instanceof a))return new a(e,t);n.call(this,t),s(this,"_read",function(){var r=e.call(this,t),i=this.emit.bind(this,"error");r.on("error",i),r.pipe(this)}),this.emit("readable")}function o(e,t){if(!(this instanceof o))return new o(e,t);n.call(this,t),s(this,"_write",function(){var r=e.call(this,t),i=this.emit.bind(this,"error");r.on("error",i),this.pipe(r)}),this.emit("writable")}e.exports={Readable:a,Writable:o},i.inherits(a,n),i.inherits(o,n)},78275:(e,t,r)=>{"use strict";var i=r(42756);function n(){}var s={},a=["REJECTED"],o=["FULFILLED"],l=["PENDING"],u=["UNHANDLED"];function c(e){if("function"!=typeof e)throw TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,this.handled=u,e!==n&&f(this,e)}function h(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function d(e,t,r){i(function(){var i;try{i=t(r)}catch(t){return s.reject(e,t)}i===e?s.reject(e,TypeError("Cannot resolve promise with itself")):s.resolve(e,i)})}function p(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var r=!1;function i(t){r||(r=!0,s.reject(e,t))}function n(t){r||(r=!0,s.resolve(e,t))}var a=m(function(){t(n,i)});"error"===a.status&&i(a.value)}function m(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}e.exports=c,c.prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){throw r})})},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===o||"function"!=typeof t&&this.state===a)return this;var r=new this.constructor(n);return this.handled===u&&(this.handled=null),this.state!==l?d(r,this.state===o?e:t,this.outcome):this.queue.push(new h(r,e,t)),r},h.prototype.callFulfilled=function(e){s.resolve(this.promise,e)},h.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},h.prototype.callRejected=function(e){s.reject(this.promise,e)},h.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},s.resolve=function(e,t){var r=m(p,t);if("error"===r.status)return s.reject(e,r.value);var i=r.value;if(i)f(e,i);else{e.state=o,e.outcome=t;for(var n=-1,a=e.queue.length;++n<a;)e.queue[n].callFulfilled(t)}return e},s.reject=function(e,t){e.state=a,e.outcome=t,e.handled===u&&i(function(){e.handled===u&&process.emit("unhandledRejection",t,e)});for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:s.resolve(new this(n),e)},c.reject=function(e){var t=new this(n);return s.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var a=Array(r),o=0,l=-1,u=new this(n);++l<r;)(function(e,n){t.resolve(e).then(function(e){a[n]=e,++o!==r||i||(i=!0,s.resolve(u,a))},function(e){i||(i=!0,s.reject(u,e))})})(e[l],l);return u},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var a=-1,o=new this(n);++a<r;)(function(e){t.resolve(e).then(function(e){i||(i=!0,s.resolve(o,e))},function(e){i||(i=!0,s.reject(o,e))})})(e[a]);return o}},58189:(e,t,r)=>{"use strict";var i=r(94735).listenerCount;i=i||function(e,t){var r=e&&e._events&&e._events[t];return Array.isArray(r)?r.length:"function"==typeof r?1:0},e.exports=i},15859:e=>{var t=/^(?:0|[1-9]\d*)$/;function r(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var i=Object.prototype,n=i.hasOwnProperty,s=i.toString,a=i.propertyIsEnumerable,o=Math.max;function l(e,t,r,s){return void 0===e||h(e,i[r])&&!n.call(s,r)?t:e}function u(e,t){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,n=-1,s=o(i.length-t,0),a=Array(s);++n<s;)a[n]=i[t+n];n=-1;for(var l=Array(t+1);++n<t;)l[n]=i[n];return l[t]=a,r(e,this,l)}}function c(e,r){return!!(r=null==r?0x1fffffffffffff:r)&&("number"==typeof e||t.test(e))&&e>-1&&e%1==0&&e<r}function h(e,t){return e===t||e!=e&&t!=t}var d=Array.isArray;function p(e){var t,r;return null!=e&&"number"==typeof(t=e.length)&&t>-1&&t%1==0&&t<=0x1fffffffffffff&&!("[object Function]"==(r=f(e)?s.call(e):"")||"[object GeneratorFunction]"==r)}function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var m=function(e){return u(function(t,r){var i=-1,n=r.length,s=n>1?r[n-1]:void 0,a=n>2?r[2]:void 0;for(s=e.length>3&&"function"==typeof s?(n--,s):void 0,a&&function(e,t,r){if(!f(r))return!1;var i=typeof t;return("number"==i?!!(p(r)&&c(t,r.length)):"string"==i&&t in r)&&h(r[t],e)}(r[0],r[1],a)&&(s=n<3?void 0:s,n=1),t=Object(t);++i<n;){var o=r[i];o&&e(t,o,i,s)}return t})}(function(e,t,r,o){!function(e,t,r,i){r||(r={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=i?i(r[o],e[o],o,r,e):void 0;!function(e,t,r){var i=e[t];n.call(e,t)&&h(i,r)&&(void 0!==r||t in e)||(e[t]=r)}(r,o,void 0===l?e[o]:l)}}(t,p(t)?function(e,t){var r=d(e)||e&&"object"==typeof e&&p(e)&&n.call(e,"callee")&&(!a.call(e,"callee")||"[object Arguments]"==s.call(e))?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],i=r.length,o=!!i;for(var l in e)(t||n.call(e,l))&&!(o&&("length"==l||c(l,i)))&&r.push(l);return r}(t,!0):function(e){if(!f(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t,r=(t=e&&e.constructor,e===("function"==typeof t&&t.prototype||i)),s=[];for(var a in e)"constructor"==a&&(r||!n.call(e,a))||s.push(a);return s}(t),e,o)}),g=u(function(e){return e.push(void 0,l),r(m,void 0,e)});e.exports=g},47162:e=>{var t="__lodash_hash_undefined__",r=/^\[object .+?Constructor\]$/,i="object"==typeof global&&global&&global.Object===Object&&global,n="object"==typeof self&&self&&self.Object===Object&&self,s=i||n||Function("return this")();function a(e,t){return!!(e?e.length:0)&&function(e,t,r){if(t!=t)return function(e,t,r,i){for(var n=e.length,s=-1;++s<n;)if(t(e[s],s,e))return s;return -1}(e,o,0);for(var i=-1,n=e.length;++i<n;)if(e[i]===t)return i;return -1}(e,t,0)>-1}function o(e){return e!=e}function l(e,t){return e.has(t)}var u=Array.prototype,c=Function.prototype,h=Object.prototype,d=s["__core-js_shared__"],p=function(){var e=/[^.]+$/.exec(d&&d.keys&&d.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),f=c.toString,m=h.hasOwnProperty,g=h.toString,y=RegExp("^"+f.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),v=s.Symbol,b=h.propertyIsEnumerable,w=u.splice,x=v?v.isConcatSpreadable:void 0,S=Math.max,E=I(s,"Map"),T=I(Object,"create");function k(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function O(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function C(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function A(e){var t=-1,r=e?e.length:0;for(this.__data__=new C;++t<r;)this.add(e[t])}function N(e,t){for(var r,i=e.length;i--;)if((r=e[i][0])===t||r!=r&&t!=t)return i;return -1}function R(e,t){var r,i=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?i["string"==typeof t?"string":"hash"]:i.map}function I(e,t){var i=null==e?void 0:e[t];return!(!F(i)||p&&p in i)&&($(i)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(i)?y:r).test(function(e){if(null!=e){try{return f.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(i))?i:void 0}function P(e){return D(e)||L(e)&&m.call(e,"callee")&&(!b.call(e,"callee")||"[object Arguments]"==g.call(e))||!!(x&&e&&e[x])}k.prototype.clear=function(){this.__data__=T?T(null):{}},k.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},k.prototype.get=function(e){var r=this.__data__;if(T){var i=r[e];return i===t?void 0:i}return m.call(r,e)?r[e]:void 0},k.prototype.has=function(e){var t=this.__data__;return T?void 0!==t[e]:m.call(t,e)},k.prototype.set=function(e,r){return this.__data__[e]=T&&void 0===r?t:r,this},O.prototype.clear=function(){this.__data__=[]},O.prototype.delete=function(e){var t=this.__data__,r=N(t,e);return!(r<0)&&(r==t.length-1?t.pop():w.call(t,r,1),!0)},O.prototype.get=function(e){var t=this.__data__,r=N(t,e);return r<0?void 0:t[r][1]},O.prototype.has=function(e){return N(this.__data__,e)>-1},O.prototype.set=function(e,t){var r=this.__data__,i=N(r,e);return i<0?r.push([e,t]):r[i][1]=t,this},C.prototype.clear=function(){this.__data__={hash:new k,map:new(E||O),string:new k}},C.prototype.delete=function(e){return R(this,e).delete(e)},C.prototype.get=function(e){return R(this,e).get(e)},C.prototype.has=function(e){return R(this,e).has(e)},C.prototype.set=function(e,t){return R(this,e).set(e,t),this},A.prototype.add=A.prototype.push=function(e){return this.__data__.set(e,t),this},A.prototype.has=function(e){return this.__data__.has(e)};var j=function(e,t){return t=S(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,n=S(r.length-t,0),s=Array(n);++i<n;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=s,function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(e,this,a)}}(function(e,t){return L(e)?function(e,t,r,i){var n=-1,s=a,o=!0,u=e.length,c=[],h=t.length;if(!u)return c;t.length>=200&&(s=l,o=!1,t=new A(t));i:for(;++n<u;){var d=e[n],p=d;if(d=0!==d?d:0,o&&p==p){for(var f=h;f--;)if(t[f]===p)continue i;c.push(d)}else s(t,p,void 0)||c.push(d)}return c}(e,function e(t,r,i,n,s){var a=-1,o=t.length;for(i||(i=P),s||(s=[]);++a<o;){var l=t[a];r>0&&i(l)?r>1?e(l,r-1,i,n,s):function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}(s,l):n||(s[s.length]=l)}return s}(t,1,L,!0)):[]}),D=Array.isArray;function L(e){var t,r;return!!e&&"object"==typeof e&&null!=(t=e)&&"number"==typeof(r=t.length)&&r>-1&&r%1==0&&r<=0x1fffffffffffff&&!$(t)}function $(e){var t=F(e)?g.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function F(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=j},94546:e=>{var t=1/0,r=/[\\^$.*+?()[\]{}|]/g,i=RegExp(r.source),n="object"==typeof global&&global&&global.Object===Object&&global,s="object"==typeof self&&self&&self.Object===Object&&self,a=n||s||Function("return this")(),o=Object.prototype.toString,l=a.Symbol,u=l?l.prototype:void 0,c=u?u.toString:void 0;e.exports=function(e){var n;return(e=null==(n=e)?"":function(e){if("string"==typeof e)return e;if("symbol"==typeof(r=e)||r&&"object"==typeof r&&"[object Symbol]"==o.call(r))return c?c.call(e):"";var r,i=e+"";return"0"==i&&1/e==-t?"-0":i}(n))&&i.test(e)?e.replace(r,"\\$&"):e}},58107:e=>{var t="object"==typeof global&&global&&global.Object===Object&&global,r="object"==typeof self&&self&&self.Object===Object&&self,i=t||r||Function("return this")(),n=Object.prototype,s=n.hasOwnProperty,a=n.toString,o=i.Symbol,l=n.propertyIsEnumerable,u=o?o.isConcatSpreadable:void 0;function c(e){var t,r,i,n,o,c;return h(e)||!!e&&"object"==typeof e&&null!=(t=e)&&"number"==typeof(r=t.length)&&r>-1&&r%1==0&&r<=0x1fffffffffffff&&!("[object Function]"==(o=typeof(n=i=t),c=n&&("object"==o||"function"==o)?a.call(i):"")||"[object GeneratorFunction]"==c)&&s.call(e,"callee")&&(!l.call(e,"callee")||"[object Arguments]"==a.call(e))||!!(u&&e&&e[u])}var h=Array.isArray;e.exports=function(e){return(e?e.length:0)?function e(t,r,i,n,s){var a=-1,o=t.length;for(i||(i=c),s||(s=[]);++a<o;){var l=t[a];r>0&&i(l)?r>1?e(l,r-1,i,n,s):function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}(s,l):n||(s[s.length]=l)}return s}(e,1):[]}},65925:(e,t,r)=>{e=r.nmd(e);var i,n,s,a,o,l="__lodash_hash_undefined__",u=1/0,c="[object Arguments]",h="[object Array]",d="[object Boolean]",p="[object Date]",f="[object Error]",m="[object Function]",g="[object Map]",y="[object Number]",v="[object Object]",b="[object Promise]",w="[object RegExp]",x="[object Set]",S="[object String]",E="[object Symbol]",T="[object WeakMap]",k="[object ArrayBuffer]",O="[object DataView]",C=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/,N=/^\./,R=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,I=/\\(\\)?/g,P=/^\[object .+?Constructor\]$/,j=/^(?:0|[1-9]\d*)$/,D={};D["[object Float32Array]"]=D["[object Float64Array]"]=D["[object Int8Array]"]=D["[object Int16Array]"]=D["[object Int32Array]"]=D["[object Uint8Array]"]=D["[object Uint8ClampedArray]"]=D["[object Uint16Array]"]=D["[object Uint32Array]"]=!0,D[c]=D[h]=D[k]=D[d]=D[O]=D[p]=D[f]=D[m]=D[g]=D[y]=D[v]=D[w]=D[x]=D[S]=D[T]=!1;var L="object"==typeof global&&global&&global.Object===Object&&global,$="object"==typeof self&&self&&self.Object===Object&&self,F=L||$||Function("return this")(),M=t&&!t.nodeType&&t,B=M&&e&&!e.nodeType&&e,U=B&&B.exports===M&&L.process,z=function(){try{return U&&U.binding("util")}catch(e){}}(),q=z&&z.isTypedArray;function H(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function W(e){var t=-1,r=Array(e.size);return e.forEach(function(e,i){r[++t]=[i,e]}),r}function V(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var G=Array.prototype,K=Function.prototype,J=Object.prototype,Q=F["__core-js_shared__"],Z=function(){var e=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),X=K.toString,Y=J.hasOwnProperty,ee=J.toString,et=RegExp("^"+X.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),er=F.Symbol,ei=F.Uint8Array,en=J.propertyIsEnumerable,es=G.splice,ea=(a=Object.keys,o=Object,function(e){return a(o(e))}),eo=ej(F,"DataView"),el=ej(F,"Map"),eu=ej(F,"Promise"),ec=ej(F,"Set"),eh=ej(F,"WeakMap"),ed=ej(Object,"create"),ep=eU(eo),ef=eU(el),em=eU(eu),eg=eU(ec),ey=eU(eh),e_=er?er.prototype:void 0,ev=e_?e_.valueOf:void 0,eb=e_?e_.toString:void 0;function ew(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function ex(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function eS(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function eE(e){var t=-1,r=e?e.length:0;for(this.__data__=new eS;++t<r;)this.add(e[t])}function eT(e){this.__data__=new ex(e)}function ek(e,t){for(var r=e.length;r--;)if(eH(e[r][0],t))return r;return -1}ew.prototype.clear=function(){this.__data__=ed?ed(null):{}},ew.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},ew.prototype.get=function(e){var t=this.__data__;if(ed){var r=t[e];return r===l?void 0:r}return Y.call(t,e)?t[e]:void 0},ew.prototype.has=function(e){var t=this.__data__;return ed?void 0!==t[e]:Y.call(t,e)},ew.prototype.set=function(e,t){return this.__data__[e]=ed&&void 0===t?l:t,this},ex.prototype.clear=function(){this.__data__=[]},ex.prototype.delete=function(e){var t=this.__data__,r=ek(t,e);return!(r<0)&&(r==t.length-1?t.pop():es.call(t,r,1),!0)},ex.prototype.get=function(e){var t=this.__data__,r=ek(t,e);return r<0?void 0:t[r][1]},ex.prototype.has=function(e){return ek(this.__data__,e)>-1},ex.prototype.set=function(e,t){var r=this.__data__,i=ek(r,e);return i<0?r.push([e,t]):r[i][1]=t,this},eS.prototype.clear=function(){this.__data__={hash:new ew,map:new(el||ex),string:new ew}},eS.prototype.delete=function(e){return eP(this,e).delete(e)},eS.prototype.get=function(e){return eP(this,e).get(e)},eS.prototype.has=function(e){return eP(this,e).has(e)},eS.prototype.set=function(e,t){return eP(this,e).set(e,t),this},eE.prototype.add=eE.prototype.push=function(e){return this.__data__.set(e,l),this},eE.prototype.has=function(e){return this.__data__.has(e)},eT.prototype.clear=function(){this.__data__=new ex},eT.prototype.delete=function(e){return this.__data__.delete(e)},eT.prototype.get=function(e){return this.__data__.get(e)},eT.prototype.has=function(e){return this.__data__.has(e)},eT.prototype.set=function(e,t){var r=this.__data__;if(r instanceof ex){var i=r.__data__;if(!el||i.length<199)return i.push([e,t]),this;r=this.__data__=new eS(i)}return r.set(e,t),this};var eO=(i=function(e,t){return e&&eC(e,t,e0)},function(e,t){if(null==e)return e;if(!eG(e))return i(e,t);for(var r=e.length,n=-1,s=Object(e);++n<r&&!1!==t(s[n],n,s););return e}),eC=function(e,t,r){for(var i=-1,n=Object(e),s=r(e),a=s.length;a--;){var o=s[++i];if(!1===t(n[o],o,n))break}return e};function eA(e,t){var r;t=e$(t,e)?[t]:eV(r=t)?r:eM(r);for(var i=0,n=t.length;null!=e&&i<n;)e=e[eB(t[i++])];return i&&i==n?e:void 0}function eN(e,t){return null!=e&&t in Object(e)}function eR(e,t,r,i,n){return e===t||(null!=e&&null!=t&&(eQ(e)||eZ(t))?function(e,t,r,i,n,s){var a=eV(e),o=eV(t),l=h,u=h;a||(l=(l=eD(e))==c?v:l),o||(u=(u=eD(t))==c?v:u);var m=l==v&&!H(e),b=u==v&&!H(t),T=l==u;if(T&&!m)return s||(s=new eT),a||eY(e)?eI(e,t,r,i,n,s):function(e,t,r,i,n,s,a){switch(r){case O:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case k:if(e.byteLength!=t.byteLength||!i(new ei(e),new ei(t)))break;return!0;case d:case p:case y:return eH(+e,+t);case f:return e.name==t.name&&e.message==t.message;case w:case S:return e==t+"";case g:var o=W;case x:var l=2&s;if(o||(o=V),e.size!=t.size&&!l)break;var u=a.get(e);if(u)return u==t;s|=1,a.set(e,t);var c=eI(o(e),o(t),i,n,s,a);return a.delete(e),c;case E:if(ev)return ev.call(e)==ev.call(t)}return!1}(e,t,l,r,i,n,s);if(!(2&n)){var C=m&&Y.call(e,"__wrapped__"),A=b&&Y.call(t,"__wrapped__");if(C||A){var N=C?e.value():e,R=A?t.value():t;return s||(s=new eT),r(N,R,i,n,s)}}return!!T&&(s||(s=new eT),function(e,t,r,i,n,s){var a=2&n,o=e0(e),l=o.length;if(l!=e0(t).length&&!a)return!1;for(var u=l;u--;){var c=o[u];if(!(a?c in t:Y.call(t,c)))return!1}var h=s.get(e);if(h&&s.get(t))return h==t;var d=!0;s.set(e,t),s.set(t,e);for(var p=a;++u<l;){var f=e[c=o[u]],m=t[c];if(i)var g=a?i(m,f,c,t,e,s):i(f,m,c,e,t,s);if(!(void 0===g?f===m||r(f,m,i,n,s):g)){d=!1;break}p||(p="constructor"==c)}if(d&&!p){var y=e.constructor,v=t.constructor;y!=v&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v)&&(d=!1)}return s.delete(e),s.delete(t),d}(e,t,r,i,n,s))}(e,t,eR,r,i,n):e!=e&&t!=t)}function eI(e,t,r,i,n,s){var a=2&n,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var u=s.get(e);if(u&&s.get(t))return u==t;var c=-1,h=!0,d=1&n?new eE:void 0;for(s.set(e,t),s.set(t,e);++c<o;){var p=e[c],f=t[c];if(i)var m=a?i(f,p,c,t,e,s):i(p,f,c,e,t,s);if(void 0!==m){if(m)continue;h=!1;break}if(d){if(!function(e,t){for(var r=-1,i=e?e.length:0;++r<i;)if(t(e[r],r,e))return!0;return!1}(t,function(e,t){if(!d.has(t)&&(p===e||r(p,e,i,n,s)))return d.add(t)})){h=!1;break}}else if(!(p===f||r(p,f,i,n,s))){h=!1;break}}return s.delete(e),s.delete(t),h}function eP(e,t){var r,i=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?i["string"==typeof t?"string":"hash"]:i.map}function ej(e,t){var r=null==e?void 0:e[t];return!(!eQ(r)||Z&&Z in r)&&(eK(r)||H(r)?et:P).test(eU(r))?r:void 0}var eD=function(e){return ee.call(e)};function eL(e,t){return!!(t=null==t?0x1fffffffffffff:t)&&("number"==typeof e||j.test(e))&&e>-1&&e%1==0&&e<t}function e$(e,t){if(eV(e))return!1;var r=typeof e;return!!("number"==r||"symbol"==r||"boolean"==r||null==e||eX(e))||A.test(e)||!C.test(e)||null!=t&&e in Object(t)}function eF(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}}(eo&&eD(new eo(new ArrayBuffer(1)))!=O||el&&eD(new el)!=g||eu&&eD(eu.resolve())!=b||ec&&eD(new ec)!=x||eh&&eD(new eh)!=T)&&(eD=function(e){var t=ee.call(e),r=t==v?e.constructor:void 0,i=r?eU(r):void 0;if(i)switch(i){case ep:return O;case ef:return g;case em:return b;case eg:return x;case ey:return T}return t});var eM=eq(function(e){e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(eX(e))return eb?eb.call(e):"";var t=e+"";return"0"==t&&1/e==-u?"-0":t}(t);var t,r=[];return N.test(e)&&r.push(""),e.replace(R,function(e,t,i,n){r.push(i?n.replace(I,"$1"):t||e)}),r});function eB(e){if("string"==typeof e||eX(e))return e;var t=e+"";return"0"==t&&1/e==-u?"-0":t}function eU(e){if(null!=e){try{return X.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var ez=(s=function(e,t,r){Y.call(e,r)?e[r].push(t):e[r]=[t]},function(e,t){var r,i,n,a,o,l;return(eV(e)?function(e,t,r,i){for(var n=-1,s=e?e.length:0;++n<s;){var a=e[n];t(i,a,r(a),e)}return i}:function(e,t,r,i){return eO(e,function(e,n,s){t(i,e,r(e),s)}),i})(e,s,"function"==typeof t?t:null==t?e1:"object"==typeof t?eV(t)?(r=t[0],i=t[1],e$(r)&&(n=i)==n&&!eQ(n)?eF(eB(r),i):function(e){var t,n=void 0===(t=null==e?void 0:eA(e,r))?void 0:t;return void 0===n&&n===i?null!=e&&function(e,t,r){t=e$(t,e)?[t]:eV(i=t)?i:eM(i);for(var i,n,s=-1,a=t.length;++s<a;){var o=eB(t[s]);if(!(n=null!=e&&r(e,o)))break;e=e[o]}if(n)return n;var a=e?e.length:0;return!!a&&eJ(a)&&eL(o,a)&&(eV(e)||eW(e))}(e,r,eN):eR(i,n,void 0,3)}):1==(a=function(e){for(var t=e0(e),r=t.length;r--;){var i=t[r],n=e[i];t[r]=[i,n,n==n&&!eQ(n)]}return t}(t)).length&&a[0][2]?eF(a[0][0],a[0][1]):function(e){return e===t||function(e,t,r,i){var n=r.length,s=n;if(null==e)return!s;for(e=Object(e);n--;){var a=r[n];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++n<s;){var o=(a=r[n])[0],l=e[o],u=a[1];if(a[2]){if(void 0===l&&!(o in e))return!1}else{var c,h=new eT;if(!(void 0===c?eR(u,l,void 0,3,h):c))return!1}}return!0}(e,0,a)}:e$(o=t)?(l=eB(o),function(e){return null==e?void 0:e[l]}):function(e){return eA(e,o)},{})});function eq(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw TypeError("Expected a function");var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],s=r.cache;if(s.has(n))return s.get(n);var a=e.apply(this,i);return r.cache=s.set(n,a),a};return r.cache=new(eq.Cache||eS),r}function eH(e,t){return e===t||e!=e&&t!=t}function eW(e){return eZ(e)&&eG(e)&&Y.call(e,"callee")&&(!en.call(e,"callee")||ee.call(e)==c)}eq.Cache=eS;var eV=Array.isArray;function eG(e){return null!=e&&eJ(e.length)&&!eK(e)}function eK(e){var t=eQ(e)?ee.call(e):"";return t==m||"[object GeneratorFunction]"==t}function eJ(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}function eQ(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function eZ(e){return!!e&&"object"==typeof e}function eX(e){return"symbol"==typeof e||eZ(e)&&ee.call(e)==E}var eY=q?function(e){return q(e)}:function(e){return eZ(e)&&eJ(e.length)&&!!D[ee.call(e)]};function e0(e){return eG(e)?function(e,t){var r=eV(e)||eW(e)?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],i=r.length,n=!!i;for(var s in e)Y.call(e,s)&&!(n&&("length"==s||eL(s,i)))&&r.push(s);return r}(e):function(e){if(t=e&&e.constructor,e!==("function"==typeof t&&t.prototype||J))return ea(e);var t,r=[];for(var i in Object(e))Y.call(e,i)&&"constructor"!=i&&r.push(i);return r}(e)}function e1(e){return e}e.exports=ez},90559:e=>{var t=Object.prototype.toString;e.exports=function(e){return!0===e||!1===e||!!e&&"object"==typeof e&&"[object Boolean]"==t.call(e)}},25832:(e,t,r)=>{e=r.nmd(e);var i,n,s="__lodash_hash_undefined__",a="[object Arguments]",o="[object Array]",l="[object Boolean]",u="[object Date]",c="[object Error]",h="[object Function]",d="[object Map]",p="[object Number]",f="[object Object]",m="[object Promise]",g="[object RegExp]",y="[object Set]",v="[object String]",b="[object WeakMap]",w="[object ArrayBuffer]",x="[object DataView]",S=/^\[object .+?Constructor\]$/,E=/^(?:0|[1-9]\d*)$/,T={};T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T[a]=T[o]=T[w]=T[l]=T[x]=T[u]=T[c]=T[h]=T[d]=T[p]=T[f]=T[g]=T[y]=T[v]=T[b]=!1;var k="object"==typeof global&&global&&global.Object===Object&&global,O="object"==typeof self&&self&&self.Object===Object&&self,C=k||O||Function("return this")(),A=t&&!t.nodeType&&t,N=A&&e&&!e.nodeType&&e,R=N&&N.exports===A,I=R&&k.process,P=function(){try{return I&&I.binding&&I.binding("util")}catch(e){}}(),j=P&&P.isTypedArray;function D(e){var t=-1,r=Array(e.size);return e.forEach(function(e,i){r[++t]=[i,e]}),r}function L(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var $=Array.prototype,F=Function.prototype,M=Object.prototype,B=C["__core-js_shared__"],U=F.toString,z=M.hasOwnProperty,q=function(){var e=/[^.]+$/.exec(B&&B.keys&&B.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),H=M.toString,W=RegExp("^"+U.call(z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=R?C.Buffer:void 0,G=C.Symbol,K=C.Uint8Array,J=M.propertyIsEnumerable,Q=$.splice,Z=G?G.toStringTag:void 0,X=Object.getOwnPropertySymbols,Y=V?V.isBuffer:void 0,ee=(i=Object.keys,n=Object,function(e){return i(n(e))}),et=eT(C,"DataView"),er=eT(C,"Map"),ei=eT(C,"Promise"),en=eT(C,"Set"),es=eT(C,"WeakMap"),ea=eT(Object,"create"),eo=eC(et),el=eC(er),eu=eC(ei),ec=eC(en),eh=eC(es),ed=G?G.prototype:void 0,ep=ed?ed.valueOf:void 0;function ef(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function em(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function eg(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function ey(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new eg;++t<r;)this.add(e[t])}function e_(e){var t=this.__data__=new em(e);this.size=t.size}function ev(e,t){for(var r=e.length;r--;)if(eA(e[r][0],t))return r;return -1}function eb(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Z&&Z in Object(e)?function(e){var t=z.call(e,Z),r=e[Z];try{e[Z]=void 0;var i=!0}catch(e){}var n=H.call(e);return i&&(t?e[Z]=r:delete e[Z]),n}(e):H.call(e)}function ew(e){return eL(e)&&eb(e)==a}function ex(e,t,r,i,n,s){var a=1&r,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var u=s.get(e);if(u&&s.get(t))return u==t;var c=-1,h=!0,d=2&r?new ey:void 0;for(s.set(e,t),s.set(t,e);++c<o;){var p=e[c],f=t[c];if(i)var m=a?i(f,p,c,t,e,s):i(p,f,c,e,t,s);if(void 0!==m){if(m)continue;h=!1;break}if(d){if(!function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}(t,function(e,t){if(!d.has(t)&&(p===e||n(p,e,r,i,s)))return d.push(t)})){h=!1;break}}else if(!(p===f||n(p,f,r,i,s))){h=!1;break}}return s.delete(e),s.delete(t),h}function eS(e){var t;return t=function(e){return null!=e&&ej(e.length)&&!eP(e)?function(e,t){var r,i=eR(e),n=!i&&eN(e),s=!i&&!n&&eI(e),a=!i&&!n&&!s&&e$(e),o=i||n||s||a,l=o?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],u=l.length;for(var c in e)z.call(e,c)&&!(o&&("length"==c||s&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||(r=null==(r=u)?0x1fffffffffffff:r)&&("number"==typeof c||E.test(c))&&c>-1&&c%1==0&&c<r))&&l.push(c);return l}(e):function(e){if(t=e&&e.constructor,e!==("function"==typeof t&&t.prototype||M))return ee(e);var t,r=[];for(var i in Object(e))z.call(e,i)&&"constructor"!=i&&r.push(i);return r}(e)}(e),eR(e)?t:function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}(t,ek(e))}function eE(e,t){var r,i=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?i["string"==typeof t?"string":"hash"]:i.map}function eT(e,t){var r=null==e?void 0:e[t];return!(!eD(r)||q&&q in r)&&(eP(r)?W:S).test(eC(r))?r:void 0}ef.prototype.clear=function(){this.__data__=ea?ea(null):{},this.size=0},ef.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ef.prototype.get=function(e){var t=this.__data__;if(ea){var r=t[e];return r===s?void 0:r}return z.call(t,e)?t[e]:void 0},ef.prototype.has=function(e){var t=this.__data__;return ea?void 0!==t[e]:z.call(t,e)},ef.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ea&&void 0===t?s:t,this},em.prototype.clear=function(){this.__data__=[],this.size=0},em.prototype.delete=function(e){var t=this.__data__,r=ev(t,e);return!(r<0)&&(r==t.length-1?t.pop():Q.call(t,r,1),--this.size,!0)},em.prototype.get=function(e){var t=this.__data__,r=ev(t,e);return r<0?void 0:t[r][1]},em.prototype.has=function(e){return ev(this.__data__,e)>-1},em.prototype.set=function(e,t){var r=this.__data__,i=ev(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this},eg.prototype.clear=function(){this.size=0,this.__data__={hash:new ef,map:new(er||em),string:new ef}},eg.prototype.delete=function(e){var t=eE(this,e).delete(e);return this.size-=t?1:0,t},eg.prototype.get=function(e){return eE(this,e).get(e)},eg.prototype.has=function(e){return eE(this,e).has(e)},eg.prototype.set=function(e,t){var r=eE(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},ey.prototype.add=ey.prototype.push=function(e){return this.__data__.set(e,s),this},ey.prototype.has=function(e){return this.__data__.has(e)},e_.prototype.clear=function(){this.__data__=new em,this.size=0},e_.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},e_.prototype.get=function(e){return this.__data__.get(e)},e_.prototype.has=function(e){return this.__data__.has(e)},e_.prototype.set=function(e,t){var r=this.__data__;if(r instanceof em){var i=r.__data__;if(!er||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new eg(i)}return r.set(e,t),this.size=r.size,this};var ek=X?function(e){return null==e?[]:function(e,t){for(var r=-1,i=null==e?0:e.length,n=0,s=[];++r<i;){var a=e[r];t(a,r,e)&&(s[n++]=a)}return s}(X(e=Object(e)),function(t){return J.call(e,t)})}:function(){return[]},eO=eb;function eC(e){if(null!=e){try{return U.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function eA(e,t){return e===t||e!=e&&t!=t}(et&&eO(new et(new ArrayBuffer(1)))!=x||er&&eO(new er)!=d||ei&&eO(ei.resolve())!=m||en&&eO(new en)!=y||es&&eO(new es)!=b)&&(eO=function(e){var t=eb(e),r=t==f?e.constructor:void 0,i=r?eC(r):"";if(i)switch(i){case eo:return x;case el:return d;case eu:return m;case ec:return y;case eh:return b}return t});var eN=ew(function(){return arguments}())?ew:function(e){return eL(e)&&z.call(e,"callee")&&!J.call(e,"callee")},eR=Array.isArray,eI=Y||function(){return!1};function eP(e){if(!eD(e))return!1;var t=eb(e);return t==h||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function ej(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}function eD(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function eL(e){return null!=e&&"object"==typeof e}var e$=j?function(e){return j(e)}:function(e){return eL(e)&&ej(e.length)&&!!T[eb(e)]};e.exports=function(e,t){return function e(t,r,i,n,s){return t===r||(null!=t&&null!=r&&(eL(t)||eL(r))?function(e,t,r,i,n,s){var h=eR(e),m=eR(t),b=h?o:eO(e),S=m?o:eO(t);b=b==a?f:b,S=S==a?f:S;var E=b==f,T=S==f,k=b==S;if(k&&eI(e)){if(!eI(t))return!1;h=!0,E=!1}if(k&&!E)return s||(s=new e_),h||e$(e)?ex(e,t,r,i,n,s):function(e,t,r,i,n,s,a){switch(r){case x:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case w:if(e.byteLength!=t.byteLength||!s(new K(e),new K(t)))break;return!0;case l:case u:case p:return eA(+e,+t);case c:return e.name==t.name&&e.message==t.message;case g:case v:return e==t+"";case d:var o=D;case y:var h=1&i;if(o||(o=L),e.size!=t.size&&!h)break;var f=a.get(e);if(f)return f==t;i|=2,a.set(e,t);var m=ex(o(e),o(t),i,n,s,a);return a.delete(e),m;case"[object Symbol]":if(ep)return ep.call(e)==ep.call(t)}return!1}(e,t,b,r,i,n,s);if(!(1&r)){var O=E&&z.call(e,"__wrapped__"),C=T&&z.call(t,"__wrapped__");if(O||C){var A=O?e.value():e,N=C?t.value():t;return s||(s=new e_),n(A,N,r,i,s)}}return!!k&&(s||(s=new e_),function(e,t,r,i,n,s){var a=1&r,o=eS(e),l=o.length;if(l!=eS(t).length&&!a)return!1;for(var u=l;u--;){var c=o[u];if(!(a?c in t:z.call(t,c)))return!1}var h=s.get(e);if(h&&s.get(t))return h==t;var d=!0;s.set(e,t),s.set(t,e);for(var p=a;++u<l;){var f=e[c=o[u]],m=t[c];if(i)var g=a?i(m,f,c,t,e,s):i(f,m,c,e,t,s);if(!(void 0===g?f===m||n(f,m,r,i,s):g)){d=!1;break}p||(p="constructor"==c)}if(d&&!p){var y=e.constructor,v=t.constructor;y!=v&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v)&&(d=!1)}return s.delete(e),s.delete(t),d}(e,t,r,i,n,s))}(t,r,i,n,e,s):t!=t&&r!=r)}(e,t)}},21903:e=>{var t="object"==typeof global&&global&&global.Object===Object&&global,r="object"==typeof self&&self&&self.Object===Object&&self,i=t||r||Function("return this")(),n=Object.prototype,s=n.hasOwnProperty,a=n.toString,o=i.Symbol,l=o?o.toStringTag:void 0;e.exports=function(e){if(t=typeof e,null==e||"object"!=t&&"function"!=t)return!1;var t,r=null==e?void 0===e?"[object Undefined]":"[object Null]":l&&l in Object(e)?function(e){var t=s.call(e,l),r=e[l];try{e[l]=void 0;var i=!0}catch(e){}var n=a.call(e);return i&&(t?e[l]=r:delete e[l]),n}(e):a.call(e);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r}},35211:e=>{e.exports=function(e){return null==e}},35933:e=>{var t,r,i=Object.prototype,n=Function.prototype.toString,s=i.hasOwnProperty,a=n.call(Object),o=i.toString,l=(t=Object.getPrototypeOf,r=Object,function(e){return t(r(e))});e.exports=function(e){if(!(e&&"object"==typeof e)||"[object Object]"!=o.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=l(e);if(null===t)return!0;var r=s.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&n.call(r)==a}},29769:e=>{e.exports=function(e){return void 0===e}},46753:e=>{var t="__lodash_hash_undefined__",r=/^\[object .+?Constructor\]$/,i="object"==typeof global&&global&&global.Object===Object&&global,n="object"==typeof self&&self&&self.Object===Object&&self,s=i||n||Function("return this")();function a(e,t){return!!(e?e.length:0)&&function(e,t,r){if(t!=t)return function(e,t,r,i){for(var n=e.length,s=-1;++s<n;)if(t(e[s],s,e))return s;return -1}(e,o,0);for(var i=-1,n=e.length;++i<n;)if(e[i]===t)return i;return -1}(e,t,0)>-1}function o(e){return e!=e}function l(e,t){return e.has(t)}function u(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var c=Array.prototype,h=Function.prototype,d=Object.prototype,p=s["__core-js_shared__"],f=function(){var e=/[^.]+$/.exec(p&&p.keys&&p.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),m=h.toString,g=d.hasOwnProperty,y=d.toString,v=RegExp("^"+m.call(g).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),b=s.Symbol,w=d.propertyIsEnumerable,x=c.splice,S=b?b.isConcatSpreadable:void 0,E=Math.max,T=D(s,"Map"),k=D(s,"Set"),O=D(Object,"create");function C(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function A(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function N(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function R(e){var t=-1,r=e?e.length:0;for(this.__data__=new N;++t<r;)this.add(e[t])}function I(e,t){for(var r,i=e.length;i--;)if((r=e[i][0])===t||r!=r&&t!=t)return i;return -1}C.prototype.clear=function(){this.__data__=O?O(null):{}},C.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},C.prototype.get=function(e){var r=this.__data__;if(O){var i=r[e];return i===t?void 0:i}return g.call(r,e)?r[e]:void 0},C.prototype.has=function(e){var t=this.__data__;return O?void 0!==t[e]:g.call(t,e)},C.prototype.set=function(e,r){return this.__data__[e]=O&&void 0===r?t:r,this},A.prototype.clear=function(){this.__data__=[]},A.prototype.delete=function(e){var t=this.__data__,r=I(t,e);return!(r<0)&&(r==t.length-1?t.pop():x.call(t,r,1),!0)},A.prototype.get=function(e){var t=this.__data__,r=I(t,e);return r<0?void 0:t[r][1]},A.prototype.has=function(e){return I(this.__data__,e)>-1},A.prototype.set=function(e,t){var r=this.__data__,i=I(r,e);return i<0?r.push([e,t]):r[i][1]=t,this},N.prototype.clear=function(){this.__data__={hash:new C,map:new(T||A),string:new C}},N.prototype.delete=function(e){return j(this,e).delete(e)},N.prototype.get=function(e){return j(this,e).get(e)},N.prototype.has=function(e){return j(this,e).has(e)},N.prototype.set=function(e,t){return j(this,e).set(e,t),this},R.prototype.add=R.prototype.push=function(e){return this.__data__.set(e,t),this},R.prototype.has=function(e){return this.__data__.has(e)};var P=k&&1/u(new k([,-0]))[1]==1/0?function(e){return new k(e)}:function(){};function j(e,t){var r,i=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?i["string"==typeof t?"string":"hash"]:i.map}function D(e,t){var i=null==e?void 0:e[t];return!(!U(i)||f&&f in i)&&(B(i)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(i)?v:r).test(function(e){if(null!=e){try{return m.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(i))?i:void 0}function L(e){return F(e)||M(e)&&g.call(e,"callee")&&(!w.call(e,"callee")||"[object Arguments]"==y.call(e))||!!(S&&e&&e[S])}var $=function(e,t){return t=E(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,n=E(r.length-t,0),s=Array(n);++i<n;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=s,function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(e,this,a)}}(function(e){return function(e,t,r){var i=-1,n=a,s=e.length,o=!0,c=[],h=c;if(s>=200){var d=P(e);if(d)return u(d);o=!1,n=l,h=new R}else h=c;i:for(;++i<s;){var p=e[i],f=p;if(p=0!==p?p:0,o&&f==f){for(var m=h.length;m--;)if(h[m]===f)continue i;t&&h.push(f),c.push(p)}else n(h,f,void 0)||(h!==c&&h.push(f),c.push(p))}return c}(function e(t,r,i,n,s){var a=-1,o=t.length;for(i||(i=L),s||(s=[]);++a<o;){var l=t[a];r>0&&i(l)?r>1?e(l,r-1,i,n,s):function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}(s,l):n||(s[s.length]=l)}return s}(e,1,M,!0))}),F=Array.isArray;function M(e){var t,r;return!!e&&"object"==typeof e&&null!=(t=e)&&"number"==typeof(r=t.length)&&r>-1&&r%1==0&&r<=0x1fffffffffffff&&!B(t)}function B(e){var t=U(e)?y.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function U(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=$},71506:e=>{var t="__lodash_hash_undefined__",r=/^\[object .+?Constructor\]$/,i="object"==typeof global&&global&&global.Object===Object&&global,n="object"==typeof self&&self&&self.Object===Object&&self,s=i||n||Function("return this")();function a(e,t){return!!(e?e.length:0)&&function(e,t,r){if(t!=t)return function(e,t,r,i){for(var n=e.length,s=-1;++s<n;)if(t(e[s],s,e))return s;return -1}(e,o,0);for(var i=-1,n=e.length;++i<n;)if(e[i]===t)return i;return -1}(e,t,0)>-1}function o(e){return e!=e}function l(e,t){return e.has(t)}function u(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var c=Array.prototype,h=Function.prototype,d=Object.prototype,p=s["__core-js_shared__"],f=function(){var e=/[^.]+$/.exec(p&&p.keys&&p.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),m=h.toString,g=d.hasOwnProperty,y=d.toString,v=RegExp("^"+m.call(g).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),b=c.splice,w=R(s,"Map"),x=R(s,"Set"),S=R(Object,"create");function E(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function T(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function k(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function O(e){var t=-1,r=e?e.length:0;for(this.__data__=new k;++t<r;)this.add(e[t])}function C(e,t){for(var r,i=e.length;i--;)if((r=e[i][0])===t||r!=r&&t!=t)return i;return -1}E.prototype.clear=function(){this.__data__=S?S(null):{}},E.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},E.prototype.get=function(e){var r=this.__data__;if(S){var i=r[e];return i===t?void 0:i}return g.call(r,e)?r[e]:void 0},E.prototype.has=function(e){var t=this.__data__;return S?void 0!==t[e]:g.call(t,e)},E.prototype.set=function(e,r){return this.__data__[e]=S&&void 0===r?t:r,this},T.prototype.clear=function(){this.__data__=[]},T.prototype.delete=function(e){var t=this.__data__,r=C(t,e);return!(r<0)&&(r==t.length-1?t.pop():b.call(t,r,1),!0)},T.prototype.get=function(e){var t=this.__data__,r=C(t,e);return r<0?void 0:t[r][1]},T.prototype.has=function(e){return C(this.__data__,e)>-1},T.prototype.set=function(e,t){var r=this.__data__,i=C(r,e);return i<0?r.push([e,t]):r[i][1]=t,this},k.prototype.clear=function(){this.__data__={hash:new E,map:new(w||T),string:new E}},k.prototype.delete=function(e){return N(this,e).delete(e)},k.prototype.get=function(e){return N(this,e).get(e)},k.prototype.has=function(e){return N(this,e).has(e)},k.prototype.set=function(e,t){return N(this,e).set(e,t),this},O.prototype.add=O.prototype.push=function(e){return this.__data__.set(e,t),this},O.prototype.has=function(e){return this.__data__.has(e)};var A=x&&1/u(new x([,-0]))[1]==1/0?function(e){return new x(e)}:function(){};function N(e,t){var r,i=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?i["string"==typeof t?"string":"hash"]:i.map}function R(e,t){var i,n=null==e?void 0:e[t];return!(!I(n)||f&&f in n)&&("[object Function]"==(i=I(n)?y.call(n):"")||"[object GeneratorFunction]"==i||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(n)?v:r).test(function(e){if(null!=e){try{return m.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(n))?n:void 0}function I(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return e&&e.length?function(e,t,r){var i=-1,n=a,s=e.length,o=!0,c=[],h=c;if(s>=200){var d=A(e);if(d)return u(d);o=!1,n=l,h=new O}else h=c;i:for(;++i<s;){var p=e[i],f=p;if(p=0!==p?p:0,o&&f==f){for(var m=h.length;m--;)if(h[m]===f)continue i;t&&h.push(f),c.push(p)}else n(h,f,void 0)||(h!==c&&h.push(f),c.push(p))}return c}(e):[]}},80747:(e,t,r)=>{e.exports=d,d.Minimatch=p;var i=function(){try{return r(33873)}catch(e){}}()||{sep:"/"};d.sep=i.sep;var n=d.GLOBSTAR=p.GLOBSTAR={},s=r(29e3),a={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},o="[^/]",l=o+"*?",u="().*{}+?[]^$\\!".split("").reduce(function(e,t){return e[t]=!0,e},{}),c=/\/+/;function h(e,t){t=t||{};var r={};return Object.keys(e).forEach(function(t){r[t]=e[t]}),Object.keys(t).forEach(function(e){r[e]=t[e]}),r}function d(e,t,r){return m(t),r||(r={}),(!!r.nocomment||"#"!==t.charAt(0))&&new p(t,r).match(e)}function p(e,t){if(!(this instanceof p))return new p(e,t);m(e),t||(t={}),e=e.trim(),t.allowWindowsEscape||"/"===i.sep||(e=e.split(i.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}function f(e,t){return(t||(t=this instanceof p?this.options:{}),m(e=void 0===e?this.pattern:e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e))?[e]:s(e)}d.filter=function(e,t){return t=t||{},function(r,i,n){return d(r,e,t)}},d.defaults=function(e){if(!e||"object"!=typeof e||!Object.keys(e).length)return d;var t=d,r=function(r,i,n){return t(r,i,h(e,n))};return r.Minimatch=function(r,i){return new t.Minimatch(r,h(e,i))},r.Minimatch.defaults=function(r){return t.defaults(h(e,r)).Minimatch},r.filter=function(r,i){return t.filter(r,h(e,i))},r.defaults=function(r){return t.defaults(h(e,r))},r.makeRe=function(r,i){return t.makeRe(r,h(e,i))},r.braceExpand=function(r,i){return t.braceExpand(r,h(e,i))},r.match=function(r,i,n){return t.match(r,i,h(e,n))},r},p.defaults=function(e){return d.defaults(e).Minimatch},p.prototype.debug=function(){},p.prototype.make=function(){var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0)){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();var r=this.globSet=this.braceExpand();t.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,r),r=this.globParts=r.map(function(e){return e.split(c)}),this.debug(this.pattern,r),r=r.map(function(e,t,r){return e.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(e){return -1===e.indexOf(!1)}),this.debug(this.pattern,r),this.set=r},p.prototype.parseNegate=function(){var e=this.pattern,t=!1,r=this.options,i=0;if(!r.nonegate){for(var n=0,s=e.length;n<s&&"!"===e.charAt(n);n++)t=!t,i++;i&&(this.pattern=e.substr(i)),this.negate=t}},d.braceExpand=function(e,t){return f(e,t)},p.prototype.braceExpand=f;var m=function(e){if("string"!=typeof e)throw TypeError("invalid pattern");if(e.length>65536)throw TypeError("pattern is too long")};p.prototype.parse=function(e,t){m(e);var r=this.options;if("**"===e){if(!r.noglobstar)return n;e="*"}if(""===e)return"";var i="",s=!!r.nocase,c=!1,h=[],d=[],p=!1,f=-1,y=-1,v="."===e.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",b=this;function w(){if(x){switch(x){case"*":i+=l,s=!0;break;case"?":i+=o,s=!0;break;default:i+="\\"+x}b.debug("clearStateChar %j %j",x,i),x=!1}}for(var x,S,E=0,T=e.length;E<T&&(S=e.charAt(E));E++){if(this.debug("%s	%s %s %j",e,E,i,S),c&&u[S]){i+="\\"+S,c=!1;continue}switch(S){case"/":return!1;case"\\":w(),c=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,E,i,S),p){this.debug("  in class"),"!"===S&&E===y+1&&(S="^"),i+=S;continue}b.debug("call clearStateChar %j",x),w(),x=S,r.noext&&w();continue;case"(":if(p){i+="(";continue}if(!x){i+="\\(";continue}h.push({type:x,start:E-1,reStart:i.length,open:a[x].open,close:a[x].close}),i+="!"===x?"(?:(?!(?:":"(?:",this.debug("plType %j %j",x,i),x=!1;continue;case")":if(p||!h.length){i+="\\)";continue}w(),s=!0;var k=h.pop();i+=k.close,"!"===k.type&&d.push(k),k.reEnd=i.length;continue;case"|":if(p||!h.length||c){i+="\\|",c=!1;continue}w(),i+="|";continue;case"[":if(w(),p){i+="\\"+S;continue}p=!0,y=E,f=i.length,i+=S;continue;case"]":if(E===y+1||!p){i+="\\"+S,c=!1;continue}var O=e.substring(y+1,E);try{RegExp("["+O+"]")}catch(e){var C=this.parse(O,g);i=i.substr(0,f)+"\\["+C[0]+"\\]",s=s||C[1],p=!1;continue}s=!0,p=!1,i+=S;continue;default:w(),c?c=!1:u[S]&&!("^"===S&&p)&&(i+="\\"),i+=S}}for(p&&(O=e.substr(y+1),C=this.parse(O,g),i=i.substr(0,f)+"\\["+C[0],s=s||C[1]),k=h.pop();k;k=h.pop()){var A=i.slice(k.reStart+k.open.length);this.debug("setting tail",i,k),A=A.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(e,t,r){return r||(r="\\"),t+t+r+"|"}),this.debug("tail=%j\n   %s",A,A,k,i);var N="*"===k.type?l:"?"===k.type?o:"\\"+k.type;s=!0,i=i.slice(0,k.reStart)+N+"\\("+A}w(),c&&(i+="\\\\");var R=!1;switch(i.charAt(0)){case"[":case".":case"(":R=!0}for(var I=d.length-1;I>-1;I--){var P=d[I],j=i.slice(0,P.reStart),D=i.slice(P.reStart,P.reEnd-8),L=i.slice(P.reEnd-8,P.reEnd),$=i.slice(P.reEnd);L+=$;var F=j.split("(").length-1,M=$;for(E=0;E<F;E++)M=M.replace(/\)[+*?]?/,"");var B="";""===($=M)&&t!==g&&(B="$"),i=j+D+$+B+L}if(""!==i&&s&&(i="(?=.)"+i),R&&(i=v+i),t===g)return[i,s];if(!s)return e.replace(/\\(.)/g,"$1");var U=r.nocase?"i":"";try{var z=RegExp("^"+i+"$",U)}catch(e){return RegExp("$.")}return z._glob=e,z._src=i,z};var g={};d.makeRe=function(e,t){return new p(e,t||{}).makeRe()},p.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,r=t.noglobstar?l:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",i=t.nocase?"i":"",s=e.map(function(e){return e.map(function(e){return e===n?r:"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e._src}).join("\\/")}).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,i)}catch(e){this.regexp=!1}return this.regexp},d.match=function(e,t,r){var i=new p(t,r=r||{});return e=e.filter(function(e){return i.match(e)}),i.options.nonull&&!e.length&&e.push(t),e},p.prototype.match=function(e,t){if(void 0===t&&(t=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var r,n,s=this.options;"/"!==i.sep&&(e=e.split(i.sep).join("/")),e=e.split(c),this.debug(this.pattern,"split",e);var a=this.set;for(this.debug(this.pattern,"set",a),n=e.length-1;n>=0&&!(r=e[n]);n--);for(n=0;n<a.length;n++){var o=a[n],l=e;if(s.matchBase&&1===o.length&&(l=[r]),this.matchOne(l,o,t)){if(s.flipNegate)return!0;return!this.negate}}return!s.flipNegate&&this.negate},p.prototype.matchOne=function(e,t,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var s=0,a=0,o=e.length,l=t.length;s<o&&a<l;s++,a++){this.debug("matchOne loop");var u,c=t[a],h=e[s];if(this.debug(t,c,h),!1===c)return!1;if(c===n){this.debug("GLOBSTAR",[t,c,h]);var d=s,p=a+1;if(p===l){for(this.debug("** at the end");s<o;s++)if("."===e[s]||".."===e[s]||!i.dot&&"."===e[s].charAt(0))return!1;return!0}for(;d<o;){var f=e[d];if(this.debug("\nglobstar while",e,d,t,p,f),this.matchOne(e.slice(d),t.slice(p),r))return this.debug("globstar found match!",d,o,f),!0;if("."===f||".."===f||!i.dot&&"."===f.charAt(0)){this.debug("dot detected!",e,d,t,p);break}this.debug("globstar swallow a segment, and continue"),d++}if(r&&(this.debug("\n>>> no match, partial?",e,d,t,p),d===o))return!0;return!1}if("string"==typeof c?(u=h===c,this.debug("string match",c,h,u)):(u=h.match(c),this.debug("pattern match",c,h,u)),!u)return!1}if(s===o&&a===l)return!0;if(s===o)return r;if(a===l)return s===o-1&&""===e[s];throw Error("wtf?")}},5358:e=>{let t="object"==typeof process&&process&&"win32"===process.platform;e.exports=t?{sep:"\\"}:{sep:"/"}},75065:(e,t,r)=>{let i=e.exports=(e,t,r={})=>(g(t),(!!r.nocomment||"#"!==t.charAt(0))&&new S(t,r).match(e));e.exports=i;let n=r(5358);i.sep=n.sep;let s=Symbol("globstar **");i.GLOBSTAR=s;let a=r(2561),o={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},l="[^/]",u=l+"*?",c=e=>e.split("").reduce((e,t)=>(e[t]=!0,e),{}),h=c("().*{}+?[]^$\\!"),d=c("[.("),p=/\/+/;i.filter=(e,t={})=>(r,n,s)=>i(r,e,t);let f=(e,t={})=>{let r={};return Object.keys(e).forEach(t=>r[t]=e[t]),Object.keys(t).forEach(e=>r[e]=t[e]),r};i.defaults=e=>{if(!e||"object"!=typeof e||!Object.keys(e).length)return i;let t=i,r=(r,i,n)=>t(r,i,f(e,n));return r.Minimatch=class extends t.Minimatch{constructor(t,r){super(t,f(e,r))}},r.Minimatch.defaults=r=>t.defaults(f(e,r)).Minimatch,r.filter=(r,i)=>t.filter(r,f(e,i)),r.defaults=r=>t.defaults(f(e,r)),r.makeRe=(r,i)=>t.makeRe(r,f(e,i)),r.braceExpand=(r,i)=>t.braceExpand(r,f(e,i)),r.match=(r,i,n)=>t.match(r,i,f(e,n)),r},i.braceExpand=(e,t)=>m(e,t);let m=(e,t={})=>(g(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e))?[e]:a(e),g=e=>{if("string"!=typeof e)throw TypeError("invalid pattern");if(e.length>65536)throw TypeError("pattern is too long")},y=Symbol("subparse");i.makeRe=(e,t)=>new S(e,t||{}).makeRe(),i.match=(e,t,r={})=>{let i=new S(t,r);return e=e.filter(e=>i.match(e)),i.options.nonull&&!e.length&&e.push(t),e};let v=e=>e.replace(/\\(.)/g,"$1"),b=e=>e.replace(/\\([^-\]])/g,"$1"),w=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),x=e=>e.replace(/[[\]\\]/g,"\\$&");class S{constructor(e,t){g(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||!1===t.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0)){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,r),r=this.globParts=r.map(e=>e.split(p)),this.debug(this.pattern,r),r=r.map((e,t,r)=>e.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(e=>-1===e.indexOf(!1)),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,t=!1,r=0;for(let i=0;i<e.length&&"!"===e.charAt(i);i++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var n=0,a=0,o=e.length,l=t.length;n<o&&a<l;n++,a++){this.debug("matchOne loop");var u,c=t[a],h=e[n];if(this.debug(t,c,h),!1===c)return!1;if(c===s){this.debug("GLOBSTAR",[t,c,h]);var d=n,p=a+1;if(p===l){for(this.debug("** at the end");n<o;n++)if("."===e[n]||".."===e[n]||!i.dot&&"."===e[n].charAt(0))return!1;return!0}for(;d<o;){var f=e[d];if(this.debug("\nglobstar while",e,d,t,p,f),this.matchOne(e.slice(d),t.slice(p),r))return this.debug("globstar found match!",d,o,f),!0;if("."===f||".."===f||!i.dot&&"."===f.charAt(0)){this.debug("dot detected!",e,d,t,p);break}this.debug("globstar swallow a segment, and continue"),d++}if(r&&(this.debug("\n>>> no match, partial?",e,d,t,p),d===o))return!0;return!1}if("string"==typeof c?(u=h===c,this.debug("string match",c,h,u)):(u=h.match(c),this.debug("pattern match",c,h,u)),!u)return!1}if(n===o&&a===l)return!0;if(n===o)return r;if(a===l)return n===o-1&&""===e[n];throw Error("wtf?")}braceExpand(){return m(this.pattern,this.options)}parse(e,t){let r,i,n,a;g(e);let c=this.options;if("**"===e){if(!c.noglobstar)return s;e="*"}if(""===e)return"";let p="",f=!1,m=!1,w=[],S=[],E=!1,T=-1,k=-1,O="."===e.charAt(0),C=c.dot||O,A=e=>"."===e.charAt(0)?"":c.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",N=()=>{if(r){switch(r){case"*":p+=u,f=!0;break;case"?":p+=l,f=!0;break;default:p+="\\"+r}this.debug("clearStateChar %j %j",r,p),r=!1}};for(let t=0,s;t<e.length&&(s=e.charAt(t));t++){if(this.debug("%s	%s %s %j",e,t,p,s),m){if("/"===s)return!1;h[s]&&(p+="\\"),p+=s,m=!1;continue}switch(s){case"/":return!1;case"\\":if(E&&"-"===e.charAt(t+1)){p+=s;continue}N(),m=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,t,p,s),E){this.debug("  in class"),"!"===s&&t===k+1&&(s="^"),p+=s;continue}this.debug("call clearStateChar %j",r),N(),r=s,c.noext&&N();continue;case"(":{if(E){p+="(";continue}if(!r){p+="\\(";continue}let i={type:r,start:t-1,reStart:p.length,open:o[r].open,close:o[r].close};this.debug(this.pattern,"	",i),w.push(i),p+=i.open,0===i.start&&"!"!==i.type&&(O=!0,p+=A(e.slice(t+1))),this.debug("plType %j %j",r,p),r=!1;continue}case")":{let e=w[w.length-1];if(E||!e){p+="\\)";continue}w.pop(),N(),f=!0,p+=(n=e).close,"!"===n.type&&S.push(Object.assign(n,{reEnd:p.length}));continue}case"|":{let r=w[w.length-1];if(E||!r){p+="\\|";continue}N(),p+="|",0===r.start&&"!"!==r.type&&(O=!0,p+=A(e.slice(t+1)));continue}case"[":if(N(),E){p+="\\"+s;continue}E=!0,k=t,T=p.length,p+=s;continue;case"]":if(t===k+1||!E){p+="\\"+s;continue}i=e.substring(k+1,t);try{RegExp("["+x(b(i))+"]"),p+=s}catch(e){p=p.substring(0,T)+"(?:$.)"}f=!0,E=!1;continue;default:N(),h[s]&&!("^"===s&&E)&&(p+="\\"),p+=s}}for(E&&(i=e.slice(k+1),a=this.parse(i,y),p=p.substring(0,T)+"\\["+a[0],f=f||a[1]),n=w.pop();n;n=w.pop()){let e;e=p.slice(n.reStart+n.open.length),this.debug("setting tail",p,n),e=e.replace(/((?:\\{2}){0,64})(\\?)\|/g,(e,t,r)=>(r||(r="\\"),t+t+r+"|")),this.debug("tail=%j\n   %s",e,e,n,p);let t="*"===n.type?u:"?"===n.type?l:"\\"+n.type;f=!0,p=p.slice(0,n.reStart)+t+"\\("+e}N(),m&&(p+="\\\\");let R=d[p.charAt(0)];for(let e=S.length-1;e>-1;e--){let r=S[e],i=p.slice(0,r.reStart),n=p.slice(r.reStart,r.reEnd-8),s=p.slice(r.reEnd),a=p.slice(r.reEnd-8,r.reEnd)+s,o=i.split(")").length,l=i.split("(").length-o,u=s;for(let e=0;e<l;e++)u=u.replace(/\)[+*?]?/,"");let c=""===(s=u)&&t!==y?"(?:$|\\/)":"";p=i+n+s+c+a}if(""!==p&&f&&(p="(?=.)"+p),R&&(p=(O?"":C?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)")+p),t===y)return[p,f];if(c.nocase&&!f&&(f=e.toUpperCase()!==e.toLowerCase()),!f)return v(e);let I=c.nocase?"i":"";try{return Object.assign(RegExp("^"+p+"$",I),{_glob:e,_src:p})}catch(e){return RegExp("$.")}}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,r=t.noglobstar?u:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",i=t.nocase?"i":"",n=e.map(e=>((e=e.map(e=>"string"==typeof e?w(e):e===s?s:e._src).reduce((e,t)=>(e[e.length-1]===s&&t===s||e.push(t),e),[])).forEach((t,i)=>{t===s&&e[i-1]!==s&&(0===i?e.length>1?e[i+1]="(?:\\/|"+r+"\\/)?"+e[i+1]:e[i]=r:i===e.length-1?e[i-1]+="(?:\\/|"+r+")?":(e[i-1]+="(?:\\/|\\/"+r+"\\/)"+e[i+1],e[i+1]=s))}),e.filter(e=>e!==s).join("/"))).join("|");n="^(?:"+n+")$",this.negate&&(n="^(?!"+n+").*$");try{this.regexp=new RegExp(n,i)}catch(e){this.regexp=!1}return this.regexp}match(e,t=this.partial){let r;if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;let i=this.options;"/"!==n.sep&&(e=e.split(n.sep).join("/")),e=e.split(p),this.debug(this.pattern,"split",e);let s=this.set;this.debug(this.pattern,"set",s);for(let t=e.length-1;t>=0&&!(r=e[t]);t--);for(let n=0;n<s.length;n++){let a=s[n],o=e;if(i.matchBase&&1===a.length&&(o=[r]),this.matchOne(o,a,t)){if(i.flipNegate)return!0;return!this.negate}}return!i.flipNegate&&this.negate}static defaults(e){return i.defaults(e).Minimatch}}i.Minimatch=S},47734:(e,t,r)=>{var i=r(33873),n=r(29021),s=parseInt("0777",8);function a(e,t,r,o){"function"==typeof t?(r=t,t={}):t&&"object"==typeof t||(t={mode:t});var l=t.mode,u=t.fs||n;void 0===l&&(l=s),o||(o=null);var c=r||function(){};e=i.resolve(e),u.mkdir(e,l,function(r){if(!r)return c(null,o=o||e);if("ENOENT"===r.code){if(i.dirname(e)===e)return c(r);a(i.dirname(e),t,function(r,i){r?c(r,i):a(e,t,c,i)})}else u.stat(e,function(e,t){e||!t.isDirectory()?c(r,o):c(null,o)})})}e.exports=a.mkdirp=a.mkdirP=a,a.sync=function e(t,r,a){r&&"object"==typeof r||(r={mode:r});var o,l=r.mode,u=r.fs||n;void 0===l&&(l=s),a||(a=null),t=i.resolve(t);try{u.mkdirSync(t,l),a=a||t}catch(n){if("ENOENT"===n.code)a=e(i.dirname(t),r,a),e(t,r,a);else{try{o=u.statSync(t)}catch(e){throw n}if(!o.isDirectory())throw n}}return a}},82971:e=>{"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab=__dirname+"/"),({189:function(){!function(e,t){"use strict";if(!e.setImmediate){var r,i,n,s,a,o=1,l={},u=!1,c=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);(h=h&&h.setTimeout?h:e,"[object process]"===({}).toString.call(e.process))?a=function(e){process.nextTick(function(){p(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(r="setImmediate$"+Math.random()+"$",i=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(r)&&p(+t.data.slice(r.length))},e.addEventListener?e.addEventListener("message",i,!1):e.attachEvent("onmessage",i),a=function(t){e.postMessage(r+t,"*")}):e.MessageChannel?((n=new MessageChannel).port1.onmessage=function(e){p(e.data)},a=function(e){n.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(s=c.documentElement,a=function(e){var t=c.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,s.removeChild(t),t=null},s.appendChild(t)}):a=function(e){setTimeout(p,0,e)},h.setImmediate=function(e){"function"!=typeof e&&(e=Function(""+e));for(var t=Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var i={callback:e,args:t};return l[o]=i,a(o),o++},h.clearImmediate=d}function d(e){delete l[e]}function p(e){if(u)setTimeout(p,0,e);else{var r=l[e];if(r){u=!0;try{!function(e){var r=e.callback,i=e.args;switch(i.length){case 0:r();break;case 1:r(i[0]);break;case 2:r(i[0],i[1]);break;case 3:r(i[0],i[1],i[2]);break;default:r.apply(t,i)}}(r)}finally{d(e),u=!1}}}}}("undefined"==typeof self?"undefined"==typeof global?this:global:self)}})[189](),e.exports={}},94287:(e,t,r)=>{"use strict";e.exports=r(44870)},13498:e=>{e.exports=function(e,t){if("string"!=typeof e)throw TypeError("expected path to be a string");if("\\"===e||"/"===e)return"/";var r=e.length;if(r<=1)return e;var i="";if(r>4&&"\\"===e[3]){var n=e[2];("?"===n||"."===n)&&"\\\\"===e.slice(0,2)&&(e=e.slice(2),i="//")}var s=e.split(/[/\\]+/);return!1!==t&&""===s[s.length-1]&&s.pop(),i+s.join("/")}},15075:(e,t,r)=>{var i=r(57083);function n(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function s(e){var t=function(){if(t.called)throw Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}e.exports=i(n),e.exports.strict=i(s),n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return s(this)},configurable:!0})})},74848:(e,t,r)=>{"use strict";var i=r(80713).assign,n=r(6743),s=r(14411),a=r(30757),o={};i(o,n,s,a),e.exports=o},6743:(e,t,r)=>{"use strict";var i=r(76875),n=r(80713),s=r(7992),a=r(22642),o=r(49578),l=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=n.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t,r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var c=i.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(0!==c)throw Error(a[c]);if(r.header&&i.deflateSetHeader(this.strm,r.header),r.dictionary){if(t="string"==typeof r.dictionary?s.string2buf(r.dictionary):"[object ArrayBuffer]"===l.call(r.dictionary)?new Uint8Array(r.dictionary):r.dictionary,0!==(c=i.deflateSetDictionary(this.strm,t)))throw Error(a[c]);this._dict_set=!0}}function c(e,t){var r=new u(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}u.prototype.push=function(e,t){var r,a,o=this.strm,u=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new n.Buf8(u),o.next_out=0,o.avail_out=u),1!==(r=i.deflate(o,a))&&0!==r)return this.onEnd(r),this.ended=!0,!1;(0===o.avail_out||0===o.avail_in&&(4===a||2===a))&&("string"===this.options.to?this.onData(s.buf2binstring(n.shrinkBuf(o.output,o.next_out))):this.onData(n.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==r);return 4===a?(r=i.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):(2===a&&(this.onEnd(0),o.avail_out=0),!0)},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=u,t.deflate=c,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,c(e,t)}},14411:(e,t,r)=>{"use strict";var i=r(2727),n=r(80713),s=r(7992),a=r(30757),o=r(22642),l=r(49578),u=r(87326),c=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits)==0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=i.inflateInit2(this.strm,t.windowBits);if(r!==a.Z_OK||(this.header=new u,i.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=s.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=i.inflateSetDictionary(this.strm,t.dictionary))!==a.Z_OK)))throw Error(o[r])}function d(e,t){var r=new h(t);if(r.push(e,!0),r.err)throw r.msg||o[r.err];return r.result}h.prototype.push=function(e,t){var r,o,l,u,h,d=this.strm,p=this.options.chunkSize,f=this.options.dictionary,m=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?d.input=s.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new n.Buf8(p),d.next_out=0,d.avail_out=p),(r=i.inflate(d,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&f&&(r=i.inflateSetDictionary(this.strm,f)),r===a.Z_BUF_ERROR&&!0===m&&(r=a.Z_OK,m=!1),r!==a.Z_STREAM_END&&r!==a.Z_OK)return this.onEnd(r),this.ended=!0,!1;d.next_out&&(0===d.avail_out||r===a.Z_STREAM_END||0===d.avail_in&&(o===a.Z_FINISH||o===a.Z_SYNC_FLUSH))&&("string"===this.options.to?(l=s.utf8border(d.output,d.next_out),u=d.next_out-l,h=s.buf2string(d.output,l),d.next_out=u,d.avail_out=p-u,u&&n.arraySet(d.output,d.output,l,u,0),this.onData(h)):this.onData(n.shrinkBuf(d.output,d.next_out))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&r!==a.Z_STREAM_END);return(r===a.Z_STREAM_END&&(o=a.Z_FINISH),o===a.Z_FINISH)?(r=i.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===a.Z_OK):(o===a.Z_SYNC_FLUSH&&(this.onEnd(a.Z_OK),d.avail_out=0),!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=h,t.inflate=d,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},t.ungzip=d},80713:(e,t)=>{"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw TypeError(r+"must be non-object");for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,i,n){if(t.subarray&&e.subarray){e.set(t.subarray(r,r+i),n);return}for(var s=0;s<i;s++)e[n+s]=t[r+s]},flattenChunks:function(e){var t,r,i,n,s,a;for(t=0,i=0,r=e.length;t<r;t++)i+=e[t].length;for(t=0,a=new Uint8Array(i),n=0,r=e.length;t<r;t++)s=e[t],a.set(s,n),n+=s.length;return a}},n={arraySet:function(e,t,r,i,n){for(var s=0;s<i;s++)e[n+s]=t[r+s]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,n))},t.setTyped(r)},7992:(e,t,r)=>{"use strict";var i=r(80713),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var a=new i.Buf8(256),o=0;o<256;o++)a[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&s||!e.subarray&&n))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var r="",a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r}a[254]=a[254]=1,t.string2buf=function(e){var t,r,n,s,a,o=e.length,l=0;for(s=0;s<o;s++)(64512&(r=e.charCodeAt(s)))==55296&&s+1<o&&(64512&(n=e.charCodeAt(s+1)))==56320&&(r=65536+(r-55296<<10)+(n-56320),s++),l+=r<128?1:r<2048?2:r<65536?3:4;for(a=0,t=new i.Buf8(l),s=0;a<l;s++)(64512&(r=e.charCodeAt(s)))==55296&&s+1<o&&(64512&(n=e.charCodeAt(s+1)))==56320&&(r=65536+(r-55296<<10)+(n-56320),s++),r<128?t[a++]=r:(r<2048?t[a++]=192|r>>>6:(r<65536?t[a++]=224|r>>>12:(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63),t[a++]=128|r>>>6&63),t[a++]=128|63&r);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new i.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,i,n,s,o=t||e.length,u=Array(2*o);for(i=0,r=0;r<o;){if((n=e[r++])<128){u[i++]=n;continue}if((s=a[n])>4){u[i++]=65533,r+=s-1;continue}for(n&=2===s?31:3===s?15:7;s>1&&r<o;)n=n<<6|63&e[r++],s--;if(s>1){u[i++]=65533;continue}n<65536?u[i++]=n:(n-=65536,u[i++]=55296|n>>10&1023,u[i++]=56320|1023&n)}return l(u,i)},t.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&(192&e[r])==128;)r--;return r<0||0===r?t:r+a[e[r]]>t?r:t}},82929:e=>{"use strict";e.exports=function(e,t,r,i){for(var n=65535&e|0,s=e>>>16&65535|0,a=0;0!==r;){a=r>2e3?2e3:r,r-=a;do s=s+(n=n+t[i++]|0)|0;while(--a);n%=65521,s%=65521}return n|s<<16|0}},30757:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},78063:e=>{"use strict";var t=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?0xedb88320^e>>>1:e>>>1;t[r]=e}return t}();e.exports=function(e,r,i,n){var s=n+i;e^=-1;for(var a=n;a<s;a++)e=e>>>8^t[(e^r[a])&255];return -1^e}},76875:(e,t,r)=>{"use strict";var i,n=r(80713),s=r(43109),a=r(82929),o=r(78063),l=r(22642);function u(e,t){return e.msg=l[t],t}function c(e){return(e<<1)-(e>4?9:0)}function h(e){for(var t=e.length;--t>=0;)e[t]=0}function d(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(n.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function p(e,t){s._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,d(e.strm)}function f(e,t){e.pending_buf[e.pending++]=t}function m(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function g(e,t){var r,i,n=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,u=e.window,c=e.w_mask,h=e.prev,d=e.strstart+258,p=u[s+a-1],f=u[s+a];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do{if(u[(r=t)+a]!==f||u[r+a-1]!==p||u[r]!==u[s]||u[++r]!==u[s+1])continue;s+=2,r++;do;while(u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&s<d);if(i=258-(d-s),s=d-258,i>a){if(e.match_start=t,a=i,i>=o)break;p=u[s+a-1],f=u[s+a]}}while((t=h[t&c])>l&&0!=--n);return a<=e.lookahead?a:e.lookahead}function y(e){var t,r,i,s,l,u=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=u+(u-262)){n.arraySet(e.window,e.window,u,u,0),e.match_start-=u,e.strstart-=u,e.block_start-=u,t=r=e.hash_size;do i=e.head[--t],e.head[t]=i>=u?i-u:0;while(--r);t=r=u;do i=e.prev[--t],e.prev[t]=i>=u?i-u:0;while(--r);s+=u}if(0===e.strm.avail_in)break;if(r=function(e,t,r,i){var s=e.avail_in;return(s>i&&(s=i),0===s)?0:(e.avail_in-=s,n.arraySet(t,e.input,e.next_in,s,r),1===e.state.wrap?e.adler=a(e.adler,t,s,r):2===e.state.wrap&&(e.adler=o(e.adler,t,s,r)),e.next_in+=s,e.total_in+=s,s)}(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function v(e,t){for(var r,i;;){if(e.lookahead<262){if(y(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-262&&(e.match_length=g(e,r)),e.match_length>=3){if(i=s._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask}else i=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(p(e,!1),0===e.strm.avail_out))return 1}return(e.insert=e.strstart<2?e.strstart:2,4===t)?(p(e,!0),0===e.strm.avail_out)?3:4:e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}function b(e,t){for(var r,i,n;;){if(e.lookahead<262){if(y(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-262&&(e.match_length=g(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,i=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(p(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=s._tr_tally(e,0,e.window[e.strstart-1]))&&p(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return(e.match_available&&(i=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t)?(p(e,!0),0===e.strm.avail_out)?3:4:e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}function w(e,t,r,i,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=i,this.func=n}function x(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(1146),this.dyn_dtree=new n.Buf16(122),this.bl_tree=new n.Buf16(78),h(this.dyn_ltree),h(this.dyn_dtree),h(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(16),this.heap=new n.Buf16(573),h(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(573),h(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function S(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,s._tr_init(t),0):u(e,-2)}function E(e){var t,r=S(e);return 0===r&&((t=e.state).window_size=2*t.w_size,h(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function T(e,t,r,i,s,a){if(!e)return -2;var o=1;if(-1===t&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),s<1||s>9||8!==r||i<8||i>15||t<0||t>9||a<0||a>4)return u(e,-2);8===i&&(i=9);var l=new x;return e.state=l,l.strm=e,l.wrap=o,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new n.Buf8(2*l.w_size),l.head=new n.Buf16(l.hash_size),l.prev=new n.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new n.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=r,E(e)}i=[new w(0,0,0,0,function(e,t){var r=65535;for(65535>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(y(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+r;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,p(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-262&&(p(e,!1),0===e.strm.avail_out))return 1}return(e.insert=0,4===t)?(p(e,!0),0===e.strm.avail_out)?3:4:(e.strstart>e.block_start&&(p(e,!1),e.strm.avail_out),1)}),new w(4,4,8,4,v),new w(4,5,16,8,v),new w(4,6,32,32,v),new w(4,4,16,16,b),new w(8,16,32,32,b),new w(8,16,128,128,b),new w(8,32,128,256,b),new w(32,128,258,1024,b),new w(32,258,258,4096,b)],t.deflateInit=function(e,t){return T(e,t,8,15,8,0)},t.deflateInit2=T,t.deflateReset=E,t.deflateResetKeep=S,t.deflateSetHeader=function(e,t){return e&&e.state&&2===e.state.wrap?(e.state.gzhead=t,0):-2},t.deflate=function(e,t){if(!e||!e.state||t>5||t<0)return e?u(e,-2):-2;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&4!==t)return u(e,0===e.avail_out?-5:-2);if(n.strm=e,r=n.last_flush,n.last_flush=t,42===n.status){if(2===n.wrap)e.adler=0,f(n,31),f(n,139),f(n,8),n.gzhead?(f(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),f(n,255&n.gzhead.time),f(n,n.gzhead.time>>8&255),f(n,n.gzhead.time>>16&255),f(n,n.gzhead.time>>24&255),f(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),f(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(f(n,255&n.gzhead.extra.length),f(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=o(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(f(n,0),f(n,0),f(n,0),f(n,0),f(n,0),f(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),f(n,3),n.status=113);else{var r,n,a,l,g=8+(n.w_bits-8<<4)<<8;g|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(g|=32),g+=31-g%31,n.status=113,m(n,g),0!==n.strstart&&(m(n,e.adler>>>16),m(n,65535&e.adler)),e.adler=1}}if(69===n.status){if(n.gzhead.extra){for(a=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),d(e),a=n.pending,n.pending!==n.pending_buf_size));)f(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73}if(73===n.status){if(n.gzhead.name){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),d(e),a=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,f(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),0===l&&(n.gzindex=0,n.status=91)}else n.status=91}if(91===n.status){if(n.gzhead.comment){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),d(e),a=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,f(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),0===l&&(n.status=103)}else n.status=103}if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&d(e),n.pending+2<=n.pending_buf_size&&(f(n,255&e.adler),f(n,e.adler>>8&255),e.adler=0,n.status=113)):n.status=113),0!==n.pending){if(d(e),0===e.avail_out)return n.last_flush=-1,0}else if(0===e.avail_in&&c(t)<=c(r)&&4!==t)return u(e,-5);if(666===n.status&&0!==e.avail_in)return u(e,-5);if(0!==e.avail_in||0!==n.lookahead||0!==t&&666!==n.status){var v=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(y(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(p(e,!1),0===e.strm.avail_out))return 1}return(e.insert=0,4===t)?(p(e,!0),0===e.strm.avail_out)?3:4:e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var r,i,n,a,o=e.window;;){if(e.lookahead<=258){if(y(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=o[n=e.strstart-1])===o[++n]&&i===o[++n]&&i===o[++n]){a=e.strstart+258;do;while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<a);e.match_length=258-(a-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=s._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(p(e,!1),0===e.strm.avail_out))return 1}return(e.insert=0,4===t)?(p(e,!0),0===e.strm.avail_out)?3:4:e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}(n,t):i[n.level].func(n,t);if((3===v||4===v)&&(n.status=666),1===v||3===v)return 0===e.avail_out&&(n.last_flush=-1),0;if(2===v&&(1===t?s._tr_align(n):5!==t&&(s._tr_stored_block(n,0,0,!1),3===t&&(h(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),d(e),0===e.avail_out))return n.last_flush=-1,0}return 4!==t?0:n.wrap<=0?1:(2===n.wrap?(f(n,255&e.adler),f(n,e.adler>>8&255),f(n,e.adler>>16&255),f(n,e.adler>>24&255),f(n,255&e.total_in),f(n,e.total_in>>8&255),f(n,e.total_in>>16&255),f(n,e.total_in>>24&255)):(m(n,e.adler>>>16),m(n,65535&e.adler)),d(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?u(e,-2):(e.state=null,113===t?u(e,-3):0):-2},t.deflateSetDictionary=function(e,t){var r,i,s,o,l,u,c,d,p=t.length;if(!e||!e.state||2===(o=(r=e.state).wrap)||1===o&&42!==r.status||r.lookahead)return -2;for(1===o&&(e.adler=a(e.adler,t,p,0)),r.wrap=0,p>=r.w_size&&(0===o&&(h(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new n.Buf8(r.w_size),n.arraySet(d,t,p-r.w_size,r.w_size,0),t=d,p=r.w_size),l=e.avail_in,u=e.next_in,c=e.input,e.avail_in=p,e.next_in=0,e.input=t,y(r);r.lookahead>=3;){i=r.strstart,s=r.lookahead-2;do r.ins_h=(r.ins_h<<r.hash_shift^r.window[i+3-1])&r.hash_mask,r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++;while(--s);r.strstart=i,r.lookahead=2,y(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=u,e.input=c,e.avail_in=l,r.wrap=o,0},t.deflateInfo="pako deflate (from Nodeca project)"},87326:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},9441:e=>{"use strict";e.exports=function(e,t){var r,i,n,s,a,o,l,u,c,h,d,p,f,m,g,y,v,b,w,x,S,E,T,k,O;r=e.state,i=e.next_in,k=e.input,n=i+(e.avail_in-5),s=e.next_out,O=e.output,a=s-(t-e.avail_out),o=s+(e.avail_out-257),l=r.dmax,u=r.wsize,c=r.whave,h=r.wnext,d=r.window,p=r.hold,f=r.bits,m=r.lencode,g=r.distcode,y=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;n:do for(f<15&&(p+=k[i++]<<f,f+=8,p+=k[i++]<<f,f+=8),b=m[p&y];;){if(p>>>=w=b>>>24,f-=w,0==(w=b>>>16&255))O[s++]=65535&b;else if(16&w)for(x=65535&b,(w&=15)&&(f<w&&(p+=k[i++]<<f,f+=8),x+=p&(1<<w)-1,p>>>=w,f-=w),f<15&&(p+=k[i++]<<f,f+=8,p+=k[i++]<<f,f+=8),b=g[p&v];;){if(p>>>=w=b>>>24,f-=w,16&(w=b>>>16&255)){if(S=65535&b,f<(w&=15)&&(p+=k[i++]<<f,(f+=8)<w&&(p+=k[i++]<<f,f+=8)),(S+=p&(1<<w)-1)>l){e.msg="invalid distance too far back",r.mode=30;break n}if(p>>>=w,f-=w,S>(w=s-a)){if((w=S-w)>c&&r.sane){e.msg="invalid distance too far back",r.mode=30;break n}if(E=0,T=d,0===h){if(E+=u-w,w<x){x-=w;do O[s++]=d[E++];while(--w);E=s-S,T=O}}else if(h<w){if(E+=u+h-w,(w-=h)<x){x-=w;do O[s++]=d[E++];while(--w);if(E=0,h<x){x-=w=h;do O[s++]=d[E++];while(--w);E=s-S,T=O}}}else if(E+=h-w,w<x){x-=w;do O[s++]=d[E++];while(--w);E=s-S,T=O}for(;x>2;)O[s++]=T[E++],O[s++]=T[E++],O[s++]=T[E++],x-=3;x&&(O[s++]=T[E++],x>1&&(O[s++]=T[E++]))}else{E=s-S;do O[s++]=O[E++],O[s++]=O[E++],O[s++]=O[E++],x-=3;while(x>2);x&&(O[s++]=O[E++],x>1&&(O[s++]=O[E++]))}}else if((64&w)==0){b=g[(65535&b)+(p&(1<<w)-1)];continue}else{e.msg="invalid distance code",r.mode=30;break n}break}else if((64&w)==0){b=m[(65535&b)+(p&(1<<w)-1)];continue}else if(32&w){r.mode=12;break n}else{e.msg="invalid literal/length code",r.mode=30;break n}break}while(i<n&&s<o);i-=x=f>>3,f-=x<<3,p&=(1<<f)-1,e.next_in=i,e.next_out=s,e.avail_in=i<n?5+(n-i):5-(i-n),e.avail_out=s<o?257+(o-s):257-(s-o),r.hold=p,r.bits=f}},2727:(e,t,r)=>{"use strict";var i,n,s=r(80713),a=r(82929),o=r(78063),l=r(9441),u=r(5406);function c(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function h(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new s.Buf32(852),t.distcode=t.distdyn=new s.Buf32(592),t.sane=1,t.back=-1,0):-2}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):-2}function f(e,t){var r,i;return e&&e.state?(i=e.state,t<0?(r=0,t=-t):(r=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15))?-2:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,p(e)):-2}function m(e,t){var r,i;return e?(i=new h,e.state=i,i.window=null,0!==(r=f(e,t))&&(e.state=null),r):-2}var g=!0;function y(e,t,r,i){var n,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new s.Buf8(a.wsize)),i>=a.wsize?(s.arraySet(a.window,t,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((n=a.wsize-a.wnext)>i&&(n=i),s.arraySet(a.window,t,r-i,n,a.wnext),(i-=n)?(s.arraySet(a.window,t,r-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=n,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=n))),0}t.inflateReset=p,t.inflateReset2=f,t.inflateResetKeep=d,t.inflateInit=function(e){return m(e,15)},t.inflateInit2=m,t.inflate=function(e,t){var r,h,d,p,f,m,v,b,w,x,S,E,T,k,O,C,A,N,R,I,P,j,D,L,$=0,F=new s.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return -2;12===(r=e.state).mode&&(r.mode=13),f=e.next_out,d=e.output,v=e.avail_out,p=e.next_in,h=e.input,m=e.avail_in,b=r.hold,w=r.bits,x=m,S=v,j=0;s:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;w<16;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}if(2&r.wrap&&35615===b){r.check=0,F[0]=255&b,F[1]=b>>>8&255,r.check=o(r.check,F,2,0),b=0,w=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&b)<<8)+(b>>8))%31){e.msg="incorrect header check",r.mode=30;break}if((15&b)!=8){e.msg="unknown compression method",r.mode=30;break}if(b>>>=4,w-=4,P=(15&b)+8,0===r.wbits)r.wbits=P;else if(P>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<P,e.adler=r.check=1,r.mode=512&b?10:12,b=0,w=0;break;case 2:for(;w<16;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}if(r.flags=b,(255&r.flags)!=8){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=b>>8&1),512&r.flags&&(F[0]=255&b,F[1]=b>>>8&255,r.check=o(r.check,F,2,0)),b=0,w=0,r.mode=3;case 3:for(;w<32;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}r.head&&(r.head.time=b),512&r.flags&&(F[0]=255&b,F[1]=b>>>8&255,F[2]=b>>>16&255,F[3]=b>>>24&255,r.check=o(r.check,F,4,0)),b=0,w=0,r.mode=4;case 4:for(;w<16;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}r.head&&(r.head.xflags=255&b,r.head.os=b>>8),512&r.flags&&(F[0]=255&b,F[1]=b>>>8&255,r.check=o(r.check,F,2,0)),b=0,w=0,r.mode=5;case 5:if(1024&r.flags){for(;w<16;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}r.length=b,r.head&&(r.head.extra_len=b),512&r.flags&&(F[0]=255&b,F[1]=b>>>8&255,r.check=o(r.check,F,2,0)),b=0,w=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((E=r.length)>m&&(E=m),E&&(r.head&&(P=r.head.extra_len-r.length,r.head.extra||(r.head.extra=Array(r.head.extra_len)),s.arraySet(r.head.extra,h,p,E,P)),512&r.flags&&(r.check=o(r.check,h,E,p)),m-=E,p+=E,r.length-=E),r.length))break s;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===m)break s;E=0;do P=h[p+E++],r.head&&P&&r.length<65536&&(r.head.name+=String.fromCharCode(P));while(P&&E<m);if(512&r.flags&&(r.check=o(r.check,h,E,p)),m-=E,p+=E,P)break s}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===m)break s;E=0;do P=h[p+E++],r.head&&P&&r.length<65536&&(r.head.comment+=String.fromCharCode(P));while(P&&E<m);if(512&r.flags&&(r.check=o(r.check,h,E,p)),m-=E,p+=E,P)break s}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;w<16;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}if(b!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}b=0,w=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;w<32;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}e.adler=r.check=c(b),b=0,w=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=f,e.avail_out=v,e.next_in=p,e.avail_in=m,r.hold=b,r.bits=w,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break s;case 13:if(r.last){b>>>=7&w,w-=7&w,r.mode=27;break}for(;w<3;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}switch(r.last=1&b,w-=1,3&(b>>>=1)){case 0:r.mode=14;break;case 1:if(function(e){if(g){var t;for(i=new s.Buf32(512),n=new s.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(u(1,e.lens,0,288,i,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;u(2,e.lens,0,32,n,0,e.work,{bits:5}),g=!1}e.lencode=i,e.lenbits=9,e.distcode=n,e.distbits=5}(r),r.mode=20,6===t){b>>>=2,w-=2;break s}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}b>>>=2,w-=2;break;case 14:for(b>>>=7&w,w-=7&w;w<32;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}if((65535&b)!=(b>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&b,b=0,w=0,r.mode=15,6===t)break s;case 15:r.mode=16;case 16:if(E=r.length){if(E>m&&(E=m),E>v&&(E=v),0===E)break s;s.arraySet(d,h,p,E,f),m-=E,p+=E,v-=E,f+=E,r.length-=E;break}r.mode=12;break;case 17:for(;w<14;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}if(r.nlen=(31&b)+257,b>>>=5,w-=5,r.ndist=(31&b)+1,b>>>=5,w-=5,r.ncode=(15&b)+4,b>>>=4,w-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;w<3;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}r.lens[M[r.have++]]=7&b,b>>>=3,w-=3}for(;r.have<19;)r.lens[M[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,D={bits:r.lenbits},j=u(0,r.lens,0,19,r.lencode,0,r.work,D),r.lenbits=D.bits,j){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;O=($=r.lencode[b&(1<<r.lenbits)-1])>>>24,C=$>>>16&255,A=65535&$,!(O<=w);){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}if(A<16)b>>>=O,w-=O,r.lens[r.have++]=A;else{if(16===A){for(L=O+2;w<L;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}if(b>>>=O,w-=O,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}P=r.lens[r.have-1],E=3+(3&b),b>>>=2,w-=2}else if(17===A){for(L=O+3;w<L;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}b>>>=O,w-=O,P=0,E=3+(7&b),b>>>=3,w-=3}else{for(L=O+7;w<L;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}b>>>=O,w-=O,P=0,E=11+(127&b),b>>>=7,w-=7}if(r.have+E>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;E--;)r.lens[r.have++]=P}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,D={bits:r.lenbits},j=u(1,r.lens,0,r.nlen,r.lencode,0,r.work,D),r.lenbits=D.bits,j){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,D={bits:r.distbits},j=u(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,D),r.distbits=D.bits,j){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break s;case 20:r.mode=21;case 21:if(m>=6&&v>=258){e.next_out=f,e.avail_out=v,e.next_in=p,e.avail_in=m,r.hold=b,r.bits=w,l(e,S),f=e.next_out,d=e.output,v=e.avail_out,p=e.next_in,h=e.input,m=e.avail_in,b=r.hold,w=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;O=($=r.lencode[b&(1<<r.lenbits)-1])>>>24,C=$>>>16&255,A=65535&$,!(O<=w);){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}if(C&&(240&C)==0){for(N=O,R=C,I=A;O=($=r.lencode[I+((b&(1<<N+R)-1)>>N)])>>>24,C=$>>>16&255,A=65535&$,!(N+O<=w);){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}b>>>=N,w-=N,r.back+=N}if(b>>>=O,w-=O,r.back+=O,r.length=A,0===C){r.mode=26;break}if(32&C){r.back=-1,r.mode=12;break}if(64&C){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&C,r.mode=22;case 22:if(r.extra){for(L=r.extra;w<L;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}r.length+=b&(1<<r.extra)-1,b>>>=r.extra,w-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;O=($=r.distcode[b&(1<<r.distbits)-1])>>>24,C=$>>>16&255,A=65535&$,!(O<=w);){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}if((240&C)==0){for(N=O,R=C,I=A;O=($=r.distcode[I+((b&(1<<N+R)-1)>>N)])>>>24,C=$>>>16&255,A=65535&$,!(N+O<=w);){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}b>>>=N,w-=N,r.back+=N}if(b>>>=O,w-=O,r.back+=O,64&C){e.msg="invalid distance code",r.mode=30;break}r.offset=A,r.extra=15&C,r.mode=24;case 24:if(r.extra){for(L=r.extra;w<L;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}r.offset+=b&(1<<r.extra)-1,b>>>=r.extra,w-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===v)break s;if(E=S-v,r.offset>E){if((E=r.offset-E)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}E>r.wnext?(E-=r.wnext,T=r.wsize-E):T=r.wnext-E,E>r.length&&(E=r.length),k=r.window}else k=d,T=f-r.offset,E=r.length;E>v&&(E=v),v-=E,r.length-=E;do d[f++]=k[T++];while(--E);0===r.length&&(r.mode=21);break;case 26:if(0===v)break s;d[f++]=r.length,v--,r.mode=21;break;case 27:if(r.wrap){for(;w<32;){if(0===m)break s;m--,b|=h[p++]<<w,w+=8}if(S-=v,e.total_out+=S,r.total+=S,S&&(e.adler=r.check=r.flags?o(r.check,d,S,f-S):a(r.check,d,S,f-S)),S=v,(r.flags?b:c(b))!==r.check){e.msg="incorrect data check",r.mode=30;break}b=0,w=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;w<32;){if(0===m)break s;m--,b+=h[p++]<<w,w+=8}if(b!==(0xffffffff&r.total)){e.msg="incorrect length check",r.mode=30;break}b=0,w=0}r.mode=29;case 29:j=1;break s;case 30:j=-3;break s;case 31:return -4;default:return -2}return(e.next_out=f,e.avail_out=v,e.next_in=p,e.avail_in=m,r.hold=b,r.bits=w,(r.wsize||S!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&y(e,e.output,e.next_out,S-e.avail_out))?(r.mode=31,-4):(x-=e.avail_in,S-=e.avail_out,e.total_in+=x,e.total_out+=S,r.total+=S,r.wrap&&S&&(e.adler=r.check=r.flags?o(r.check,d,S,e.next_out-S):a(r.check,d,S,e.next_out-S)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===x&&0===S||4===t)&&0===j&&(j=-5),j)},t.inflateEnd=function(e){if(!e||!e.state)return -2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var r;return e&&e.state&&(2&(r=e.state).wrap)!=0?(r.head=t,t.done=!1,0):-2},t.inflateSetDictionary=function(e,t){var r,i=t.length;return e&&e.state&&(0===(r=e.state).wrap||11===r.mode)?11===r.mode&&a(1,t,i,0)!==r.check?-3:y(e,t,i,i)?(r.mode=31,-4):(r.havedict=1,0):-2},t.inflateInfo="pako inflate (from Nodeca project)"},5406:(e,t,r)=>{"use strict";var i=r(80713),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,r,l,u,c,h,d){var p,f,m,g,y,v,b,w,x,S=d.bits,E=0,T=0,k=0,O=0,C=0,A=0,N=0,R=0,I=0,P=0,j=null,D=0,L=new i.Buf16(16),$=new i.Buf16(16),F=null,M=0;for(E=0;E<=15;E++)L[E]=0;for(T=0;T<l;T++)L[t[r+T]]++;for(O=15,C=S;O>=1&&0===L[O];O--);if(C>O&&(C=O),0===O)return u[c++]=0x1400000,u[c++]=0x1400000,d.bits=1,0;for(k=1;k<O&&0===L[k];k++);for(C<k&&(C=k),R=1,E=1;E<=15;E++)if(R<<=1,(R-=L[E])<0)return -1;if(R>0&&(0===e||1!==O))return -1;for(E=1,$[1]=0;E<15;E++)$[E+1]=$[E]+L[E];for(T=0;T<l;T++)0!==t[r+T]&&(h[$[t[r+T]]++]=T);if(0===e?(j=F=h,v=19):1===e?(j=n,D-=257,F=s,M-=257,v=256):(j=a,F=o,v=-1),P=0,T=0,E=k,y=c,A=C,N=0,m=-1,g=(I=1<<C)-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){b=E-N,h[T]<v?(w=0,x=h[T]):h[T]>v?(w=F[M+h[T]],x=j[D+h[T]]):(w=96,x=0),p=1<<E-N,k=f=1<<A;do u[y+(P>>N)+(f-=p)]=b<<24|w<<16|x|0;while(0!==f);for(p=1<<E-1;P&p;)p>>=1;if(0!==p?(P&=p-1,P+=p):P=0,T++,0==--L[E]){if(E===O)break;E=t[r+h[T]]}if(E>C&&(P&g)!==m){for(0===N&&(N=C),y+=k,R=1<<(A=E-N);A+N<O&&!((R-=L[A+N])<=0);)A++,R<<=1;if(I+=1<<A,1===e&&I>852||2===e&&I>592)return 1;u[m=P&g]=C<<24|A<<16|y-c|0}}return 0!==P&&(u[y+P]=E-N<<24|4194304),d.bits=C,0}},22642:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},43109:(e,t,r)=>{"use strict";var i,n,s,a=r(80713);function o(e){for(var t=e.length;--t>=0;)e[t]=0}var l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],d=Array(576);o(d);var p=Array(60);o(p);var f=Array(512);o(f);var m=Array(256);o(m);var g=Array(29);o(g);var y=Array(30);function v(e,t,r,i,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=e&&e.length}function b(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function w(e){return e<256?f[e]:f[256+(e>>>7)]}function x(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function S(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,x(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function E(e,t,r){S(e,r[2*t],r[2*t+1])}function T(e,t){var r=0;do r|=1&e,e>>>=1,r<<=1;while(--t>0);return r>>>1}function k(e,t,r){var i,n,s=Array(16),a=0;for(i=1;i<=15;i++)s[i]=a=a+r[i-1]<<1;for(n=0;n<=t;n++){var o=e[2*n+1];0!==o&&(e[2*n]=T(s[o]++,o))}}function O(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function C(e){e.bi_valid>8?x(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function A(e,t,r,i){var n=2*t,s=2*r;return e[n]<e[s]||e[n]===e[s]&&i[t]<=i[r]}function N(e,t,r){for(var i=e.heap[r],n=r<<1;n<=e.heap_len&&(n<e.heap_len&&A(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!A(t,i,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=i}function R(e,t,r){var i,n,s,a,o=0;if(0!==e.last_lit)do i=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],n=e.pending_buf[e.l_buf+o],o++,0===i?E(e,n,t):(E(e,(s=m[n])+256+1,t),0!==(a=l[s])&&S(e,n-=g[s],a),E(e,s=w(--i),r),0!==(a=u[s])&&S(e,i-=y[s],a));while(o<e.last_lit);E(e,256,t)}function I(e,t){var r,i,n,s=t.dyn_tree,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(r=0,e.heap_len=0,e.heap_max=573;r<l;r++)0!==s[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):s[2*r+1]=0;for(;e.heap_len<2;)s[2*(n=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[n]=0,e.opt_len--,o&&(e.static_len-=a[2*n+1]);for(t.max_code=u,r=e.heap_len>>1;r>=1;r--)N(e,s,r);n=l;do r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],N(e,s,1),i=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=i,s[2*n]=s[2*r]+s[2*i],e.depth[n]=(e.depth[r]>=e.depth[i]?e.depth[r]:e.depth[i])+1,s[2*r+1]=s[2*i+1]=n,e.heap[1]=n++,N(e,s,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,i,n,s,a,o,l=t.dyn_tree,u=t.max_code,c=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,m=0;for(s=0;s<=15;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(s=l[2*l[2*(i=e.heap[r])+1]+1]+1)>f&&(s=f,m++),l[2*i+1]=s,!(i>u)&&(e.bl_count[s]++,a=0,i>=p&&(a=d[i-p]),o=l[2*i],e.opt_len+=o*(s+a),h&&(e.static_len+=o*(c[2*i+1]+a)));if(0!==m){do{for(s=f-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[f]--,m-=2}while(m>0);for(s=f;0!==s;s--)for(i=e.bl_count[s];0!==i;)!((n=e.heap[--r])>u)&&(l[2*n+1]!==s&&(e.opt_len+=(s-l[2*n+1])*l[2*n],l[2*n+1]=s),i--)}}(e,t),k(s,u,e.bl_count)}function P(e,t,r){var i,n,s=-1,a=t[1],o=0,l=7,u=4;for(0===a&&(l=138,u=3),t[(r+1)*2+1]=65535,i=0;i<=r;i++)n=a,a=t[(i+1)*2+1],++o<l&&n===a||(o<u?e.bl_tree[2*n]+=o:0!==n?(n!==s&&e.bl_tree[2*n]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,s=n,0===a?(l=138,u=3):n===a?(l=6,u=3):(l=7,u=4))}function j(e,t,r){var i,n,s=-1,a=t[1],o=0,l=7,u=4;for(0===a&&(l=138,u=3),i=0;i<=r;i++)if(n=a,a=t[(i+1)*2+1],!(++o<l)||n!==a){if(o<u)do E(e,n,e.bl_tree);while(0!=--o);else 0!==n?(n!==s&&(E(e,n,e.bl_tree),o--),E(e,16,e.bl_tree),S(e,o-3,2)):o<=10?(E(e,17,e.bl_tree),S(e,o-3,3)):(E(e,18,e.bl_tree),S(e,o-11,7));o=0,s=n,0===a?(l=138,u=3):n===a?(l=6,u=3):(l=7,u=4)}}o(y);var D=!1;function L(e,t,r,i){S(e,0+(i?1:0),3),C(e),x(e,r),x(e,~r),a.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}t._tr_init=function(e){D||(function(){var e,t,r,a,o,h=Array(16);for(a=0,r=0;a<28;a++)for(e=0,g[a]=r;e<1<<l[a];e++)m[r++]=a;for(m[r-1]=a,o=0,a=0;a<16;a++)for(e=0,y[a]=o;e<1<<u[a];e++)f[o++]=a;for(o>>=7;a<30;a++)for(e=0,y[a]=o<<7;e<1<<u[a]-7;e++)f[256+o++]=a;for(t=0;t<=15;t++)h[t]=0;for(e=0;e<=143;)d[2*e+1]=8,e++,h[8]++;for(;e<=255;)d[2*e+1]=9,e++,h[9]++;for(;e<=279;)d[2*e+1]=7,e++,h[7]++;for(;e<=287;)d[2*e+1]=8,e++,h[8]++;for(k(d,287,h),e=0;e<30;e++)p[2*e+1]=5,p[2*e]=T(e,5);i=new v(d,l,257,286,15),n=new v(p,u,0,30,15),s=new v([],c,0,19,7)}(),D=!0),e.l_desc=new b(e.dyn_ltree,i),e.d_desc=new b(e.dyn_dtree,n),e.bl_desc=new b(e.bl_tree,s),e.bi_buf=0,e.bi_valid=0,O(e)},t._tr_stored_block=L,t._tr_flush_block=function(e,t,r,i){var n,s,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=0xf3ffc07f;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),I(e,e.l_desc),I(e,e.d_desc),a=function(e){var t;for(P(e,e.dyn_ltree,e.l_desc.max_code),P(e,e.dyn_dtree,e.d_desc.max_code),I(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*h[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),n=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=n&&(n=s)):n=s=r+5,r+4<=n&&-1!==t?L(e,t,r,i):4===e.strategy||s===n?(S(e,2+(i?1:0),3),R(e,d,p)):(S(e,4+(i?1:0),3),function(e,t,r,i){var n;for(S(e,t-257,5),S(e,r-1,5),S(e,i-4,4),n=0;n<i;n++)S(e,e.bl_tree[2*h[n]+1],3);j(e,e.dyn_ltree,t-1),j(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),R(e,e.dyn_ltree,e.dyn_dtree)),O(e),i&&C(e)},t._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[(m[r]+256+1)*2]++,e.dyn_dtree[2*w(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){S(e,2,3),E(e,256,d),16===e.bi_valid?(x(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}},49578:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},89671:e=>{"use strict";function t(e){return"/"===e.charAt(0)}function r(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(e),r=t[1]||"",i=!!(r&&":"!==r.charAt(1));return!!(t[2]||i)}e.exports="win32"===process.platform?r:t,e.exports.posix=t,e.exports.win32=r},89210:e=>{"use strict";"undefined"!=typeof process&&process.version&&0!==process.version.indexOf("v0.")&&(0!==process.version.indexOf("v1.")||0===process.version.indexOf("v1.8."))?e.exports=process:e.exports={nextTick:function(e,t,r,i){if("function"!=typeof e)throw TypeError('"callback" argument must be a function');var n,s,a=arguments.length;switch(a){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,t)});case 3:return process.nextTick(function(){e.call(null,t,r)});case 4:return process.nextTick(function(){e.call(null,t,r,i)});default:for(n=Array(a-1),s=0;s<n.length;)n[s++]=arguments[s];return process.nextTick(function(){e.apply(null,n)})}}}},90830:(e,t,r)=>{"use strict";var i=r(89210),n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=h;var s=Object.create(r(11225));s.inherits=r(76225);var a=r(48488),o=r(48376);s.inherits(h,a);for(var l=n(o.prototype),u=0;u<l.length;u++){var c=l[u];h.prototype[c]||(h.prototype[c]=o.prototype[c])}function h(e){if(!(this instanceof h))return new h(e);a.call(this,e),o.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||i.nextTick(p,this)}function p(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),i.nextTick(t,e)}},69876:(e,t,r)=>{"use strict";e.exports=s;var i=r(12546),n=Object.create(r(11225));function s(e){if(!(this instanceof s))return new s(e);i.call(this,e)}n.inherits=r(76225),n.inherits(s,i),s.prototype._transform=function(e,t,r){r(null,e)}},48488:(e,t,r)=>{"use strict";var i,n,s=r(89210);e.exports=v;var a=r(7268);v.ReadableState=y,r(94735).EventEmitter;var o=function(e,t){return e.listeners(t).length},l=r(81052),u=r(20549).Buffer,c=("undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},h=Object.create(r(11225));h.inherits=r(76225);var d=r(28354),p=void 0;p=d&&d.debuglog?d.debuglog("stream"):function(){};var f=r(24542),m=r(38924);h.inherits(v,l);var g=["error","close","destroy","pause","resume"];function y(e,t){i=i||r(90830),e=e||{};var s=t instanceof i;this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var a=e.highWaterMark,o=e.readableHighWaterMark,l=this.objectMode?16:16384;a||0===a?this.highWaterMark=a:s&&(o||0===o)?this.highWaterMark=o:this.highWaterMark=l,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(n||(n=r(90080).I),this.decoder=new n(e.encoding),this.encoding=e.encoding)}function v(e){if(i=i||r(90830),!(this instanceof v))return new v(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),l.call(this)}function b(e,t,r,i,n){var s,a,o,l,h,d=e._readableState;return null===t?(d.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,S(e)}}(e,d)):(n||(s=d,a=t,u.isBuffer(a)||a instanceof c||"string"==typeof a||void 0===a||s.objectMode||(o=TypeError("Invalid non-string/buffer chunk")),h=o),h)?e.emit("error",h):d.objectMode||t&&t.length>0?("string"==typeof t||d.objectMode||Object.getPrototypeOf(t)===u.prototype||(l=t,t=u.from(l)),i?d.endEmitted?e.emit("error",Error("stream.unshift() after end event")):w(e,d,t,!0):d.ended?e.emit("error",Error("stream.push() after EOF")):(d.reading=!1,d.decoder&&!r?(t=d.decoder.write(t),d.objectMode||0!==t.length?w(e,d,t,!1):T(e,d)):w(e,d,t,!1))):i||(d.reading=!1),!d.ended&&(d.needReadable||d.length<d.highWaterMark||0===d.length)}function w(e,t,r,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&S(e)),T(e,t)}function x(e,t){if(e<=0||0===t.length&&t.ended)return 0;if(t.objectMode)return 1;if(e!=e)return t.flowing&&t.length?t.buffer.head.data.length:t.length;if(e>t.highWaterMark){var r;t.highWaterMark=((r=e)>=8388608?r=8388608:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r)}return e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0)}function S(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(p("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?s.nextTick(E,e):E(e))}function E(e){p("emit readable"),e.emit("readable"),A(e)}function T(e,t){t.readingMore||(t.readingMore=!0,s.nextTick(k,e,t))}function k(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(p("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function O(e){p("readable nexttick read 0"),e.read(0)}function C(e,t){t.reading||(p("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),A(e),t.flowing&&!t.reading&&e.read(0)}function A(e){var t=e._readableState;for(p("flow",t.flowing);t.flowing&&null!==e.read(););}function N(e,t){var r,i,n,s;return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):(i=t.buffer,n=t.decoder,e<i.head.data.length?(s=i.head.data.slice(0,e),i.head.data=i.head.data.slice(e)):s=e===i.head.data.length?i.shift():n?function(e,t){var r=t.head,i=1,n=r.data;for(e-=n.length;r=r.next;){var s=r.data,a=e>s.length?s.length:e;if(a===s.length?n+=s:n+=s.slice(0,e),0==(e-=a)){a===s.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=s.slice(a));break}++i}return t.length-=i,n}(e,i):function(e,t){var r=u.allocUnsafe(e),i=t.head,n=1;for(i.data.copy(r),e-=i.data.length;i=i.next;){var s=i.data,a=e>s.length?s.length:e;if(s.copy(r,r.length-e,0,a),0==(e-=a)){a===s.length?(++n,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=s.slice(a));break}++n}return t.length-=n,r}(e,i),r=s),r)}function R(e){var t=e._readableState;if(t.length>0)throw Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,s.nextTick(I,t,e))}function I(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function P(e,t){for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return -1}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=m.destroy,v.prototype._undestroy=m.undestroy,v.prototype._destroy=function(e,t){this.push(null),t(e)},v.prototype.push=function(e,t){var r,i=this._readableState;return i.objectMode?r=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=u.from(e,t),t=""),r=!0),b(this,e,t,!1,r)},v.prototype.unshift=function(e){return b(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(e){return n||(n=r(90080).I),this._readableState.decoder=new n(e),this._readableState.encoding=e,this},v.prototype.read=function(e){p("read",e),e=parseInt(e,10);var t,r=this._readableState,i=e;if(0!==e&&(r.emittedReadable=!1),0===e&&r.needReadable&&(r.length>=r.highWaterMark||r.ended))return p("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?R(this):S(this),null;if(0===(e=x(e,r))&&r.ended)return 0===r.length&&R(this),null;var n=r.needReadable;return p("need readable",n),(0===r.length||r.length-e<r.highWaterMark)&&p("length less than watermark",n=!0),r.ended||r.reading?p("reading or ended",n=!1):n&&(p("do read"),r.reading=!0,r.sync=!0,0===r.length&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=x(i,r))),null===(t=e>0?N(e,r):null)?(r.needReadable=!0,e=0):r.length-=e,0===r.length&&(r.ended||(r.needReadable=!0),i!==e&&r.ended&&R(this)),null!==t&&this.emit("data",t),t},v.prototype._read=function(e){this.emit("error",Error("_read() is not implemented"))},v.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,p("pipe count=%d opts=%j",i.pipesCount,t);var n=t&&!1===t.end||e===process.stdout||e===process.stderr?y:l;function l(){p("onend"),e.end()}i.endEmitted?s.nextTick(n):r.once("end",n),e.on("unpipe",function t(n,s){p("onunpipe"),n===r&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,p("cleanup"),e.removeListener("close",m),e.removeListener("finish",g),e.removeListener("drain",u),e.removeListener("error",f),e.removeListener("unpipe",t),r.removeListener("end",l),r.removeListener("end",y),r.removeListener("data",d),c=!0,i.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&u())});var u=function(){var e=r._readableState;p("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&o(r,"data")&&(e.flowing=!0,A(r))};e.on("drain",u);var c=!1,h=!1;function d(t){p("ondata"),h=!1,!1!==e.write(t)||h||((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==P(i.pipes,e))&&!c&&(p("false write response, pause",i.awaitDrain),i.awaitDrain++,h=!0),r.pause())}function f(t){p("onerror",t),y(),e.removeListener("error",f),0===o(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",g),y()}function g(){p("onfinish"),e.removeListener("close",m),y()}function y(){p("unpipe"),r.unpipe(e)}return r.on("data",d),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?a(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",f),e.once("close",m),e.once("finish",g),e.emit("pipe",r),i.flowing||(p("pipe resume"),r.resume()),e},v.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=P(t.pipes,e);return -1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},v.prototype.on=function(e,t){var r=l.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&S(this):s.nextTick(O,this))}return r},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var e=this._readableState;return e.flowing||(p("resume"),e.flowing=!0,e.resumeScheduled||(e.resumeScheduled=!0,s.nextTick(C,this,e))),this},v.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(e){var t=this,r=this._readableState,i=!1;for(var n in e.on("end",function(){if(p("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(n){p("wrapped data"),r.decoder&&(n=r.decoder.write(n)),(!r.objectMode||null!=n)&&(r.objectMode||n&&n.length)&&(t.push(n)||(i=!0,e.pause()))}),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var s=0;s<g.length;s++)e.on(g[s],this.emit.bind(this,g[s]));return this._read=function(t){p("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=N},12546:(e,t,r)=>{"use strict";e.exports=a;var i=r(90830),n=Object.create(r(11225));function s(e,t){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(!i)return this.emit("error",Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),i(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function a(e){if(!(this instanceof a))return new a(e);i.call(this,e),this._transformState={afterTransform:s.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",o)}function o(){var e=this;"function"==typeof this._flush?this._flush(function(t,r){l(e,t,r)}):l(this,null,null)}function l(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw Error("Calling transform done when still transforming");return e.push(null)}n.inherits=r(76225),n.inherits(a,i),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,r){throw Error("_transform() is not implemented")},a.prototype._write=function(e,t,r){var i=this._transformState;if(i.writecb=r,i.writechunk=e,i.writeencoding=t,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},a.prototype._destroy=function(e,t){var r=this;i.prototype._destroy.call(this,e,function(e){t(e),r.emit("close")})}},48376:(e,t,r)=>{"use strict";var i,n,s=r(89210);function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){(function(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(void 0),i=i.next}t.corkedRequestsFree.next=e})(t,e)}}e.exports=g;var o=["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:s.nextTick;g.WritableState=m;var l=Object.create(r(11225));l.inherits=r(76225);var u={deprecate:r(82552)},c=r(81052),h=r(20549).Buffer,d=("undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},p=r(38924);function f(){}function m(e,t){i=i||r(90830),e=e||{};var n=t instanceof i;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var l=e.highWaterMark,u=e.writableHighWaterMark,c=this.objectMode?16:16384;l||0===l?this.highWaterMark=l:n&&(u||0===u)?this.highWaterMark=u:this.highWaterMark=c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var h=!1===e.decodeStrings;this.decodeStrings=!h,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){(function(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if(r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,t)--r.pendingcb,i?(s.nextTick(n,t),s.nextTick(S,e,r),e._writableState.errorEmitted=!0,e.emit("error",t)):(n(t),e._writableState.errorEmitted=!0,e.emit("error",t),S(e,r));else{var a=w(r);a||r.corked||r.bufferProcessing||!r.bufferedRequest||b(e,r),i?o(v,e,r,a,n):v(e,r,a,n)}})(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function g(e){if(i=i||r(90830),!n.call(g,this)&&!(this instanceof i))return new g(e);this._writableState=new m(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),c.call(this)}function y(e,t,r,i,n,s,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,s,t.onwrite),t.sync=!1}function v(e,t,r,i){r||0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain")),t.pendingcb--,i(),S(e,t)}function b(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=Array(t.bufferedRequestCount),n=t.corkedRequestsFree;n.entry=r;for(var s=0,o=!0;r;)i[s]=r,r.isBuf||(o=!1),r=r.next,s+=1;i.allBuffers=o,y(e,t,!0,t.length,i,"",n.finish),t.pendingcb++,t.lastBufferedRequest=null,n.next?(t.corkedRequestsFree=n.next,n.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,u=r.encoding,c=r.callback,h=t.objectMode?1:l.length;if(y(e,t,!1,h,l,u,c),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function w(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function x(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),S(e,t)})}function S(e,t){var r=w(t);return r&&(t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,s.nextTick(x,e,t)):(t.prefinished=!0,e.emit("prefinish"))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}l.inherits(g,c),m.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(m.prototype,"buffer",{get:u.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(n=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(e){return!!n.call(this,e)||this===g&&e&&e._writableState instanceof m}})):n=function(e){return e instanceof this},g.prototype.pipe=function(){this.emit("error",Error("Cannot pipe, not readable"))},g.prototype.write=function(e,t,r){var i,n,a,o,l,u,c,p,m=this._writableState,g=!1,v=!m.objectMode&&(i=e,h.isBuffer(i)||i instanceof d);return v&&!h.isBuffer(e)&&(n=e,e=h.from(n)),("function"==typeof t&&(r=t,t=null),v?t="buffer":t||(t=m.defaultEncoding),"function"!=typeof r&&(r=f),m.ended)?(a=r,o=Error("write after end"),this.emit("error",o),s.nextTick(a,o)):(v||(l=e,u=r,c=!0,p=!1,null===l?p=TypeError("May not write null values to stream"):"string"==typeof l||void 0===l||m.objectMode||(p=TypeError("Invalid non-string/buffer chunk")),p&&(this.emit("error",p),s.nextTick(u,p),c=!1),c))&&(m.pendingcb++,g=function(e,t,r,i,n,s){if(!r){var a,o,l=(a=i,o=n,t.objectMode||!1===t.decodeStrings||"string"!=typeof a||(a=h.from(a,o)),a);i!==l&&(r=!0,n="buffer",i=l)}var u=t.objectMode?1:i.length;t.length+=u;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var d=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},d?d.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,u,i,n,s);return c}(this,m,v,e,t,r)),g},g.prototype.cork=function(){var e=this._writableState;e.corked++},g.prototype.uncork=function(){var e=this._writableState;!e.corked||(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||b(this,e))},g.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(e,t,r){r(Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(e,t,r){var i,n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||(i=r,n.ending=!0,S(this,n),i&&(n.finished?s.nextTick(i):this.once("finish",i)),n.ended=!0,this.writable=!1)},Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),g.prototype.destroy=p.destroy,g.prototype._undestroy=p.undestroy,g.prototype._destroy=function(e,t){this.end(),t(e)}},24542:(e,t,r)=>{"use strict";var i=r(20549).Buffer,n=r(28354);e.exports=function(){function e(){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);for(var t=i.allocUnsafe(e>>>0),r=this.head,n=0;r;)(function(e,t,r){e.copy(t,r)})(r.data,t,n),n+=r.data.length,r=r.next;return t},e}(),n&&n.inspect&&n.inspect.custom&&(e.exports.prototype[n.inspect.custom]=function(){var e=n.inspect({length:this.length});return this.constructor.name+" "+e})},38924:(e,t,r)=>{"use strict";var i=r(89210);function n(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,s=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return s||a?t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(n,this,e)):i.nextTick(n,this,e)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?r._writableState?r._writableState.errorEmitted||(r._writableState.errorEmitted=!0,i.nextTick(n,r,e)):i.nextTick(n,r,e):t&&t(e)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},81052:(e,t,r)=>{e.exports=r(27910)},82610:(e,t,r)=>{e.exports=r(32662).PassThrough},32662:(e,t,r)=>{var i=r(27910);"disable"===process.env.READABLE_STREAM&&i?(e.exports=i,(t=e.exports=i.Readable).Readable=i.Readable,t.Writable=i.Writable,t.Duplex=i.Duplex,t.Transform=i.Transform,t.PassThrough=i.PassThrough,t.Stream=i):((t=e.exports=r(48488)).Stream=i||t,t.Readable=t,t.Writable=r(48376),t.Duplex=r(90830),t.Transform=r(12546),t.PassThrough=r(69876))},52171:e=>{"use strict";let t={};function r(e,r,i){i||(i=Error);class n extends i{constructor(e,t,i){super("string"==typeof r?r:r(e,t,i))}}n.prototype.name=i.name,n.prototype.code=e,t[e]=n}function i(e,t){if(!Array.isArray(e))return`of ${t} ${String(e)}`;{let r=e.length;return(e=e.map(e=>String(e)),r>2)?`one of ${t} ${e.slice(0,r-1).join(", ")}, or `+e[r-1]:2===r?`one of ${t} ${e[0]} or ${e[1]}`:`of ${t} ${e[0]}`}}r("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(e,t,r){var n,s,a,o;let l,u;if("string"==typeof t&&(n="not ",t.substr(0,n.length)===n)?(l="must not be",t=t.replace(/^not /,"")):l="must be",s=" argument",(void 0===a||a>e.length)&&(a=e.length),e.substring(a-s.length,a)===s)u=`The ${e} ${l} ${i(t,"type")}`;else{let r=("number"!=typeof o&&(o=0),o+1>e.length||-1===e.indexOf(".",o))?"argument":"property";u=`The "${e}" ${r} ${l} ${i(t,"type")}`}return u+`. Received type ${typeof r}`},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.F=t},49152:(e,t,r)=>{"use strict";var i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=u;var n=r(98418),s=r(54254);r(76225)(u,n);for(var a=i(s.prototype),o=0;o<a.length;o++){var l=a[o];u.prototype[l]||(u.prototype[l]=s.prototype[l])}function u(e){if(!(this instanceof u))return new u(e);n.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||process.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},54646:(e,t,r)=>{"use strict";e.exports=n;var i=r(89584);function n(e){if(!(this instanceof n))return new n(e);i.call(this,e)}r(76225)(n,i),n.prototype._transform=function(e,t,r){r(null,e)}},98418:(e,t,r)=>{"use strict";e.exports=T,T.ReadableState=E,r(94735).EventEmitter;var i,n,s,a,o,l=function(e,t){return e.listeners(t).length},u=r(15450),c=r(79428).Buffer,h=("undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},d=r(28354);n=d&&d.debuglog?d.debuglog("stream"):function(){};var p=r(77687),f=r(93322),m=r(34729).getHighWaterMark,g=r(52171).F,y=g.ERR_INVALID_ARG_TYPE,v=g.ERR_STREAM_PUSH_AFTER_EOF,b=g.ERR_METHOD_NOT_IMPLEMENTED,w=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(76225)(T,u);var x=f.errorOrDestroy,S=["error","close","destroy","pause","resume"];function E(e,t,n){i=i||r(49152),e=e||{},"boolean"!=typeof n&&(n=t instanceof i),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=m(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(s||(s=r(47143).I),this.decoder=new s(e.encoding),this.encoding=e.encoding)}function T(e){if(i=i||r(49152),!(this instanceof T))return new T(e);var t=this instanceof i;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),u.call(this)}function k(e,t,r,i,s){n("readableAddChunk",t);var a,o,l,u,d,p=e._readableState;if(null===t)p.reading=!1,function(e,t){if(n("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?A(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,N(e)))}}(e,p);else{if(s||(a=p,o=t,c.isBuffer(o)||o instanceof h||"string"==typeof o||void 0===o||a.objectMode||(l=new y("chunk",["string","Buffer","Uint8Array"],o)),d=l),d)x(e,d);else if(p.objectMode||t&&t.length>0){if("string"==typeof t||p.objectMode||Object.getPrototypeOf(t)===c.prototype||(u=t,t=c.from(u)),i)p.endEmitted?x(e,new w):O(e,p,t,!0);else if(p.ended)x(e,new v);else{if(p.destroyed)return!1;p.reading=!1,p.decoder&&!r?(t=p.decoder.write(t),p.objectMode||0!==t.length?O(e,p,t,!1):R(e,p)):O(e,p,t,!1)}}else i||(p.reading=!1,R(e,p))}return!p.ended&&(p.length<p.highWaterMark||0===p.length)}function O(e,t,r,i){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&A(e)),R(e,t)}function C(e,t){if(e<=0||0===t.length&&t.ended)return 0;if(t.objectMode)return 1;if(e!=e)return t.flowing&&t.length?t.buffer.head.data.length:t.length;if(e>t.highWaterMark){var r;t.highWaterMark=((r=e)>=0x40000000?r=0x40000000:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r)}return e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0)}function A(e){var t=e._readableState;n("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(n("emitReadable",t.flowing),t.emittedReadable=!0,process.nextTick(N,e))}function N(e){var t=e._readableState;n("emitReadable_",t.destroyed,t.length,t.ended),!t.destroyed&&(t.length||t.ended)&&(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function R(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(I,e,t))}function I(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(n("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function P(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function j(e){n("readable nexttick read 0"),e.read(0)}function D(e,t){n("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(n("flow",t.flowing);t.flowing&&null!==e.read(););}function $(e,t){var r;return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r)}function F(e){var t=e._readableState;n("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,process.nextTick(M,t,e))}function M(e,t){if(n("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function B(e,t){for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return -1}Object.defineProperty(T.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),T.prototype.destroy=f.destroy,T.prototype._undestroy=f.undestroy,T.prototype._destroy=function(e,t){t(e)},T.prototype.push=function(e,t){var r,i=this._readableState;return i.objectMode?r=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=c.from(e,t),t=""),r=!0),k(this,e,t,!1,r)},T.prototype.unshift=function(e){return k(this,e,null,!0,!1)},T.prototype.isPaused=function(){return!1===this._readableState.flowing},T.prototype.setEncoding=function(e){s||(s=r(47143).I);var t=new s(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var i=this._readableState.buffer.head,n="";null!==i;)n+=t.write(i.data),i=i.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this},T.prototype.read=function(e){n("read",e),e=parseInt(e,10);var t,r=this._readableState,i=e;if(0!==e&&(r.emittedReadable=!1),0===e&&r.needReadable&&((0!==r.highWaterMark?r.length>=r.highWaterMark:r.length>0)||r.ended))return n("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?F(this):A(this),null;if(0===(e=C(e,r))&&r.ended)return 0===r.length&&F(this),null;var s=r.needReadable;return n("need readable",s),(0===r.length||r.length-e<r.highWaterMark)&&n("length less than watermark",s=!0),r.ended||r.reading?n("reading or ended",s=!1):s&&(n("do read"),r.reading=!0,r.sync=!0,0===r.length&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=C(i,r))),null===(t=e>0?$(e,r):null)?(r.needReadable=r.length<=r.highWaterMark,e=0):(r.length-=e,r.awaitDrain=0),0===r.length&&(r.ended||(r.needReadable=!0),i!==e&&r.ended&&F(this)),null!==t&&this.emit("data",t),t},T.prototype._read=function(e){x(this,new b("_read()"))},T.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,n("pipe count=%d opts=%j",i.pipesCount,t);var s=t&&!1===t.end||e===process.stdout||e===process.stderr?f:a;function a(){n("onend"),e.end()}i.endEmitted?process.nextTick(s):r.once("end",s),e.on("unpipe",function t(s,l){n("onunpipe"),s===r&&l&&!1===l.hasUnpiped&&(l.hasUnpiped=!0,n("cleanup"),e.removeListener("close",d),e.removeListener("finish",p),e.removeListener("drain",o),e.removeListener("error",h),e.removeListener("unpipe",t),r.removeListener("end",a),r.removeListener("end",f),r.removeListener("data",c),u=!0,i.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&o())});var o=function(){var e=r._readableState;n("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&l(r,"data")&&(e.flowing=!0,L(r))};e.on("drain",o);var u=!1;function c(t){n("ondata");var s=e.write(t);n("dest.write",s),!1===s&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==B(i.pipes,e))&&!u&&(n("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function h(t){n("onerror",t),f(),e.removeListener("error",h),0===l(e,"error")&&x(e,t)}function d(){e.removeListener("finish",p),f()}function p(){n("onfinish"),e.removeListener("close",d),f()}function f(){n("unpipe"),r.unpipe(e)}return r.on("data",c),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",h),e.once("close",d),e.once("finish",p),e.emit("pipe",r),i.flowing||(n("pipe resume"),r.resume()),e},T.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=B(t.pipes,e);return -1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},T.prototype.on=function(e,t){var r=u.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"!==e||i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,n("on readable",i.length,i.reading),i.length?A(this):i.reading||process.nextTick(j,this)),r},T.prototype.addListener=T.prototype.on,T.prototype.removeListener=function(e,t){var r=u.prototype.removeListener.call(this,e,t);return"readable"===e&&process.nextTick(P,this),r},T.prototype.removeAllListeners=function(e){var t=u.prototype.removeAllListeners.apply(this,arguments);return("readable"===e||void 0===e)&&process.nextTick(P,this),t},T.prototype.resume=function(){var e=this._readableState;return e.flowing||(n("resume"),e.flowing=!e.readableListening,e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(D,this,e))),e.paused=!1,this},T.prototype.pause=function(){return n("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(n("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},T.prototype.wrap=function(e){var t=this,r=this._readableState,i=!1;for(var s in e.on("end",function(){if(n("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(s){n("wrapped data"),r.decoder&&(s=r.decoder.write(s)),(!r.objectMode||null!=s)&&(r.objectMode||s&&s.length)&&(t.push(s)||(i=!0,e.pause()))}),e)void 0===this[s]&&"function"==typeof e[s]&&(this[s]=function(t){return function(){return e[t].apply(e,arguments)}}(s));for(var a=0;a<S.length;a++)e.on(S[a],this.emit.bind(this,S[a]));return this._read=function(t){n("wrapped _read",t),i&&(i=!1,e.resume())},this},"function"==typeof Symbol&&(T.prototype[Symbol.asyncIterator]=function(){return void 0===a&&(a=r(12269)),a(this)}),Object.defineProperty(T.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(T.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(T.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),T._fromList=$,Object.defineProperty(T.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(T.from=function(e,t){return void 0===o&&(o=r(52922)),o(T,e,t)})},89584:(e,t,r)=>{"use strict";e.exports=c;var i=r(52171).F,n=i.ERR_METHOD_NOT_IMPLEMENTED,s=i.ERR_MULTIPLE_CALLBACK,a=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=i.ERR_TRANSFORM_WITH_LENGTH_0,l=r(49152);function u(e,t){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(null===i)return this.emit("error",new s);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),i(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);l.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush(function(t,r){d(e,t,r)})}function d(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new o;if(e._transformState.transforming)throw new a;return e.push(null)}r(76225)(c,l),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,r){r(new n("_transform()"))},c.prototype._write=function(e,t,r){var i=this._transformState;if(i.writecb=r,i.writechunk=e,i.writeencoding=t,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,function(e){t(e)})}},54254:(e,t,r)=>{"use strict";function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){(function(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(void 0),i=i.next}t.corkedRequestsFree.next=e})(t,e)}}e.exports=T,T.WritableState=E;var n,s,a={deprecate:r(82552)},o=r(15450),l=r(79428).Buffer,u=("undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},c=r(93322),h=r(34729).getHighWaterMark,d=r(52171).F,p=d.ERR_INVALID_ARG_TYPE,f=d.ERR_METHOD_NOT_IMPLEMENTED,m=d.ERR_MULTIPLE_CALLBACK,g=d.ERR_STREAM_CANNOT_PIPE,y=d.ERR_STREAM_DESTROYED,v=d.ERR_STREAM_NULL_VALUES,b=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,x=c.errorOrDestroy;function S(){}function E(e,t,s){n=n||r(49152),e=e||{},"boolean"!=typeof s&&(s=t instanceof n),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=h(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){(function(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if("function"!=typeof n)throw new m;if(r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,t)--r.pendingcb,i?(process.nextTick(n,t),process.nextTick(R,e,r),e._writableState.errorEmitted=!0,x(e,t)):(n(t),e._writableState.errorEmitted=!0,x(e,t),R(e,r));else{var s=A(r)||e.destroyed;s||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?process.nextTick(O,e,r,s,n):O(e,r,s,n)}})(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function T(e){var t=this instanceof(n=n||r(49152));if(!t&&!s.call(T,this))return new T(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),o.call(this)}function k(e,t,r,i,n,s,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new y("write")):r?e._writev(n,t.onwrite):e._write(n,s,t.onwrite),t.sync=!1}function O(e,t,r,i){r||0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain")),t.pendingcb--,i(),R(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=Array(t.bufferedRequestCount),s=t.corkedRequestsFree;s.entry=r;for(var a=0,o=!0;r;)n[a]=r,r.isBuf||(o=!1),r=r.next,a+=1;n.allBuffers=o,k(e,t,!0,t.length,n,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,u=r.encoding,c=r.callback,h=t.objectMode?1:l.length;if(k(e,t,!1,h,l,u,c),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function A(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function N(e,t){e._final(function(r){t.pendingcb--,r&&x(e,r),t.prefinished=!0,e.emit("prefinish"),R(e,t)})}function R(e,t){var r=A(t);if(r&&(t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,process.nextTick(N,e,t))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}r(76225)(T,o),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:a.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(T,Symbol.hasInstance,{value:function(e){return!!s.call(this,e)||this===T&&e&&e._writableState instanceof E}})):s=function(e){return e instanceof this},T.prototype.pipe=function(){x(this,new g)},T.prototype.write=function(e,t,r){var i,n,s,a,o,c,h,d=this._writableState,f=!1,m=!d.objectMode&&(i=e,l.isBuffer(i)||i instanceof u);return m&&!l.isBuffer(e)&&(n=e,e=l.from(n)),("function"==typeof t&&(r=t,t=null),m?t="buffer":t||(t=d.defaultEncoding),"function"!=typeof r&&(r=S),d.ending)?(s=r,x(this,a=new b),process.nextTick(s,a)):(m||(o=e,c=r,null===o?h=new v:"string"==typeof o||d.objectMode||(h=new p("chunk",["string","Buffer"],o)),!h||(x(this,h),process.nextTick(c,h),0)))&&(d.pendingcb++,f=function(e,t,r,i,n,s){if(!r){var a,o,u=(a=i,o=n,t.objectMode||!1===t.decodeStrings||"string"!=typeof a||(a=l.from(a,o)),a);i!==u&&(r=!0,n="buffer",i=u)}var c=t.objectMode?1:i.length;t.length+=c;var h=t.length<t.highWaterMark;if(h||(t.needDrain=!0),t.writing||t.corked){var d=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},d?d.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else k(e,t,!1,c,i,n,s);return h}(this,d,m,e,t,r)),f},T.prototype.cork=function(){this._writableState.corked++},T.prototype.uncork=function(){var e=this._writableState;!e.corked||(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},T.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(T.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(T.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),T.prototype._write=function(e,t,r){r(new f("_write()"))},T.prototype._writev=null,T.prototype.end=function(e,t,r){var i,n=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||(i=r,n.ending=!0,R(this,n),i&&(n.finished?process.nextTick(i):this.once("finish",i)),n.ended=!0,this.writable=!1),this},Object.defineProperty(T.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(T.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),T.prototype.destroy=c.destroy,T.prototype._undestroy=c.undestroy,T.prototype._destroy=function(e,t){t(e)}},12269:(e,t,r)=>{"use strict";function i(e,t,r){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:String(i))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var n,s=r(89452),a=Symbol("lastResolve"),o=Symbol("lastReject"),l=Symbol("error"),u=Symbol("ended"),c=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function p(e,t){return{value:e,done:t}}function f(e){var t=e[a];if(null!==t){var r=e[d].read();null!==r&&(e[c]=null,e[a]=null,e[o]=null,t(p(r,!1)))}}function m(e){process.nextTick(f,e)}var g=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((i(n={get stream(){return this[d]},next:function(){var e,t,r=this,i=this[l];if(null!==i)return Promise.reject(i);if(this[u])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise(function(e,t){process.nextTick(function(){r[l]?t(r[l]):e(p(void 0,!0))})});var n=this[c];if(n)t=new Promise((e=this,function(t,r){n.then(function(){if(e[u]){t(p(void 0,!0));return}e[h](t,r)},r)}));else{var s=this[d].read();if(null!==s)return Promise.resolve(p(s,!1));t=new Promise(this[h])}return this[c]=t,t}},Symbol.asyncIterator,function(){return this}),i(n,"return",function(){var e=this;return new Promise(function(t,r){e[d].destroy(null,function(e){if(e){r(e);return}t(p(void 0,!0))})})}),n),g);e.exports=function(e){var t,r=Object.create(y,(i(t={},d,{value:e,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,l,{value:null,writable:!0}),i(t,u,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var i=r[d].read();i?(r[c]=null,r[a]=null,r[o]=null,e(p(i,!1))):(r[a]=e,r[o]=t)},writable:!0}),t));return r[c]=null,s(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[o];null!==t&&(r[c]=null,r[a]=null,r[o]=null,t(e)),r[l]=e;return}var i=r[a];null!==i&&(r[c]=null,r[a]=null,r[o]=null,i(p(void 0,!0))),r[u]=!0}),e.on("readable",m.bind(null,r)),r}},77687:(e,t,r)=>{"use strict";function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var i,n;i=t,n=r[t],(i=s(i))in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var a=r(79428).Buffer,o=r(28354).inspect,l=o&&o.custom||"inspect";e.exports=function(){var e;function t(){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.head=null,this.tail=null,this.length=0}return e=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return a.alloc(0);for(var t,r,i=a.allocUnsafe(e>>>0),n=this.head,s=0;n;)t=n.data,r=s,a.prototype.copy.call(t,i,r),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,i=t.data;for(e-=i.length;t=t.next;){var n=t.data,s=e>n.length?n.length:e;if(s===n.length?i+=n:i+=n.slice(0,e),0==(e-=s)){s===n.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=n.slice(s));break}++r}return this.length-=r,i}},{key:"_getBuffer",value:function(e){var t=a.allocUnsafe(e),r=this.head,i=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var n=r.data,s=e>n.length?n.length:e;if(n.copy(t,t.length-e,0,s),0==(e-=s)){s===n.length?(++i,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=n.slice(s));break}++i}return this.length-=i,t}},{key:l,value:function(e,t){return o(this,n(n({},t),{},{depth:0,customInspect:!1}))}}],function(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,s(i.key),i)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}()},93322:e=>{"use strict";function t(e,t){i(e,t),r(e)}function r(e){(!e._writableState||e._writableState.emitClose)&&(!e._readableState||e._readableState.emitClose)&&e.emit("close")}function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,n){var s=this,a=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return a||o?n?n(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(i,this,e)):process.nextTick(i,this,e)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!n&&e?s._writableState?s._writableState.errorEmitted?process.nextTick(r,s):(s._writableState.errorEmitted=!0,process.nextTick(t,s,e)):process.nextTick(t,s,e):n?(process.nextTick(r,s),n(e)):process.nextTick(r,s)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,i=e._writableState;r&&r.autoDestroy||i&&i.autoDestroy?e.destroy(t):e.emit("error",t)}}},89452:(e,t,r)=>{"use strict";var i=r(52171).F.ERR_STREAM_PREMATURE_CLOSE;function n(){}e.exports=function e(t,r,s){if("function"==typeof r)return e(t,null,r);r||(r={}),a=s||n,o=!1,s=function(){if(!o){o=!0;for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];a.apply(this,t)}};var a,o,l=r.readable||!1!==r.readable&&t.readable,u=r.writable||!1!==r.writable&&t.writable,c=function(){t.writable||d()},h=t._writableState&&t._writableState.finished,d=function(){u=!1,h=!0,l||s.call(t)},p=t._readableState&&t._readableState.endEmitted,f=function(){l=!1,p=!0,u||s.call(t)},m=function(e){s.call(t,e)},g=function(){var e;return l&&!p?(t._readableState&&t._readableState.ended||(e=new i),s.call(t,e)):u&&!h?(t._writableState&&t._writableState.ended||(e=new i),s.call(t,e)):void 0},y=function(){t.req.on("finish",d)};return t.setHeader&&"function"==typeof t.abort?(t.on("complete",d),t.on("abort",g),t.req?y():t.on("request",y)):u&&!t._writableState&&(t.on("end",c),t.on("close",c)),t.on("end",f),t.on("finish",d),!1!==r.error&&t.on("error",m),t.on("close",g),function(){t.removeListener("complete",d),t.removeListener("abort",g),t.removeListener("request",y),t.req&&t.req.removeListener("finish",d),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",d),t.removeListener("end",f),t.removeListener("error",m),t.removeListener("close",g)}}},52922:(e,t,r)=>{"use strict";function i(e,t,r,i,n,s,a){try{var o=e[s](a),l=o.value}catch(e){r(e);return}o.done?t(l):Promise.resolve(l).then(i,n)}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}var s=r(52171).F.ERR_INVALID_ARG_TYPE;e.exports=function(e,t,r){if(t&&"function"==typeof t.next)a=t;else if(t&&t[Symbol.asyncIterator])a=t[Symbol.asyncIterator]();else if(t&&t[Symbol.iterator])a=t[Symbol.iterator]();else throw new s("iterable",["Iterable"],t);var a,o=new e(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){var i,n;i=t,n=r[t],(i=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(i))in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({objectMode:!0},r)),l=!1;function u(){return c.apply(this,arguments)}function c(){var e;return e=function*(){try{var e=yield a.next(),t=e.value;e.done?o.push(null):o.push((yield t))?u():l=!1}catch(e){o.destroy(e)}},(c=function(){var t=this,r=arguments;return new Promise(function(n,s){var a=e.apply(t,r);function o(e){i(a,n,s,o,l,"next",e)}function l(e){i(a,n,s,o,l,"throw",e)}o(void 0)})}).apply(this,arguments)}return o._read=function(){l||(l=!0,u())},o}},54024:(e,t,r)=>{"use strict";var i,n=r(52171).F,s=n.ERR_MISSING_ARGS,a=n.ERR_STREAM_DESTROYED;function o(e){if(e)throw e}function l(e){e()}function u(e,t){return e.pipe(t)}e.exports=function(){for(var e,t,n=arguments.length,c=Array(n),h=0;h<n;h++)c[h]=arguments[h];var d=(e=c).length&&"function"==typeof e[e.length-1]?e.pop():o;if(Array.isArray(c[0])&&(c=c[0]),c.length<2)throw new s("streams");var p=c.map(function(e,n){var s,o,u,h,f,m,g=n<c.length-1;return s=n>0,u=o=function(e){t||(t=e),e&&p.forEach(l),g||(p.forEach(l),d(t))},h=!1,o=function(){h||(h=!0,u.apply(void 0,arguments))},f=!1,e.on("close",function(){f=!0}),void 0===i&&(i=r(89452)),i(e,{readable:g,writable:s},function(e){if(e)return o(e);f=!0,o()}),m=!1,function(t){if(!f&&!m){if(m=!0,e.setHeader&&"function"==typeof e.abort)return e.abort();if("function"==typeof e.destroy)return e.destroy();o(t||new a("pipe"))}}});return c.reduce(u)}},34729:(e,t,r)=>{"use strict";var i=r(52171).F.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,n){var s=null!=t.highWaterMark?t.highWaterMark:n?t[r]:null;if(null!=s){if(!(isFinite(s)&&Math.floor(s)===s)||s<0)throw new i(n?r:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}},15450:(e,t,r)=>{e.exports=r(27910)},68280:(e,t,r)=>{var i=r(27910);"disable"===process.env.READABLE_STREAM&&i?(e.exports=i.Readable,Object.assign(e.exports,i),e.exports.Stream=i):((t=e.exports=r(98418)).Stream=i||t,t.Readable=t,t.Writable=r(54254),t.Duplex=r(49152),t.Transform=r(89584),t.PassThrough=r(54646),t.finished=r(89452),t.pipeline=r(54024))},33162:(e,t,r)=>{e.exports=c;let i=r(29021),{EventEmitter:n}=r(94735),{Minimatch:s}=r(75065),{resolve:a}=r(33873);async function*o(e,t,r,n,s,a){var l;for(let u of(await (l=t+e,new Promise((e,t)=>{i.readdir(l,{withFileTypes:!0},(r,i)=>{if(r)switch(r.code){case"ENOTDIR":a?t(r):e([]);break;case"ENOTSUP":case"ENOENT":case"ENAMETOOLONG":case"UNKNOWN":e([]);break;default:t(r)}else e(i)})})))){let a=u.name;void 0===a&&(a=u,n=!0);let l=e+"/"+a,c=l.slice(1),h=t+"/"+c,d=null;(n||r)&&(d=await function e(t,r){return new Promise((n,s)=>{(r?i.stat:i.lstat)(t,(i,s)=>{i?"ENOENT"===i.code&&r?n(e(t,!1)):n(null):n(s)})})}(h,r)),d||void 0===u.name||(d=u),null===d&&(d={isDirectory:()=>!1}),d.isDirectory()?s(c)||(yield{relative:c,absolute:h,stats:d},yield*o(l,t,r,n,s,!1)):yield{relative:c,absolute:h,stats:d}}}async function*l(e,t,r,i){yield*o("",e,t,r,i,!0)}class u extends n{constructor(e,t,r){if(super(),"function"==typeof t&&(r=t,t=null),this.options=function(e){return{pattern:e.pattern,dot:!!e.dot,noglobstar:!!e.noglobstar,matchBase:!!e.matchBase,nocase:!!e.nocase,ignore:e.ignore,skip:e.skip,follow:!!e.follow,stat:!!e.stat,nodir:!!e.nodir,mark:!!e.mark,silent:!!e.silent,absolute:!!e.absolute}}(t||{}),this.matchers=[],this.options.pattern){let e=Array.isArray(this.options.pattern)?this.options.pattern:[this.options.pattern];this.matchers=e.map(e=>new s(e,{dot:this.options.dot,noglobstar:this.options.noglobstar,matchBase:this.options.matchBase,nocase:this.options.nocase}))}if(this.ignoreMatchers=[],this.options.ignore){let e=Array.isArray(this.options.ignore)?this.options.ignore:[this.options.ignore];this.ignoreMatchers=e.map(e=>new s(e,{dot:!0}))}if(this.skipMatchers=[],this.options.skip){let e=Array.isArray(this.options.skip)?this.options.skip:[this.options.skip];this.skipMatchers=e.map(e=>new s(e,{dot:!0}))}this.iterator=l(a(e||"."),this.options.follow,this.options.stat,this._shouldSkipDirectory.bind(this)),this.paused=!1,this.inactive=!1,this.aborted=!1,r&&(this._matches=[],this.on("match",e=>this._matches.push(this.options.absolute?e.absolute:e.relative)),this.on("error",e=>r(e)),this.on("end",()=>r(null,this._matches))),setTimeout(()=>this._next(),0)}_shouldSkipDirectory(e){return this.skipMatchers.some(t=>t.match(e))}_fileMatches(e,t){let r=e+(t?"/":"");return(0===this.matchers.length||this.matchers.some(e=>e.match(r)))&&!this.ignoreMatchers.some(e=>e.match(r))&&(!this.options.nodir||!t)}_next(){this.paused||this.aborted?this.inactive=!0:this.iterator.next().then(e=>{if(e.done)this.emit("end");else{let t=e.value.stats.isDirectory();if(this._fileMatches(e.value.relative,t)){let r=e.value.relative,i=e.value.absolute;this.options.mark&&t&&(r+="/",i+="/"),this.options.stat?this.emit("match",{relative:r,absolute:i,stat:e.value.stats}):this.emit("match",{relative:r,absolute:i})}this._next(this.iterator)}}).catch(e=>{this.abort(),this.emit("error",e),e.code||this.options.silent||console.error(e)})}abort(){this.aborted=!0}pause(){this.paused=!0}resume(){this.paused=!1,this.inactive&&(this.inactive=!1,this._next())}}function c(e,t,r){return new u(e,t,r)}c.ReaddirGlob=u},20549:(e,t,r)=>{var i=r(79428),n=i.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=i:(s(i,t),t.Buffer=a),s(n,a),a.from=function(e,t,r){if("number"==typeof e)throw TypeError("Argument must not be a number");return n(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},a.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return i.SlowBuffer(e)}},40185:(e,t,r)=>{var i=r(79428),n=i.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=i:(s(i,t),t.Buffer=a),a.prototype=Object.create(n.prototype),s(n,a),a.from=function(e,t,r){if("number"==typeof e)throw TypeError("Argument must not be a number");return n(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},a.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return i.SlowBuffer(e)}},15959:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(2203),n=r(69141),s=r(18162);var a=i.isS,o=i.isChar,l=i.isNameStartChar,u=i.isNameChar,c=i.S_LIST,h=i.NAME_RE,d=n.isChar,p=s.isNCNameStartChar,f=s.isNCNameChar,m=s.NC_NAME_RE;let g="http://www.w3.org/XML/1998/namespace",y="http://www.w3.org/2000/xmlns/",v={__proto__:null,xml:g,xmlns:y},b={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},w=e=>34===e||39===e,x=[34,39],S=[...x,91,62],E=[...x,60,93],T=[61,63,...c],k=[...c,62,38,60];function O(e,t,r){switch(t){case"xml":r!==g&&e.fail(`xml prefix must be bound to ${g}.`);break;case"xmlns":r!==y&&e.fail(`xmlns prefix must be bound to ${y}.`)}switch(r){case y:e.fail(""===t?`the default namespace may not be set to ${r}.`:`may not assign a prefix (even "xmlns") to the URI \
${y}.`);break;case g:switch(t){case"xml":break;case"":e.fail(`the default namespace may not be set to ${r}.`);break;default:e.fail("may not assign the xml namespace to another prefix.")}}}let C=e=>m.test(e),A=e=>h.test(e);t.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];let N={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};class R{constructor(e){this.opt=null!=e?e:{},this.fragmentOpt=!!this.opt.fragment;let t=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=!1!==this.opt.position,this.fileName=this.opt.fileName,t){this.nameStartCheck=p,this.nameCheck=f,this.isName=C,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},v);let e=this.opt.additionalNamespaces;null!=e&&(function(e,t){for(let r of Object.keys(t))O(e,r,t[r])}(this,e),Object.assign(this.ns,e))}else this.nameStartCheck=l,this.nameCheck=u,this.isName=A,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var e;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];let{fragmentOpt:t}=this;this.state=t?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=t,this.xmlDeclPossible=!t,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:r}=this.opt;if(void 0===r){if(!0===this.opt.forceXMLVersion)throw Error("forceXMLVersion set but defaultXMLVersion is not set");r="1.0"}this.setXMLVersion(r),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(b),null===(e=this.readyHandler)||void 0===e||e.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(e,t){this[N[e]]=t}off(e){this[N[e]]=void 0}makeError(e){var t;let r=null!==(t=this.fileName)&&void 0!==t?t:"";return this.trackPosition&&(r.length>0&&(r+=":"),r+=`${this.line}:${this.column}`),r.length>0&&(r+=": "),Error(r+e)}fail(e){let t=this.makeError(e),r=this.errorHandler;if(void 0===r)throw t;return r(t),this}write(e){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let t=!1;null===e?(t=!0,e=""):"object"==typeof e&&(e=e.toString()),void 0!==this.carriedFromPrevious&&(e=`${this.carriedFromPrevious}${e}`,this.carriedFromPrevious=void 0);let r=e.length,i=e.charCodeAt(r-1);!t&&(13===i||i>=55296&&i<=56319)&&(this.carriedFromPrevious=e[r-1],r--,e=e.slice(0,r));let{stateTable:n}=this;for(this.chunk=e,this.i=0;this.i<r;)n[this.state].call(this);return this.chunkPosition+=r,t?this.end():this}close(){return this.write(null)}getCode10(){let{chunk:e,i:t}=this;if(this.prevI=t,this.i=t+1,t>=e.length)return -1;let r=e.charCodeAt(t);if(this.column++,r<55296){if(r>=32||9===r)return r;switch(r){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return 10===e.charCodeAt(t+1)&&(this.i=t+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;let i=65536+(r-55296)*1024+(e.charCodeAt(t+1)-56320);return this.i=t+2,i>1114111&&this.fail("disallowed character."),i}getCode11(){let{chunk:e,i:t}=this;if(this.prevI=t,this.i=t+1,t>=e.length)return -1;let r=e.charCodeAt(t);if(this.column++,r<55296){if(r>31&&r<127||r>159&&8232!==r||9===r)return r;switch(r){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{let r=e.charCodeAt(t+1);(10===r||133===r)&&(this.i=t+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;let i=65536+(r-55296)*1024+(e.charCodeAt(t+1)-56320);return this.i=t+2,i>1114111&&this.fail("disallowed character."),i}getCodeNorm(){let e=this.getCode();return -2===e?10:e}unget(){this.i=this.prevI,this.column--}captureTo(e){let{i:t}=this,{chunk:r}=this;for(;;){let i=this.getCode(),n=-2===i,s=n?10:i;if(-1===s||e.includes(s))return this.text+=r.slice(t,this.prevI),s;n&&(this.text+=`${r.slice(t,this.prevI)}
`,t=this.i)}}captureToChar(e){let{i:t}=this,{chunk:r}=this;for(;;){let i=this.getCode();switch(i){case -2:this.text+=`${r.slice(t,this.prevI)}
`,t=this.i,i=10;break;case -1:return this.text+=r.slice(t),!1}if(i===e)return this.text+=r.slice(t,this.prevI),!0}}captureNameChars(){let{chunk:e,i:t}=this;for(;;){let r=this.getCode();if(-1===r)return this.name+=e.slice(t),-1;if(!u(r))return this.name+=e.slice(t,this.prevI),-2===r?10:r}}skipSpaces(){for(;;){let e=this.getCodeNorm();if(-1===e||!a(e))return e}}setXMLVersion(e){this.currentXMLVersion=e,"1.0"===e?(this.isChar=o,this.getCode=this.getCode10):(this.isChar=d,this.getCode=this.getCode11)}sBegin(){65279===this.chunk.charCodeAt(0)&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){let e=this.i,t=this.skipSpaces();switch(this.prevI!==e&&(this.xmlDeclPossible=!1),t){case 60:if(this.state=15,0!==this.text.length)throw Error("no-empty text at start");break;case -1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var e;let t=this.captureTo(S);switch(t){case 62:null===(e=this.doctypeHandler)||void 0===e||e.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case -1:break;default:this.text+=String.fromCodePoint(t),91===t?this.state=4:w(t)&&(this.state=3,this.q=t)}}sDoctypeQuote(){let e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.q=null,this.state=2)}sDTD(){let e=this.captureTo(E);-1!==e&&(this.text+=String.fromCodePoint(e),93===e?this.state=2:60===e?this.state=6:w(e)&&(this.state=5,this.q=e))}sDTDQuoted(){let e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.state=4,this.q=null)}sDTDOpenWaka(){let e=this.getCodeNorm();switch(this.text+=String.fromCodePoint(e),e){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){let e=String.fromCodePoint(this.getCodeNorm()),t=this.openWakaBang+=e;this.text+=e,"-"!==t&&(this.state="--"===t?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),this.state=45===e?10:8}sDTDCommentEnded(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),62===e?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),62===e&&(this.state=4)}sText(){0!==this.tags.length?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:e}=this,{chunk:t}=this;a:for(;;)switch(this.getCode()){case -2:this.entity+=`${t.slice(e,this.prevI)}
`,e=this.i;break;case 59:{let r;let{entityReturnState:i}=this,n=this.entity+t.slice(e,this.prevI);this.state=i,""===n?(this.fail("empty entity name."),r="&;"):(r=this.parseEntity(n),this.entity=""),(13!==i||void 0!==this.textHandler)&&(this.text+=r);break a}case -1:this.entity+=t.slice(e);break a}}sOpenWaka(){let e=this.getCode();if(l(e))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(e){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var e;let t=this.getCodeNorm();45===t?(this.state=19,null===(e=this.commentHandler)||void 0===e||e.call(this,this.text),this.text=""):(this.text+=`-${String.fromCodePoint(t)}`,this.state=17)}sCommentEnded(){let e=this.getCodeNorm();62!==e?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(e)}`,this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){let e=this.getCodeNorm();93===e?this.state=22:(this.text+=`]${String.fromCodePoint(e)}`,this.state=20)}sCDataEnding2(){var e;let t=this.getCodeNorm();switch(t){case 62:null===(e=this.cdataHandler)||void 0===e||e.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(t)}`,this.state=20}}sPIFirstChar(){let e=this.getCodeNorm();this.nameStartCheck(e)?(this.piTarget+=String.fromCodePoint(e),this.state=24):63===e||a(e)?(this.fail("processing instruction without a target."),this.state=63===e?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(e),this.state=24)}sPIRest(){let{chunk:e,i:t}=this;for(;;){let r=this.getCodeNorm();if(-1===r){this.piTarget+=e.slice(t);return}if(!this.nameCheck(r)){this.piTarget+=e.slice(t,this.prevI);let i=63===r;i||a(r)?"xml"===this.piTarget?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=i?33:27):this.state=i?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(r));break}}}sPIBody(){if(0===this.text.length){let e=this.getCodeNorm();63===e?this.state=26:a(e)||(this.text=String.fromCodePoint(e))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var e;let t=this.getCodeNorm();if(62===t){let{piTarget:t}=this;"xml"===t.toLowerCase()&&this.fail("the XML declaration must appear at the start of the document."),null===(e=this.piHandler)||void 0===e||e.call(this,{target:t,body:this.text}),this.piTarget=this.text="",this.state=13}else 63===t?this.text+="?":(this.text+=`?${String.fromCodePoint(t)}`,this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){let e=this.skipSpaces();if(63===e){this.state=33;return}-1!==e&&(this.state=28,this.name=String.fromCodePoint(e))}sXMLDeclName(){let e=this.captureTo(T);if(63===e){this.state=33,this.name+=this.text,this.text="",this.fail("XML declaration is incomplete.");return}if(a(e)||61===e){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=61===e?30:29}}sXMLDeclEq(){let e=this.getCodeNorm();if(63===e){this.state=33,this.fail("XML declaration is incomplete.");return}a(e)||(61!==e&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){let e=this.getCodeNorm();if(63===e){this.state=33,this.fail("XML declaration is incomplete.");return}a(e)||(w(e)?this.q=e:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){let e=this.captureTo([this.q,63]);if(63===e){this.state=33,this.text="",this.fail("XML declaration is incomplete.");return}if(-1===e)return;let t=this.text;switch(this.text="",this.name){case"version":this.xmlDeclExpects=["encoding","standalone"],this.xmlDecl.version=t,/^1\.[0-9]+$/.test(t)?this.opt.forceXMLVersion||this.setXMLVersion(t):this.fail("version number must match /^1\\.[0-9]+$/.");break;case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(t)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=t;break;case"standalone":"yes"!==t&&"no"!==t&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=t}this.name="",this.state=32}sXMLDeclSeparator(){let e=this.getCodeNorm();if(63===e){this.state=33;return}a(e)||(this.fail("whitespace required."),this.unget()),this.state=27}sXMLDeclEnding(){var e;62===this.getCodeNorm()?("xml"!==this.piTarget?this.fail("processing instructions are not allowed before root."):"version"!==this.name&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),null===(e=this.xmldeclHandler)||void 0===e||e.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var e;let t=this.captureNameChars();if(-1===t)return;let r=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=r.ns=Object.create(null)),null===(e=this.openTagStartHandler)||void 0===e||e.call(this,r),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),t){case 62:this.openTag();break;case 47:this.state=35;break;default:a(t)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){62===this.getCode()?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){let e=this.skipSpaces();-1!==e&&(l(e)?(this.unget(),this.state=37):62===e?this.openTag():47===e?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){let e=this.captureNameChars();61===e?this.state=39:a(e)?this.state=38:62===e?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):-1!==e&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){let e=this.skipSpaces();switch(e){case -1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",62===e?this.openTag():l(e)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){let e=this.getCodeNorm();w(e)?(this.q=e,this.state=40):a(e)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){let{q:e,chunk:t}=this,{i:r}=this;for(;;)switch(this.getCode()){case e:this.pushAttrib(this.name,this.text+t.slice(r,this.prevI)),this.name=this.text="",this.q=null,this.state=41;return;case 38:this.text+=t.slice(r,this.prevI),this.state=14,this.entityReturnState=40;return;case 10:case -2:case 9:this.text+=`${t.slice(r,this.prevI)} `,r=this.i;break;case 60:this.text+=t.slice(r,this.prevI),this.fail("disallowed character.");return;case -1:this.text+=t.slice(r);return}}sAttribValueClosed(){let e=this.getCodeNorm();a(e)?this.state=36:62===e?this.openTag():47===e?this.state=35:l(e)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){let e=this.captureTo(k);switch(e){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case -1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",62===e?this.openTag():this.state=36}}sCloseTag(){let e=this.captureNameChars();62===e?this.closeTag():a(e)?this.state=44:-1!==e&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case -1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:e,forbiddenState:t}=this,{chunk:r,textHandler:i}=this;o:for(;;)switch(this.getCode()){case 60:if(this.state=15,void 0!==i){let{text:t}=this,n=r.slice(e,this.prevI);0!==t.length?(i(t+n),this.text=""):0!==n.length&&i(n)}t=0;break o;case 38:this.state=14,this.entityReturnState=13,void 0!==i&&(this.text+=r.slice(e,this.prevI)),t=0;break o;case 93:switch(t){case 0:t=1;break;case 1:t=2;break;case 2:break;default:throw Error("impossible state")}break;case 62:2===t&&this.fail('the string "]]>" is disallowed in char data.'),t=0;break;case -2:void 0!==i&&(this.text+=`${r.slice(e,this.prevI)}
`),e=this.i,t=0;break;case -1:void 0!==i&&(this.text+=r.slice(e));break o;default:t=0}this.forbiddenState=t}handleTextOutsideRoot(){let{i:e}=this,{chunk:t,textHandler:r}=this,i=!1;l:for(;;){let n=this.getCode();switch(n){case 60:if(this.state=15,void 0!==r){let{text:i}=this,n=t.slice(e,this.prevI);0!==i.length?(r(i+n),this.text=""):0!==n.length&&r(n)}break l;case 38:this.state=14,this.entityReturnState=13,void 0!==r&&(this.text+=t.slice(e,this.prevI)),i=!0;break l;case -2:void 0!==r&&(this.text+=`${t.slice(e,this.prevI)}
`),e=this.i;break;case -1:void 0!==r&&(this.text+=t.slice(e));break l;default:a(n)||(i=!0)}}i&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(e,t){var r;let{prefix:i,local:n}=this.qname(e),s={name:e,prefix:i,local:n,value:t};if(this.attribList.push(s),null===(r=this.attributeHandler)||void 0===r||r.call(this,s),"xmlns"===i){let e=t.trim();"1.0"===this.currentXMLVersion&&""===e&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[n]=e,O(this,n,e)}else if("xmlns"===e){let e=t.trim();this.topNS[""]=e,O(this,"",e)}}pushAttribPlain(e,t){var r;let i={name:e,value:t};this.attribList.push(i),null===(r=this.attributeHandler)||void 0===r||r.call(this,i)}end(){var e,t;this.sawRoot||this.fail("document must contain a root element.");let{tags:r}=this;for(;r.length>0;){let e=r.pop();this.fail(`unclosed tag: ${e.name}`)}0!==this.state&&13!==this.state&&this.fail("unexpected end.");let{text:i}=this;return 0!==i.length&&(null===(e=this.textHandler)||void 0===e||e.call(this,i),this.text=""),this._closed=!0,null===(t=this.endHandler)||void 0===t||t.call(this),this._init(),this}resolve(e){var t,r;let i=this.topNS[e];if(void 0!==i)return i;let{tags:n}=this;for(let t=n.length-1;t>=0;t--)if(void 0!==(i=n[t].ns[e]))return i;return void 0!==(i=this.ns[e])?i:null===(r=(t=this.opt).resolvePrefix)||void 0===r?void 0:r.call(t,e)}qname(e){let t=e.indexOf(":");if(-1===t)return{prefix:"",local:e};let r=e.slice(t+1),i=e.slice(0,t);return(""===i||""===r||r.includes(":"))&&this.fail(`malformed name: ${e}.`),{prefix:i,local:r}}processAttribsNS(){var e;let{attribList:t}=this,r=this.tag;{let{prefix:t,local:i}=this.qname(r.name);r.prefix=t,r.local=i;let n=r.uri=null!==(e=this.resolve(t))&&void 0!==e?e:"";""!==t&&("xmlns"===t&&this.fail('tags may not have "xmlns" as prefix.'),""===n&&(this.fail(`unbound namespace prefix: ${JSON.stringify(t)}.`),r.uri=t))}if(0===t.length)return;let{attributes:i}=r,n=new Set;for(let e of t){let t,r;let{name:s,prefix:a,local:o}=e;""===a?(t="xmlns"===s?y:"",r=s):(void 0===(t=this.resolve(a))&&(this.fail(`unbound namespace prefix: ${JSON.stringify(a)}.`),t=a),r=`{${t}}${o}`),n.has(r)&&this.fail(`duplicate attribute: ${r}.`),n.add(r),e.uri=t,i[s]=e}this.attribList=[]}processAttribsPlain(){let{attribList:e}=this,t=this.tag.attributes;for(let{name:r,value:i}of e)void 0!==t[r]&&this.fail(`duplicate attribute: ${r}.`),t[r]=i;this.attribList=[]}openTag(){var e;this.processAttribs();let{tags:t}=this,r=this.tag;r.isSelfClosing=!1,null===(e=this.openTagHandler)||void 0===e||e.call(this,r),t.push(r),this.state=13,this.name=""}openSelfClosingTag(){var e,t,r;this.processAttribs();let{tags:i}=this,n=this.tag;n.isSelfClosing=!0,null===(e=this.openTagHandler)||void 0===e||e.call(this,n),null===(t=this.closeTagHandler)||void 0===t||t.call(this,n),null===(this.tag=null!==(r=i[i.length-1])&&void 0!==r?r:null)&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){let{tags:e,name:t}=this;if(this.state=13,this.name="",""===t){this.fail("weird empty close tag."),this.text+="</>";return}let r=this.closeTagHandler,i=e.length;for(;i-- >0;){let i=this.tag=e.pop();if(this.topNS=i.ns,null==r||r(i),i.name===t)break;this.fail("unexpected close tag.")}0===i?this.closedRoot=!0:i<0&&(this.fail(`unmatched closing tag: ${t}.`),this.text+=`</${t}>`)}parseEntity(e){if("#"!==e[0]){let t=this.ENTITIES[e];return void 0!==t?t:(this.fail(this.isName(e)?"undefined entity.":"disallowed character in entity name."),`&${e};`)}let t=NaN;return("x"===e[1]&&/^#x[0-9a-f]+$/i.test(e)?t=parseInt(e.slice(2),16):/^#[0-9]+$/.test(e)&&(t=parseInt(e.slice(1),10)),this.isChar(t))?String.fromCodePoint(t):(this.fail("malformed character entity."),`&${e};`)}}t.SaxesParser=R},90080:(e,t,r)=>{"use strict";var i=r(20549).Buffer,n=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){var t;if(!e)return"utf8";for(;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===n||!n(e)))throw Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=c,this.end=h,t=3;break;default:this.write=d,this.end=p;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if((192&t[0])!=128)return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if((192&t[1])!=128)return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&(192&t[2])!=128)return e.lastNeed=2,""}}(this,e,0);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(e.copy(this.lastChar,t,0,e.length),this.lastNeed-=e.length)}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function c(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}t.I=s,s.prototype.write=function(e){var t,r;if(0===e.length)return"";if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var n=a(t[i]);return n>=0?(n>0&&(e.lastNeed=n-1),n):--i<r||-2===n?0:(n=a(t[i]))>=0?(n>0&&(e.lastNeed=n-2),n):--i<r||-2===n?0:(n=a(t[i]))>=0?(n>0&&(2===n?n=0:e.lastNeed=n-3),n):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},47143:(e,t,r)=>{"use strict";var i=r(40185).Buffer,n=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){var t;if(!e)return"utf8";for(;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===n||!n(e)))throw Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=c,this.end=h,t=3;break;default:this.write=d,this.end=p;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if((192&t[0])!=128)return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if((192&t[1])!=128)return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&(192&t[2])!=128)return e.lastNeed=2,""}}(this,e,0);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(e.copy(this.lastChar,t,0,e.length),this.lastNeed-=e.length)}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function c(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}t.I=s,s.prototype.write=function(e){var t,r;if(0===e.length)return"";if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var n=a(t[i]);return n>=0?(n>0&&(e.lastNeed=n-1),n):--i<r||-2===n?0:(n=a(t[i]))>=0?(n>0&&(e.lastNeed=n-2),n):--i<r||-2===n?0:(n=a(t[i]))>=0?(n>0&&(2===n?n=0:e.lastNeed=n-3),n):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},88682:(e,t,r)=>{var i=r(28354),n=r(42396),s=r(34641),a=r(68280).Writable,o=r(68280).PassThrough,l=function(){},u=function(e){return(e&=511)&&512-e},c=function(e,t){var r=new h(e,t);return r.end(),r},h=function(e,t){this._parent=e,this.offset=t,o.call(this,{autoDestroy:!1})};i.inherits(h,o),h.prototype.destroy=function(e){this._parent.destroy(e)};var d=function(e){if(!(this instanceof d))return new d(e);a.call(this,e),e=e||{},this._offset=0,this._buffer=n(),this._missing=0,this._partial=!1,this._onparse=l,this._header=null,this._stream=null,this._overflow=null,this._cb=null,this._locked=!1,this._destroyed=!1,this._pax=null,this._paxGlobal=null,this._gnuLongPath=null,this._gnuLongLinkPath=null;var t=this,r=t._buffer,i=function(){t._continue()},o=function(e){if(t._locked=!1,e)return t.destroy(e);t._stream||i()},p=function(){t._stream=null;var e=u(t._header.size);e?t._parse(e,f):t._parse(512,b),t._locked||i()},f=function(){t._buffer.consume(u(t._header.size)),t._parse(512,b),i()},m=function(){var e=t._header.size;t._paxGlobal=s.decodePax(r.slice(0,e)),r.consume(e),p()},g=function(){var e=t._header.size;t._pax=s.decodePax(r.slice(0,e)),t._paxGlobal&&(t._pax=Object.assign({},t._paxGlobal,t._pax)),r.consume(e),p()},y=function(){var i=t._header.size;this._gnuLongPath=s.decodeLongPath(r.slice(0,i),e.filenameEncoding),r.consume(i),p()},v=function(){var i=t._header.size;this._gnuLongLinkPath=s.decodeLongPath(r.slice(0,i),e.filenameEncoding),r.consume(i),p()},b=function(){var n,a,l,u=t._offset;try{l=t._header=s.decode(r.slice(0,512),e.filenameEncoding,e.allowUnknownFormat)}catch(e){t.emit("error",e)}if(r.consume(512),!l){t._parse(512,b),i();return}if("gnu-long-path"===l.type){t._parse(l.size,y),i();return}if("gnu-long-link-path"===l.type){t._parse(l.size,v),i();return}if("pax-global-header"===l.type){t._parse(l.size,m),i();return}if("pax-header"===l.type){t._parse(l.size,g),i();return}if(t._gnuLongPath&&(l.name=t._gnuLongPath,t._gnuLongPath=null),t._gnuLongLinkPath&&(l.linkname=t._gnuLongLinkPath,t._gnuLongLinkPath=null),t._pax&&(t._header=(n=l,(a=t._pax).path&&(n.name=a.path),a.linkpath&&(n.linkname=a.linkpath),a.size&&(n.size=parseInt(a.size,10)),n.pax=a,l=n),t._pax=null),t._locked=!0,!l.size||"directory"===l.type){t._parse(512,b),t.emit("entry",l,c(t,u),o);return}t._stream=new h(t,u),t.emit("entry",l,t._stream,o),t._parse(l.size,p),i()};this._onheader=b,this._parse(512,b)};i.inherits(d,a),d.prototype.destroy=function(e){!this._destroyed&&(this._destroyed=!0,e&&this.emit("error",e),this.emit("close"),this._stream&&this._stream.emit("close"))},d.prototype._parse=function(e,t){this._destroyed||(this._offset+=e,this._missing=e,t===this._onheader&&(this._partial=!1),this._onparse=t)},d.prototype._continue=function(){if(!this._destroyed){var e=this._cb;this._cb=l,this._overflow?this._write(this._overflow,void 0,e):e()}},d.prototype._write=function(e,t,r){if(!this._destroyed){var i=this._stream,n=this._buffer,s=this._missing;if(e.length&&(this._partial=!0),e.length<s)return(this._missing-=e.length,this._overflow=null,i)?i.write(e,r):(n.append(e),r());this._cb=r,this._missing=0;var a=null;e.length>s&&(a=e.slice(s),e=e.slice(0,s)),i?i.end(e):n.append(e),this._overflow=a,this._onparse()}},d.prototype._final=function(e){if(this._partial)return this.destroy(Error("Unexpected end of data"));e()},e.exports=d},34641:(e,t)=>{var r=Buffer.alloc,i=Buffer.from("ustar\0","binary"),n=Buffer.from("00","binary"),s=Buffer.from("ustar ","binary"),a=Buffer.from(" \0","binary"),o=parseInt("7777",8),l=function(e){switch(e){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null},u=function(e){switch(e){case"file":break;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0},c=function(e,t,r,i){for(;r<i;r++)if(e[r]===t)return r;return i},h=function(e){for(var t=256,r=0;r<148;r++)t+=e[r];for(var i=156;i<512;i++)t+=e[i];return t},d=function(e,t){return(e=e.toString(8)).length>t?"7777777777777777777".slice(0,t)+" ":"0000000000000000000".slice(0,t-e.length)+e+" "},p=function(e,t,r){if(128&(e=e.slice(t,t+r))[t=0])return function(e){if(128===e[0])t=!0;else{if(255!==e[0])return null;t=!1}for(var t,r=[],i=e.length-1;i>0;i--){var n=e[i];t?r.push(n):r.push(255-n)}var s=0,a=r.length;for(i=0;i<a;i++)s+=r[i]*Math.pow(256,i);return t?s:-1*s}(e);for(;t<e.length&&32===e[t];)t++;for(var i,n,s,a=(i=c(e,32,t,e.length),n=e.length,s=e.length,"number"!=typeof i?s:(i=~~i)>=n?n:i>=0||(i+=n)>=0?i:0);t<a&&0===e[t];)t++;return a===t?0:parseInt(e.slice(t,a).toString(),8)},f=function(e,t,r,i){return e.slice(t,c(e,0,t,t+r)).toString(i)},m=function(e){var t=Buffer.byteLength(e),r=Math.floor(Math.log(t)/Math.log(10))+1;return t+r>=Math.pow(10,r)&&r++,t+r+e};t.decodeLongPath=function(e,t){return f(e,0,e.length,t)},t.encodePax=function(e){var t="";e.name&&(t+=m(" path="+e.name+"\n")),e.linkname&&(t+=m(" linkpath="+e.linkname+"\n"));var r=e.pax;if(r)for(var i in r)t+=m(" "+i+"="+r[i]+"\n");return Buffer.from(t)},t.decodePax=function(e){for(var t={};e.length;){for(var r=0;r<e.length&&32!==e[r];)r++;var i=parseInt(e.slice(0,r).toString(),10);if(!i)break;var n=e.slice(r+1,i-1).toString(),s=n.indexOf("=");if(-1===s)break;t[n.slice(0,s)]=n.slice(s+1),e=e.slice(i)}return t},t.encode=function(e){var t=r(512),s=e.name,a="";if(5===e.typeflag&&"/"!==s[s.length-1]&&(s+="/"),Buffer.byteLength(s)!==s.length)return null;for(;Buffer.byteLength(s)>100;){var l=s.indexOf("/");if(-1===l)return null;a+=a?"/"+s.slice(0,l):s.slice(0,l),s=s.slice(l+1)}return Buffer.byteLength(s)>100||Buffer.byteLength(a)>155||e.linkname&&Buffer.byteLength(e.linkname)>100?null:(t.write(s),t.write(d(e.mode&o,6),100),t.write(d(e.uid,6),108),t.write(d(e.gid,6),116),t.write(d(e.size,11),124),t.write(d(e.mtime.getTime()/1e3|0,11),136),t[156]=48+u(e.type),e.linkname&&t.write(e.linkname,157),i.copy(t,257),n.copy(t,263),e.uname&&t.write(e.uname,265),e.gname&&t.write(e.gname,297),t.write(d(e.devmajor||0,6),329),t.write(d(e.devminor||0,6),337),a&&t.write(a,345),t.write(d(h(t),6),148),t)},t.decode=function(e,t,r){var n=0===e[156]?0:e[156]-48,o=f(e,0,100,t),u=p(e,100,8),c=p(e,108,8),d=p(e,116,8),m=p(e,124,12),g=p(e,136,12),y=l(n),v=0===e[157]?null:f(e,157,100,t),b=f(e,265,32),w=f(e,297,32),x=p(e,329,8),S=p(e,337,8),E=h(e);if(256===E)return null;if(E!==p(e,148,8))throw Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(0===i.compare(e,257,263))e[345]&&(o=f(e,345,155,t)+"/"+o);else if(0===s.compare(e,257,263)&&0===a.compare(e,263,265));else if(!r)throw Error("Invalid tar header: unknown format.");return 0===n&&o&&"/"===o[o.length-1]&&(n=5),{name:o,mode:u,uid:c,gid:d,size:m,mtime:new Date(1e3*g),type:y,linkname:v,uname:b,gname:w,devmajor:x,devminor:S}}},47851:(e,t,r)=>{t.extract=r(88682),t.pack=r(46010)},46010:(e,t,r)=>{var i=r(73252),n=r(25879),s=r(76225),a=Buffer.alloc,o=r(68280).Readable,l=r(68280).Writable,u=r(41204).StringDecoder,c=r(34641),h=parseInt("755",8),d=parseInt("644",8),p=a(1024),f=function(){},m=function(e,t){(t&=511)&&e.push(p.slice(0,512-t))},g=function(e){l.call(this),this.written=0,this._to=e,this._destroyed=!1};s(g,l),g.prototype._write=function(e,t,r){if(this.written+=e.length,this._to.push(e))return r();this._to._drain=r},g.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var y=function(){l.call(this),this.linkname="",this._decoder=new u("utf-8"),this._destroyed=!1};s(y,l),y.prototype._write=function(e,t,r){this.linkname+=this._decoder.write(e),r()},y.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var v=function(){l.call(this),this._destroyed=!1};s(v,l),v.prototype._write=function(e,t,r){r(Error("No body allowed for this entry"))},v.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var b=function(e){if(!(this instanceof b))return new b(e);o.call(this,e),this._drain=f,this._finalized=!1,this._finalizing=!1,this._destroyed=!1,this._stream=null};s(b,o),b.prototype.entry=function(e,t,r){if(this._stream)throw Error("already piping an entry");if(!this._finalized&&!this._destroyed){"function"==typeof t&&(r=t,t=null),r||(r=f);var s=this;if(e.size&&"symlink"!==e.type||(e.size=0),e.type||(e.type=function(e){switch(e&i.S_IFMT){case i.S_IFBLK:return"block-device";case i.S_IFCHR:return"character-device";case i.S_IFDIR:return"directory";case i.S_IFIFO:return"fifo";case i.S_IFLNK:return"symlink"}return"file"}(e.mode)),e.mode||(e.mode="directory"===e.type?h:d),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),"string"==typeof t&&(t=Buffer.from(t)),Buffer.isBuffer(t)){e.size=t.length,this._encode(e);var a=this.push(t);return m(s,e.size),a?process.nextTick(r):this._drain=r,new v}if("symlink"===e.type&&!e.linkname){var o=new y;return n(o,function(t){if(t)return s.destroy(),r(t);e.linkname=o.linkname,s._encode(e),r()}),o}if(this._encode(e),"file"!==e.type&&"contiguous-file"!==e.type)return process.nextTick(r),new v;var l=new g(this);return this._stream=l,n(l,function(t){return(s._stream=null,t)?(s.destroy(),r(t)):l.written!==e.size?(s.destroy(),r(Error("size mismatch"))):void(m(s,e.size),s._finalizing&&s.finalize(),r())}),l}},b.prototype.finalize=function(){if(this._stream){this._finalizing=!0;return}this._finalized||(this._finalized=!0,this.push(p),this.push(null))},b.prototype.destroy=function(e){!this._destroyed&&(this._destroyed=!0,e&&this.emit("error",e),this.emit("close"),this._stream&&this._stream.destroy&&this._stream.destroy())},b.prototype._encode=function(e){if(!e.pax){var t=c.encode(e);if(t){this.push(t);return}}this._encodePax(e)},b.prototype._encodePax=function(e){var t=c.encodePax({name:e.name,linkname:e.linkname,pax:e.pax}),r={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.length,mtime:e.mtime,type:"pax-header",linkname:e.linkname&&"PaxHeader",uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};this.push(c.encode(r)),this.push(t),m(this,t.length),r.size=e.size,r.type=e.type,this.push(c.encode(r))},b.prototype._read=function(e){var t=this._drain;this._drain=f,t()},e.exports=b},54319:(e,t,r)=>{let i=r(29021),n=r(21820),s=r(33873),a=r(55511),o={fs:i.constants,os:n.constants},l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",u=/XXXXXX/,c=(o.O_CREAT||o.fs.O_CREAT)|(o.O_EXCL||o.fs.O_EXCL)|(o.O_RDWR||o.fs.O_RDWR),h="win32"===n.platform(),d=o.EBADF||o.os.errno.EBADF,p=o.ENOENT||o.os.errno.ENOENT,f=[],m=i.rmdirSync.bind(i),g=!1;function y(e,t){return i.rm(e,{recursive:!0},t)}function v(e){return i.rmSync(e,{recursive:!0})}function b(e,t){var r,s;let a=A(e,t),o=a[0],l=a[1];r=function(e,t){if(e)return l(e);let r=t.tries;!function e(){try{let n=N(t);i.stat(n,function(t){if(!t)return r-- >0?e():l(Error("Could not get a unique tmp filename, max tries reached "+n));l(null,n)})}catch(e){l(e)}}()},s=function(e,t){if(e)return r(e);o.tmpdir=t;try{R(o,t)}catch(e){return r(e)}I("dir",o.dir,t,function(e,i){if(e)return r(e);o.dir=C(i)?"":i,I("template",o.template,t,function(e,t){if(e)return r(e);o.template=t,r(null,o)})})},i.realpath(o&&o.tmpdir||n.tmpdir(),s)}function w(e){let t=function(e){let t=e.tmpdir=L(e);R(e,t);let r=P("dir",e.dir,t);return e.dir=C(r)?"":r,e.template=P("template",e.template,t),e}(A(e)[0]),r=t.tries;do{let e=N(t);try{i.statSync(e)}catch(t){return e}}while(r-- >0);throw Error("Could not get a unique tmp filename, max tries reached")}function x(e,t){let r=function(e){if(e&&!j(e))return t(e);t()};0<=e[0]?i.close(e[0],function(){i.unlink(e[1],r)}):i.unlink(e[1],r)}function S(e){let t=null;try{0<=e[0]&&i.closeSync(e[0])}catch(e){if(!D(e,-d,"EBADF")&&!j(e))throw e}finally{try{i.unlinkSync(e[1])}catch(e){j(e)||(t=e)}}if(null!==t)throw t}function E(e,t,r,i){let n=k(S,[t,e],i),s=k(x,[t,e],i,n);return r.keep||f.unshift(n),i?n:s}function T(e,t,r){let n=t.unsafeCleanup?y:i.rmdir.bind(i),s=k(t.unsafeCleanup?v:m,e,r),a=k(n,e,r,s);return t.keep||f.unshift(s),r?s:a}function k(e,t,r,i){let n=!1;return function s(a){if(!n){let o=f.indexOf(i||s);return(o>=0&&f.splice(o,1),n=!0,r||e===m||e===v)?e(t):e(t,a||function(){})}}}function O(e){let t=[],r=null;try{r=a.randomBytes(e)}catch(t){r=a.pseudoRandomBytes(e)}for(let i=0;i<e;i++)t.push(l[r[i]%l.length]);return t.join("")}function C(e){return void 0===e}function A(e,t){if("function"==typeof e)return[{},e];if(C(e))return[{},t];let r={};for(let t of Object.getOwnPropertyNames(e))r[t]=e[t];return[r,t]}function N(e){let t=e.tmpdir;if(!C(e.name))return s.join(t,e.dir,e.name);if(!C(e.template))return s.join(t,e.dir,e.template).replace(u,O(6));let r=[e.prefix?e.prefix:"tmp","-",process.pid,"-",O(12),e.postfix?"-"+e.postfix:""].join("");return s.join(t,e.dir,r)}function R(e){if(!C(e.name)){let t=e.name;if(s.isAbsolute(t))throw Error(`name option must not contain an absolute path, found "${t}".`);let r=s.basename(t);if(".."===r||"."===r||r!==t)throw Error(`name option must not contain a path, found "${t}".`)}if(!C(e.template)&&!e.template.match(u))throw Error(`Invalid template, found "${e.template}".`);if(!C(e.tries)&&isNaN(e.tries)||e.tries<0)throw Error(`Invalid tries, found "${e.tries}".`);e.tries=C(e.name)?e.tries||3:1,e.keep=!!e.keep,e.detachDescriptor=!!e.detachDescriptor,e.discardDescriptor=!!e.discardDescriptor,e.unsafeCleanup=!!e.unsafeCleanup,e.prefix=C(e.prefix)?"":e.prefix,e.postfix=C(e.postfix)?"":e.postfix}function I(e,t,r,n){if(C(t))return n(null);!function(e,t,r){let n=s.isAbsolute(e)?e:s.join(t,e);i.stat(n,function(e){e?i.realpath(s.dirname(n),function(e,t){if(e)return r(e);r(null,s.join(t,s.basename(n)))}):i.realpath(n,r)})}(t,r,function(t,i){if(t)return n(t);let a=s.relative(r,i);if(!i.startsWith(r))return n(Error(`${e} option must be relative to "${r}", found "${a}".`));n(null,a)})}function P(e,t,r){if(C(t))return;let n=function(e,t){let r=s.isAbsolute(e)?e:s.join(t,e);try{return i.statSync(r),i.realpathSync(r)}catch(t){let e=i.realpathSync(s.dirname(r));return s.join(e,s.basename(r))}}(t,r),a=s.relative(r,n);if(!n.startsWith(r))throw Error(`${e} option must be relative to "${r}", found "${a}".`);return a}function j(e){return D(e,-p,"ENOENT")}function D(e,t,r){return h?e.code===r:e.code===r&&e.errno===t}function L(e){return i.realpathSync(e&&e.tmpdir||n.tmpdir())}process.addListener("exit",function(){if(g)for(;f.length;)try{f[0]()}catch(e){}}),Object.defineProperty(e.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return L()}}),e.exports.dir=function(e,t){let r=A(e,t),n=r[0],s=r[1];b(n,function(e,t){if(e)return s(e);i.mkdir(t,n.mode||448,function(e){if(e)return s(e);s(null,t,T(t,n,!1))})})},e.exports.dirSync=function(e){let t=A(e)[0],r=w(t);return i.mkdirSync(r,t.mode||448),{name:r,removeCallback:T(r,t,!0)}},e.exports.file=function(e,t){let r=A(e,t),n=r[0],s=r[1];b(n,function(e,t){if(e)return s(e);i.open(t,c,n.mode||384,function(e,r){return e?s(e):n.discardDescriptor?i.close(r,function(e){return s(e,t,void 0,E(t,-1,n,!1))}):void s(null,t,r,E(t,n.discardDescriptor||n.detachDescriptor?-1:r,n,!1))})})},e.exports.fileSync=function(e){let t=A(e)[0],r=t.discardDescriptor||t.detachDescriptor,n=w(t),s=i.openSync(n,c,t.mode||384);return t.discardDescriptor&&(i.closeSync(s),s=void 0),{name:n,fd:s,removeCallback:E(n,r?-1:s,t,!0)}},e.exports.tmpName=b,e.exports.tmpNameSync=w,e.exports.setGracefulCleanup=function(){g=!0}},21033:e=>{function t(e){if(!(this instanceof t))return new t(e);this.value=e}function r(e,t,r){var n=[],s=[],a=!0;return function e(o){var l=r?i(o):o,u={},c={node:l,node_:o,path:[].concat(n),parent:s.slice(-1)[0],key:n.slice(-1)[0],isRoot:0===n.length,level:n.length,circular:null,update:function(e){c.isRoot||(c.parent.node[c.key]=e),c.node=e},delete:function(){delete c.parent.node[c.key]},remove:function(){Array.isArray(c.parent.node)?c.parent.node.splice(c.key,1):delete c.parent.node[c.key]},before:function(e){u.before=e},after:function(e){u.after=e},pre:function(e){u.pre=e},post:function(e){u.post=e},stop:function(){a=!1}};if(!a)return c;if("object"==typeof l&&null!==l){c.isLeaf=0==Object.keys(l).length;for(var h=0;h<s.length;h++)if(s[h].node_===o){c.circular=s[h];break}}else c.isLeaf=!0;c.notLeaf=!c.isLeaf,c.notRoot=!c.isRoot;var d=t.call(c,c.node);if(void 0!==d&&c.update&&c.update(d),u.before&&u.before.call(c,c.node),"object"==typeof c.node&&null!==c.node&&!c.circular){s.push(c);var p=Object.keys(c.node);p.forEach(function(t,i){n.push(t),u.pre&&u.pre.call(c,c.node[t],t);var s=e(c.node[t]);r&&Object.hasOwnProperty.call(c.node,t)&&(c.node[t]=s.node),s.isLast=i==p.length-1,s.isFirst=0==i,u.post&&u.post.call(c,s),n.pop()}),s.pop()}return u.after&&u.after.call(c,c.node),c}(e).node}function i(e){var t;return"object"!=typeof e||null===e?e:(t=Array.isArray(e)?[]:e instanceof Date?new Date(e):e instanceof Boolean?new Boolean(e):e instanceof Number?new Number(e):e instanceof String?new String(e):Object.create(Object.getPrototypeOf(e)),Object.keys(e).forEach(function(r){t[r]=e[r]}),t)}e.exports=t,t.prototype.get=function(e){for(var t=this.value,r=0;r<e.length;r++){var i=e[r];if(!Object.hasOwnProperty.call(t,i)){t=void 0;break}t=t[i]}return t},t.prototype.set=function(e,t){for(var r=this.value,i=0;i<e.length-1;i++){var n=e[i];Object.hasOwnProperty.call(r,n)||(r[n]={}),r=r[n]}return r[e[i]]=t,t},t.prototype.map=function(e){return r(this.value,e,!0)},t.prototype.forEach=function(e){return this.value=r(this.value,e,!1),this.value},t.prototype.reduce=function(e,t){var r=1==arguments.length,i=r?this.value:t;return this.forEach(function(t){this.isRoot&&r||(i=e.call(this,i,t))}),i},t.prototype.deepEqual=function(e){if(1!=arguments.length)throw Error("deepEqual requires exactly one object to compare against");var r=!0,i=e;return this.forEach(function(n){var s=(function(){r=!1}).bind(this);if(!this.isRoot){if("object"!=typeof i)return s();i=i[this.key]}var a=i;this.post(function(){i=a});var o=function(e){return Object.prototype.toString.call(e)};if(this.circular)t(e).get(this.circular.path)!==a&&s();else if(typeof a!=typeof n)s();else if(null===a||null===n||void 0===a||void 0===n)a!==n&&s();else if(a.__proto__!==n.__proto__)s();else if(a===n);else if("function"==typeof a)a instanceof RegExp?a.toString()!=n.toString()&&s():a!==n&&s();else if("object"==typeof a){if("[object Arguments]"===o(n)||"[object Arguments]"===o(a))o(a)!==o(n)&&s();else if(a instanceof Date||n instanceof Date)a instanceof Date&&n instanceof Date&&a.getTime()===n.getTime()||s();else{var l=Object.keys(a),u=Object.keys(n);if(l.length!==u.length)return s();for(var c=0;c<l.length;c++){var h=l[c];Object.hasOwnProperty.call(n,h)||s()}}}}),r},t.prototype.paths=function(){var e=[];return this.forEach(function(t){e.push(this.path)}),e},t.prototype.nodes=function(){var e=[];return this.forEach(function(t){e.push(this.node)}),e},t.prototype.clone=function(){var e=[],t=[];return function r(n){for(var s=0;s<e.length;s++)if(e[s]===n)return t[s];if("object"!=typeof n||null===n)return n;var a=i(n);return e.push(n),t.push(a),Object.keys(n).forEach(function(e){a[e]=r(n[e])}),e.pop(),t.pop(),a}(this.value)},Object.keys(t.prototype).forEach(function(e){t[e]=function(r){var i=[].slice.call(arguments,1),n=t(r);return n[e].apply(n,i)}})},62159:(e,t,r)=>{var i=r(79428).Buffer;void 0===i.from&&(i.from=function(e,t,r){return new i(e,t,r)},i.alloc=i.from),e.exports=i},51167:(e,t,r)=>{var i=r(72886),n=r(27910),s=r(62159);n.Writable&&n.Writable.prototype.destroy||(n=r(32662)),e.exports=function(e){return new i(function(t,r){var i=[],a=n.Transform().on("finish",function(){t(s.concat(i))}).on("error",r);a._transform=function(e,t,r){i.push(e),r()},e.on("error",r).pipe(a)})}},3748:(e,t,r)=>{var i,n=r(62269),s=r(27910);function a(e,t){return i||function(){var e,t,r;for(t=0,i=[];t<256;t++){for(r=0,e=t;r<8;r++)e=1&e?0xedb88320^e>>>1:e>>>=1;i[t]=e>>>0}}(),e.charCodeAt&&(e=e.charCodeAt(0)),n(t).shiftRight(8).and(0xffffff).xor(i[n(t).xor(e).and(255)]).value}function o(){if(!(this instanceof o))return new o;this.key0=0x12345678,this.key1=0x23456789,this.key2=0x34567890}s.Writable&&s.Writable.prototype.destroy||(s=r(32662)),o.prototype.update=function(e){this.key0=a(e,this.key0),this.key1=n(this.key0).and(255).and(0xffffffff).add(this.key1),this.key1=n(this.key1).multiply(0x8088405).add(1).and(0xffffffff).value,this.key2=a(n(this.key1).shiftRight(24).and(255),this.key2)},o.prototype.decryptByte=function(e){var t=n(this.key2).or(2);return e^=n(t).multiply(n(1^t)).shiftRight(8).and(255),this.update(e),e},o.prototype.stream=function(){var e=s.Transform(),t=this;return e._transform=function(e,r,i){for(var n=0;n<e.length;n++)e[n]=t.decryptByte(e[n]);this.push(e),i()},e},e.exports=o},33985:(e,t,r)=>{var i=r(27910),n=r(28354);function s(){if(!(this instanceof s))return new s;i.Transform.call(this)}i.Writable&&i.Writable.prototype.destroy||(i=r(32662)),n.inherits(s,i.Transform),s.prototype._transform=function(e,t,r){r()},e.exports=s},54617:(e,t,r)=>{var i=r(30086),n=r(56142),s=r(81956),a=r(72886),o=r(51167),l=r(27640),u=r(62159),c=r(33873),h=r(81469).Writer,d=r(89667),p=u.alloc(4);p.writeUInt32LE(0x6054b50,0),e.exports=function(e,t){var r,u,f,m,g,y=n(),v=n(),b=t&&t.tailSize||80;return t&&t.crx&&(f=(r=e.stream(0).pipe(n())).pull(4).then(function(e){var t;if(0x34327243===e.readUInt32LE(0))return r.pull(12).then(function(e){t=i.parse(e).word32lu("version").word32lu("pubKeyLength").word32lu("signatureLength").vars}).then(function(){return r.pull(t.pubKeyLength+t.signatureLength)}).then(function(e){return t.publicKey=e.slice(0,t.pubKeyLength),t.signature=e.slice(t.pubKeyLength),t.size=16+t.pubKeyLength+t.signatureLength,t})})),e.size().then(function(t){return u=t,e.stream(Math.max(0,t-b)).on("error",function(e){y.emit("error",e)}).pipe(y),y.pull(p)}).then(function(){return a.props({directory:y.pull(22),crxHeader:f})}).then(function(t){var r=t.directory;if(m=t.crxHeader&&t.crxHeader.size||0,65535==(g=i.parse(r).word32lu("signature").word16lu("diskNumber").word16lu("diskStart").word16lu("numberOfRecordsOnDisk").word16lu("numberOfRecords").word32lu("sizeOfCentralDirectory").word32lu("offsetToStartOfCentralDirectory").word16lu("commentLength").vars).numberOfRecords||65535==g.numberOfRecords||0xffffffff==g.offsetToStartOfCentralDirectory){let t=u-(b-y.match+20),r=n();return e.stream(t).pipe(r),r.pull(20).then(function(t){return function(e,t){var r=i.parse(t).word32lu("signature").word32lu("diskNumber").word64lu("offsetToStartOfCentralDirectory").word32lu("numberOfDisks").vars;if(0x7064b50!=r.signature)throw Error("invalid zip64 end of central dir locator signature (0x07064b50): 0x"+r.signature.toString(16));var s=n();return e.stream(r.offsetToStartOfCentralDirectory).pipe(s),s.pull(56)}(e,t)}).then(function(e){g=function(e){var t=i.parse(e).word32lu("signature").word64lu("sizeOfCentralDirectory").word16lu("version").word16lu("versionsNeededToExtract").word32lu("diskNumber").word32lu("diskStart").word64lu("numberOfRecordsOnDisk").word64lu("numberOfRecords").word64lu("sizeOfCentralDirectory").word64lu("offsetToStartOfCentralDirectory").vars;if(0x6064b50!=t.signature)throw Error("invalid zip64 end of central dir locator signature (0x06064b50): 0x0"+t.signature.toString(16));return t}(e)})}g.offsetToStartOfCentralDirectory+=m}).then(function(){if(g.commentLength)return y.pull(g.commentLength).then(function(e){g.comment=e.toString("utf8")})}).then(function(){return e.stream(g.offsetToStartOfCentralDirectory).pipe(v),g.extract=function(e){if(!e||!e.path)throw Error("PATH_MISSING");return e.path=c.resolve(c.normalize(e.path)),g.files.then(function(t){return a.map(t,function(t){if("Directory"!=t.type){var r=c.join(e.path,t.path);if(0==r.indexOf(e.path)){var i=e.getWriter?e.getWriter({path:r}):h({path:r});return new a(function(r,n){t.stream(e.password).on("error",n).pipe(i).on("close",r).on("error",n)})}}},{concurrency:e.concurrency>1?e.concurrency:1})})},g.files=a.mapSeries(Array(g.numberOfRecords),function(){return v.pull(46).then(function(t){var r=i.parse(t).word32lu("signature").word16lu("versionMadeBy").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").word16lu("fileCommentLength").word16lu("diskNumber").word16lu("internalFileAttributes").word32lu("externalFileAttributes").word32lu("offsetToLocalFileHeader").vars;return r.offsetToLocalFileHeader+=m,r.lastModifiedDateTime=d(r.lastModifiedDate,r.lastModifiedTime),v.pull(r.fileNameLength).then(function(e){return r.pathBuffer=e,r.path=e.toString("utf8"),r.isUnicode=(2048&r.flags)!=0,v.pull(r.extraFieldLength)}).then(function(e){return r.extra=l(e,r),v.pull(r.fileCommentLength)}).then(function(t){return r.comment=t,r.type=0===r.uncompressedSize&&/[\/\\]$/.test(r.path)?"Directory":"File",r.stream=function(t){return s(e,r.offsetToLocalFileHeader,t,r)},r.buffer=function(e){return o(r.stream(e))},r})})}),a.props(g)})}},61338:(e,t,r)=>{var i=r(2720),n=r(72886),s=r(54617),a=r(27910);a.Writable&&a.Writable.prototype.destroy||(a=r(32662)),e.exports={buffer:function(e,t){return s({stream:function(t,r){var i=a.PassThrough();return i.end(e.slice(t,r)),i},size:function(){return n.resolve(e.length)}},t)},file:function(e,t){return s({stream:function(t,r){return i.createReadStream(e,{start:t,end:r&&t+r})},size:function(){return new n(function(t,r){i.stat(e,function(e,i){e?r(e):t(i.size)})})}},t)},url:function(e,t,r){if("string"==typeof t&&(t={url:t}),!t.url)throw"URL missing";return t.headers=t.headers||{},s({stream:function(r,i){var n=Object.create(t);return n.headers=Object.create(t.headers),n.headers.range="bytes="+r+"-"+(i||""),e(n)},size:function(){return new n(function(r,i){var n=e(t);n.on("response",function(e){n.abort(),e.headers["content-length"]?r(e.headers["content-length"]):i(Error("Missing content length header"))}).on("error",i)})}},r)},s3:function(e,t,r){return s({size:function(){return new n(function(r,i){e.headObject(t,function(e,t){e?i(e):r(t.ContentLength)})})},stream:function(r,i){var n={};for(var s in t)n[s]=t[s];return n.Range="bytes="+r+"-"+(i||""),e.getObject(n).createReadStream()}},r)},custom:function(e,t){return s(e,t)}}},81956:(e,t,r)=>{var i=r(72886),n=r(3748),s=r(56142),a=r(27910),o=r(30086),l=r(74075),u=r(27640),c=r(62159),h=r(89667);a.Writable&&a.Writable.prototype.destroy||(a=r(32662)),e.exports=function(e,t,r,d){var p=s(),f=a.PassThrough(),m=e.stream(t);return m.pipe(p).on("error",function(e){f.emit("error",e)}),f.vars=p.pull(30).then(function(e){var t=o.parse(e).word32lu("signature").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").vars;return t.lastModifiedDateTime=h(t.lastModifiedDate,t.lastModifiedTime),p.pull(t.fileNameLength).then(function(e){return t.fileName=e.toString("utf8"),p.pull(t.extraFieldLength)}).then(function(e){var s;return t.extra=u(e,t),d&&d.compressedSize&&(t=d),1&t.flags&&(s=p.pull(12).then(function(e){if(!r)throw Error("MISSING_PASSWORD");var i=n();String(r).split("").forEach(function(e){i.update(e)});for(var s=0;s<e.length;s++)e[s]=i.decryptByte(e[s]);t.decrypt=i,t.compressedSize-=12;var a=8&t.flags?t.lastModifiedTime>>8&255:t.crc32>>24&255;if(e[11]!==a)throw Error("BAD_PASSWORD");return t})),i.resolve(s).then(function(){return f.emit("vars",t),t})})}),f.vars.then(function(e){var t,r=!(8&e.flags)||e.compressedSize>0,i=e.compressionMethod?l.createInflateRaw():a.PassThrough();r?(f.size=e.uncompressedSize,t=e.compressedSize):(t=c.alloc(4)).writeUInt32LE(0x8074b50,0);var n=p.stream(t);e.decrypt&&(n=n.pipe(e.decrypt.stream())),n.pipe(i).on("error",function(e){f.emit("error",e)}).pipe(f).on("finish",function(){m.destroy?m.destroy():m.abort?m.abort():m.close?m.close():m.push?m.push():console.log("warning - unable to close stream")})}).catch(function(e){f.emit("error",e)}),f}},56142:(e,t,r)=>{var i=r(27910),n=r(72886),s=r(28354),a=r(62159);function o(){if(!(this instanceof o))return new o;i.Duplex.call(this,{decodeStrings:!1,objectMode:!0}),this.buffer=a.from("");var e=this;e.on("finish",function(){e.finished=!0,e.emit("chunk",!1)})}i.Writable&&i.Writable.prototype.destroy||(i=r(32662)),s.inherits(o,i.Duplex),o.prototype._write=function(e,t,r){this.buffer=a.concat([this.buffer,e]),this.cb=r,this.emit("chunk")},o.prototype.stream=function(e,t){var r,n=i.PassThrough(),s=this;function a(){if("function"==typeof s.cb){var e=s.cb;return s.cb=void 0,e()}}function o(){var i;if(s.buffer&&s.buffer.length){if("number"==typeof e)i=s.buffer.slice(0,e),s.buffer=s.buffer.slice(e),e-=i.length,r=!e;else{var l=s.buffer.indexOf(e);if(-1!==l)s.match=l,t&&(l+=e.length),i=s.buffer.slice(0,l),s.buffer=s.buffer.slice(l),r=!0;else{var u=s.buffer.length-e.length;u<=0?a():(i=s.buffer.slice(0,u),s.buffer=s.buffer.slice(u))}}i&&n.write(i,function(){(0===s.buffer.length||e.length&&s.buffer.length<=e.length)&&a()})}if(r)s.removeListener("chunk",o),n.end();else if(s.finished){s.removeListener("chunk",o),s.emit("error",Error("FILE_ENDED"));return}}return s.on("chunk",o),o(),n},o.prototype.pull=function(e,t){if(0===e)return n.resolve("");if(!isNaN(e)&&this.buffer.length>e){var r,s,o=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n.resolve(o)}var l=a.from(""),u=this,c=i.Transform();return c._transform=function(e,t,r){l=a.concat([l,e]),r()},new n(function(i,n){if(r=n,s=function(e){u.__emittedError=e,n(e)},u.finished)return n(Error("FILE_ENDED"));u.once("error",s),u.stream(e,t).on("error",n).pipe(c).on("finish",function(){i(l)}).on("error",n)}).finally(function(){u.removeListener("error",r),u.removeListener("error",s)})},o.prototype._read=function(){},e.exports=o},67071:(e,t,r)=>{e.exports=function(e){e.path=s.resolve(s.normalize(e.path));var t=new i(e),r=new a.Writable({objectMode:!0});r._write=function(t,r,i){if("Directory"==t.type)return i();var a=s.join(e.path,t.path);if(0!=a.indexOf(e.path))return i();let o=e.getWriter?e.getWriter({path:a}):n({path:a});t.pipe(o).on("error",i).on("close",i)};var u=o(t,r);return t.once("crx-header",function(e){u.crxHeader=e}),t.pipe(r).on("finish",function(){u.emit("close")}),u.promise=function(){return new l(function(e,t){u.on("close",e),u.on("error",t)})},u};var i=r(5426),n=r(81469).Writer,s=r(33873),a=r(27910),o=r(67412),l=r(72886)},5426:(e,t,r)=>{var i=r(28354),n=r(74075),s=r(27910),a=r(30086),o=r(72886),l=r(56142),u=r(33985),c=r(51167),h=r(27640),d=r(62159),p=r(89667);s.Writable&&s.Writable.prototype.destroy||(s=r(32662));var f=d.alloc(4);function m(e){if(!(this instanceof m))return new m(e);var t=this;t._opts=e||{verbose:!1},l.call(t,t._opts),t.on("finish",function(){t.emit("end"),t.emit("close")}),t._readRecord().catch(function(e){t.__emittedError&&t.__emittedError===e||t.emit("error",e)})}f.writeUInt32LE(0x6054b50,0),i.inherits(m,l),m.prototype._readRecord=function(){var e=this;return e.pull(4).then(function(t){if(0!==t.length){var r=t.readUInt32LE(0);if(0x34327243===r)return e._readCrxHeader();if(0x4034b50===r)return e._readFile();if(0x2014b50===r)return e.reachedCD=!0,e._readCentralDirectoryFileHeader();if(0x6054b50===r)return e._readEndOfCentralDirectoryRecord();if(e.reachedCD)return e.pull(f,!0).then(function(){return e._readEndOfCentralDirectoryRecord()});e.emit("error",Error("invalid signature: 0x"+r.toString(16)))}})},m.prototype._readCrxHeader=function(){var e=this;return e.pull(12).then(function(t){return e.crxHeader=a.parse(t).word32lu("version").word32lu("pubKeyLength").word32lu("signatureLength").vars,e.pull(e.crxHeader.pubKeyLength+e.crxHeader.signatureLength)}).then(function(t){return e.crxHeader.publicKey=t.slice(0,e.crxHeader.pubKeyLength),e.crxHeader.signature=t.slice(e.crxHeader.pubKeyLength),e.emit("crx-header",e.crxHeader),e._readRecord()})},m.prototype._readFile=function(){var e=this;return e.pull(26).then(function(t){var r=a.parse(t).word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").vars;return r.lastModifiedDateTime=p(r.lastModifiedDate,r.lastModifiedTime),e.crxHeader&&(r.crxHeader=e.crxHeader),e.pull(r.fileNameLength).then(function(t){var i=t.toString("utf8"),a=s.PassThrough(),l=!1;return a.autodrain=function(){l=!0;var e=a.pipe(u());return e.promise=function(){return new o(function(t,r){e.on("finish",t),e.on("error",r)})},e},a.buffer=function(){return c(a)},a.path=i,a.props={},a.props.path=i,a.props.pathBuffer=t,a.props.flags={isUnicode:(2048&r.flags)!=0},a.type=0===r.uncompressedSize&&/[\/\\]$/.test(i)?"Directory":"File",e._opts.verbose&&("Directory"===a.type?console.log("   creating:",i):"File"===a.type&&(0===r.compressionMethod?console.log(" extracting:",i):console.log("  inflating:",i))),e.pull(r.extraFieldLength).then(function(t){var u=h(t,r);a.vars=r,a.extra=u,e._opts.forceStream?e.push(a):(e.emit("entry",a),(e._readableState.pipesCount||e._readableState.pipes&&e._readableState.pipes.length)&&e.push(a)),e._opts.verbose&&console.log({filename:i,vars:r,extra:u});var c,p=!(8&r.flags)||r.compressedSize>0;a.__autodraining=l;var f=r.compressionMethod&&!l?n.createInflateRaw():s.PassThrough();return p?(a.size=r.uncompressedSize,c=r.compressedSize):(c=d.alloc(4)).writeUInt32LE(0x8074b50,0),new o(function(t,r){e.stream(c).pipe(f).on("error",function(t){e.emit("error",t)}).pipe(a).on("finish",function(){return p?e._readRecord().then(t).catch(r):e._processDataDescriptor(a).then(t).catch(r)})})})})})},m.prototype._processDataDescriptor=function(e){var t=this;return t.pull(16).then(function(r){var i=a.parse(r).word32lu("dataDescriptorSignature").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").vars;return e.size=i.uncompressedSize,t._readRecord()})},m.prototype._readCentralDirectoryFileHeader=function(){var e=this;return e.pull(42).then(function(t){var r=a.parse(t).word16lu("versionMadeBy").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").word16lu("fileCommentLength").word16lu("diskNumber").word16lu("internalFileAttributes").word32lu("externalFileAttributes").word32lu("offsetToLocalFileHeader").vars;return e.pull(r.fileNameLength).then(function(t){return r.fileName=t.toString("utf8"),e.pull(r.extraFieldLength)}).then(function(t){return e.pull(r.fileCommentLength)}).then(function(t){return e._readRecord()})})},m.prototype._readEndOfCentralDirectoryRecord=function(){var e=this;return e.pull(18).then(function(t){var r=a.parse(t).word16lu("diskNumber").word16lu("diskStart").word16lu("numberOfRecordsOnDisk").word16lu("numberOfRecords").word32lu("sizeOfCentralDirectory").word32lu("offsetToStartOfCentralDirectory").word16lu("commentLength").vars;return e.pull(r.commentLength).then(function(t){t=t.toString("utf8"),e.end(),e.push(null)})})},m.prototype.promise=function(){var e=this;return new o(function(t,r){e.on("finish",t),e.on("error",r)})},e.exports=m},89667:e=>{e.exports=function(e,t){return new Date(Date.UTC((e>>9&127)+1980,(e>>5&15)-1,31&e,t?t>>11:0,t?t>>5&63:0,t?(31&t)*2:0))}},27640:(e,t,r)=>{var i=r(30086);e.exports=function(e,t){for(var r;!r&&e&&e.length;){var n=i.parse(e).word16lu("signature").word16lu("partsize").word64lu("uncompressedSize").word64lu("compressedSize").word64lu("offset").word64lu("disknum").vars;1===n.signature?r=n:e=e.slice(n.partsize+4)}return r=r||{},0xffffffff===t.compressedSize&&(t.compressedSize=r.compressedSize),0xffffffff===t.uncompressedSize&&(t.uncompressedSize=r.uncompressedSize),0xffffffff===t.offsetToLocalFileHeader&&(t.offsetToLocalFileHeader=r.offset),r}},57460:(e,t,r)=>{var i=r(27910),n=r(5426),s=r(67412),a=r(51167);i.Writable&&i.Writable.prototype.destroy||(i=r(32662)),e.exports=function(e,t){var r,o=i.PassThrough({objectMode:!0}),l=i.PassThrough(),u=i.Transform({objectMode:!0}),c=e instanceof RegExp?e:e&&new RegExp(e);u._transform=function(e,t,i){if(r||c&&!c.exec(e.path))return e.autodrain(),i();r=!0,h.emit("entry",e),e.on("error",function(e){l.emit("error",e)}),e.pipe(l).on("error",function(e){i(e)}).on("finish",function(e){i(null,e)})},o.pipe(n(t)).on("error",function(e){l.emit("error",e)}).pipe(u).on("error",Object).on("finish",function(){r?l.end():l.emit("error",Error("PATTERN_NOT_FOUND"))});var h=s(o,l);return h.buffer=function(){return a(l)},h}},82811:(e,t,r)=>{"use strict";r(58189),r(29444),r(82971),t.Parse=r(5426),t.ParseOne=r(57460),t.Extract=r(67071),t.Open=r(61338)},82552:(e,t,r)=>{e.exports=r(28354).deprecate},1607:(e,t,r)=>{"use strict";let i,n;r.r(t),r.d(t,{NIL:()=>S,parse:()=>y,stringify:()=>p,v1:()=>g,v3:()=>b,v4:()=>w,v5:()=>x,validate:()=>h,version:()=>E});var s=r(55511),a=r.n(s);let o=new Uint8Array(256),l=o.length;function u(){return l>o.length-16&&(a().randomFillSync(o),l=0),o.slice(l,l+=16)}let c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,h=function(e){return"string"==typeof e&&c.test(e)},d=[];for(let e=0;e<256;++e)d.push((e+256).toString(16).substr(1));let p=function(e,t=0){let r=(d[e[t+0]]+d[e[t+1]]+d[e[t+2]]+d[e[t+3]]+"-"+d[e[t+4]]+d[e[t+5]]+"-"+d[e[t+6]]+d[e[t+7]]+"-"+d[e[t+8]]+d[e[t+9]]+"-"+d[e[t+10]]+d[e[t+11]]+d[e[t+12]]+d[e[t+13]]+d[e[t+14]]+d[e[t+15]]).toLowerCase();if(!h(r))throw TypeError("Stringified UUID is invalid");return r},f=0,m=0,g=function(e,t,r){let s=t&&r||0,a=t||Array(16),o=(e=e||{}).node||i,l=void 0!==e.clockseq?e.clockseq:n;if(null==o||null==l){let t=e.random||(e.rng||u)();null==o&&(o=i=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==l&&(l=n=(t[6]<<8|t[7])&16383)}let c=void 0!==e.msecs?e.msecs:Date.now(),h=void 0!==e.nsecs?e.nsecs:m+1,d=c-f+(h-m)/1e4;if(d<0&&void 0===e.clockseq&&(l=l+1&16383),(d<0||c>f)&&void 0===e.nsecs&&(h=0),h>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");f=c,m=h,n=l;let g=((0xfffffff&(c+=122192928e5))*1e4+h)%0x100000000;a[s++]=g>>>24&255,a[s++]=g>>>16&255,a[s++]=g>>>8&255,a[s++]=255&g;let y=c/0x100000000*1e4&0xfffffff;a[s++]=y>>>8&255,a[s++]=255&y,a[s++]=y>>>24&15|16,a[s++]=y>>>16&255,a[s++]=l>>>8|128,a[s++]=255&l;for(let e=0;e<6;++e)a[s+e]=o[e];return t||p(a)},y=function(e){let t;if(!h(e))throw TypeError("Invalid UUID");let r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/0x10000000000&255,r[11]=t/0x100000000&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function v(e,t,r){function i(e,i,n,s){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof i&&(i=y(i)),16!==i.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(i),a.set(e,i.length),(a=r(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,n){s=s||0;for(let e=0;e<16;++e)n[s+e]=a[e];return n}return p(a)}try{i.name=e}catch(e){}return i.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",i.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",i}let b=v("v3",48,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),a().createHash("md5").update(e).digest()}),w=function(e,t,r){let i=(e=e||{}).random||(e.rng||u)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=i[e];return t}return p(i)},x=v("v5",80,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),a().createHash("sha1").update(e).digest()}),S="00000000-0000-0000-0000-000000000000",E=function(e){if(!h(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},57083:e=>{e.exports=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw TypeError("need wrapper function");return Object.keys(t).forEach(function(e){i[e]=t[e]}),i;function i(){for(var e=Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var i=t.apply(this,e),n=e[e.length-1];return"function"==typeof i&&i!==n&&Object.keys(n).forEach(function(e){i[e]=n[e]}),i}}},2203:(e,t)=>{"use strict";function r(e){return e>=65&&e<=90||e>=97&&e<=122||58===e||95===e||8204===e||8205===e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(t,"__esModule",{value:!0}),t.CHAR="	\n\r --\uD800\uDC00-\uDBFF\uDFFF",t.S=" 	\r\n",t.NAME_START_CHAR=":A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8--------\uD800\uDC00-\uDB7F\uDFFF",t.NAME_CHAR="-"+t.NAME_START_CHAR+".0-9\xb7--",t.CHAR_RE=RegExp("^["+t.CHAR+"]$","u"),t.S_RE=RegExp("^["+t.S+"]+$","u"),t.NAME_START_CHAR_RE=RegExp("^["+t.NAME_START_CHAR+"]$","u"),t.NAME_CHAR_RE=RegExp("^["+t.NAME_CHAR+"]$","u"),t.NAME_RE=RegExp("^["+t.NAME_START_CHAR+"]["+t.NAME_CHAR+"]*$","u"),t.NMTOKEN_RE=RegExp("^["+t.NAME_CHAR+"]+$","u"),t.S_LIST=[32,10,13,9],t.isChar=function(e){return e>=32&&e<=55295||10===e||13===e||9===e||e>=57344&&e<=65533||e>=65536&&e<=1114111},t.isS=function(e){return 32===e||10===e||13===e||9===e},t.isNameStartChar=r,t.isNameChar=function(e){return r(e)||e>=48&&e<=57||45===e||46===e||183===e||e>=768&&e<=879||e>=8255&&e<=8256}},69141:(e,t)=>{"use strict";function r(e){return e>=65&&e<=90||e>=97&&e<=122||58===e||95===e||8204===e||8205===e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(t,"__esModule",{value:!0}),t.CHAR="\x01--\uD800\uDC00-\uDBFF\uDFFF",t.RESTRICTED_CHAR="\x01-\b\v\f\x0e-\x1f\x7f-\x84\x86-\x9f",t.S=" 	\r\n",t.NAME_START_CHAR=":A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8--------\uD800\uDC00-\uDB7F\uDFFF",t.NAME_CHAR="-"+t.NAME_START_CHAR+".0-9\xb7--",t.CHAR_RE=RegExp("^["+t.CHAR+"]$","u"),t.RESTRICTED_CHAR_RE=RegExp("^["+t.RESTRICTED_CHAR+"]$","u"),t.S_RE=RegExp("^["+t.S+"]+$","u"),t.NAME_START_CHAR_RE=RegExp("^["+t.NAME_START_CHAR+"]$","u"),t.NAME_CHAR_RE=RegExp("^["+t.NAME_CHAR+"]$","u"),t.NAME_RE=RegExp("^["+t.NAME_START_CHAR+"]["+t.NAME_CHAR+"]*$","u"),t.NMTOKEN_RE=RegExp("^["+t.NAME_CHAR+"]+$","u"),t.S_LIST=[32,10,13,9],t.isChar=function(e){return e>=1&&e<=55295||e>=57344&&e<=65533||e>=65536&&e<=1114111},t.isRestrictedChar=function(e){return e>=1&&e<=8||11===e||12===e||e>=14&&e<=31||e>=127&&e<=132||e>=134&&e<=159},t.isCharAndNotRestricted=function(e){return 9===e||10===e||13===e||e>31&&e<127||133===e||e>159&&e<=55295||e>=57344&&e<=65533||e>=65536&&e<=1114111},t.isS=function(e){return 32===e||10===e||13===e||9===e},t.isNameStartChar=r,t.isNameChar=function(e){return r(e)||e>=48&&e<=57||45===e||46===e||183===e||e>=768&&e<=879||e>=8255&&e<=8256}},18162:(e,t)=>{"use strict";function r(e){return e>=65&&e<=90||95===e||e>=97&&e<=122||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(t,"__esModule",{value:!0}),t.NC_NAME_START_CHAR="A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8---------\uD800\uDC00-\uDB7F\uDFFF",t.NC_NAME_CHAR="-"+t.NC_NAME_START_CHAR+".0-9\xb7--",t.NC_NAME_START_CHAR_RE=RegExp("^["+t.NC_NAME_START_CHAR+"]$","u"),t.NC_NAME_CHAR_RE=RegExp("^["+t.NC_NAME_CHAR+"]$","u"),t.NC_NAME_RE=RegExp("^["+t.NC_NAME_START_CHAR+"]["+t.NC_NAME_CHAR+"]*$","u"),t.isNCNameStartChar=r,t.isNCNameChar=function(e){return r(e)||45===e||46===e||e>=48&&e<=57||183===e||e>=768&&e<=879||e>=8255&&e<=8256}},89635:(e,t,r)=>{var i=r(28354).inherits,n=r(63971).ZipArchiveOutputStream,s=r(63971).ZipArchiveEntry,a=r(96782),o=e.exports=function(e){if(!(this instanceof o))return new o(e);(e=this.options=e||{}).zlib=e.zlib||{},n.call(this,e),"number"==typeof e.level&&e.level>=0&&(e.zlib.level=e.level,delete e.level),e.forceZip64||"number"!=typeof e.zlib.level||0!==e.zlib.level||(e.store=!0),e.namePrependSlash=e.namePrependSlash||!1,e.comment&&e.comment.length>0&&this.setComment(e.comment)};i(o,n),o.prototype._normalizeFileData=function(e){var t="directory"===(e=a.defaults(e,{type:"file",name:null,namePrependSlash:this.options.namePrependSlash,linkname:null,date:null,mode:null,store:this.options.store,comment:""})).type,r="symlink"===e.type;return e.name&&(e.name=a.sanitizePath(e.name),r||"/"!==e.name.slice(-1)?t&&(e.name+="/"):(t=!0,e.type="directory")),(t||r)&&(e.store=!0),e.date=a.dateify(e.date),e},o.prototype.entry=function(e,t,r){if("function"!=typeof r&&(r=this._emitErrorCallback.bind(this)),"file"!==(t=this._normalizeFileData(t)).type&&"directory"!==t.type&&"symlink"!==t.type){r(Error(t.type+" entries not currently supported"));return}if("string"!=typeof t.name||0===t.name.length){r(Error("entry name must be a non-empty string value"));return}if("symlink"===t.type&&"string"!=typeof t.linkname){r(Error("entry linkname must be a non-empty string value when type equals symlink"));return}var i=new s(t.name);return i.setTime(t.date,this.options.forceLocalTime),t.namePrependSlash&&i.setName(t.name,!0),t.store&&i.setMethod(0),t.comment.length>0&&i.setComment(t.comment),"symlink"===t.type&&"number"!=typeof t.mode&&(t.mode=40960),"number"==typeof t.mode&&("symlink"===t.type&&(t.mode|=40960),i.setUnixMode(t.mode)),"symlink"===t.type&&"string"==typeof t.linkname&&(e=Buffer.from(t.linkname)),n.prototype.entry.call(this,i,e,r)},o.prototype.finalize=function(){this.finish()}},44849:(e,t,r)=>{e.exports=d,d.sync=y;var i=r(12412),n=r(33873),s=r(29021),a=void 0;try{a=r(88939)}catch(e){}var o=parseInt("666",8),l={nosort:!0,silent:!0},u=0,c="win32"===process.platform;function h(e){if(["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(function(t){e[t]=e[t]||s[t],e[t+="Sync"]=e[t]||s[t]}),e.maxBusyTries=e.maxBusyTries||3,e.emfileWait=e.emfileWait||1e3,!1===e.glob&&(e.disableGlob=!0),!0!==e.disableGlob&&void 0===a)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");e.disableGlob=e.disableGlob||!1,e.glob=e.glob||l}function d(e,t,r){"function"==typeof t&&(r=t,t={}),i(e,"rimraf: missing path"),i.equal(typeof e,"string","rimraf: path should be a string"),i.equal(typeof r,"function","rimraf: callback function required"),i(t,"rimraf: invalid options argument provided"),i.equal(typeof t,"object","rimraf: options should be object"),h(t);var n=0,s=null,o=0;if(t.disableGlob||!a.hasMagic(e))return l(null,[e]);function l(e,i){return e?r(e):0===(o=i.length)?r():void i.forEach(function(e){p(e,t,function i(a){var l;if(a){if(("EBUSY"===a.code||"ENOTEMPTY"===a.code||"EPERM"===a.code)&&n<t.maxBusyTries)return setTimeout(function(){p(e,t,i)},100*++n);if("EMFILE"===a.code&&u<t.emfileWait)return setTimeout(function(){p(e,t,i)},u++);"ENOENT"===a.code&&(a=null)}u=0,l=a,s=s||l,0==--o&&r(s)})})}t.lstat(e,function(r,i){if(!r)return l(null,[e]);a(e,t.glob,l)})}function p(e,t,r){i(e),i(t),i("function"==typeof r),t.lstat(e,function(i,n){return i&&"ENOENT"===i.code?r(null):(i&&"EPERM"===i.code&&c&&f(e,t,i,r),n&&n.isDirectory())?g(e,t,i,r):void t.unlink(e,function(i){if(i){if("ENOENT"===i.code)return r(null);if("EPERM"===i.code)return c?f(e,t,i,r):g(e,t,i,r);if("EISDIR"===i.code)return g(e,t,i,r)}return r(i)})})}function f(e,t,r,n){i(e),i(t),i("function"==typeof n),r&&i(r instanceof Error),t.chmod(e,o,function(i){i?n("ENOENT"===i.code?null:r):t.stat(e,function(i,s){i?n("ENOENT"===i.code?null:r):s.isDirectory()?g(e,t,r,n):t.unlink(e,n)})})}function m(e,t,r){i(e),i(t),r&&i(r instanceof Error);try{t.chmodSync(e,o)}catch(e){if("ENOENT"===e.code)return;throw r}try{var n=t.statSync(e)}catch(e){if("ENOENT"===e.code)return;throw r}n.isDirectory()?v(e,t,r):t.unlinkSync(e)}function g(e,t,r,s){i(e),i(t),r&&i(r instanceof Error),i("function"==typeof s),t.rmdir(e,function(a){a&&("ENOTEMPTY"===a.code||"EEXIST"===a.code||"EPERM"===a.code)?(i(e),i(t),i("function"==typeof s),t.readdir(e,function(r,i){if(r)return s(r);var a,o=i.length;if(0===o)return t.rmdir(e,s);i.forEach(function(r){d(n.join(e,r),t,function(r){if(!a){if(r)return s(a=r);0==--o&&t.rmdir(e,s)}})})})):a&&"ENOTDIR"===a.code?s(r):s(a)})}function y(e,t){if(h(t=t||{}),i(e,"rimraf: missing path"),i.equal(typeof e,"string","rimraf: path should be a string"),i(t,"rimraf: missing options"),i.equal(typeof t,"object","rimraf: options should be object"),t.disableGlob||!a.hasMagic(e))r=[e];else try{t.lstatSync(e),r=[e]}catch(i){r=a.sync(e,t.glob)}if(r.length)for(var r,n=0;n<r.length;n++){var e=r[n];try{var s=t.lstatSync(e)}catch(r){if("ENOENT"===r.code)return;"EPERM"===r.code&&c&&m(e,t,r)}try{s&&s.isDirectory()?v(e,t,null):t.unlinkSync(e)}catch(r){if("ENOENT"===r.code)return;if("EPERM"===r.code)return c?m(e,t,r):v(e,t,r);if("EISDIR"!==r.code)throw r;v(e,t,r)}}}function v(e,t,r){i(e),i(t),r&&i(r instanceof Error);try{t.rmdirSync(e)}catch(s){if("ENOENT"===s.code)return;if("ENOTDIR"===s.code)throw r;("ENOTEMPTY"===s.code||"EEXIST"===s.code||"EPERM"===s.code)&&function(e,t){i(e),i(t),t.readdirSync(e).forEach(function(r){y(n.join(e,r),t)});for(var r=c?100:1,s=0;;){var a=!0;try{var o=t.rmdirSync(e,t);return a=!1,o}finally{if(++s<r&&a)continue}}}(e,t)}}},75450:(e,t,r)=>{"use strict";function i(e,...t){return(...r)=>e(...t,...r)}function n(e){return function(...t){var r=t.pop();return e.call(this,t,r)}}r.r(t),r.d(t,{all:()=>ep,allLimit:()=>ef,allSeries:()=>em,any:()=>eJ,anyLimit:()=>eQ,anySeries:()=>eZ,apply:()=>i,applyEach:()=>A,applyEachSeries:()=>I,asyncify:()=>h,auto:()=>D,autoInject:()=>B,cargo:()=>H,cargoQueue:()=>W,compose:()=>K,concat:()=>Z,concatLimit:()=>Q,concatSeries:()=>X,constant:()=>Y,default:()=>e9,detect:()=>et,detectLimit:()=>er,detectSeries:()=>ei,dir:()=>es,doDuring:()=>ea,doUntil:()=>eo,doWhilst:()=>ea,during:()=>e4,each:()=>eu,eachLimit:()=>ec,eachOf:()=>O,eachOfLimit:()=>k,eachOfSeries:()=>N,eachSeries:()=>eh,ensureAsync:()=>ed,every:()=>ep,everyLimit:()=>ef,everySeries:()=>em,filter:()=>ey,filterLimit:()=>e_,filterSeries:()=>ev,find:()=>et,findLimit:()=>er,findSeries:()=>ei,flatMap:()=>Z,flatMapLimit:()=>Q,flatMapSeries:()=>X,foldl:()=>V,foldr:()=>eF,forEach:()=>eu,forEachLimit:()=>ec,forEachOf:()=>O,forEachOfLimit:()=>k,forEachOfSeries:()=>N,forEachSeries:()=>eh,forever:()=>eb,groupBy:()=>ex,groupByLimit:()=>ew,groupBySeries:()=>eS,inject:()=>V,log:()=>eE,map:()=>C,mapLimit:()=>J,mapSeries:()=>R,mapValues:()=>ek,mapValuesLimit:()=>eT,mapValuesSeries:()=>eO,memoize:()=>eC,nextTick:()=>eA,parallel:()=>eR,parallelLimit:()=>eI,priorityQueue:()=>eL,queue:()=>eP,race:()=>e$,reduce:()=>V,reduceRight:()=>eF,reflect:()=>eM,reflectAll:()=>eB,reject:()=>ez,rejectLimit:()=>eq,rejectSeries:()=>eH,retry:()=>eV,retryable:()=>eG,select:()=>ey,selectLimit:()=>e_,selectSeries:()=>ev,seq:()=>G,series:()=>eK,setImmediate:()=>c,some:()=>eJ,someLimit:()=>eQ,someSeries:()=>eZ,sortBy:()=>eX,timeout:()=>eY,times:()=>e1,timesLimit:()=>e0,timesSeries:()=>e2,transform:()=>e5,tryEach:()=>e6,unmemoize:()=>e3,until:()=>e8,waterfall:()=>e7,whilst:()=>e4,wrapSync:()=>h});var s="function"==typeof queueMicrotask&&queueMicrotask,a="function"==typeof setImmediate&&setImmediate,o="object"==typeof process&&"function"==typeof process.nextTick;function l(e){setTimeout(e,0)}function u(e){return(t,...r)=>e(()=>t(...r))}var c=u(s?queueMicrotask:a?setImmediate:o?process.nextTick:l);function h(e){return f(e)?function(...t){let r=t.pop();return d(e.apply(this,t),r)}:n(function(t,r){var i;try{i=e.apply(this,t)}catch(e){return r(e)}if(i&&"function"==typeof i.then)return d(i,r);r(null,i)})}function d(e,t){return e.then(e=>{p(t,null,e)},e=>{p(t,e&&(e instanceof Error||e.message)?e:Error(e))})}function p(e,t,r){try{e(t,r)}catch(e){c(e=>{throw e},e)}}function f(e){return"AsyncFunction"===e[Symbol.toStringTag]}function m(e){if("function"!=typeof e)throw Error("expected a function");return f(e)?h(e):e}function g(e,t){if(t||(t=e.length),!t)throw Error("arity is undefined");return function(...r){return"function"==typeof r[t-1]?e.apply(this,r):new Promise((i,n)=>{r[t-1]=(e,...t)=>{if(e)return n(e);i(t.length>1?t:t[0])},e.apply(this,r)})}}function y(e){return function(t,...r){return g(function(i){var n=this;return e(t,(e,t)=>{m(e).apply(n,r.concat(t))},i)})}}function v(e,t,r,i){t=t||[];var n=[],s=0,a=m(r);return e(t,(e,t,r)=>{var i=s++;a(e,(e,t)=>{n[i]=t,r(e)})},e=>{i(e,n)})}function b(e){return e&&"number"==typeof e.length&&e.length>=0&&e.length%1==0}let w={};function x(e){function t(...r){if(null!==e){var i=e;e=null,i.apply(this,r)}}return Object.assign(t,e),t}function S(e){return function(...t){if(null===e)throw Error("Callback was already called.");var r=e;e=null,r.apply(this,t)}}function E(e,t,r,i){let n=!1,s=!1,a=!1,o=0,l=0;function u(){o>=t||a||n||(a=!0,e.next().then(({value:e,done:t})=>{if(!s&&!n){if(a=!1,t){n=!0,o<=0&&i(null);return}o++,r(e,l,c),l++,u()}}).catch(h))}function c(e,t){if(o-=1,!s){if(e)return h(e);if(!1===e){n=!0,s=!0;return}if(t===w||n&&o<=0)return n=!0,i(null);u()}}function h(e){s||(a=!1,n=!0,i(e))}u()}var T=e=>(t,r,i)=>{if(i=x(i),e<=0)throw RangeError("concurrency limit cannot be less than 1");if(!t)return i(null);if("AsyncGenerator"===t[Symbol.toStringTag])return E(t,e,r,i);if("function"==typeof t[Symbol.asyncIterator])return E(t[Symbol.asyncIterator](),e,r,i);var n=function(e){if(b(e))return t=-1,r=e.length,function(){return++t<r?{value:e[t],key:t}:null};var t,r,i,n,s,a,o=e[Symbol.iterator]&&e[Symbol.iterator]();return o?(i=-1,function(){var e=o.next();return e.done?null:(i++,{value:e.value,key:i})}):(n=e?Object.keys(e):[],s=-1,a=n.length,function t(){var r=n[++s];return"__proto__"===r?t():s<a?{value:e[r],key:r}:null})}(t),s=!1,a=!1,o=0,l=!1;function u(e,t){if(!a){if(o-=1,e)s=!0,i(e);else if(!1===e)s=!0,a=!0;else{if(t===w||s&&o<=0)return s=!0,i(null);l||c()}}}function c(){for(l=!0;o<e&&!s;){var t=n();if(null===t){s=!0,o<=0&&i(null);return}o+=1,r(t.value,t.key,S(u))}l=!1}c()},k=g(function(e,t,r,i){return T(t)(e,m(r),i)},4),O=g(function(e,t,r){return(b(e)?function(e,t,r){r=x(r);var i=0,n=0,{length:s}=e,a=!1;function o(e,t){!1===e&&(a=!0),!0!==a&&(e?r(e):(++n===s||t===w)&&r(null))}for(0===s&&r(null);i<s;i++)t(e[i],i,S(o))}:function(e,t,r){return k(e,1/0,t,r)})(e,m(t),r)},3),C=g(function(e,t,r){return v(O,e,t,r)},3),A=y(C),N=g(function(e,t,r){return k(e,1,t,r)},3),R=g(function(e,t,r){return v(N,e,t,r)},3),I=y(R);let P=Symbol("promiseCallback");function j(){let e,t;function r(i,...n){if(i)return t(i);e(n.length>1?n:n[0])}return r[P]=new Promise((r,i)=>{e=r,t=i}),r}function D(e,t,r){"number"!=typeof t&&(r=t,t=null),r=x(r||j());var i=Object.keys(e).length;if(!i)return r(null);t||(t=i);var n={},s=0,a=!1,o=!1,l=Object.create(null),u=[],c=[],h={};function d(e,t){u.push(()=>(function(e,t){if(!o){var i=S((t,...i)=>{if(s--,!1===t){a=!0;return}if(i.length<2&&([i]=i),t){var u={};if(Object.keys(n).forEach(e=>{u[e]=n[e]}),u[e]=i,o=!0,l=Object.create(null),a)return;r(t,u)}else n[e]=i,(l[e]||[]).forEach(e=>e()),p()});s++;var u=m(t[t.length-1]);t.length>1?u(n,i):u(i)}})(e,t))}function p(){if(!a){if(0===u.length&&0===s)return r(null,n);for(;u.length&&s<t;)u.shift()()}}return Object.keys(e).forEach(t=>{var r=e[t];if(!Array.isArray(r)){d(t,[r]),c.push(t);return}var i=r.slice(0,r.length-1),n=i.length;if(0===n){d(t,r),c.push(t);return}h[t]=n,i.forEach(s=>{var a,o;if(!e[s])throw Error("async.auto task `"+t+"` has a non-existent dependency `"+s+"` in "+i.join(", "));a=()=>{0==--n&&d(t,r)},(o=l[s])||(o=l[s]=[]),o.push(a)})}),function(){for(var t,r=0;c.length;)t=c.pop(),r++,(function(t){var r=[];return Object.keys(e).forEach(i=>{let n=e[i];Array.isArray(n)&&n.indexOf(t)>=0&&r.push(i)}),r})(t).forEach(e=>{0==--h[e]&&c.push(e)});if(r!==i)throw Error("async.auto cannot execute tasks due to a recursive dependency")}(),p(),r[P]}var L=/^(?:async\s)?(?:function)?\s*(?:\w+\s*)?\(([^)]+)\)(?:\s*{)/,$=/^(?:async\s)?\s*(?:\(\s*)?((?:[^)=\s]\s*)*)(?:\)\s*)?=>/,F=/,/,M=/(=.+)?(\s*)$/;function B(e,t){var r={};return Object.keys(e).forEach(t=>{var i,n=e[t],s=f(n),a=!s&&1===n.length||s&&0===n.length;if(Array.isArray(n))n=(i=[...n]).pop(),r[t]=i.concat(i.length>0?o:n);else if(a)r[t]=n;else{if(i=function(e){let t=function(e){let t="",r=0,i=e.indexOf("*/");for(;r<e.length;)if("/"===e[r]&&"/"===e[r+1]){let t=e.indexOf("\n",r);r=-1===t?e.length:t}else if(-1!==i&&"/"===e[r]&&"*"===e[r+1]){let n=e.indexOf("*/",r);-1!==n?(r=n+2,i=e.indexOf("*/",r)):(t+=e[r],r++)}else t+=e[r],r++;return t}(e.toString()),r=t.match(L);if(r||(r=t.match($)),!r)throw Error("could not parse args in autoInject\nSource:\n"+t);let[,i]=r;return i.replace(/\s/g,"").split(F).map(e=>e.replace(M,"").trim())}(n),0===n.length&&!s&&0===i.length)throw Error("autoInject task functions require explicit parameters.");s||i.pop(),r[t]=i.concat(o)}function o(e,t){var r=i.map(t=>e[t]);r.push(t),m(n)(...r)}}),D(r,t)}class U{constructor(){this.head=this.tail=null,this.length=0}removeLink(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e}empty(){for(;this.head;)this.shift();return this}insertAfter(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1}insertBefore(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1}unshift(e){this.head?this.insertBefore(this.head,e):z(this,e)}push(e){this.tail?this.insertAfter(this.tail,e):z(this,e)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var e=this.head;e;)yield e.data,e=e.next}remove(e){for(var t=this.head;t;){var{next:r}=t;e(t)&&this.removeLink(t),t=r}return this}}function z(e,t){e.length=1,e.head=e.tail=t}function q(e,t,r){if(null==t)t=1;else if(0===t)throw RangeError("Concurrency must not be zero");var i=m(e),n=0,s=[];let a={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function o(e,t){return e?t?void(a[e]=a[e].filter(e=>e!==t)):a[e]=[]:Object.keys(a).forEach(e=>a[e]=[])}function l(e,...t){a[e].forEach(e=>e(...t))}var u=!1;function h(e,t,r,i){if(null!=i&&"function"!=typeof i)throw Error("task callback must be a function");function n(e,...t){return e?r?a(e):s():t.length<=1?s(t[0]):void s(t)}g.started=!0;var s,a,o=g._createTaskItem(e,r?n:i||n);if(t?g._tasks.unshift(o):g._tasks.push(o),u||(u=!0,c(()=>{u=!1,g.process()})),r||!i)return new Promise((e,t)=>{s=e,a=t})}function d(e){return!!(0===e.length&&g.idle())&&(c(()=>l("drain")),!0)}let p=e=>t=>{if(!t)return new Promise((t,r)=>{!function(e,t){let r=(...i)=>{o(e,r),t(...i)};a[e].push(r)}(e,(e,i)=>{if(e)return r(e);t(i)})});o(e),function(e,t){a[e].push(t)}(e,t)};var f=!1,g={_tasks:new U,_createTaskItem:(e,t)=>({data:e,callback:t}),*[Symbol.iterator](){yield*g._tasks[Symbol.iterator]()},concurrency:t,payload:r,buffer:t/4,started:!1,paused:!1,push(e,t){if(Array.isArray(e)){if(d(e))return;return e.map(e=>h(e,!1,!1,t))}return h(e,!1,!1,t)},pushAsync(e,t){if(Array.isArray(e)){if(d(e))return;return e.map(e=>h(e,!1,!0,t))}return h(e,!1,!0,t)},kill(){o(),g._tasks.empty()},unshift(e,t){if(Array.isArray(e)){if(d(e))return;return e.map(e=>h(e,!0,!1,t))}return h(e,!0,!1,t)},unshiftAsync(e,t){if(Array.isArray(e)){if(d(e))return;return e.map(e=>h(e,!0,!0,t))}return h(e,!0,!0,t)},remove(e){g._tasks.remove(e)},process(){if(!f){for(f=!0;!g.paused&&n<g.concurrency&&g._tasks.length;){var e=[],t=[],r=g._tasks.length;g.payload&&(r=Math.min(r,g.payload));for(var a=0;a<r;a++){var o=g._tasks.shift();e.push(o),s.push(o),t.push(o.data)}n+=1,0===g._tasks.length&&l("empty"),n===g.concurrency&&l("saturated"),i(t,S(function(e){return function(t,...r){n-=1;for(var i=0,a=e.length;i<a;i++){var o=e[i],u=s.indexOf(o);0===u?s.shift():u>0&&s.splice(u,1),o.callback(t,...r),null!=t&&l("error",t,o.data)}n<=g.concurrency-g.buffer&&l("unsaturated"),g.idle()&&l("drain"),g.process()}}(e)))}f=!1}},length:()=>g._tasks.length,running:()=>n,workersList:()=>s,idle:()=>g._tasks.length+n===0,pause(){g.paused=!0},resume(){!1!==g.paused&&(g.paused=!1,c(g.process))}};return Object.defineProperties(g,{saturated:{writable:!1,value:p("saturated")},unsaturated:{writable:!1,value:p("unsaturated")},empty:{writable:!1,value:p("empty")},drain:{writable:!1,value:p("drain")},error:{writable:!1,value:p("error")}}),g}function H(e,t){return q(e,1,t)}function W(e,t,r){return q(e,t,r)}var V=g(function(e,t,r,i){i=x(i);var n=m(r);return N(e,(e,r,i)=>{n(t,e,(e,r)=>{t=r,i(e)})},e=>i(e,t))},4);function G(...e){var t=e.map(m);return function(...e){var r=this,i=e[e.length-1];return"function"==typeof i?e.pop():i=j(),V(t,e,(e,t,i)=>{t.apply(r,e.concat((e,...t)=>{i(e,t)}))},(e,t)=>i(e,...t)),i[P]}}function K(...e){return G(...e.reverse())}var J=g(function(e,t,r,i){return v(T(t),e,r,i)},4),Q=g(function(e,t,r,i){var n=m(r);return J(e,t,(e,t)=>{n(e,(e,...r)=>e?t(e):t(e,r))},(e,t)=>{for(var r=[],n=0;n<t.length;n++)t[n]&&(r=r.concat(...t[n]));return i(e,r)})},4),Z=g(function(e,t,r){return Q(e,1/0,t,r)},3),X=g(function(e,t,r){return Q(e,1,t,r)},3);function Y(...e){return function(...t){return t.pop()(null,...e)}}function ee(e,t){return(r,i,n,s)=>{var a,o=!1;let l=m(n);r(i,(r,i,n)=>{l(r,(i,s)=>i||!1===i?n(i):e(s)&&!a?(o=!0,a=t(!0,r),n(null,w)):void n())},e=>{if(e)return s(e);s(null,o?a:t(!1))})}}var et=g(function(e,t,r){return ee(e=>e,(e,t)=>t)(O,e,t,r)},3),er=g(function(e,t,r,i){return ee(e=>e,(e,t)=>t)(T(t),e,r,i)},4),ei=g(function(e,t,r){return ee(e=>e,(e,t)=>t)(T(1),e,t,r)},3);function en(e){return(t,...r)=>m(t)(...r,(t,...r)=>{"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&r.forEach(t=>console[e](t)))})}var es=en("dir"),ea=g(function(e,t,r){r=S(r);var i,n=m(e),s=m(t);function a(e,...t){if(e)return r(e);!1!==e&&(i=t,s(...t,o))}function o(e,t){if(e)return r(e);if(!1!==e){if(!t)return r(null,...i);n(a)}}return o(null,!0)},3);function eo(e,t,r){let i=m(t);return ea(e,(...e)=>{let t=e.pop();i(...e,(e,r)=>t(e,!r))},r)}function el(e){return(t,r,i)=>e(t,i)}var eu=g(function(e,t,r){return O(e,el(m(t)),r)},3),ec=g(function(e,t,r,i){return T(t)(e,el(m(r)),i)},4),eh=g(function(e,t,r){return ec(e,1,t,r)},3);function ed(e){return f(e)?e:function(...t){var r=t.pop(),i=!0;t.push((...e)=>{i?c(()=>r(...e)):r(...e)}),e.apply(this,t),i=!1}}var ep=g(function(e,t,r){return ee(e=>!e,e=>!e)(O,e,t,r)},3),ef=g(function(e,t,r,i){return ee(e=>!e,e=>!e)(T(t),e,r,i)},4),em=g(function(e,t,r){return ee(e=>!e,e=>!e)(N,e,t,r)},3);function eg(e,t,r,i){return(b(t)?function(e,t,r,i){var n=Array(t.length);e(t,(e,t,i)=>{r(e,(e,r)=>{n[t]=!!r,i(e)})},e=>{if(e)return i(e);for(var r=[],s=0;s<t.length;s++)n[s]&&r.push(t[s]);i(null,r)})}:function(e,t,r,i){var n=[];e(t,(e,t,i)=>{r(e,(r,s)=>{if(r)return i(r);s&&n.push({index:t,value:e}),i(r)})},e=>{if(e)return i(e);i(null,n.sort((e,t)=>e.index-t.index).map(e=>e.value))})})(e,t,m(r),i)}var ey=g(function(e,t,r){return eg(O,e,t,r)},3),e_=g(function(e,t,r,i){return eg(T(t),e,r,i)},4),ev=g(function(e,t,r){return eg(N,e,t,r)},3),eb=g(function(e,t){var r=S(t),i=m(ed(e));return function e(t){if(t)return r(t);!1!==t&&i(e)}()},2),ew=g(function(e,t,r,i){var n=m(r);return J(e,t,(e,t)=>{n(e,(r,i)=>r?t(r):t(r,{key:i,val:e}))},(e,t)=>{for(var r={},{hasOwnProperty:n}=Object.prototype,s=0;s<t.length;s++)if(t[s]){var{key:a}=t[s],{val:o}=t[s];n.call(r,a)?r[a].push(o):r[a]=[o]}return i(e,r)})},4);function ex(e,t,r){return ew(e,1/0,t,r)}function eS(e,t,r){return ew(e,1,t,r)}var eE=en("log"),eT=g(function(e,t,r,i){i=x(i);var n={},s=m(r);return T(t)(e,(e,t,r)=>{s(e,t,(e,i)=>{if(e)return r(e);n[t]=i,r(e)})},e=>i(e,n))},4);function ek(e,t,r){return eT(e,1/0,t,r)}function eO(e,t,r){return eT(e,1,t,r)}function eC(e,t=e=>e){var r=Object.create(null),i=Object.create(null),s=m(e),a=n((e,n)=>{var a=t(...e);a in r?c(()=>n(null,...r[a])):a in i?i[a].push(n):(i[a]=[n],s(...e,(e,...t)=>{e||(r[a]=t);var n=i[a];delete i[a];for(var s=0,o=n.length;s<o;s++)n[s](e,...t)}))});return a.memo=r,a.unmemoized=e,a}var eA=u(o?process.nextTick:a?setImmediate:l),eN=g((e,t,r)=>{var i=b(t)?[]:{};e(t,(e,t,r)=>{m(e)((e,...n)=>{n.length<2&&([n]=n),i[t]=n,r(e)})},e=>r(e,i))},3);function eR(e,t){return eN(O,e,t)}function eI(e,t,r){return eN(T(t),e,r)}function eP(e,t){var r=m(e);return q((e,t)=>{r(e[0],t)},t,1)}class ej{constructor(){this.heap=[],this.pushCount=Number.MIN_SAFE_INTEGER}get length(){return this.heap.length}empty(){return this.heap=[],this}percUp(e){let t;for(;e>0&&eD(this.heap[e],this.heap[t=(e+1>>1)-1]);){let r=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=r,e=t}}percDown(e){let t;for(;(t=(e<<1)+1)<this.heap.length&&(t+1<this.heap.length&&eD(this.heap[t+1],this.heap[t])&&(t+=1),!eD(this.heap[e],this.heap[t]));){let r=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=r,e=t}}push(e){e.pushCount=++this.pushCount,this.heap.push(e),this.percUp(this.heap.length-1)}unshift(e){return this.heap.push(e)}shift(){let[e]=this.heap;return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.percDown(0),e}toArray(){return[...this]}*[Symbol.iterator](){for(let e=0;e<this.heap.length;e++)yield this.heap[e].data}remove(e){let t=0;for(let r=0;r<this.heap.length;r++)!e(this.heap[r])&&(this.heap[t]=this.heap[r],t++);this.heap.splice(t);for(let e=(this.heap.length-1+1>>1)-1;e>=0;e--)this.percDown(e);return this}}function eD(e,t){return e.priority!==t.priority?e.priority<t.priority:e.pushCount<t.pushCount}function eL(e,t){var r=eP(e,t),{push:i,pushAsync:n}=r;function s(e,t){return Array.isArray(e)?e.map(e=>({data:e,priority:t})):{data:e,priority:t}}return r._tasks=new ej,r._createTaskItem=({data:e,priority:t},r)=>({data:e,priority:t,callback:r}),r.push=function(e,t=0,r){return i(s(e,t),r)},r.pushAsync=function(e,t=0,r){return n(s(e,t),r)},delete r.unshift,delete r.unshiftAsync,r}var e$=g(function(e,t){if(t=x(t),!Array.isArray(e))return t(TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var r=0,i=e.length;r<i;r++)m(e[r])(t)},2);function eF(e,t,r,i){return V([...e].reverse(),t,r,i)}function eM(e){var t=m(e);return n(function(e,r){return e.push((e,...t)=>{let i={};if(e&&(i.error=e),t.length>0){var n=t;t.length<=1&&([n]=t),i.value=n}r(null,i)}),t.apply(this,e)})}function eB(e){var t;return Array.isArray(e)?t=e.map(eM):(t={},Object.keys(e).forEach(r=>{t[r]=eM.call(this,e[r])})),t}function eU(e,t,r,i){let n=m(r);return eg(e,t,(e,t)=>{n(e,(e,r)=>{t(e,!r)})},i)}var ez=g(function(e,t,r){return eU(O,e,t,r)},3),eq=g(function(e,t,r,i){return eU(T(t),e,r,i)},4),eH=g(function(e,t,r){return eU(N,e,t,r)},3);function eW(e){return function(){return e}}function eV(e,t,r){var i={times:5,intervalFunc:eW(0)};if(arguments.length<3&&"function"==typeof e?(r=t||j(),t=e):(function(e,t){if("object"==typeof t)e.times=+t.times||5,e.intervalFunc="function"==typeof t.interval?t.interval:eW(+t.interval||0),e.errorFilter=t.errorFilter;else if("number"==typeof t||"string"==typeof t)e.times=+t||5;else throw Error("Invalid arguments for async.retry")}(i,e),r=r||j()),"function"!=typeof t)throw Error("Invalid arguments for async.retry");var n=m(t),s=1;return function e(){n((t,...n)=>{!1!==t&&(t&&s++<i.times&&("function"!=typeof i.errorFilter||i.errorFilter(t))?setTimeout(e,i.intervalFunc(s-1)):r(t,...n))})}(),r[P]}function eG(e,t){t||(t=e,e=null);let r=e&&e.arity||t.length;f(t)&&(r+=1);var i=m(t);return n((t,n)=>{function s(e){i(...t,e)}return(t.length<r-1||null==n)&&(t.push(n),n=j()),e?eV(e,s,n):eV(s,n),n[P]})}function eK(e,t){return eN(N,e,t)}var eJ=g(function(e,t,r){return ee(Boolean,e=>e)(O,e,t,r)},3),eQ=g(function(e,t,r,i){return ee(Boolean,e=>e)(T(t),e,r,i)},4),eZ=g(function(e,t,r){return ee(Boolean,e=>e)(N,e,t,r)},3),eX=g(function(e,t,r){var i=m(t);return C(e,(e,t)=>{i(e,(r,i)=>{if(r)return t(r);t(r,{value:e,criteria:i})})},(e,t)=>{if(e)return r(e);r(null,t.sort(n).map(e=>e.value))});function n(e,t){var r=e.criteria,i=t.criteria;return r<i?-1:r>i?1:0}},3);function eY(e,t,r){var i=m(e);return n((n,s)=>{var a,o=!1;n.push((...e)=>{o||(s(...e),clearTimeout(a))}),a=setTimeout(function(){var t=Error('Callback function "'+(e.name||"anonymous")+'" timed out.');t.code="ETIMEDOUT",r&&(t.info=r),o=!0,s(t)},t),i(...n)})}function e0(e,t,r,i){var n=m(r);return J(function(e){for(var t=Array(e);e--;)t[e]=e;return t}(e),t,n,i)}function e1(e,t,r){return e0(e,1/0,t,r)}function e2(e,t,r){return e0(e,1,t,r)}function e5(e,t,r,i){arguments.length<=3&&"function"==typeof t&&(i=r,r=t,t=Array.isArray(e)?[]:{}),i=x(i||j());var n=m(r);return O(e,(e,r,i)=>{n(t,e,r,i)},e=>i(e,t)),i[P]}var e6=g(function(e,t){var r,i=null;return eh(e,(e,t)=>{m(e)((e,...n)=>{if(!1===e)return t(e);n.length<2?[r]=n:r=n,i=e,t(e?null:{})})},()=>t(i,r))});function e3(e){return(...t)=>(e.unmemoized||e)(...t)}var e4=g(function(e,t,r){r=S(r);var i=m(t),n=m(e),s=[];function a(e,...t){if(e)return r(e);s=t,!1!==e&&n(o)}function o(e,t){if(e)return r(e);if(!1!==e){if(!t)return r(null,...s);i(a)}}return n(o)},3);function e8(e,t,r){let i=m(e);return e4(e=>i((t,r)=>e(t,!r)),t,r)}var e7=g(function(e,t){if(t=x(t),!Array.isArray(e))return t(Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var r=0;function i(t){m(e[r++])(...t,S(n))}function n(s,...a){if(!1!==s){if(s||r===e.length)return t(s,...a);i(a)}}i([])}),e9={apply:i,applyEach:A,applyEachSeries:I,asyncify:h,auto:D,autoInject:B,cargo:H,cargoQueue:W,compose:K,concat:Z,concatLimit:Q,concatSeries:X,constant:Y,detect:et,detectLimit:er,detectSeries:ei,dir:es,doUntil:eo,doWhilst:ea,each:eu,eachLimit:ec,eachOf:O,eachOfLimit:k,eachOfSeries:N,eachSeries:eh,ensureAsync:ed,every:ep,everyLimit:ef,everySeries:em,filter:ey,filterLimit:e_,filterSeries:ev,forever:eb,groupBy:ex,groupByLimit:ew,groupBySeries:eS,log:eE,map:C,mapLimit:J,mapSeries:R,mapValues:ek,mapValuesLimit:eT,mapValuesSeries:eO,memoize:eC,nextTick:eA,parallel:eR,parallelLimit:eI,priorityQueue:eL,queue:eP,race:e$,reduce:V,reduceRight:eF,reflect:eM,reflectAll:eB,reject:ez,rejectLimit:eq,rejectSeries:eH,retry:eV,retryable:eG,seq:G,series:eK,setImmediate:c,some:eJ,someLimit:eQ,someSeries:eZ,sortBy:eX,timeout:eY,times:e1,timesLimit:e0,timesSeries:e2,transform:e5,tryEach:e6,unmemoize:e3,until:e8,waterfall:e7,whilst:e4,all:ep,allLimit:ef,allSeries:em,any:eJ,anyLimit:eQ,anySeries:eZ,find:et,findLimit:er,findSeries:ei,flatMap:Z,flatMapLimit:Q,flatMapSeries:X,forEach:eu,forEachSeries:eh,forEachLimit:ec,forEachOf:O,forEachOfSeries:N,forEachOfLimit:k,inject:V,foldl:V,foldr:eF,select:ey,selectLimit:e_,selectSeries:ev,wrapSync:h,during:e4,doDuring:ea}},921:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>L,__assign:()=>s,__asyncDelegator:()=>k,__asyncGenerator:()=>T,__asyncValues:()=>O,__await:()=>E,__awaiter:()=>f,__classPrivateFieldGet:()=>P,__classPrivateFieldIn:()=>D,__classPrivateFieldSet:()=>j,__createBinding:()=>g,__decorate:()=>o,__disposeResources:()=>F,__esDecorate:()=>u,__exportStar:()=>y,__extends:()=>n,__generator:()=>m,__importDefault:()=>I,__importStar:()=>R,__makeTemplateObject:()=>C,__metadata:()=>p,__param:()=>l,__propKey:()=>h,__read:()=>b,__rest:()=>a,__rewriteRelativeImportExtension:()=>M,__runInitializers:()=>c,__setFunctionName:()=>d,__spread:()=>w,__spreadArray:()=>S,__spreadArrays:()=>x,__values:()=>v,default:()=>B});var i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return(s=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r}function o(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a}function l(e,t){return function(r,i){t(r,i,e)}}function u(e,t,r,i,n,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw TypeError("Function expected");return e}for(var o,l=i.kind,u="getter"===l?"get":"setter"===l?"set":"value",c=!t&&e?i.static?e:e.prototype:null,h=t||(c?Object.getOwnPropertyDescriptor(c,i.name):{}),d=!1,p=r.length-1;p>=0;p--){var f={};for(var m in i)f[m]="access"===m?{}:i[m];for(var m in i.access)f.access[m]=i.access[m];f.addInitializer=function(e){if(d)throw TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var g=(0,r[p])("accessor"===l?{get:h.get,set:h.set}:h[u],f);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw TypeError("Object expected");(o=a(g.get))&&(h.get=o),(o=a(g.set))&&(h.set=o),(o=a(g.init))&&n.unshift(o)}else(o=a(g))&&("field"===l?n.unshift(o):h[u]=o)}c&&Object.defineProperty(c,i.name,h),d=!0}function c(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0}function h(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,i){return new(r||(r=Promise))(function(n,s){function a(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((i=i.apply(e,t||[])).next())})}function m(e,t){var r,i,n,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(l){return function(o){if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(s=0)),s;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}var g=Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function x(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),n=0,t=0;t<r;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,n++)i[n]=s[a];return i}function S(e,t,r){if(r||2==arguments.length)for(var i,n=0,s=t.length;n<s;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function T(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),s=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),i[Symbol.asyncIterator]=function(){return this},i;function a(e,t){n[e]&&(i[e]=function(t){return new Promise(function(r,i){s.push([e,t,r,i])>1||o(e,t)})},t&&(i[e]=t(i[e])))}function o(e,t){try{var r;(r=n[e](t)).value instanceof E?Promise.resolve(r.value.v).then(l,u):c(s[0][2],r)}catch(e){c(s[0][3],e)}}function l(e){o("next",e)}function u(e){o("throw",e)}function c(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}}function k(e){var t,r;return t={},i("next"),i("throw",function(e){throw e}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,n){t[i]=e[i]?function(t){return(r=!r)?{value:E(e[i](t)),done:!1}:n?n(t):t}:n}}function O(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise(function(i,n){(function(e,t,r,i){Promise.resolve(i).then(function(t){e({value:t,done:r})},t)})(i,n,(t=e[r](t)).done,t.value)})}}}function C(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},N=function(e){return(N=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(e)};function R(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=N(e),i=0;i<r.length;i++)"default"!==r[i]&&g(t,e,r[i]);return A(t,e),t}function I(e){return e&&e.__esModule?e:{default:e}}function P(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}function j(e,t,r,i,n){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function L(e,t,r){if(null!=t){var i,n;if("object"!=typeof t&&"function"!=typeof t)throw TypeError("Object expected.");if(r){if(!Symbol.asyncDispose)throw TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],r&&(n=i)}if("function"!=typeof i)throw TypeError("Object not disposable.");n&&(i=function(){try{n.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t}var $="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i};function F(e){function t(t){e.error=e.hasError?new $(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,i=0;return function n(){for(;r=e.stack.pop();)try{if(!r.async&&1===i)return i=0,e.stack.push(r),Promise.resolve().then(n);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(s).then(n,function(e){return t(e),n()})}else i|=1}catch(e){t(e)}if(1===i)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function M(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,r,i,n,s){return r?t?".jsx":".js":!i||n&&s?i+n+"."+s.toLowerCase()+"js":e}):e}let B={__extends:n,__assign:s,__rest:a,__decorate:o,__param:l,__esDecorate:u,__runInitializers:c,__propKey:h,__setFunctionName:d,__metadata:p,__awaiter:f,__generator:m,__createBinding:g,__exportStar:y,__values:v,__read:b,__spread:w,__spreadArrays:x,__spreadArray:S,__await:E,__asyncGenerator:T,__asyncDelegator:k,__asyncValues:O,__makeTemplateObject:C,__importStar:R,__importDefault:I,__classPrivateFieldGet:P,__classPrivateFieldSet:j,__classPrivateFieldIn:D,__addDisposableResource:L,__disposeResources:F,__rewriteRelativeImportExtension:M}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[303],()=>r(78460));module.exports=i})();