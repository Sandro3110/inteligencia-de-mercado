{
  "query": "\n-- Verificar dados gravados com pesquisaId e cruzamentos\n\n-- 1. Clientes enriquecidos\nSELECT \n  COUNT(*) as total_enriquecidos,\n  COUNT(DISTINCT pesquisaId) as pesquisas_distintas\nFROM clientes \nWHERE validationStatus = 'validated';\n\n-- 2. Mercados criados\nSELECT \n  COUNT(*) as total_mercados,\n  COUNT(DISTINCT pesquisaId) as pesquisas_distintas,\n  pesquisaId\nFROM mercados_unicos\nGROUP BY pesquisaId;\n\n-- 3. Produtos criados\nSELECT \n  COUNT(*) as total_produtos,\n  COUNT(DISTINCT pesquisaId) as pesquisas_distintas,\n  COUNT(DISTINCT clienteId) as clientes_distintos,\n  pesquisaId\nFROM produtos\nGROUP BY pesquisaId;\n\n-- 4. Concorrentes criados\nSELECT \n  COUNT(*) as total_concorrentes,\n  COUNT(DISTINCT pesquisaId) as pesquisas_distintas,\n  COUNT(DISTINCT mercadoId) as mercados_distintos,\n  pesquisaId\nFROM concorrentes\nGROUP BY pesquisaId;\n\n-- 5. Leads criados\nSELECT \n  COUNT(*) as total_leads,\n  COUNT(DISTINCT pesquisaId) as pesquisas_distintas,\n  COUNT(DISTINCT mercadoId) as mercados_distintos,\n  pesquisaId\nFROM leads\nGROUP BY pesquisaId;\n\n-- 6. Cruzamento clientes-mercados\nSELECT \n  COUNT(*) as total_associacoes,\n  COUNT(DISTINCT clienteId) as clientes_distintos,\n  COUNT(DISTINCT mercadoId) as mercados_distintos,\n  pesquisaId\nFROM clientes_mercados\nGROUP BY pesquisaId;\n\n-- 7. Amostra de 3 clientes com dados completos\nSELECT \n  c.id as cliente_id,\n  c.nome as cliente_nome,\n  c.pesquisaId,\n  COUNT(DISTINCT cm.mercadoId) as mercados,\n  COUNT(DISTINCT p.id) as produtos\nFROM clientes c\nLEFT JOIN clientes_mercados cm ON cm.clienteId = c.id\nLEFT JOIN produtos p ON p.clienteId = c.id\nWHERE c.validationStatus = 'validated'\nGROUP BY c.id\nLIMIT 3;\n",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 4LxBqKfHv1LE9mk.f65588d6698e --database XpSHcSiEisTmX38X46V9tQ --execute \n-- Verificar dados gravados com pesquisaId e cruzamentos\n\n-- 1. Clientes enriquecidos\nSELECT \n  COUNT(*) as total_enriquecidos,\n  COUNT(DISTINCT pesquisaId) as pesquisas_distintas\nFROM clientes \nWHERE validationStatus = 'validated';\n\n-- 2. Mercados criados\nSELECT \n  COUNT(*) as total_mercados,\n  COUNT(DISTINCT pesquisaId) as pesquisas_distintas,\n  pesquisaId\nFROM mercados_unicos\nGROUP BY pesquisaId;\n\n-- 3. Produtos criados\nSELECT \n  COUNT(*) as total_produtos,\n  COUNT(DISTINCT pesquisaId) as pesquisas_distintas,\n  COUNT(DISTINCT clienteId) as clientes_distintos,\n  pesquisaId\nFROM produtos\nGROUP BY pesquisaId;\n\n-- 4. Concorrentes criados\nSELECT \n  COUNT(*) as total_concorrentes,\n  COUNT(DISTINCT pesquisaId) as pesquisas_distintas,\n  COUNT(DISTINCT mercadoId) as mercados_distintos,\n  pesquisaId\nFROM concorrentes\nGROUP BY pesquisaId;\n\n-- 5. Leads criados\nSELECT \n  COUNT(*) as total_leads,\n  COUNT(DISTINCT pesquisaId) as pesquisas_distintas,\n  COUNT(DISTINCT mercadoId) as mercados_distintos,\n  pesquisaId\nFROM leads\nGROUP BY pesquisaId;\n\n-- 6. Cruzamento clientes-mercados\nSELECT \n  COUNT(*) as total_associacoes,\n  COUNT(DISTINCT clienteId) as clientes_distintos,\n  COUNT(DISTINCT mercadoId) as mercados_distintos,\n  pesquisaId\nFROM clientes_mercados\nGROUP BY pesquisaId;\n\n-- 7. Amostra de 3 clientes com dados completos\nSELECT \n  c.id as cliente_id,\n  c.nome as cliente_nome,\n  c.pesquisaId,\n  COUNT(DISTINCT cm.mercadoId) as mercados,\n  COUNT(DISTINCT p.id) as produtos\nFROM clientes c\nLEFT JOIN clientes_mercados cm ON cm.clienteId = c.id\nLEFT JOIN produtos p ON p.clienteId = c.id\nWHERE c.validationStatus = 'validated'\nGROUP BY c.id\nLIMIT 3;\n",
  "returncode": 1,
  "logs": [
    "total_enriquecidos\tpesquisas_distintas",
    "0\t0",
    "total_mercados\tpesquisas_distintas\tpesquisaId",
    "13\t1\t1",
    "total_produtos\tpesquisas_distintas\tclientes_distintos\tpesquisaId",
    "41\t1\t17\t1",
    "total_concorrentes\tpesquisas_distintas\tmercados_distintos\tpesquisaId",
    "113\t1\t13\t1",
    "total_leads\tpesquisas_distintas\tmercados_distintos\tpesquisaId",
    "73\t1\t13\t1",
    "ERROR 1054 (42S22) at line 47: Unknown column 'pesquisaid' in 'group statement'"
  ]
}
