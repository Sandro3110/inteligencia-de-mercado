{
  "query": "\n-- Verificar histórico de mudanças\nSELECT \n  'Clientes' as entidade,\n  changeType,\n  DATE(changedAt) as data,\n  COUNT(*) as quantidade_mudancas,\n  COUNT(DISTINCT clienteId) as registros_afetados\nFROM clientes_history\nGROUP BY changeType, DATE(changedAt)\nORDER BY DATE(changedAt) DESC, changeType\n\nUNION ALL\n\nSELECT \n  'Mercados' as entidade,\n  changeType,\n  DATE(changedAt) as data,\n  COUNT(*) as quantidade_mudancas,\n  COUNT(DISTINCT mercadoId) as registros_afetados\nFROM mercados_history\nGROUP BY changeType, DATE(changedAt)\nORDER BY DATE(changedAt) DESC, changeType\n\nUNION ALL\n\nSELECT \n  'Concorrentes' as entidade,\n  changeType,\n  DATE(changedAt) as data,\n  COUNT(*) as quantidade_mudancas,\n  COUNT(DISTINCT concorrenteId) as registros_afetados\nFROM concorrentes_history\nGROUP BY changeType, DATE(changedAt)\nORDER BY DATE(changedAt) DESC, changeType\n\nUNION ALL\n\nSELECT \n  'Leads' as entidade,\n  changeType,\n  DATE(changedAt) as data,\n  COUNT(*) as quantidade_mudancas,\n  COUNT(DISTINCT leadId) as registros_afetados\nFROM leads_history\nGROUP BY changeType, DATE(changedAt)\nORDER BY DATE(changedAt) DESC, changeType;\n",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 4LxBqKfHv1LE9mk.f65588d6698e --database XpSHcSiEisTmX38X46V9tQ --execute \n-- Verificar histórico de mudanças\nSELECT \n  'Clientes' as entidade,\n  changeType,\n  DATE(changedAt) as data,\n  COUNT(*) as quantidade_mudancas,\n  COUNT(DISTINCT clienteId) as registros_afetados\nFROM clientes_history\nGROUP BY changeType, DATE(changedAt)\nORDER BY DATE(changedAt) DESC, changeType\n\nUNION ALL\n\nSELECT \n  'Mercados' as entidade,\n  changeType,\n  DATE(changedAt) as data,\n  COUNT(*) as quantidade_mudancas,\n  COUNT(DISTINCT mercadoId) as registros_afetados\nFROM mercados_history\nGROUP BY changeType, DATE(changedAt)\nORDER BY DATE(changedAt) DESC, changeType\n\nUNION ALL\n\nSELECT \n  'Concorrentes' as entidade,\n  changeType,\n  DATE(changedAt) as data,\n  COUNT(*) as quantidade_mudancas,\n  COUNT(DISTINCT concorrenteId) as registros_afetados\nFROM concorrentes_history\nGROUP BY changeType, DATE(changedAt)\nORDER BY DATE(changedAt) DESC, changeType\n\nUNION ALL\n\nSELECT \n  'Leads' as entidade,\n  changeType,\n  DATE(changedAt) as data,\n  COUNT(*) as quantidade_mudancas,\n  COUNT(DISTINCT leadId) as registros_afetados\nFROM leads_history\nGROUP BY changeType, DATE(changedAt)\nORDER BY DATE(changedAt) DESC, changeType;\n",
  "returncode": 1,
  "logs": [
    "ERROR 1221 (HY000) at line 3: Incorrect usage of UNION and ORDER BY"
  ]
}